<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Computer Networking: A Top-Down Approach, 7th Edition</title><meta name="author" content="Www.Yutou.Org"/><style type="text/css"> .s1 { color: #156744; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 27.5pt; }
 .s3 { color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 18.5pt; }
 .s4 { color: #575757; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s5 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s6 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 .h3 { color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 .s7 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s8 { color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 .s9 { color: #333; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s10 { color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s11 { color: #AAA; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12pt; }
 .s12 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7.5pt; vertical-align: 3pt; }
 .h4 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 7.5pt; }
 .s13 { color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 .s14 { color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 .s15 { color: #1E79B8; font-family:Arial, sans-serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 12pt; }
 .s16 { color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 .h1 { color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 20pt; }
 .p, p { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; margin:0pt; }
 .s17 { color: #333; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s18 { color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 .a { color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 .s19 { color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 .s20 { color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 .h2, h2 { color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 .s21 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt; vertical-align: 6pt; }
 .s22 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
 .s23 { color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; vertical-align: 2pt; }
 .s24 { color: #575757; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s26 { color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s27 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: 2pt; }
 .s28 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 .s29 { color: #333; font-family:"Segoe UI Symbol", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s30 { color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s31 { color: #333; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
 .s32 { color: #468173; font-family:Georgia, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 15.5pt; }
 .s33 { color: #468173; font-family:Georgia, serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s34 { color: #AAA; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s35 { color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s36 { color: #1E79B8; font-family:"Courier New", monospace; font-style: italic; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 .s37 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: 1pt; }
 .s38 { color: #AAA; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s39 { color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: 1pt; }
 .s40 { color: #AAA; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: 1pt; }
 .s41 { color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; vertical-align: 3pt; }
 .s42 { color: #1E79B8; font-family:"Courier New", monospace; font-style: italic; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 .s43 { color: #AAA; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s44 { color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; vertical-align: 1pt; }
 .s45 { color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 .s46 { color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: bold; text-decoration: none; font-size: 12.5pt; vertical-align: -2pt; }
 .s47 { color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: 2pt; }
 .s48 { color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; vertical-align: -2pt; }
 .s49 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: -2pt; }
 .s50 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 12.5pt; }
 .s51 { color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: 4pt; }
 .s52 { color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: bold; text-decoration: none; font-size: 12.5pt; vertical-align: 4pt; }
 .s53 { color: #26AAD6; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 72pt; vertical-align: 1pt; }
 .s54 { color: #26AAD6; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 72pt; }
 .s55 { color: #26AAD6; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 55pt; }
 .s56 { color: #423B4D; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 .s58 { color: #A8A8A8; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; }
 .s59 { color: #A8A8A8; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5pt; vertical-align: 1pt; }
 .s60 { color: #827789; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 .s61 { color: #827789; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; vertical-align: 1pt; }
 .s62 { color: #827789; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 .s63 { color: #8C8A97; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 .s64 { color: #827789; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 3.5pt; }
 .s65 { color: #827789; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 1pt; }
 .s67 { color: #827789; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; vertical-align: -1pt; }
 .s68 { color: #827789; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s69 { color: #232123; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
 .s70 { color: #232123; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; vertical-align: -3pt; }
 .s71 { color: #A8A8A8; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 1pt; }
 .s72 { color: #8C8A97; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; }
 .s73 { color: #232123; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 .s74 { color: #8C8A97; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 5.5pt; vertical-align: 1pt; }
 .s75 { color: #827789; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 23.5pt; vertical-align: -6pt; }
 .s76 { color: #C1C1C4; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 39pt; }
 .s77 { color: #26AAD6; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 39pt; }
 .s78 { color: #C1C1C4; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 .s79 { color: #8C8A97; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 .s81 { color: #856B69; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; vertical-align: -1pt; }
 .s82 { color: #232123; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 .s83 { color: #C1C1C4; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 13pt; }
 .s84 { color: #C1C1C4; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 25pt; vertical-align: -8pt; }
 .s85 { color: #827789; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 .s86 { color: #8C8A97; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 .s87 { color: #C1C1C4; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 25pt; vertical-align: -7pt; }
 .s88 { color: #C1C1C4; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s92 { color: #26AAD6; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 16.5pt; }
 .s94 { color: #1CBFF2; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 16pt; }
 .s95 { color: #1CBFF2; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s96 { color: #C1C1C4; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14.5pt; }
 .s97 { color: #1CBFF2; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14.5pt; }
 .s98 { color: #6B676E; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 .s99 { color: #6B676E; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 .s100 { color: #C1C1C4; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s101 { color: #388CAE; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s102 { color: #595262; font-family:"Times New Roman", serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 14.5pt; }
 .s103 { color: #1CBFF2; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s104 { color: #827789; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s105 { color: #C1C1C4; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 17pt; }
 .s106 { color: #487B97; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 17pt; }
 .s107 { color: #C1C1C4; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 25pt; }
 .s108 { color: #C1C1C4; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 25pt; vertical-align: -9pt; }
 .s109 { color: #1CBFF2; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 24.5pt; }
 .s110 { color: #C1C1C4; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 25pt; vertical-align: -2pt; }
 .s111 { color: #C1C1C4; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s112 { color: #595262; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 .s113 { color: #595262; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 .s115 { color: #827789; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 62.5pt; vertical-align: -45pt; }
 .s116 { color: #827789; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 62.5pt; }
 .s117 { color: #1CBFF2; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 13pt; }
 .s118 { color: #03B3ED; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 13pt; }
 .s119 { color: #827789; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 72pt; vertical-align: -46pt; }
 .s121 { color: #333; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7.5pt; vertical-align: 6pt; }
 .s122 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s123 { color: #AAA; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s124 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s125 { color: #468173; font-family:"Segoe UI Symbol", sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: -1pt; }
 .s126 { color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s127 { color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; vertical-align: 1pt; }
 .s128 { color: #1E79B8; font-family:Arial, sans-serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 .s129 { color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s130 { color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s131 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 .s132 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s133 { color: #1E79B8; font-family:Arial, sans-serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 .s134 { color: #468173; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 .s135 { color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7.5pt; vertical-align: -1pt; }
 .s136 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: 1pt; }
 .s137 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 .s138 { color: #1E79B8; font-family:Arial, sans-serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 12.5pt; vertical-align: 2pt; }
 .s139 { color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: underline; font-size: 12.5pt; }
 .s140 { color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; vertical-align: 2pt; }
 .s141 { color: #468173; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: -4pt; }
 .s142 { color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
 .s143 { color: #468173; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7.5pt; }
 .s144 { color: #468173; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 7.5pt; vertical-align: 4pt; }
 .s145 { color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 .s148 { color: #575757; font-family:Arial, sans-serif; font-style: italic; font-weight: bold; text-decoration: none; font-size: 7.5pt; }
 li {display: block; }
 #l1 {padding-left: 0pt;counter-reset: c1 1; }
 #l1> li:before {counter-increment: c1; content: counter(c1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l2 {padding-left: 0pt;counter-reset: c2 0; }
 #l2> li:before {counter-increment: c2; content: counter(c1, decimal)"."counter(c2, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l3 {padding-left: 0pt;counter-reset: c3 0; }
 #l3> li:before {counter-increment: c3; content: counter(c1, decimal)"."counter(c2, decimal)"."counter(c3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l4 {padding-left: 0pt;counter-reset: c3 0; }
 #l4> li:before {counter-increment: c3; content: counter(c1, decimal)"."counter(c2, decimal)"."counter(c3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l5 {padding-left: 0pt;counter-reset: c3 0; }
 #l5> li:before {counter-increment: c3; content: counter(c1, decimal)"."counter(c2, decimal)"."counter(c3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l6 {padding-left: 0pt;counter-reset: c3 0; }
 #l6> li:before {counter-increment: c3; content: counter(c1, decimal)"."counter(c2, decimal)"."counter(c3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l7 {padding-left: 0pt;counter-reset: c3 0; }
 #l7> li:before {counter-increment: c3; content: counter(c1, decimal)"."counter(c2, decimal)"."counter(c3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l8 {padding-left: 0pt;counter-reset: c3 0; }
 #l8> li:before {counter-increment: c3; content: counter(c1, decimal)"."counter(c2, decimal)"."counter(c3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 li {display: block; }
 #l9 {padding-left: 0pt;counter-reset: d1 2; }
 #l9> li:before {counter-increment: d1; content: counter(d1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l10 {padding-left: 0pt;counter-reset: d2 0; }
 #l10> li:before {counter-increment: d2; content: counter(d1, decimal)"."counter(d2, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l11 {padding-left: 0pt;counter-reset: d3 0; }
 #l11> li:before {counter-increment: d3; content: counter(d1, decimal)"."counter(d2, decimal)"."counter(d3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l12 {padding-left: 0pt;counter-reset: d3 0; }
 #l12> li:before {counter-increment: d3; content: counter(d1, decimal)"."counter(d2, decimal)"."counter(d3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l13 {padding-left: 0pt;counter-reset: d3 0; }
 #l13> li:before {counter-increment: d3; content: counter(d1, decimal)"."counter(d2, decimal)"."counter(d3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l14 {padding-left: 0pt;counter-reset: d3 0; }
 #l14> li:before {counter-increment: d3; content: counter(d1, decimal)"."counter(d2, decimal)"."counter(d3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l15 {padding-left: 0pt;counter-reset: d3 0; }
 #l15> li:before {counter-increment: d3; content: counter(d1, decimal)"."counter(d2, decimal)"."counter(d3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l16 {padding-left: 0pt;counter-reset: d3 0; }
 #l16> li:before {counter-increment: d3; content: counter(d1, decimal)"."counter(d2, decimal)"."counter(d3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l17 {padding-left: 0pt;counter-reset: d3 0; }
 #l17> li:before {counter-increment: d3; content: counter(d1, decimal)"."counter(d2, decimal)"."counter(d3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 li {display: block; }
 #l18 {padding-left: 0pt;counter-reset: e1 3; }
 #l18> li:before {counter-increment: e1; content: counter(e1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l19 {padding-left: 0pt;counter-reset: e2 0; }
 #l19> li:before {counter-increment: e2; content: counter(e1, decimal)"."counter(e2, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l20 {padding-left: 0pt;counter-reset: e3 0; }
 #l20> li:before {counter-increment: e3; content: counter(e1, decimal)"."counter(e2, decimal)"."counter(e3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l21 {padding-left: 0pt;counter-reset: e3 0; }
 #l21> li:before {counter-increment: e3; content: counter(e1, decimal)"."counter(e2, decimal)"."counter(e3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l22 {padding-left: 0pt;counter-reset: e3 0; }
 #l22> li:before {counter-increment: e3; content: counter(e1, decimal)"."counter(e2, decimal)"."counter(e3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l23 {padding-left: 0pt;counter-reset: e3 0; }
 #l23> li:before {counter-increment: e3; content: counter(e1, decimal)"."counter(e2, decimal)"."counter(e3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l24 {padding-left: 0pt;counter-reset: e3 0; }
 #l24> li:before {counter-increment: e3; content: counter(e1, decimal)"."counter(e2, decimal)"."counter(e3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l25 {padding-left: 0pt;counter-reset: e3 0; }
 #l25> li:before {counter-increment: e3; content: counter(e1, decimal)"."counter(e2, decimal)"."counter(e3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 li {display: block; }
 #l26 {padding-left: 0pt;counter-reset: f1 4; }
 #l26> li:before {counter-increment: f1; content: counter(f1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l27 {padding-left: 0pt;counter-reset: f2 0; }
 #l27> li:before {counter-increment: f2; content: counter(f1, decimal)"."counter(f2, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l28 {padding-left: 0pt;counter-reset: f3 0; }
 #l28> li:before {counter-increment: f3; content: counter(f1, decimal)"."counter(f2, decimal)"."counter(f3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l29 {padding-left: 0pt;counter-reset: f3 0; }
 #l29> li:before {counter-increment: f3; content: counter(f1, decimal)"."counter(f2, decimal)"."counter(f3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l30 {padding-left: 0pt;counter-reset: f3 0; }
 #l30> li:before {counter-increment: f3; content: counter(f1, decimal)"."counter(f2, decimal)"."counter(f3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l31 {padding-left: 0pt;counter-reset: f3 0; }
 #l31> li:before {counter-increment: f3; content: counter(f1, decimal)"."counter(f2, decimal)"."counter(f3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 li {display: block; }
 #l32 {padding-left: 0pt;counter-reset: g1 5; }
 #l32> li:before {counter-increment: g1; content: counter(g1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l33 {padding-left: 0pt;counter-reset: g2 0; }
 #l33> li:before {counter-increment: g2; content: counter(g1, decimal)"."counter(g2, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l34 {padding-left: 0pt;counter-reset: g3 0; }
 #l34> li:before {counter-increment: g3; content: counter(g1, decimal)"."counter(g2, decimal)"."counter(g3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l35 {padding-left: 0pt;counter-reset: g3 0; }
 #l35> li:before {counter-increment: g3; content: counter(g1, decimal)"."counter(g2, decimal)"."counter(g3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l36 {padding-left: 0pt;counter-reset: g3 0; }
 #l36> li:before {counter-increment: g3; content: counter(g1, decimal)"."counter(g2, decimal)"."counter(g3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l37 {padding-left: 0pt;counter-reset: g3 0; }
 #l37> li:before {counter-increment: g3; content: counter(g1, decimal)"."counter(g2, decimal)"."counter(g3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 li {display: block; }
 #l38 {padding-left: 0pt;counter-reset: h1 6; }
 #l38> li:before {counter-increment: h1; content: counter(h1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l39 {padding-left: 0pt;counter-reset: h2 0; }
 #l39> li:before {counter-increment: h2; content: counter(h1, decimal)"."counter(h2, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l40 {padding-left: 0pt;counter-reset: h3 0; }
 #l40> li:before {counter-increment: h3; content: counter(h1, decimal)"."counter(h2, decimal)"."counter(h3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l41 {padding-left: 0pt;counter-reset: h3 0; }
 #l41> li:before {counter-increment: h3; content: counter(h1, decimal)"."counter(h2, decimal)"."counter(h3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l42 {padding-left: 0pt;counter-reset: h3 0; }
 #l42> li:before {counter-increment: h3; content: counter(h1, decimal)"."counter(h2, decimal)"."counter(h3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l43 {padding-left: 0pt;counter-reset: h3 0; }
 #l43> li:before {counter-increment: h3; content: counter(h1, decimal)"."counter(h2, decimal)"."counter(h3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l44 {padding-left: 0pt;counter-reset: h3 0; }
 #l44> li:before {counter-increment: h3; content: counter(h1, decimal)"."counter(h2, decimal)"."counter(h3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l45 {padding-left: 0pt;counter-reset: h3 0; }
 #l45> li:before {counter-increment: h3; content: counter(h1, decimal)"."counter(h2, decimal)"."counter(h3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 li {display: block; }
 #l46 {padding-left: 0pt;counter-reset: i1 7; }
 #l46> li:before {counter-increment: i1; content: counter(i1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l47 {padding-left: 0pt;counter-reset: i2 0; }
 #l47> li:before {counter-increment: i2; content: counter(i1, decimal)"."counter(i2, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l48 {padding-left: 0pt;counter-reset: i3 0; }
 #l48> li:before {counter-increment: i3; content: counter(i1, decimal)"."counter(i2, decimal)"."counter(i3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l49 {padding-left: 0pt;counter-reset: i3 0; }
 #l49> li:before {counter-increment: i3; content: counter(i1, decimal)"."counter(i2, decimal)"."counter(i3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l50 {padding-left: 0pt;counter-reset: i3 0; }
 #l50> li:before {counter-increment: i3; content: counter(i1, decimal)"."counter(i2, decimal)"."counter(i3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l51 {padding-left: 0pt;counter-reset: i3 0; }
 #l51> li:before {counter-increment: i3; content: counter(i1, decimal)"."counter(i2, decimal)"."counter(i3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l52 {padding-left: 0pt;counter-reset: i3 0; }
 #l52> li:before {counter-increment: i3; content: counter(i1, decimal)"."counter(i2, decimal)"."counter(i3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 li {display: block; }
 #l53 {padding-left: 0pt;counter-reset: j1 8; }
 #l53> li:before {counter-increment: j1; content: counter(j1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l54 {padding-left: 0pt;counter-reset: j2 0; }
 #l54> li:before {counter-increment: j2; content: counter(j1, decimal)"."counter(j2, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l55 {padding-left: 0pt;counter-reset: j3 0; }
 #l55> li:before {counter-increment: j3; content: counter(j1, decimal)"."counter(j2, decimal)"."counter(j3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l56 {padding-left: 0pt;counter-reset: j3 0; }
 #l56> li:before {counter-increment: j3; content: counter(j1, decimal)"."counter(j2, decimal)"."counter(j3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l57 {padding-left: 0pt;counter-reset: j3 0; }
 #l57> li:before {counter-increment: j3; content: counter(j1, decimal)"."counter(j2, decimal)"."counter(j3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l58 {padding-left: 0pt;counter-reset: j3 0; }
 #l58> li:before {counter-increment: j3; content: counter(j1, decimal)"."counter(j2, decimal)"."counter(j3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l59 {padding-left: 0pt;counter-reset: j3 0; }
 #l59> li:before {counter-increment: j3; content: counter(j1, decimal)"."counter(j2, decimal)"."counter(j3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l60 {padding-left: 0pt;counter-reset: j3 0; }
 #l60> li:before {counter-increment: j3; content: counter(j1, decimal)"."counter(j2, decimal)"."counter(j3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l61 {padding-left: 0pt;counter-reset: j3 0; }
 #l61> li:before {counter-increment: j3; content: counter(j1, decimal)"."counter(j2, decimal)"."counter(j3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l62 {padding-left: 0pt;counter-reset: j3 0; }
 #l62> li:before {counter-increment: j3; content: counter(j1, decimal)"."counter(j2, decimal)"."counter(j3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 li {display: block; }
 #l63 {padding-left: 0pt;counter-reset: k1 9; }
 #l63> li:before {counter-increment: k1; content: counter(k1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l64 {padding-left: 0pt;counter-reset: k2 0; }
 #l64> li:before {counter-increment: k2; content: counter(k1, decimal)"."counter(k2, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l65 {padding-left: 0pt;counter-reset: k3 0; }
 #l65> li:before {counter-increment: k3; content: counter(k1, decimal)"."counter(k2, decimal)"."counter(k3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l66 {padding-left: 0pt;counter-reset: k3 0; }
 #l66> li:before {counter-increment: k3; content: counter(k1, decimal)"."counter(k2, decimal)"."counter(k3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l67 {padding-left: 0pt;counter-reset: k3 0; }
 #l67> li:before {counter-increment: k3; content: counter(k1, decimal)"."counter(k2, decimal)"."counter(k3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l68 {padding-left: 0pt;counter-reset: k3 0; }
 #l68> li:before {counter-increment: k3; content: counter(k1, decimal)"."counter(k2, decimal)"."counter(k3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 #l69 {padding-left: 0pt;counter-reset: k3 0; }
 #l69> li:before {counter-increment: k3; content: counter(k1, decimal)"."counter(k2, decimal)"."counter(k3, decimal)" "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12pt; }
 li {display: block; }
 #l70 {padding-left: 0pt;counter-reset: l1 1; }
 #l70> li:before {counter-increment: l1; content: counter(l1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l71 {padding-left: 0pt;counter-reset: l2 0; }
 #l71> li:before {counter-increment: l2; content: counter(l1, decimal)"."counter(l2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l72 {padding-left: 0pt;counter-reset: l3 0; }
 #l72> li:before {counter-increment: l3; content: counter(l1, decimal)"."counter(l2, decimal)"."counter(l3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l73 {padding-left: 0pt;counter-reset: m1 1; }
 #l73> li:before {counter-increment: m1; content: counter(m1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l74 {padding-left: 0pt;counter-reset: m2 2; }
 #l74> li:before {counter-increment: m2; content: counter(m1, decimal)"."counter(m2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l75 {padding-left: 0pt;counter-reset: m3 0; }
 #l75> li:before {counter-increment: m3; content: counter(m1, decimal)"."counter(m2, decimal)"."counter(m3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l76 {padding-left: 0pt;counter-reset: n1 0; }
 #l76> li:before {counter-increment: n1; content: "("counter(n1, decimal)") "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 #l77 {padding-left: 0pt;counter-reset: m3 0; }
 #l77> li:before {counter-increment: m3; content: counter(m1, decimal)"."counter(m2, decimal)"."counter(m3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l78 {padding-left: 0pt;counter-reset: m3 0; }
 #l78> li:before {counter-increment: m3; content: counter(m1, decimal)"."counter(m2, decimal)"."counter(m3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l79 {padding-left: 0pt;counter-reset: o1 1; }
 #l79> li:before {counter-increment: o1; content: counter(o1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l80 {padding-left: 0pt;counter-reset: o2 5; }
 #l80> li:before {counter-increment: o2; content: counter(o1, decimal)"."counter(o2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l81 {padding-left: 0pt;counter-reset: o3 0; }
 #l81> li:before {counter-increment: o3; content: counter(o1, decimal)"."counter(o2, decimal)"."counter(o3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l82 {padding-left: 0pt;counter-reset: p1 1; }
 #l82> li:before {counter-increment: p1; content: counter(p1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l83 {padding-left: 0pt;counter-reset: p2 7; }
 #l83> li:before {counter-increment: p2; content: counter(p1, decimal)"."counter(p2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l84 {padding-left: 0pt;counter-reset: p3 0; }
 #l84> li:before {counter-increment: p3; content: counter(p3, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l85 {padding-left: 0pt;counter-reset: p4 0; }
 #l85> li:before {counter-increment: p4; content: counter(p4, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l86 {padding-left: 0pt;counter-reset: q1 0; }
 #l86> li:before {counter-increment: q1; content: counter(q1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l87 {padding-left: 0pt;counter-reset: r1 0; }
 #l87> li:before {counter-increment: r1; content: counter(r1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l88 {padding-left: 0pt;counter-reset: s1 0; }
 #l88> li:before {counter-increment: s1; content: counter(s1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l89 {padding-left: 0pt;counter-reset: t1 0; }
 #l89> li:before {counter-increment: t1; content: counter(t1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l90 {padding-left: 0pt;counter-reset: u1 0; }
 #l90> li:before {counter-increment: u1; content: counter(u1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l91 {padding-left: 0pt;counter-reset: v1 0; }
 #l91> li:before {counter-increment: v1; content: counter(v1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l92 {padding-left: 0pt;counter-reset: w1 0; }
 #l92> li:before {counter-increment: w1; content: counter(w1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l93 {padding-left: 0pt;counter-reset: x1 0; }
 #l93> li:before {counter-increment: x1; content: counter(x1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l94 {padding-left: 0pt;counter-reset: y1 0; }
 #l94> li:before {counter-increment: y1; content: counter(y1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l95 {padding-left: 0pt;counter-reset: z1 0; }
 #l95> li:before {counter-increment: z1; content: counter(z1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l96 {padding-left: 0pt;counter-reset: c1 0; }
 #l96> li:before {counter-increment: c1; content: counter(c1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l97 {padding-left: 0pt;counter-reset: d1 0; }
 #l97> li:before {counter-increment: d1; content: counter(d1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l98 {padding-left: 0pt;counter-reset: e1 0; }
 #l98> li:before {counter-increment: e1; content: counter(e1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l99 {padding-left: 0pt;counter-reset: f1 0; }
 #l99> li:before {counter-increment: f1; content: counter(f1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l100 {padding-left: 0pt;counter-reset: g1 0; }
 #l100> li:before {counter-increment: g1; content: counter(g1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l101 {padding-left: 0pt;counter-reset: h1 0; }
 #l101> li:before {counter-increment: h1; content: counter(h1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l102 {padding-left: 0pt;counter-reset: i1 0; }
 #l102> li:before {counter-increment: i1; content: counter(i1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l103 {padding-left: 0pt;counter-reset: j1 0; }
 #l103> li:before {counter-increment: j1; content: counter(j1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l104 {padding-left: 0pt;counter-reset: k1 2; }
 #l104> li:before {counter-increment: k1; content: counter(k1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l105 {padding-left: 0pt;counter-reset: k2 0; }
 #l105> li:before {counter-increment: k2; content: counter(k1, decimal)"."counter(k2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l106 {padding-left: 0pt;counter-reset: k3 0; }
 #l106> li:before {counter-increment: k3; content: counter(k1, decimal)"."counter(k2, decimal)"."counter(k3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l107 {padding-left: 0pt;counter-reset: n1 1; }
 #l107> li:before {counter-increment: n1; content: "("counter(n1, decimal)") "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 li {display: block; }
 #l108 {padding-left: 0pt;counter-reset: l1 2; }
 #l108> li:before {counter-increment: l1; content: counter(l1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l109 {padding-left: 0pt;counter-reset: l2 1; }
 #l109> li:before {counter-increment: l2; content: counter(l1, decimal)"."counter(l2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l110 {padding-left: 0pt;counter-reset: l3 0; }
 #l110> li:before {counter-increment: l3; content: counter(l1, decimal)"."counter(l2, decimal)"."counter(l3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l111 {padding-left: 0pt;counter-reset: l4 0; }
 #l111> li:before {counter-increment: l4; content: counter(l4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l112 {padding-left: 0pt;counter-reset: l4 0; }
 #l112> li:before {counter-increment: l4; content: counter(l4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l113 {padding-left: 0pt;counter-reset: m1 2; }
 #l113> li:before {counter-increment: m1; content: counter(m1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l114 {padding-left: 0pt;counter-reset: m2 2; }
 #l114> li:before {counter-increment: m2; content: counter(m1, decimal)"."counter(m2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l115 {padding-left: 0pt;counter-reset: m3 0; }
 #l115> li:before {counter-increment: m3; content: counter(m1, decimal)"."counter(m2, decimal)"."counter(m3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l116 {padding-left: 0pt;counter-reset: m4 0; }
 #l116> li:before {counter-increment: m4; content: counter(m4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l117 {padding-left: 0pt;counter-reset: n1 2; }
 #l117> li:before {counter-increment: n1; content: counter(n1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l118 {padding-left: 0pt;counter-reset: n2 3; }
 #l118> li:before {counter-increment: n2; content: counter(n1, decimal)"."counter(n2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l119 {padding-left: 0pt;counter-reset: n3 0; }
 #l119> li:before {counter-increment: n3; content: counter(n1, decimal)"."counter(n2, decimal)"."counter(n3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l120 {padding-left: 0pt;counter-reset: n4 0; }
 #l120> li:before {counter-increment: n4; content: counter(n4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l121 {padding-left: 0pt;counter-reset: o1 2; }
 #l121> li:before {counter-increment: o1; content: counter(o1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l122 {padding-left: 0pt;counter-reset: o2 4; }
 #l122> li:before {counter-increment: o2; content: counter(o1, decimal)"."counter(o2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l123 {padding-left: 0pt;counter-reset: o3 0; }
 #l123> li:before {counter-increment: o3; content: counter(o1, decimal)"."counter(o2, decimal)"."counter(o3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l124 {padding-left: 0pt;counter-reset: p1 0; }
 #l124> li:before {counter-increment: p1; content: counter(p1, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l125 {padding-left: 0pt;counter-reset: q1 2; }
 #l125> li:before {counter-increment: q1; content: counter(q1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l126 {padding-left: 0pt;counter-reset: q2 6; }
 #l126> li:before {counter-increment: q2; content: counter(q1, decimal)"."counter(q2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l127 {padding-left: 0pt;counter-reset: q3 0; }
 #l127> li:before {counter-increment: q3; content: counter(q1, decimal)"."counter(q2, decimal)"."counter(q3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l128 {padding-left: 0pt;counter-reset: q4 0; }
 #l128> li:before {counter-increment: q4; content: counter(q4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l129 {padding-left: 0pt;counter-reset: r1 0; }
 #l129> li:before {counter-increment: r1; content: counter(r1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l130 {padding-left: 0pt;counter-reset: s1 0; }
 #l130> li:before {counter-increment: s1; content: counter(s1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l131 {padding-left: 0pt;counter-reset: t1 0; }
 #l131> li:before {counter-increment: t1; content: counter(t1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l132 {padding-left: 0pt;counter-reset: u1 0; }
 #l132> li:before {counter-increment: u1; content: counter(u1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l133 {padding-left: 0pt;counter-reset: v1 0; }
 #l133> li:before {counter-increment: v1; content: counter(v1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l134 {padding-left: 0pt;counter-reset: w1 0; }
 #l134> li:before {counter-increment: w1; content: counter(w1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l135 {padding-left: 0pt;counter-reset: x1 0; }
 #l135> li:before {counter-increment: x1; content: counter(x1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l136 {padding-left: 0pt;counter-reset: y1 0; }
 #l136> li:before {counter-increment: y1; content: counter(y1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l137 {padding-left: 0pt;counter-reset: z1 0; }
 #l137> li:before {counter-increment: z1; content: counter(z1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l138 {padding-left: 0pt;counter-reset: c1 0; }
 #l138> li:before {counter-increment: c1; content: counter(c1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l139 {padding-left: 0pt;counter-reset: d1 0; }
 #l139> li:before {counter-increment: d1; content: counter(d1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l140 {padding-left: 0pt;counter-reset: e1 0; }
 #l140> li:before {counter-increment: e1; content: counter(e1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l141 {padding-left: 0pt;counter-reset: f1 0; }
 #l141> li:before {counter-increment: f1; content: counter(f1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l142 {padding-left: 0pt;counter-reset: f2 0; }
 #l142> li:before {counter-increment: f2; content: counter(f2, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l143 {padding-left: 0pt;counter-reset: g1 0; }
 #l143> li:before {counter-increment: g1; content: counter(g1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l144 {padding-left: 0pt;counter-reset: h1 3; }
 #l144> li:before {counter-increment: h1; content: counter(h1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l145 {padding-left: 0pt;counter-reset: h2 0; }
 #l145> li:before {counter-increment: h2; content: counter(h1, decimal)"."counter(h2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l146 {padding-left: 0pt;counter-reset: h3 0; }
 #l146> li:before {counter-increment: h3; content: counter(h1, decimal)"."counter(h2, decimal)"."counter(h3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l147 {padding-left: 0pt;counter-reset: h3 0; }
 #l147> li:before {counter-increment: h3; content: counter(h1, decimal)"."counter(h2, decimal)"."counter(h3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l148 {padding-left: 0pt;counter-reset: i1 2; }
 #l148> li:before {counter-increment: i1; content: counter(i1, lower-latin)". "; color: #423B4D; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10.5pt; }
 #l149 {padding-left: 0pt;counter-reset: i2 17; }
 #l149> li:before {counter-increment: i2; content: "."counter(i2, lower-latin)" "; color: #C1C1C4; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 25pt; vertical-align: -2pt; }
 #l150 {padding-left: 0pt; }
 #l150> li:before {content: "· "; color: #C1C1C4; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 #l151 {padding-left: 0pt; }
 #l151> li:before {content: "· "; color: #C1C1C4; font-family:宋体; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 li {display: block; }
 #l152 {padding-left: 0pt;counter-reset: k1 3; }
 #l152> li:before {counter-increment: k1; content: counter(k1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l153 {padding-left: 0pt;counter-reset: k2 4; }
 #l153> li:before {counter-increment: k2; content: counter(k1, decimal)"."counter(k2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l154 {padding-left: 0pt;counter-reset: k3 0; }
 #l154> li:before {counter-increment: k3; content: counter(k1, decimal)"."counter(k2, decimal)"."counter(k3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l155 {padding-left: 0pt;counter-reset: l1 3; }
 #l155> li:before {counter-increment: l1; content: counter(l1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l156 {padding-left: 0pt;counter-reset: l2 5; }
 #l156> li:before {counter-increment: l2; content: counter(l1, decimal)"."counter(l2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l157 {padding-left: 0pt;counter-reset: l3 4; }
 #l157> li:before {counter-increment: l3; content: counter(l1, decimal)"."counter(l2, decimal)"."counter(l3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l158 {padding-left: 0pt;counter-reset: m1 3; }
 #l158> li:before {counter-increment: m1; content: counter(m1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l159 {padding-left: 0pt;counter-reset: m2 5; }
 #l159> li:before {counter-increment: m2; content: counter(m1, decimal)"."counter(m2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l160 {padding-left: 0pt;counter-reset: m3 0; }
 #l160> li:before {counter-increment: m3; content: counter(m1, decimal)"."counter(m2, decimal)"."counter(m3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l161 {padding-left: 0pt;counter-reset: n1 3; }
 #l161> li:before {counter-increment: n1; content: counter(n1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l162 {padding-left: 0pt;counter-reset: n2 6; }
 #l162> li:before {counter-increment: n2; content: counter(n1, decimal)"."counter(n2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l163 {padding-left: 0pt;counter-reset: n3 0; }
 #l163> li:before {counter-increment: n3; content: counter(n1, decimal)"."counter(n2, decimal)"."counter(n3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l164 {padding-left: 0pt;counter-reset: o1 3; }
 #l164> li:before {counter-increment: o1; content: counter(o1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l165 {padding-left: 0pt;counter-reset: o2 7; }
 #l165> li:before {counter-increment: o2; content: counter(o1, decimal)"."counter(o2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l166 {padding-left: 0pt;counter-reset: o3 0; }
 #l166> li:before {counter-increment: o3; content: counter(o3, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l167 {padding-left: 0pt;counter-reset: p1 0; }
 #l167> li:before {counter-increment: p1; content: counter(p1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l168 {padding-left: 0pt;counter-reset: q1 0; }
 #l168> li:before {counter-increment: q1; content: counter(q1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l169 {padding-left: 0pt;counter-reset: r1 0; }
 #l169> li:before {counter-increment: r1; content: counter(r1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l170 {padding-left: 0pt;counter-reset: s1 0; }
 #l170> li:before {counter-increment: s1; content: counter(s1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l171 {padding-left: 0pt;counter-reset: t1 0; }
 #l171> li:before {counter-increment: t1; content: counter(t1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l172 {padding-left: 0pt;counter-reset: u1 0; }
 #l172> li:before {counter-increment: u1; content: counter(u1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l173 {padding-left: 0pt;counter-reset: v1 2; }
 #l173> li:before {counter-increment: v1; content: counter(v1, upper-latin)") "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 #l174 {padding-left: 0pt;counter-reset: v2 0; }
 #l174> li:before {counter-increment: v2; content: counter(v2, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l175 {padding-left: 0pt;counter-reset: w1 0; }
 #l175> li:before {counter-increment: w1; content: counter(w1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l176 {padding-left: 0pt;counter-reset: x1 0; }
 #l176> li:before {counter-increment: x1; content: counter(x1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l177 {padding-left: 0pt;counter-reset: y1 0; }
 #l177> li:before {counter-increment: y1; content: counter(y1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l178 {padding-left: 0pt;counter-reset: z1 0; }
 #l178> li:before {counter-increment: z1; content: counter(z1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l179 {padding-left: 0pt;counter-reset: c1 0; }
 #l179> li:before {counter-increment: c1; content: counter(c1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l180 {padding-left: 0pt;counter-reset: d1 0; }
 #l180> li:before {counter-increment: d1; content: counter(d1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l181 {padding-left: 0pt;counter-reset: e1 0; }
 #l181> li:before {counter-increment: e1; content: counter(e1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l182 {padding-left: 0pt;counter-reset: f1 0; }
 #l182> li:before {counter-increment: f1; content: counter(f1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l183 {padding-left: 0pt;counter-reset: g1 0; }
 #l183> li:before {counter-increment: g1; content: counter(g1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l184 {padding-left: 0pt;counter-reset: h1 0; }
 #l184> li:before {counter-increment: h1; content: counter(h1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l185 {padding-left: 0pt;counter-reset: i1 0; }
 #l185> li:before {counter-increment: i1; content: counter(i1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l186 {padding-left: 0pt;counter-reset: j1 0; }
 #l186> li:before {counter-increment: j1; content: counter(j1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l187 {padding-left: 0pt;counter-reset: k1 0; }
 #l187> li:before {counter-increment: k1; content: counter(k1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l188 {padding-left: 0pt;counter-reset: l1 0; }
 #l188> li:before {counter-increment: l1; content: counter(l1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l189 {padding-left: 0pt;counter-reset: m1 0; }
 #l189> li:before {counter-increment: m1; content: counter(m1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l190 {padding-left: 0pt;counter-reset: n1 0; }
 #l190> li:before {counter-increment: n1; content: counter(n1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; vertical-align: -2pt; }
 li {display: block; }
 #l191 {padding-left: 0pt;counter-reset: o1 4; }
 #l191> li:before {counter-increment: o1; content: counter(o1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l192 {padding-left: 0pt;counter-reset: o2 1; }
 #l192> li:before {counter-increment: o2; content: counter(o1, decimal)"."counter(o2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l193 {padding-left: 0pt;counter-reset: o3 0; }
 #l193> li:before {counter-increment: o3; content: counter(o1, decimal)"."counter(o2, decimal)"."counter(o3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l194 {padding-left: 0pt;counter-reset: p1 4; }
 #l194> li:before {counter-increment: p1; content: counter(p1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l195 {padding-left: 0pt;counter-reset: p2 2; }
 #l195> li:before {counter-increment: p2; content: counter(p1, decimal)"."counter(p2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l196 {padding-left: 0pt;counter-reset: p3 0; }
 #l196> li:before {counter-increment: p3; content: counter(p1, decimal)"."counter(p2, decimal)"."counter(p3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l197 {padding-left: 0pt;counter-reset: q1 4; }
 #l197> li:before {counter-increment: q1; content: counter(q1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l198 {padding-left: 0pt;counter-reset: q2 3; }
 #l198> li:before {counter-increment: q2; content: counter(q1, decimal)"."counter(q2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l199 {padding-left: 0pt;counter-reset: q3 3; }
 #l199> li:before {counter-increment: q3; content: counter(q1, decimal)"."counter(q2, decimal)"."counter(q3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l200 {padding-left: 0pt;counter-reset: r1 4; }
 #l200> li:before {counter-increment: r1; content: counter(r1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l201 {padding-left: 0pt;counter-reset: r2 3; }
 #l201> li:before {counter-increment: r2; content: counter(r1, decimal)"."counter(r2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l202 {padding-left: 0pt;counter-reset: r3 0; }
 #l202> li:before {counter-increment: r3; content: counter(r1, decimal)"."counter(r2, decimal)"."counter(r3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l203 {padding-left: 0pt;counter-reset: s1 4; }
 #l203> li:before {counter-increment: s1; content: counter(s1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l204 {padding-left: 0pt;counter-reset: s2 4; }
 #l204> li:before {counter-increment: s2; content: counter(s1, decimal)"."counter(s2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l205 {padding-left: 0pt;counter-reset: s3 0; }
 #l205> li:before {counter-increment: s3; content: counter(s3, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l206 {padding-left: 0pt;counter-reset: t1 0; }
 #l206> li:before {counter-increment: t1; content: counter(t1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l207 {padding-left: 0pt;counter-reset: u1 2; }
 #l207> li:before {counter-increment: u1; content: "("counter(u1, lower-latin)") "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 #l208 {padding-left: 0pt;counter-reset: u2 0; }
 #l208> li:before {counter-increment: u2; content: counter(u2, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l209 {padding-left: 0pt;counter-reset: v1 1; }
 #l209> li:before {counter-increment: v1; content: counter(v1, lower-latin)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l210 {padding-left: 0pt;counter-reset: v2 2; }
 #l210> li:before {counter-increment: v2; content: counter(v1, lower-latin)"."counter(v2, lower-latin)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l211 {padding-left: 0pt;counter-reset: v3 3; }
 #l211> li:before {counter-increment: v3; content: counter(v1, lower-latin)"."counter(v2, lower-latin)"."counter(v3, lower-latin)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l212 {padding-left: 0pt;counter-reset: v4 3; }
 #l212> li:before {counter-increment: v4; content: counter(v1, lower-latin)"."counter(v2, lower-latin)"."counter(v3, lower-latin)"."counter(v4, lower-latin)" "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 #l213 {padding-left: 0pt;counter-reset: v5 0; }
 #l213> li:before {counter-increment: v5; content: counter(v5, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l214 {padding-left: 0pt;counter-reset: w1 0; }
 #l214> li:before {counter-increment: w1; content: counter(w1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l215 {padding-left: 0pt;counter-reset: x1 0; }
 #l215> li:before {counter-increment: x1; content: counter(x1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l216 {padding-left: 0pt;counter-reset: y1 5; }
 #l216> li:before {counter-increment: y1; content: counter(y1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l217 {padding-left: 0pt;counter-reset: y2 0; }
 #l217> li:before {counter-increment: y2; content: counter(y1, decimal)"."counter(y2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 li {display: block; }
 #l218 {padding-left: 0pt;counter-reset: z1 2; }
 #l218> li:before {counter-increment: z1; content: counter(z1, decimal)" "; color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 li {display: block; }
 #l219 {padding-left: 0pt;counter-reset: c1 7; }
 #l219> li:before {counter-increment: c1; content: counter(c1, decimal)" "; color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: 2pt; }
 li {display: block; }
 #l220 {padding-left: 0pt;counter-reset: d1 12; }
 #l220> li:before {counter-increment: d1; content: counter(d1, decimal)" "; color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 li {display: block; }
 #l221 {padding-left: 0pt;counter-reset: e1 5; }
 #l221> li:before {counter-increment: e1; content: counter(e1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l222 {padding-left: 0pt;counter-reset: e2 2; }
 #l222> li:before {counter-increment: e2; content: counter(e1, decimal)"."counter(e2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l223 {padding-left: 0pt;counter-reset: e3 1; }
 #l223> li:before {counter-increment: e3; content: counter(e1, decimal)"."counter(e2, decimal)"."counter(e3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l224 {padding-left: 0pt;counter-reset: e4 0; }
 #l224> li:before {counter-increment: e4; content: counter(e4, decimal)" "; color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: 2pt; }
 li {display: block; }
 #l225 {padding-left: 0pt;counter-reset: f1 8; }
 #l225> li:before {counter-increment: f1; content: counter(f1, decimal)" "; color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: 2pt; }
 li {display: block; }
 #l226 {padding-left: 0pt;counter-reset: g1 12; }
 #l226> li:before {counter-increment: g1; content: counter(g1, decimal)" "; color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 li {display: block; }
 #l227 {padding-left: 0pt;counter-reset: h1 15; }
 #l227> li:before {counter-increment: h1; content: counter(h1, decimal)" "; color: #468173; font-family:"Courier New", monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 li {display: block; }
 #l228 {padding-left: 0pt;counter-reset: i1 0; }
 #l228> li:before {counter-increment: i1; content: counter(i1, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l229 {padding-left: 0pt;counter-reset: j1 5; }
 #l229> li:before {counter-increment: j1; content: counter(j1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l230 {padding-left: 0pt;counter-reset: j2 2; }
 #l230> li:before {counter-increment: j2; content: counter(j1, decimal)"."counter(j2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l231 {padding-left: 0pt;counter-reset: j3 0; }
 #l231> li:before {counter-increment: j3; content: counter(j1, decimal)"."counter(j2, decimal)"."counter(j3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l232 {padding-left: 0pt;counter-reset: j4 0; }
 #l232> li:before {counter-increment: j4; content: counter(j4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l233 {padding-left: 0pt;counter-reset: j4 0; }
 #l233> li:before {counter-increment: j4; content: counter(j4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l234 {padding-left: 0pt;counter-reset: k1 5; }
 #l234> li:before {counter-increment: k1; content: counter(k1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l235 {padding-left: 0pt;counter-reset: k2 5; }
 #l235> li:before {counter-increment: k2; content: counter(k1, decimal)"."counter(k2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l236 {padding-left: 0pt;counter-reset: k3 1; }
 #l236> li:before {counter-increment: k3; content: counter(k1, decimal)"."counter(k2, decimal)"."counter(k3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l237 {padding-left: 0pt;counter-reset: k4 0; }
 #l237> li:before {counter-increment: k4; content: counter(k4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l238 {padding-left: 0pt;counter-reset: l1 5; }
 #l238> li:before {counter-increment: l1; content: counter(l1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l239 {padding-left: 0pt;counter-reset: l2 5; }
 #l239> li:before {counter-increment: l2; content: counter(l1, decimal)"."counter(l2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 li {display: block; }
 #l240 {padding-left: 0pt;counter-reset: m1 5; }
 #l240> li:before {counter-increment: m1; content: counter(m1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l241 {padding-left: 0pt;counter-reset: m2 7; }
 #l241> li:before {counter-increment: m2; content: counter(m1, decimal)"."counter(m2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l242 {padding-left: 0pt;counter-reset: m3 0; }
 #l242> li:before {counter-increment: m3; content: counter(m1, decimal)"."counter(m2, decimal)"."counter(m3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l243 {padding-left: 0pt;counter-reset: n1 5; }
 #l243> li:before {counter-increment: n1; content: counter(n1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l244 {padding-left: 0pt;counter-reset: n2 6; }
 #l244> li:before {counter-increment: n2; content: counter(n1, decimal)"."counter(n2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l245 {padding-left: 0pt;counter-reset: n3 0; }
 #l245> li:before {counter-increment: n3; content: counter(n3, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l246 {padding-left: 0pt;counter-reset: o1 0; }
 #l246> li:before {counter-increment: o1; content: counter(o1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l247 {padding-left: 0pt;counter-reset: p1 0; }
 #l247> li:before {counter-increment: p1; content: counter(p1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l248 {padding-left: 0pt;counter-reset: q1 0; }
 #l248> li:before {counter-increment: q1; content: counter(q1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l249 {padding-left: 0pt;counter-reset: r1 0; }
 #l249> li:before {counter-increment: r1; content: counter(r1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l250 {padding-left: 0pt;counter-reset: s1 6; }
 #l250> li:before {counter-increment: s1; content: counter(s1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l251 {padding-left: 0pt;counter-reset: s2 0; }
 #l251> li:before {counter-increment: s2; content: counter(s1, decimal)"."counter(s2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l252 {padding-left: 0pt;counter-reset: s3 0; }
 #l252> li:before {counter-increment: s3; content: counter(s1, decimal)"."counter(s2, decimal)"."counter(s3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l253 {padding-left: 0pt;counter-reset: s3 0; }
 #l253> li:before {counter-increment: s3; content: counter(s1, decimal)"."counter(s2, decimal)"."counter(s3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l254 {padding-left: 0pt;counter-reset: t1 6; }
 #l254> li:before {counter-increment: t1; content: counter(t1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l255 {padding-left: 0pt;counter-reset: t2 2; }
 #l255> li:before {counter-increment: t2; content: counter(t1, decimal)"."counter(t2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l256 {padding-left: 0pt;counter-reset: t3 0; }
 #l256> li:before {counter-increment: t3; content: counter(t3, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l257 {padding-left: 0pt;counter-reset: u1 6; }
 #l257> li:before {counter-increment: u1; content: counter(u1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l258 {padding-left: 0pt;counter-reset: u2 3; }
 #l258> li:before {counter-increment: u2; content: counter(u1, decimal)"."counter(u2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l259 {padding-left: 0pt;counter-reset: u3 0; }
 #l259> li:before {counter-increment: u3; content: counter(u1, decimal)"."counter(u2, decimal)"."counter(u3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l260 {padding-left: 0pt;counter-reset: u4 0; }
 #l260> li:before {counter-increment: u4; content: counter(u4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l261 {padding-left: 0pt;counter-reset: v1 6; }
 #l261> li:before {counter-increment: v1; content: counter(v1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l262 {padding-left: 0pt;counter-reset: v2 4; }
 #l262> li:before {counter-increment: v2; content: counter(v1, decimal)"."counter(v2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l263 {padding-left: 0pt;counter-reset: v3 2; }
 #l263> li:before {counter-increment: v3; content: counter(v1, decimal)"."counter(v2, decimal)"."counter(v3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l264 {padding-left: 0pt;counter-reset: w1 6; }
 #l264> li:before {counter-increment: w1; content: counter(w1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l265 {padding-left: 0pt;counter-reset: w2 21; }
 #l265> li:before {counter-increment: w2; content: counter(w1, decimal)"."counter(w2, decimal)". "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 #l266 {padding-left: 0pt;counter-reset: w3 0; }
 #l266> li:before {counter-increment: w3; content: counter(w3, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l267 {padding-left: 0pt;counter-reset: x1 6; }
 #l267> li:before {counter-increment: x1; content: counter(x1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l268 {padding-left: 0pt;counter-reset: x2 5; }
 #l268> li:before {counter-increment: x2; content: counter(x1, decimal)"."counter(x2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l269 {padding-left: 0pt;counter-reset: x3 0; }
 #l269> li:before {counter-increment: x3; content: counter(x1, decimal)"."counter(x2, decimal)"."counter(x3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l270 {padding-left: 0pt;counter-reset: x4 0; }
 #l270> li:before {counter-increment: x4; content: counter(x4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l271 {padding-left: 0pt;counter-reset: y1 7; }
 #l271> li:before {counter-increment: y1; content: counter(y1, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l272 {padding-left: 0pt;counter-reset: y1 13; }
 #l272> li:before {counter-increment: y1; content: counter(y1, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l273 {padding-left: 0pt;counter-reset: y1 17; }
 #l273> li:before {counter-increment: y1; content: counter(y1, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l274 {padding-left: 0pt;counter-reset: z1 6; }
 #l274> li:before {counter-increment: z1; content: counter(z1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l275 {padding-left: 0pt;counter-reset: z2 7; }
 #l275> li:before {counter-increment: z2; content: counter(z1, decimal)"."counter(z2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l276 {padding-left: 0pt;counter-reset: z3 0; }
 #l276> li:before {counter-increment: z3; content: counter(z3, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l277 {padding-left: 0pt;counter-reset: c1 0; }
 #l277> li:before {counter-increment: c1; content: counter(c1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l278 {padding-left: 0pt;counter-reset: d1 0; }
 #l278> li:before {counter-increment: d1; content: counter(d1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l279 {padding-left: 0pt;counter-reset: e1 0; }
 #l279> li:before {counter-increment: e1; content: counter(e1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l280 {padding-left: 0pt;counter-reset: f1 0; }
 #l280> li:before {counter-increment: f1; content: counter(f1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l281 {padding-left: 0pt;counter-reset: g1 0; }
 #l281> li:before {counter-increment: g1; content: counter(g1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; vertical-align: -2pt; }
 li {display: block; }
 #l282 {padding-left: 0pt;counter-reset: h1 0; }
 #l282> li:before {counter-increment: h1; content: counter(h1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l283 {padding-left: 0pt;counter-reset: i1 0; }
 #l283> li:before {counter-increment: i1; content: counter(i1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l284 {padding-left: 0pt;counter-reset: j1 0; }
 #l284> li:before {counter-increment: j1; content: counter(j1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l285 {padding-left: 0pt;counter-reset: k1 0; }
 #l285> li:before {counter-increment: k1; content: counter(k1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l286 {padding-left: 0pt;counter-reset: k2 0; }
 #l286> li:before {counter-increment: k2; content: counter(k2, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l287 {padding-left: 0pt;counter-reset: l1 0; }
 #l287> li:before {counter-increment: l1; content: counter(l1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l288 {padding-left: 0pt;counter-reset: m1 7; }
 #l288> li:before {counter-increment: m1; content: counter(m1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l289 {padding-left: 0pt;counter-reset: m2 0; }
 #l289> li:before {counter-increment: m2; content: counter(m1, decimal)"."counter(m2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 li {display: block; }
 #l290 {padding-left: 0pt;counter-reset: n1 7; }
 #l290> li:before {counter-increment: n1; content: counter(n1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l291 {padding-left: 0pt;counter-reset: n2 3; }
 #l291> li:before {counter-increment: n2; content: counter(n1, decimal)"."counter(n2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l292 {padding-left: 0pt;counter-reset: n3 0; }
 #l292> li:before {counter-increment: n3; content: counter(n1, decimal)"."counter(n2, decimal)"."counter(n3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l293 {padding-left: 0pt;counter-reset: o1 802; }
 #l293> li:before {counter-increment: o1; content: counter(o1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l294 {padding-left: 0pt;counter-reset: o2 10; }
 #l294> li:before {counter-increment: o2; content: counter(o1, decimal)"."counter(o2, decimal)" "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 #l295 {padding-left: 0pt;counter-reset: o3 0; }
 #l295> li:before {counter-increment: o3; content: counter(o3, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l296 {padding-left: 0pt;counter-reset: p1 7; }
 #l296> li:before {counter-increment: p1; content: counter(p1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l297 {padding-left: 0pt;counter-reset: p2 3; }
 #l297> li:before {counter-increment: p2; content: counter(p1, decimal)"."counter(p2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l298 {padding-left: 0pt;counter-reset: p3 2; }
 #l298> li:before {counter-increment: p3; content: counter(p1, decimal)"."counter(p2, decimal)"."counter(p3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l299 {padding-left: 0pt;counter-reset: q1 7; }
 #l299> li:before {counter-increment: q1; content: counter(q1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l300 {padding-left: 0pt;counter-reset: q2 4; }
 #l300> li:before {counter-increment: q2; content: counter(q1, decimal)"."counter(q2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l301 {padding-left: 0pt;counter-reset: q3 1; }
 #l301> li:before {counter-increment: q3; content: counter(q1, decimal)"."counter(q2, decimal)"."counter(q3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l302 {padding-left: 0pt;counter-reset: r1 7; }
 #l302> li:before {counter-increment: r1; content: counter(r1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l303 {padding-left: 0pt;counter-reset: r2 4; }
 #l303> li:before {counter-increment: r2; content: counter(r1, decimal)"."counter(r2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l304 {padding-left: 0pt;counter-reset: r3 0; }
 #l304> li:before {counter-increment: r3; content: counter(r1, decimal)"."counter(r2, decimal)"."counter(r3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l305 {padding-left: 0pt;counter-reset: s1 7; }
 #l305> li:before {counter-increment: s1; content: counter(s1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l306 {padding-left: 0pt;counter-reset: s2 5; }
 #l306> li:before {counter-increment: s2; content: counter(s1, decimal)"."counter(s2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l307 {padding-left: 0pt;counter-reset: s3 0; }
 #l307> li:before {counter-increment: s3; content: counter(s3, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l308 {padding-left: 0pt;counter-reset: t1 7; }
 #l308> li:before {counter-increment: t1; content: counter(t1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l309 {padding-left: 0pt;counter-reset: t2 7; }
 #l309> li:before {counter-increment: t2; content: counter(t1, decimal)"."counter(t2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l310 {padding-left: 0pt;counter-reset: t3 0; }
 #l310> li:before {counter-increment: t3; content: counter(t1, decimal)"."counter(t2, decimal)"."counter(t3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l311 {padding-left: 0pt;counter-reset: t4 0; }
 #l311> li:before {counter-increment: t4; content: counter(t4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l312 {padding-left: 0pt;counter-reset: t4 0; }
 #l312> li:before {counter-increment: t4; content: counter(t4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l313 {padding-left: 0pt;counter-reset: u1 7; }
 #l313> li:before {counter-increment: u1; content: counter(u1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l314 {padding-left: 0pt;counter-reset: u2 7; }
 #l314> li:before {counter-increment: u2; content: counter(u1, decimal)"."counter(u2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l315 {padding-left: 0pt;counter-reset: u3 0; }
 #l315> li:before {counter-increment: u3; content: counter(u3, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l316 {padding-left: 0pt;counter-reset: v1 0; }
 #l316> li:before {counter-increment: v1; content: counter(v1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l317 {padding-left: 0pt;counter-reset: w1 0; }
 #l317> li:before {counter-increment: w1; content: counter(w1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l318 {padding-left: 0pt;counter-reset: x1 0; }
 #l318> li:before {counter-increment: x1; content: counter(x1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l319 {padding-left: 0pt;counter-reset: y1 8; }
 #l319> li:before {counter-increment: y1; content: counter(y1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l320 {padding-left: 0pt;counter-reset: y2 0; }
 #l320> li:before {counter-increment: y2; content: counter(y1, decimal)"."counter(y2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l321 {padding-left: 0pt;counter-reset: y3 0; }
 #l321> li:before {counter-increment: y3; content: counter(y1, decimal)"."counter(y2, decimal)"."counter(y3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l322 {padding-left: 0pt;counter-reset: z1 0; }
 #l322> li:before {counter-increment: z1; content: counter(z1, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l323 {padding-left: 0pt;counter-reset: y4 0; }
 #l323> li:before {counter-increment: y4; content: counter(y4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l324 {padding-left: 0pt;counter-reset: c1 0; }
 #l324> li:before {counter-increment: c1; content: counter(c1, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l325 {padding-left: 0pt;counter-reset: y3 0; }
 #l325> li:before {counter-increment: y3; content: counter(y1, decimal)"."counter(y2, decimal)"."counter(y3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l326 {padding-left: 0pt;counter-reset: y4 0; }
 #l326> li:before {counter-increment: y4; content: counter(y4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l327 {padding-left: 0pt;counter-reset: d1 0; }
 #l327> li:before {counter-increment: d1; content: counter(d1, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l328 {padding-left: 0pt;counter-reset: y4 0; }
 #l328> li:before {counter-increment: y4; content: counter(y4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l329 {padding-left: 0pt;counter-reset: y3 0; }
 #l329> li:before {counter-increment: y3; content: counter(y1, decimal)"."counter(y2, decimal)"."counter(y3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l330 {padding-left: 0pt;counter-reset: y4 0; }
 #l330> li:before {counter-increment: y4; content: counter(y4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l331 {padding-left: 0pt;counter-reset: e1 8; }
 #l331> li:before {counter-increment: e1; content: counter(e1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l332 {padding-left: 0pt;counter-reset: e2 4; }
 #l332> li:before {counter-increment: e2; content: counter(e1, decimal)"."counter(e2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l333 {padding-left: 0pt;counter-reset: e3 0; }
 #l333> li:before {counter-increment: e3; content: counter(e1, decimal)"."counter(e2, decimal)"."counter(e3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l334 {padding-left: 0pt;counter-reset: f1 8; }
 #l334> li:before {counter-increment: f1; content: counter(f1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l335 {padding-left: 0pt;counter-reset: f2 5; }
 #l335> li:before {counter-increment: f2; content: counter(f1, decimal)"."counter(f2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l336 {padding-left: 0pt;counter-reset: f3 0; }
 #l336> li:before {counter-increment: f3; content: counter(f1, decimal)"."counter(f2, decimal)"."counter(f3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l337 {padding-left: 0pt;counter-reset: g1 8; }
 #l337> li:before {counter-increment: g1; content: counter(g1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l338 {padding-left: 0pt;counter-reset: g2 2; }
 #l338> li:before {counter-increment: g2; content: counter(g1, decimal)"."counter(g2, decimal)". "; color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt; }
 #l339 {padding-left: 0pt;counter-reset: g3 0; }
 #l339> li:before {counter-increment: g3; content: counter(g3, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l340 {padding-left: 0pt;counter-reset: f4 0; }
 #l340> li:before {counter-increment: f4; content: counter(f4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l341 {padding-left: 0pt;counter-reset: h1 8; }
 #l341> li:before {counter-increment: h1; content: counter(h1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l342 {padding-left: 0pt;counter-reset: h2 6; }
 #l342> li:before {counter-increment: h2; content: counter(h1, decimal)"."counter(h2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l343 {padding-left: 0pt;counter-reset: h3 0; }
 #l343> li:before {counter-increment: h3; content: counter(h1, decimal)"."counter(h2, decimal)"."counter(h3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l344 {padding-left: 0pt;counter-reset: i1 8; }
 #l344> li:before {counter-increment: i1; content: counter(i1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l345 {padding-left: 0pt;counter-reset: i2 8; }
 #l345> li:before {counter-increment: i2; content: counter(i1, decimal)"."counter(i2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l346 {padding-left: 0pt;counter-reset: i3 0; }
 #l346> li:before {counter-increment: i3; content: counter(i1, decimal)"."counter(i2, decimal)"."counter(i3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l347 {padding-left: 0pt;counter-reset: i4 0; }
 #l347> li:before {counter-increment: i4; content: counter(i4, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l348 {padding-left: 0pt;counter-reset: j1 802; }
 #l348> li:before {counter-increment: j1; content: counter(j1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l349 {padding-left: 0pt;counter-reset: j2 10; }
 #l349> li:before {counter-increment: j2; content: counter(j1, decimal)"."counter(j2, decimal)" "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 #l350 {padding-left: 0pt;counter-reset: j3 0; }
 #l350> li:before {counter-increment: j3; content: counter(j3, decimal)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l351 {padding-left: 0pt;counter-reset: k1 8; }
 #l351> li:before {counter-increment: k1; content: counter(k1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l352 {padding-left: 0pt;counter-reset: k2 8; }
 #l352> li:before {counter-increment: k2; content: counter(k1, decimal)"."counter(k2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l353 {padding-left: 0pt;counter-reset: k3 0; }
 #l353> li:before {counter-increment: k3; content: counter(k1, decimal)"."counter(k2, decimal)"."counter(k3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l354 {padding-left: 0pt;counter-reset: k4 0; }
 #l354> li:before {counter-increment: k4; content: "("counter(k4, decimal)") "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 li {display: block; }
 #l355 {padding-left: 0pt;counter-reset: l1 8; }
 #l355> li:before {counter-increment: l1; content: counter(l1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l356 {padding-left: 0pt;counter-reset: l2 9; }
 #l356> li:before {counter-increment: l2; content: counter(l1, decimal)"."counter(l2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l357 {padding-left: 0pt;counter-reset: l3 0; }
 #l357> li:before {counter-increment: l3; content: counter(l3, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l358 {padding-left: 0pt;counter-reset: m1 0; }
 #l358> li:before {counter-increment: m1; content: counter(m1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l359 {padding-left: 0pt;counter-reset: n1 0; }
 #l359> li:before {counter-increment: n1; content: counter(n1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l360 {padding-left: 0pt;counter-reset: o1 3; }
 #l360> li:before {counter-increment: o1; content: "("counter(o1, decimal)") "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt; }
 #l361 {padding-left: 0pt;counter-reset: o2 0; }
 #l361> li:before {counter-increment: o2; content: counter(o2, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l362 {padding-left: 0pt;counter-reset: p1 0; }
 #l362> li:before {counter-increment: p1; content: counter(p1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l363 {padding-left: 0pt;counter-reset: q1 0; }
 #l363> li:before {counter-increment: q1; content: counter(q1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l364 {padding-left: 0pt;counter-reset: r1 0; }
 #l364> li:before {counter-increment: r1; content: counter(r1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l365 {padding-left: 0pt;counter-reset: s1 0; }
 #l365> li:before {counter-increment: s1; content: counter(s1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l366 {padding-left: 0pt;counter-reset: t1 0; }
 #l366> li:before {counter-increment: t1; content: counter(t1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l367 {padding-left: 0pt;counter-reset: t2 0; }
 #l367> li:before {counter-increment: t2; content: counter(t2, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l368 {padding-left: 0pt;counter-reset: u1 9; }
 #l368> li:before {counter-increment: u1; content: counter(u1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l369 {padding-left: 0pt;counter-reset: u2 0; }
 #l369> li:before {counter-increment: u2; content: counter(u1, decimal)"."counter(u2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l370 {padding-left: 0pt;counter-reset: u3 0; }
 #l370> li:before {counter-increment: u3; content: counter(u1, decimal)"."counter(u2, decimal)"."counter(u3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l371 {padding-left: 0pt;counter-reset: u3 0; }
 #l371> li:before {counter-increment: u3; content: counter(u1, decimal)"."counter(u2, decimal)"."counter(u3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 #l372 {padding-left: 0pt;counter-reset: u3 0; }
 #l372> li:before {counter-increment: u3; content: counter(u1, decimal)"."counter(u2, decimal)"."counter(u3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l373 {padding-left: 0pt;counter-reset: v1 9; }
 #l373> li:before {counter-increment: v1; content: counter(v1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l374 {padding-left: 0pt;counter-reset: v2 3; }
 #l374> li:before {counter-increment: v2; content: counter(v1, decimal)"."counter(v2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l375 {padding-left: 0pt;counter-reset: v3 0; }
 #l375> li:before {counter-increment: v3; content: counter(v1, decimal)"."counter(v2, decimal)"."counter(v3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l376 {padding-left: 0pt;counter-reset: w1 9; }
 #l376> li:before {counter-increment: w1; content: counter(w1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l377 {padding-left: 0pt;counter-reset: w2 4; }
 #l377> li:before {counter-increment: w2; content: counter(w1, decimal)"."counter(w2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l378 {padding-left: 0pt;counter-reset: w3 0; }
 #l378> li:before {counter-increment: w3; content: counter(w1, decimal)"."counter(w2, decimal)"."counter(w3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l379 {padding-left: 0pt;counter-reset: x1 9; }
 #l379> li:before {counter-increment: x1; content: counter(x1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l380 {padding-left: 0pt;counter-reset: x2 5; }
 #l380> li:before {counter-increment: x2; content: counter(x1, decimal)"."counter(x2, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l381 {padding-left: 0pt;counter-reset: x3 2; }
 #l381> li:before {counter-increment: x3; content: counter(x1, decimal)"."counter(x2, decimal)"."counter(x3, decimal)" "; color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 15pt; }
 li {display: block; }
 #l382 {padding-left: 0pt;counter-reset: y1 9; }
 #l382> li:before {counter-increment: y1; content: counter(y1, decimal)" "; color: black; font-style: normal; font-weight: normal; text-decoration: none; }
 #l383 {padding-left: 0pt;counter-reset: y2 5; }
 #l383> li:before {counter-increment: y2; content: counter(y1, decimal)"."counter(y2, decimal)" "; color: #468173; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 20pt; }
 #l384 {padding-left: 0pt;counter-reset: y3 0; }
 #l384> li:before {counter-increment: y3; content: counter(y3, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l385 {padding-left: 0pt;counter-reset: z1 0; }
 #l385> li:before {counter-increment: z1; content: counter(z1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l386 {padding-left: 0pt;counter-reset: c1 0; }
 #l386> li:before {counter-increment: c1; content: counter(c1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l387 {padding-left: 0pt;counter-reset: d1 0; }
 #l387> li:before {counter-increment: d1; content: counter(d1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l388 {padding-left: 0pt;counter-reset: e1 0; }
 #l388> li:before {counter-increment: e1; content: counter(e1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l389 {padding-left: 0pt;counter-reset: f1 0; }
 #l389> li:before {counter-increment: f1; content: counter(f1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l390 {padding-left: 0pt;counter-reset: g1 0; }
 #l390> li:before {counter-increment: g1; content: counter(g1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l391 {padding-left: 0pt;counter-reset: h1 0; }
 #l391> li:before {counter-increment: h1; content: counter(h1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l392 {padding-left: 0pt;counter-reset: i1 0; }
 #l392> li:before {counter-increment: i1; content: counter(i1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l393 {padding-left: 0pt;counter-reset: j1 0; }
 #l393> li:before {counter-increment: j1; content: counter(j1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l394 {padding-left: 0pt;counter-reset: k1 0; }
 #l394> li:before {counter-increment: k1; content: counter(k1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l395 {padding-left: 0pt;counter-reset: l1 0; }
 #l395> li:before {counter-increment: l1; content: counter(l1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l396 {padding-left: 0pt;counter-reset: m1 0; }
 #l396> li:before {counter-increment: m1; content: counter(m1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 li {display: block; }
 #l397 {padding-left: 0pt;counter-reset: n1 0; }
 #l397> li:before {counter-increment: n1; content: counter(n1, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l398 {padding-left: 0pt;counter-reset: n2 0; }
 #l398> li:before {counter-increment: n2; content: counter(n2, upper-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 #l399 {padding-left: 0pt;counter-reset: n3 0; }
 #l399> li:before {counter-increment: n3; content: counter(n3, lower-latin)". "; color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 14pt; }
 td>p {display: inline; }
</style></head><body><p style="text-indent: 0pt;text-align: left;"><span><img width="943" height="1246" alt="image" src="计算机网络自顶向下7th-en/Image_001.jpg"/></span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s1" style="padding-top: 1pt;padding-left: 322pt;text-indent: 0pt;text-align: left;">KUROSE <span style=" color: #7E4D3A;">• </span>ROSS</p><p class="s3" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark0">Computer Networking</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">A Top-Down Approach</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Seventh Edition</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">James F. Kurose</p><p class="s5" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">University of Massachusetts, Amherst</p><p class="s6" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Keith W. Ross</p><p class="s5" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">NYU and NYU Shanghai</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="180" height="54" alt="image" src="计算机网络自顶向下7th-en/Image_002.gif"/></span></p><p class="s5" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Boston  Columbus Indianapolis New York San Francisco Hoboken Amsterdam Cape Town Dubai London Madrid Milan Munich Paris Montréal Toronto Delhi Mexico City São Paulo Sydney Hong Kong Seoul Singapore Taipei Tokyo</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Vice President, Editorial Director, ECS: <span class="s5">Marcia Horton</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Acquisitions Editor: <span class="s5">Matt Goldstein</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Editorial Assistant: <span class="s5">Kristy Alaura</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;line-height: 260%;text-align: left;">Vice President of Marketing: <span class="s5">Christy Lesko </span>Director of Field Marketing: <span class="s5">Tim Galligan </span>Product Marketing Manager: <span class="s5">Bram Van Kempen </span>Field Marketing Manager: <span class="s5">Demetrius Hall </span>Marketing Assistant: <span class="s5">Jon Bryant</span></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Director of Product Management: <span class="s5">Erin Gregg</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Team Lead, Program and Project Management: <span class="s5">Scott Disanno</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Program Manager: <span class="s5">Joanne Manning and Carole Snyder</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Project Manager: <span class="s5">Katrina Ostler, Ostler Editorial, Inc.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Senior Specialist, Program Planning and Support: <span class="s5">Maura Zaldivar-Garcia</span></p><p class="s6" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Cover Designer: <span class="s5">Joyce Wells</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Manager, Rights and Permissions: <span class="s5">Ben Ferrini</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Project Manager, Rights and Permissions: <span class="s5">Jenny Hoffman, Aptara Corporation</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Inventory Manager: <span class="s5">Ann Lam</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 5pt;text-indent: 0pt;line-height: 260%;text-align: left;">Cover Image: <span class="s5">Marc Gutierrez/Getty Images </span>Media Project Manager: <span class="s5">Steve Wright </span>Composition: <span class="s5">Cenveo Publishing Services </span>Printer/Binder: <span class="s5">Edwards Brothers Malloy</span></p><p class="s6" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Cover and Insert Printer: <span class="s5">Phoenix Color/ Hagerstown</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">Credits and acknowledgments borrowed from other sources and reproduced, with permission, in this textbook appear on appropriate page within text.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">Copyright © 2017, 2013, 2010 <b>Pearson Education, Inc. </b><a href="http://www.pearsoned.com/permissions/" class="s7" target="_blank">All rights reserved. Manufactured in the United States of America. This publication is protected by Copyright, and permission should be obtained from the publisher prior to any prohibited reproduction, storage in a retrieval system, or transmission in any form or by any means, electronic, mechanical, photocopying, recording, or likewise. For information regarding permissions, request forms and the appropriate contacts within the Pearson Education Global Rights &amp; Permissions Department, please visit </a><a href="http://www.pearsoned.com/permissions/" class="h3" target="_blank">www.pearsoned.com/permissions/</a><a href="http://www.pearsoned.com/permissions/" class="s7" target="_blank">.</a> Many of the designations by manufacturers  and seller to distinguish their products are claimed as trademarks. Where those designations appear in this book, and the publisher was aware of a trademark claim, the designations have been printed in initial caps or all caps.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Library of Congress Cataloging-in-Publication Data</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Names: Kurose, James F. | Ross, Keith W., 1956-</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">Title: Computer networking: a top-down approach / James F. Kurose, University of Massachusetts, Amherst, Keith W. Ross, NYU and NYU Shanghai.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">Description: Seventh edition. | Hoboken, New Jersey: Pearson, [2017] | Includes bibliographical references and index.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Identifiers: LCCN 2016004976 | ISBN 9780133594140 | ISBN 0133594149</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Subjects: LCSH: Internet. | Computer networks.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Classification: LCC TK5105.875.I57 K88 2017 | DDC 004.6-dc23</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="http://lccn.loc.gov/2016004976" class="s7" target="_blank">LC record available at </a><a href="http://lccn.loc.gov/2016004976" class="h3" target="_blank">http://lccn.loc.gov/2016004976</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="180" height="54" alt="image" src="计算机网络自顶向下7th-en/Image_003.gif"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s5" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">ISBN-10:     0-13-359414-9</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">ISBN-13: 978-0-13-359414-0</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s8" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">About the Authors</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Jim Kurose</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Jim Kurose is a Distinguished University Professor of Computer Science at the University of Massachusetts, Amherst. He is currently on leave from the University of Massachusetts, serving as an Assistant Director at the US National Science Foundation, where he leads the Directorate of Computer and Information Science and Engineering.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Dr. Kurose has received a number of recognitions for his educational activities including Outstanding Teacher Awards from the National Technological University (eight times), the University of Massachusetts, and the Northeast Association of Graduate Schools. He received the IEEE Taylor Booth Education Medal and was recognized for his leadership of Massachusetts’ Commonwealth Information Technology Initiative. He has won several conference best paper awards and received the IEEE Infocom Achievement Award and the ACM Sigcomm Test of Time Award.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="183" height="216" alt="image" src="计算机网络自顶向下7th-en/Image_004.gif"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Dr. Kurose is a former Editor-in-Chief of <i>IEEE Transactions on Communications </i>and of <i>IEEE/ACM Transactions on Networking</i>. He has served as Technical Program co-Chair for <i>IEEE Infocom, ACM SIGCOMM, ACM Internet Measurement Conference</i>, and <i>ACM SIGMETRICS</i>. He is a Fellow of the IEEE and the ACM. His research interests include network protocols and architecture, network measurement, multimedia communication, and modeling and performance evaluation. He holds a PhD in Computer Science from Columbia University.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Keith Ross</p><p class="s5" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">Keith Ross is the Dean of Engineering and Computer Science at NYU Shanghai and the Leonard J. Shustek Chair Professor in the Computer Science and Engineering Department at NYU. Previously he was at University of Pennsylvania (13 years), Eurecom Institute (5 years) and Polytechnic University (10 years). <i>He received a B.S.E.E from Tufts University, a M.S.E.E. from Columbia University, and a Ph.D. in Computer and Control Engineering from The University of Michigan. Keith Ross is also the co-founder and original CEO of Wimba, which develops online multimedia applications for e-learning and was acquired by Blackboard in 2010.</i></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="180" height="252" alt="image" src="计算机网络自顶向下7th-en/Image_005.gif"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">Professor Ross’s research interests are in privacy, social networks, peer-to-peer networking, Internet measurement, content distribution networks, and stochastic modeling. He is an ACM Fellow, an IEEE Fellow, recipient of the Infocom 2009 Best Paper Award, and recipient of 2011 and 2008 Best Paper Awards for Multimedia Communications (awarded by IEEE Communications Society). He has served on numerous journal editorial boards and conference program committees, including <i>IEEE/ACM Transactions on Networking, ACM SIGCOMM, ACM CoNext, and ACM Internet Measurement Conference</i>. He also has served as an advisor to the Federal Trade Commission on P2P file sharing.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 48pt;text-indent: 0pt;text-align: left;">To Julie and our three precious ones—Chris, Charlie, and Nina</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 48pt;text-indent: 0pt;text-align: left;">JFK</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 48pt;text-indent: 0pt;text-align: left;">A big THANKS to my professors, colleagues, and students all over the world.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s6" style="padding-left: 48pt;text-indent: 0pt;text-align: left;">KWR</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s8" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Preface</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Welcome to the seventh edition of <i>Computer Networking: A Top-Down Approach. </i>Since the publication of the first edition 16 years ago, our book has been adopted for use at many hundreds of colleges and universities, translated into 14 languages, and used by over one hundred thousand students and practitioners worldwide. We’ve heard from many of these readers and have been overwhelmed by the positive response.</p><p class="s4" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">What’s New in the Seventh Edition?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">We think one important reason for this success has been that our book continues to offer a fresh and timely approach to computer networking instruction. We’ve made changes in this seventh edition, but we’ve also kept unchanged what we believe (and the instructors and students who have used our book have confirmed) to be the most important aspects of this book: its top-down approach, its focus on the Internet and a modern treatment of computer networking, its attention to both principles and practice, and its accessible style and approach toward learning about computer networking. Nevertheless, the seventh edition has been revised and updated substantially.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s14" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark368" class="s7">Long-time readers of our book will notice that for the first time since this text was published, we’ve changed the organization of the chapters themselves. The network layer, which had been previously covered in a single chapter, is now covered in </a><a href="#bookmark368" class="h3">Chapter 4</a> <a href="#bookmark444" class="s7">(which focuses on the so-called “data plane” component of the network layer) and </a><a href="#bookmark444" class="h3">Chapter 5</a> <a href="#bookmark775" class="s7">(which focuses on the network layer’s “control plane”). This expanded coverage of the network layer reflects the swift rise in importance of software-defined networking (SDN), arguably the most important and exciting advance in networking in decades. Although a relatively recent innovation, SDN has been rapidly adopted in practice—so much so that it’s already hard to imagine an introduction to modern computer networking that doesn’t cover SDN. The topic of network management, previously covered in </a><a href="#bookmark775" class="h3">Chapter </a>9<a href="#bookmark444" class="s7">, has now been folded into the new </a><a href="#bookmark444" class="h3">Chapter </a>5<span class="s5">. As always, we’ve also updated many other sections of the text to reflect recent changes in the dynamic field of networking since the sixth edition. As always, material that has been retired from the printed text can always be found on this book’s Companion Website. The most important updates are the following:</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_006.png"/></span></p><p class="s14" style="padding-top: 3pt;padding-left: 24pt;text-indent: 0pt;text-align: left;"><a href="#bookmark5" class="h3">Chapter 1</a> <span class="s5">has been updated to reflect the ever-growing reach and use of the Internet.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_007.png"/></span></p><p class="s14" style="padding-top: 4pt;padding-left: 24pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark138" class="h3">Chapter </a>2<span class="s5">, which covers the application layer, has been significantly updated. We’ve removed the material on the FTP protocol and distributed hash tables to make room for a new section on application-level video streaming and content distribution networks, together with Netflix and YouTube case studies. The</span></p><p class="s5" style="padding-left: 24pt;text-indent: 0pt;text-align: left;">socket programming sections have been updated from Python 2 to Python 3.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_008.png"/></span></p><p class="s14" style="padding-top: 4pt;padding-left: 24pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark254" class="h3">Chapter </a>3<span class="s5">, which covers the transport layer, has been modestly updated. The material on asynchronous transport mode (ATM) networks has been replaced by more modern material on the Internet’s explicit congestion notification (ECN), which teaches the same principles.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_009.png"/></span></p><p class="s5" style="padding-left: 24pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark368" class="h3">Chapter 4</a><span class="s14"> </span>covers the “data plane” component of the network layer—the <i>per-router </i>forwarding function that determine how a packet arriving on one of a router’s input links is forwarded to one of that router’s output links. We updated the material on traditional Internet forwarding found in all previous editions, and added material on packet scheduling. We’ve also added a new section on generalized forwarding, as practiced in SDN. There are also numerous updates throughout the chapter. Material on multicast and broadcast communication has been removed to make way for the new material.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_010.png"/></span></p><p class="s5" style="padding-left: 24pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark444" class="s7">In </a><a href="#bookmark444" class="h3">Chapter </a><span class="s14">5</span>, we cover the control plane functions of the network layer—the <i>network-wide </i>logic that controls how a datagram is routed along an end-to-end path of routers from the source host to the destination host. As in previous editions, we cover routing algorithms, as well as routing protocols (with an updated treatment of BGP) used in today’s Internet. We’ve added a significant new section on the SDN control plane, where routing and other functions are implemented in so-called SDN controllers.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_011.png"/></span></p><p class="s14" style="padding-left: 24pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark513" class="h3">Chapter </a>6<span class="s5">, which now covers the link layer, has an updated treatment of Ethernet, and of data center networking.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_012.png"/></span></p><p class="s14" style="padding-left: 24pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark591" class="h3">Chapter </a>7<span class="s5">, which covers wireless and mobile networking, contains updated material on 802.11 (so-called “WiFi) networks and cellular networks, including 4G and LTE.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_013.png"/></span></p><p class="s14" style="padding-left: 24pt;text-indent: 0pt;text-align: left;"><a href="#bookmark671" class="h3">Chapter </a>8<span class="s5">, which covers network security and was extensively updated in the sixth edition, has only</span></p><p class="s5" style="padding-top: 3pt;padding-left: 23pt;text-indent: 0pt;text-align: left;">modest updates in this seventh edition.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_014.png"/></span></p><p class="s14" style="padding-top: 4pt;padding-left: 23pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark775" class="h3">Chapter </a>9<a href="#bookmark138" class="s7">, on multimedia networking, is now slightly “thinner” than in the sixth edition, as material on video streaming and content distribution networks has been moved to </a><a href="#bookmark138" class="h3">Chapter </a>2<a href="#bookmark368" class="s7">, and material on packet scheduling has been incorporated into </a><a href="#bookmark368" class="h3">Chapter </a>4<span class="s5">.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_015.png"/></span></p><p class="s5" style="padding-left: 23pt;text-indent: 0pt;line-height: 130%;text-align: left;">Significant new material involving end-of-chapter problems has been added. As with all previous editions, homework problems have been revised, added, and removed.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s5" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">As always, our aim in creating this new edition of our book is to continue to provide a focused and modern treatment of computer networking, emphasizing both principles and practice.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s10" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Audience</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">This textbook is for a first course on computer networking. It can be used in both computer science and electrical engineering departments. In terms of programming languages, the book assumes only that the student has experience with C, C++, Java, or Python (and even then only in a few places). Although this book is more precise and analytical than many other introductory computer networking texts, it rarely uses any mathematical concepts that are not taught in high school. We have made a deliberate effort to avoid using any advanced calculus, probability, or stochastic process concepts (although we’ve included some homework problems for students with this advanced background). The book is therefore appropriate for undergraduate courses and for first-year graduate courses. It should also be useful to practitioners in the telecommunications industry.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">What Is Unique About This Textbook?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">The subject of computer networking is enormously complex, involving many concepts, protocols, and technologies that are woven together in an intricate manner. To cope with this scope and complexity, many computer networking texts are often organized around the “layers” of a network architecture. With a layered organization, students can see through the complexity of computer networking—they learn about the distinct concepts and protocols in one part of the architecture while seeing the big picture of how all parts fit together. From a pedagogical perspective, our personal experience has been that such a layered approach indeed works well. Nevertheless, we have found that the traditional approach of teaching—bottom up; that is, from the physical layer towards the application layer—is not the best approach for a modern course on computer networking.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s10" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">A Top-Down Approach</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Our book broke new ground 16 years ago by treating networking in a top-down manner—that is, by  beginning at the application layer and working its way down toward the physical layer. The feedback we received from teachers and students alike have confirmed that this top-down approach has many advantages and does indeed work well pedagogically. First, it places emphasis on the application layer (a “high growth area” in networking). Indeed, many of the recent revolutions in computer networking—including the Web, peer-to-peer file sharing, and media streaming—have taken place at the application layer. An early emphasis on application-layer issues differs from the approaches taken in most other texts, which have only a small</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">amount of material on network applications, their requirements, application-layer paradigms (e.g., client-server and peer-to-peer), and application programming interfaces. Second, our experience as instructors (and that</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">of many instructors who have used this text) has been that teaching networking applications near the beginning of the course is a powerful motivational tool. Students are thrilled to learn about how networking</p><p class="s5" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">applications work—applications such as e-mail and the Web, which most students use on a daily basis. Once a student understands the applications, the student can then understand the network services needed to support these applications. The student can then, in turn, examine the various ways in which such services might be provided and implemented in the lower layers. Covering applications early thus provides motivation for the remainder of the text.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Third, a top-down approach enables instructors to introduce network application development at an early stage. Students not only see how popular applications and protocols work, but also learn how easy it is to create their own network applications and application-level protocols. With the top-down approach, students get early exposure to the notions of socket programming, service models, and protocols—important concepts that resurface in all subsequent layers. By providing socket programming examples in Python, we highlight the central ideas without confusing students with complex code. Undergraduates in electrical engineering and computer science should not have difficulty following the Python code.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s10" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">An Internet Focus</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">Although we dropped the phrase “Featuring the Internet” from the title of this book with the fourth edition, this doesn’t mean that we dropped our focus on the Internet. Indeed, nothing could be further from the case! Instead, since the Internet has become so pervasive, we felt that any networking textbook must have a significant focus on the Internet, and thus this phrase was somewhat unnecessary. We continue to use the Internet’s architecture and protocols as primary vehicles for studying fundamental computer networking concepts. Of course, we also include concepts and protocols from other network architectures. But the spotlight is clearly on the Internet, a fact reflected in our organizing the book around the Internet’s five-layer architecture: the application, transport, network, link, and physical layers.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">Another benefit of spotlighting the Internet is that most computer science and electrical engineering students are eager to learn about the Internet and its protocols. They know that the Internet has been a revolutionary and disruptive technology and can see that it is profoundly changing our world. Given the enormous relevance of the Internet, students are naturally curious about what is “under the hood.” Thus, it is easy for an instructor to get students excited about basic principles when using the Internet as the guiding focus.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s10" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Teaching Networking Principles</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">Two of the unique features of the book—its top-down approach and its focus on the Internet—have appeared in the titles of our book. If we could have squeezed a <i>third </i>phrase into the subtitle, it would have contained the word <i>principles. </i>The field of networking is now mature enough that a number of fundamentally important issues can be identified. For example, in the transport layer, the fundamental issues include reliable communication over an unreliable network layer, connection establishment/ teardown and handshaking, congestion and flow control, and multiplexing. Three fundamentally important network-layer issues are determining “good” paths between two routers, interconnecting a large number of heterogeneous networks, and managing the complexity of a modern network. In the link layer, a fundamental problem is sharing a multiple access channel. In network security, techniques for providing confidentiality, authentication, and message integrity are all based on cryptographic fundamentals. This text identifies fundamental networking issues and studies approaches towards addressing these issues. The student learning these principles will gain knowledge with a long “shelf life”—long after today’s network standards and protocols have become obsolete, the principles they embody will remain important and relevant. We believe that the combination of using the Internet to get the student’s foot in the door and then emphasizing fundamental issues and solution approaches will allow the student to</p><p class="s5" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">quickly understand just about any networking technology.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s10" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The Website</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources/" class="s7" target="_blank">Each new copy of this textbook includes twelve months of access to a Companion Website for all book readers at </a><a href="http://www.pearsonhighered.com/cs-resources/" class="h3" target="_blank">http://www.pearsonhighered.com/cs-resources/</a><a href="http://www.pearsonhighered.com/cs-resources/" class="s7" target="_blank">,</a> which includes:</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_016.png"/></span></p><p class="s14" style="padding-top: 3pt;padding-left: 22pt;text-indent: 0pt;line-height: 130%;text-align: left;"><span style=" color: #333;">Interactive learning material. </span><a href="#bookmark5" class="s7">The book’s Companion Website contains VideoNotes—video presentations of important topics throughout the book done by the authors, as well as walkthroughs of solutions to problems similar to those at the end of the chapter. We’ve seeded the Web site with VideoNotes and online problems for </a><a href="#bookmark5" class="h3">Chapters 1</a> <a href="#bookmark444" class="s7">through </a><a href="#bookmark444" class="h3">5</a> <span class="s5">and will continue to actively add and update this material over time. As in earlier editions, the Web site contains the interactive Java applets that</span></p><p class="s5" style="padding-left: 22pt;text-indent: 0pt;line-height: 130%;text-align: justify;">animate many key networking concepts. The site also has interactive quizzes that permit students to check their basic understanding of the subject matter. Professors can integrate these interactive features into their lectures or use them as mini labs.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_017.png"/></span></p><p class="s6" style="padding-left: 23pt;text-indent: 0pt;line-height: 130%;text-align: left;">Additional technical material. <span class="s5">As we have added new material in each edition of our book, we’ve had to remove coverage of some existing topics to keep the book at manageable length. For example, to make room for the new material in this edition, we’ve removed material on FTP, distributed hash tables, and multicasting, Material that appeared in earlier editions of the text is still of interest, and thus can be found on the book’s Web site.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_018.png"/></span></p><p class="s6" style="padding-left: 23pt;text-indent: 0pt;line-height: 130%;text-align: left;">Programming assignments. <span class="s5">The Web site also provides a number of detailed programming assignments, which include building a multithreaded Web server, building an e-mail client with a GUI interface, programming the sender and receiver sides of a reliable data transport protocol, programming a</span></p><p class="s5" style="padding-left: 23pt;text-indent: 0pt;text-align: left;">distributed routing algorithm, and more.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_019.png"/></span></p><p class="s6" style="padding-top: 4pt;padding-left: 23pt;text-indent: 0pt;line-height: 130%;text-align: left;">Wireshark labs. <span class="s5">One’s understanding of network protocols can be greatly deepened by seeing them in action. The Web site provides numerous Wireshark assignments that enable students to actually observe the sequence of messages exchanged between two protocol entities. The Web site includes separate Wireshark labs on HTTP, DNS, TCP, UDP, IP, ICMP, Ethernet, ARP, WiFi, SSL, and on tracing all protocols involved in satisfying a request to fetch a Web page. We’ll continue to add new labs over time.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s5" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="http://gaia.cs.umass.edu/kurose_ross/interactive" class="s7" target="_blank">In addition to the Companion Website, the authors maintain a public Web site, </a><a href="http://gaia.cs.umass.edu/kurose_ross/interactive" class="s11" target="_blank">http://gaia.cs.umass.edu/kurose_ross</a><a href="http://gaia.cs.umass.edu/kurose_ross/interactive" class="s7" target="_blank">/interactive,</a> containing interactive exercises that create (and present solutions for) problems similar to selected end-of-chapter problems. Since students can generate (and view solutions for) an unlimited number of similar problem instances, they can work until the material is truly mastered.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Pedagogical Features</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">We have each been teaching computer networking for more than 30 years. Together, we bring more than 60 years of teaching experience to this text, during which time we have taught many thousands of students. We have also been active researchers in computer networking during this time. (In fact, Jim and Keith first met each other as master’s students in a computer networking course taught by Mischa Schwartz in 1979 at Columbia University.) We think all this gives us a good perspective on where networking has been and where it is likely to go in the future. Nevertheless, we have resisted temptations to bias the material in this book towards our own pet research projects. We figure you can visit our personal Web sites if you are interested in our research. Thus, this book is about modern computer networking—it is about contemporary protocols and technologies as well as the underlying principles behind these protocols and technologies. We also believe</p><p class="s5" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">that learning (and teaching!) about networking can be fun. A sense of humor, use of analogies, and real-world examples in this book will hopefully make this material more fun.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Supplements for Instructors</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="http://www.pearsonhighered.com/irc)" class="s7" target="_blank">We provide a complete supplements package to aid instructors in teaching this course. This material can be accessed from Pearson’s Instructor Resource Center (</a><a href="http://www.pearsonhighered.com/irc)" class="h3" target="_blank">http://www.pearsonhighered.com/irc</a><a href="http://www.pearsonhighered.com/irc)" class="s7" target="_blank">).</a> Visit the Instructor Resource Center for information about accessing these instructor’s supplements.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_020.png"/></span></p><p class="s6" style="padding-top: 3pt;padding-left: 23pt;text-indent: 0pt;line-height: 132%;text-align: left;">PowerPoint<span class="s12">®</span><span class="h4"> </span>slides. <span class="s5">We provide PowerPoint slides for all nine chapters. The slides have been completely updated with this seventh edition. The slides cover each chapter in detail. They use graphics and animations (rather than relying only on monotonous text bullets) to make the slides interesting and visually appealing. We provide the original PowerPoint slides so you can customize them to best suit your own teaching needs. Some of these slides have been contributed by other instructors who have taught from our book.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="6" height="6" alt="image" src="计算机网络自顶向下7th-en/Image_021.png"/></span></p><p class="s6" style="padding-left: 24pt;text-indent: 0pt;line-height: 14pt;text-align: left;">Homework solutions. <span class="s5">We provide a solutions manual for the homework problems in the text, programming</span></p><p class="s5" style="padding-top: 4pt;padding-left: 23pt;text-indent: 0pt;line-height: 130%;text-align: left;">assignments, and Wireshark labs. As noted earlier, we’ve introduced many new homework problems in the first six chapters of the book.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s4" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Chapter Dependencies</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s14" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark5" class="s7">The first chapter of this text presents a self-contained overview of computer networking. Introducing many key concepts and terminology, this chapter sets the stage for the rest of the book. All of the other chapters directly depend on this first chapter. After completing </a><a href="#bookmark5" class="h3">Chapter </a>1<a href="#bookmark138" class="s7">, we recommend instructors cover </a><a href="#bookmark138" class="h3">Chapters 2</a> <a href="#bookmark444" class="s7">through </a><a href="#bookmark444" class="h3">6</a> <span class="s5">in sequence, following our top-down philosophy. Each of these five chapters leverages material from the preceding chapters. After completing the first six chapters, the instructor has quite a bit of flexibility. There are no interdependencies among the last three chapters, so they can be taught in any order. However, each of the last three chapters depends on the material in the first six chapters. Many instructors first teach the first six chapters and then teach one of the last three chapters for “dessert.”</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s4" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">One Final Note: We’d Love to Hear from You</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">We encourage students and instructors to e-mail us with any comments they might have about our book. It’s been wonderful for us to hear from so many instructors and students from around the world about our first five editions. We’ve incorporated many of these suggestions into later editions of the book. We also encourage instructors to send us new homework problems (and solutions) that would complement the current homework problems. We’ll post these on the instructor-only portion of the Web site. We also encourage instructors and students to create new Java applets that illustrate the concepts and protocols in this book. If you have an applet that you think would be appropriate for this text, please submit it to us. If the applet (including notation and terminology) is appropriate, we’ll be happy to include it on the text’s Web site, with an appropriate reference to the applet’s authors.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s14" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><span class="s5">So, as the saying goes, “Keep those cards and letters coming!” Seriously, please </span><span class="s9">do </span><a href="mailto:kurose@cs.umass.edu" class="s7" target="_blank">continue to send us interesting URLs, point out typos, disagree with any of our claims, and tell us what works and what doesn’t work. Tell us what you think should or shouldn’t be included in the next edition. Send your e-mail to </a><a href="mailto:kurose@cs.umass.edu" class="h3" target="_blank">kurose@cs.umass.edu</a> <a href="mailto:keithwross@nyu.edu" class="s7" target="_blank">and </a>keithwross@nyu.edu<span class="s5">.</span></p><p class="s8" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Acknowledgments</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Since we began writing this book in 1996, many people have given us invaluable help and have been influential in shaping our thoughts on how to best organize and teach a networking course. We want to say A BIG THANKS to everyone who has helped us from the earliest first drafts of this book, up to this seventh edition. We are also <i>very </i>thankful to the many hundreds of readers from around the world—students, faculty, practitioners—who have sent us thoughts and comments on earlier editions of the book and suggestions for future editions of the book. Special thanks go out to:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Al Aho (Columbia University)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Hisham Al-Mubaid (University of Houston-Clear Lake) Pratima Akkunoor (Arizona State University)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Paul Amer (University of Delaware) Shamiul Azom (Arizona State University)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Lichun Bao (University of California at Irvine) Paul Barford (University of Wisconsin)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Bobby Bhattacharjee (University of Maryland) Steven Bellovin (Columbia University)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Pravin Bhagwat (Wibhu)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Supratik Bhattacharyya (previously at Sprint) Ernst Biersack (Eurécom Institute)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Shahid Bokhari (University of Engineering &amp; Technology, Lahore) Jean Bolot (Technicolor Research)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Daniel Brushteyn (former University of Pennsylvania student) Ken Calvert (University of Kentucky)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Evandro Cantu (Federal University of Santa Catarina) Jeff Case (SNMP Research International)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Jeff Chaltas (Sprint) Vinton Cerf (Google)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Byung Kyu Choi (Michigan Technological University) Bram Cohen (BitTorrent, Inc.)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Constantine Coutras (Pace University) John Daigle (University of Mississippi)</p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Edmundo A. de Souza e Silva (Federal University of Rio de Janeiro)</p><p class="s5" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Philippe Decuetos (Eurécom Institute) Christophe Diot (Technicolor Research) Prithula Dhunghel (Akamai)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Deborah Estrin (University of California, Los Angeles) Michalis Faloutsos (University of California at Riverside) Wu-chi Feng (Oregon Graduate Institute)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Sally Floyd (ICIR, University of California at Berkeley) Paul Francis (Max Planck Institute)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">David Fullager (Netflix)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Lixin Gao (University of Massachusetts)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">JJ Garcia-Luna-Aceves (University of California at Santa Cruz) Mario Gerla (University of California at Los Angeles)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">David Goodman (NYU-Poly)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Yang Guo (Alcatel/Lucent Bell Labs) Tim Griffin (Cambridge University)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Max Hailperin (Gustavus Adolphus College)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Bruce Harvey (Florida A&amp;M University, Florida State University) Carl Hauser (Washington State University)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Rachelle Heller (George Washington University) Phillipp Hoschka (INRIA/W3C)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Wen Hsin (Park University)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Albert Huang (former University of Pennsylvania student) Cheng Huang (Microsoft Research)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Esther A. Hughes (Virginia Commonwealth University) Van Jacobson (Xerox PARC)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Pinak Jain (former NYU-Poly student)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Jobin James (University of California at Riverside) Sugih Jamin (University of Michigan)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Shivkumar Kalyanaraman (IBM Research, India) Jussi Kangasharju (University of Helsinki) Sneha Kasera (University of Utah)</p><p class="s5" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Parviz Kermani (formerly of IBM Research)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Hyojin Kim (former University of Pennsylvania student) Leonard Kleinrock (University of California at Los Angeles) David Kotz (Dartmouth College)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Beshan Kulapala (Arizona State University) Rakesh Kumar (Bloomberg)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Miguel A. Labrador (University of South Florida) Simon Lam (University of Texas)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Steve Lai (Ohio State University) Tom LaPorta (Penn State University)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Tim-Berners Lee (World Wide Web Consortium) Arnaud Legout (INRIA)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Lee Leitner (Drexel University)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Brian Levine (University of Massachusetts) Chunchun Li (former NYU-Poly student) Yong Liu (NYU-Poly)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">William Liang (former University of Pennsylvania student) Willis Marti (Texas A&amp;M University)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Nick McKeown (Stanford University) Josh McKinzie (Park University)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Deep Medhi (University of Missouri, Kansas City) Bob Metcalfe (International Data Group)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Sue Moon (KAIST) Jenni Moyer (Comcast)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Erich Nahum (IBM Research)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Christos Papadopoulos (Colorado Sate University) Craig Partridge (BBN Technologies)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Radia Perlman (Intel)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Jitendra Padhye (Microsoft Research)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Vern Paxson (University of California at Berkeley) Kevin Phillips (Sprint)</p><p class="s5" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">George Polyzos (Athens University of Economics and Business) Sriram Rajagopalan (Arizona State University)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Ramachandran Ramjee (Microsoft Research) Ken Reek (Rochester Institute of Technology) Martin Reisslein (Arizona State University) Jennifer Rexford (Princeton University)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Leon Reznik (Rochester Institute of Technology) Pablo Rodrigez (Telefonica)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Sumit Roy (University of Washington) Dan Rubenstein (Columbia University) Avi Rubin (Johns Hopkins University) Douglas Salane (John Jay College) Despina Saparilla (Cisco Systems) John Schanz (Comcast)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Henning Schulzrinne (Columbia University) Mischa Schwartz (Columbia University) Ardash Sethi (University of Delaware) Harish Sethu (Drexel University)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">K. Sam Shanmugan (University of Kansas) Prashant Shenoy (University of Massachusetts) Clay Shields (Georgetown University)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Subin Shrestra (University of Pennsylvania) Bojie Shu (former NYU-Poly student)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Mihail L. Sichitiu (NC State University)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Peter Steenkiste (Carnegie Mellon University) Tatsuya Suda (University of California at Irvine)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">Kin Sun Tam (State University of New York at Albany) Don Towsley (University of Massachusetts)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 195%;text-align: left;">David Turner (California State University, San Bernardino) Nitin Vaidya (University of Illinois)</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Michele Weigle (Clemson University)</p><p class="s5" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 195%;text-align: left;">David Wetherall (University of Washington) Ira Winston (University of Pennsylvania)</p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 195%;text-align: left;">Di Wu (Sun Yat-sen University) Shirley Wynn (NYU-Poly)</p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Raj Yavatkar (Intel)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 195%;text-align: left;">Yechiam Yemini (Columbia University) Dian Yu (NYU Shanghai)</p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 195%;text-align: left;">Ming Yu (State University of New York at Binghamton) Ellen Zegura (Georgia Institute of Technology) Honggang Zhang (Suffolk University)</p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Hui Zhang (Carnegie Mellon University)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 195%;text-align: left;">Lixia Zhang (University of California at Los Angeles) Meng Zhang (former NYU-Poly student)</p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 195%;text-align: left;">Shuchun Zhang (former University of Pennsylvania student) Xiaodong Zhang (Ohio State University)</p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">ZhiLi Zhang (University of Minnesota)</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 6pt;text-indent: 0pt;line-height: 195%;text-align: left;">Phil Zimmermann (independent consultant) Mike Zink (University of Massachusetts) Cliff C. Zou (University of Central Florida)</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">We also want to thank the entire Pearson team—in particular, Matt Goldstein and Joanne Manning—who have done an absolutely outstanding job on this seventh edition (and who have put up with two very finicky authors who seem congenitally unable to meet deadlines!). Thanks also to our artists, Janet Theurer and Patrice</p><p class="s5" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Rossi Calkin, for their work on the beautiful figures in this and earlier editions of our book, and to Katie Ostler and her team at Cenveo for their wonderful production work on this edition. Finally, a most special thanks go to our previous two editors at Addison-Wesley—Michael Hirsch and Susan Hartman. This book would not be what it is (and may well not have been at all) without their graceful management, constant encouragement, nearly infinite patience, good humor, and perseverance.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s3" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark1">Table of Contents</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark5" class="s13">Chapter 1 Computer Networks and the Internet 1</a></p><ol id="l1"><ol id="l2"><li style="padding-top: 4pt;padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark15" class="h3">What Is the Internet? 2</a></p><ol id="l3"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark10" class="h3">A Nuts-and-Bolts Description 2</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark12" class="h3">A Services Description 5</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark16" class="h3">What Is a Protocol? 7</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark37" class="h3">The Network Edge 9</a></p><ol id="l4"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark33" class="h3">Access Networks 12</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark38" class="h3">Physical Media 18</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark59" class="h3">The Network Core 21</a></p><ol id="l5"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark49" class="h3">Packet Switching 23</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark56" class="h3">Circuit Switching 27</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark60" class="h3">A Network of Networks 31</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark79" class="h3">Delay, Loss, and Throughput in Packet-Switched Networks 35</a></p><ol id="l6"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark68" class="h3">Overview of Delay in Packet-Switched Networks 35</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark70" class="h3">Queuing Delay and Packet Loss 39</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark75" class="h3">End-to-End Delay 41</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark80" class="h3">Throughput in Computer Networks 43</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark94" class="h3">Protocol Layers and Their Service Models 47</a></p><ol id="l7"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark92" class="h3">Layered Architecture 47</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark95" class="h3">Encapsulation 53</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark101" class="h3">Networks Under Attack 55</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark112" class="h3">History of Computer Networking and the Internet 59</a></p><ol id="l8"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark104" class="h3">The Development of Packet Switching: 1961–1972 59</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark106" class="h3">Proprietary Networks and Internetworking: 1972–1980 60</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark108" class="h3">A Proliferation of Networks: 1980–1990 62</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark110" class="h3">The Internet Explosion: The 1990s 63</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark113" class="h3">The New Millennium 64</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark116" class="h3">Summary 65</a></p></li></ol></ol><p style="padding-top: 3pt;padding-left: 23pt;text-indent: 0pt;line-height: 195%;text-align: left;"><a href="#bookmark133" class="h3">Homework Problems and Questions </a><a href="#bookmark129" class="h3">67 Wireshark Lab 77</a></p><p style="padding-left: 23pt;text-indent: 0pt;text-align: left;"><a href="#bookmark134" class="h3">Interview: Leonard Kleinrock 79</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: center;"><a href="#bookmark138" class="s13">Chapter 2 Application Layer 83</a></p><ol id="l9"><ol id="l10"><li style="padding-top: 4pt;padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark157" class="h3">Principles of Network Applications 84</a></p><ol id="l11"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark144" class="h3">Network Application Architectures 86</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark147" class="h3">Processes Communicating 88</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark149" class="h3">Transport Services Available to Applications 90</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark153" class="h3">Transport Services Provided by the Internet 93</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark156" class="h3">Application-Layer Protocols 96</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark158" class="h3">Network Applications Covered in This Book 97</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark176" class="h3">The Web and HTTP 98</a></p><ol id="l12"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark161" class="h3">Overview of HTTP 98</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark163" class="h3">Non-Persistent and Persistent Connections 100</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark168" class="h3">HTTP Message Format 103</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark171" class="h3">User-Server Interaction: Cookies 108</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark177" class="h3">Web Caching 110</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark192" class="h3">Electronic Mail in the Internet 116</a></p><ol id="l13"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark185" class="h3">SMTP 118</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark186" class="h3">Comparison with HTTP 121</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark187" class="h3">Mail Message Formats 121</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark193" class="h3">Mail Access Protocols 122</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark206" class="h3">DNS—The Internet’s Directory Service 126</a></p><ol id="l14"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark196" class="h3">Services Provided by DNS 127</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark203" class="h3">Overview of How DNS Works 129</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark207" class="h3">DNS Records and Messages 135</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark216" class="h3">Peer-to-Peer Applications 140</a></p><ol id="l15"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark217" class="h3">P2P File Distribution 140</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark228" class="h3">Video Streaming and Content Distribution Networks 147</a></p><ol id="l16"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark219" class="h3">Internet Video 148</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark220" class="h3">HTTP Streaming and DASH 148</a></p></li><li style="padding-top: 3pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark223" class="h3">Content Distribution Networks 149</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark229" class="h3">Case Studies: Netflix, YouTube, and Kankan 153</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark239" class="h3">Socket Programming: Creating Network Applications 157</a></p><ol id="l17"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark234" class="h3">Socket Programming with UDP 159</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark240" class="h3">Socket Programming with TCP 164</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark242" class="h3">Summary 170</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;line-height: 195%;text-align: left;"><a href="#bookmark250" class="h3">Homework Problems and Questions </a><a href="#bookmark246" class="h3">171 Socket Programming Assignments </a><a href="#bookmark247" class="h3">180 Wireshark Labs: HTTP, DNS </a><a href="#bookmark251" class="h3">182 Interview: Marc Andreessen 184</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark254" class="s13">Chapter 3 Transport Layer 187</a></p><ol id="l18"><ol id="l19"><li style="padding-top: 4pt;padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark258" class="h3">Introduction and Transport-Layer Services 188</a></p><ol id="l20"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark257" class="h3">Relationship Between Transport and Network Layers 188</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark259" class="h3">Overview of the Transport Layer in the Internet 191</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark266" class="h3">Multiplexing and Demultiplexing 193</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark271" class="h3">Connectionless Transport: UDP 200</a></p><ol id="l21"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark269" class="h3">UDP Segment Structure 204</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark272" class="h3">UDP Checksum 204</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark298" class="h3">Principles of Reliable Data Transfer 206</a></p><ol id="l22"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark281" class="h3">Building a Reliable Data Transfer Protocol 208</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark286" class="h3">Pipelined Reliable Data Transfer Protocols 217</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark290" class="h3">Go-Back-N (GBN) 221</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark299" class="h3">Selective Repeat (SR) 226</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark329" class="h3">Connection-Oriented Transport: TCP 233</a></p><ol id="l23"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark303" class="h3">The TCP Connection 233</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark309" class="h3">TCP Segment Structure 236</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark310" class="h3">Round-Trip Time Estimation and Timeout 241</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark320" class="h3">Reliable Data Transfer 244</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark323" class="h3">Flow Control 252</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark330" class="h3">TCP Connection Management 255</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark341" class="h3">Principles of Congestion Control 261</a></p><ol id="l24"><li style="padding-top: 3pt;padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark339" class="h3">The Causes and the Costs of Congestion 261</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark342" class="h3">Approaches to Congestion Control 268</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark355" class="h3">TCP Congestion Control 269</a></p><ol id="l25"><li style="padding-top: 4pt;padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark353" class="h3">Fairness 279</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark356" class="h3">Explicit Congestion Notification (ECN): Network-assisted Congestion Control 282</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark358" class="h3">Summary 284</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;line-height: 195%;text-align: left;"><a href="#bookmark365" class="h3">Homework Problems and Questions </a><a href="#bookmark362" class="h3">286 Programming Assignments </a><a href="#bookmark363" class="h3">301 Wireshark Labs: Exploring TCP, UDP </a><a href="#bookmark366" class="h3">302 Interview: Van Jacobson 303</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: center;"><a href="#bookmark368" class="s13">Chapter 4 The Network Layer: Data Plane 305</a></p><ol id="l26"><ol id="l27"><li style="padding-top: 4pt;padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark374" class="h3">Overview of Network Layer 306</a></p><ol id="l28"><li style="padding-top: 4pt;padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark373" class="h3">Forwarding and Routing: The Network Data and Control Planes 306</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark375" class="h3">Network Service Models 311</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark394" class="h3">What’s Inside a Router? 313</a></p><ol id="l29"><li style="padding-top: 4pt;padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark380" class="h3">Input Port Processing and Destination-Based Forwarding 316</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark382" class="h3">Switching 319</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark383" class="h3">Output Port Processing 321</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark387" class="h3">Where Does Queuing Occur? 321</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark395" class="h3">Packet Scheduling 325</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark423" class="h3">The Internet Protocol (IP): IPv4, Addressing, IPv6, and More 329</a></p><ol id="l30"><li style="padding-top: 4pt;padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark400" class="h3">IPv4 Datagram Format 330</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark402" class="h3">IPv4 Datagram Fragmentation 332</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark416" class="h3">IPv4 Addressing 334</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark419" class="h3">Network Address Translation (NAT) 345</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark424" class="h3">IPv6 348</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark433" class="h3">Generalized Forwarding and SDN 354</a></p><ol id="l31"><li style="padding-top: 4pt;padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark430" class="h3">Match 356</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark431" class="h3">Action 358</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark434" class="h3">OpenFlow Examples of Match-plus-action in Action 358</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark437" class="h3">Summary 361</a></p></li></ol></ol><p style="padding-top: 3pt;padding-left: 23pt;text-indent: 0pt;line-height: 195%;text-align: left;"><a href="#bookmark441" class="h3">Homework Problems and Questions </a><a href="#bookmark440" class="h3">361 Wireshark Lab 370</a></p><p style="padding-left: 23pt;text-indent: 0pt;text-align: left;"><a href="#bookmark442" class="h3">Interview: Vinton G. Cerf 371</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: center;"><a href="#bookmark444" class="s13">Chapter 5 The Network Layer: Control Plane 373</a></p><ol id="l32"><ol id="l33"><li style="padding-top: 4pt;padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark448" class="h3">Introduction 374</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark459" class="h3">Routing Algorithms 376</a></p><ol id="l34"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark454" class="h3">The Link-State (LS) Routing Algorithm 379</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark460" class="h3">The Distance-Vector (DV) Routing Algorithm 384</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark463" class="h3">Intra-AS Routing in the Internet: OSPF 391</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark480" class="h3">Routing Among the ISPs: BGP 395</a></p><ol id="l35"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark466" class="h3">The Role of BGP 395</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark469" class="h3">Advertising BGP Route Information 396</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark473" class="h3">Determining the Best Routes 398</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark474" class="h3">IP-Anycast 402</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark478" class="h3">Routing Policy 403</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark481" class="h3">Putting the Pieces Together: Obtaining Internet Presence 406</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark492" class="h3">The SDN Control Plane 407</a></p><ol id="l36"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark486" class="h3">The SDN Control Plane: SDN Controller and SDN Control Applications 410</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark487" class="h3">OpenFlow Protocol 412</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark489" class="h3">Data and Control Plane Interaction: An Example 414</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark493" class="h3">SDN: Past and Future 415</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark496" class="h3">ICMP: The Internet Control Message Protocol 419</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark502" class="h3">Network Management and SNMP 421</a></p><ol id="l37"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark498" class="h3">The Network Management Framework 422</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark503" class="h3">The Simple Network Management Protocol (SNMP) 424</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark505" class="h3">Summary 426</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;line-height: 195%;text-align: left;"><a href="#bookmark510" class="h3">Homework Problems and Questions </a><a href="#bookmark507" class="h3">427 Socket Programming Assignment </a><a href="#bookmark508" class="h3">433 Programming Assignment 434</a></p><p style="padding-left: 23pt;text-indent: 0pt;text-align: left;"><a href="#bookmark509" class="h3">Wireshark Lab 435</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;text-align: left;"><a href="#bookmark511" class="h3">Interview: Jennifer Rexford 436</a></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark513" class="s13">Chapter 6 The Link Layer and LANs 439</a></p><ol id="l38"><ol id="l39"><li style="padding-top: 4pt;padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark517" class="h3">Introduction to the Link Layer 440</a></p><ol id="l40"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark516" class="h3">The Services Provided by the Link Layer 442</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark518" class="h3">Where Is the Link Layer Implemented? 443</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark527" class="h3">Error-Detection and -Correction Techniques 444</a></p><ol id="l41"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark523" class="h3">Parity Checks 446</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark525" class="h3">Checksumming Methods 448</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark528" class="h3">Cyclic Redundancy Check (CRC) 449</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark542" class="h3">Multiple Access Links and Protocols 451</a></p><ol id="l42"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark533" class="h3">Channel Partitioning Protocols 453</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark539" class="h3">Random Access Protocols 455</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark540" class="h3">Taking-Turns Protocols 464</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark543" class="h3">DOCSIS: The Link-Layer Protocol for Cable Internet Access 465</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark561" class="h3">Switched Local Area Networks 467</a></p><ol id="l43"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark551" class="h3">Link-Layer Addressing and ARP 468</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark554" class="h3">Ethernet 474</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark558" class="h3">Link-Layer Switches 481</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark562" class="h3">Virtual Local Area Networks (VLANs) 487</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark568" class="h3">Link Virtualization: A Network as a Link Layer 491</a></p><ol id="l44"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark569" class="h3">Multiprotocol Label Switching (MPLS) 492</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark573" class="h3">Data Center Networking 495</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark580" class="h3">Retrospective: A Day in the Life of a Web Page Request 500</a></p><ol id="l45"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark577" class="h3">Getting Started: DHCP, UDP, IP, and Ethernet 500</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark578" class="h3">Still Getting Started: DNS and ARP 502</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark579" class="h3">Still Getting Started: Intra-Domain Routing to the DNS Server 503</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark581" class="h3">Web Client-Server Interaction: TCP and HTTP 504</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark583" class="h3">Summary 506</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;line-height: 195%;text-align: left;"><a href="#bookmark588" class="h3">Homework Problems and Questions </a><a href="#bookmark587" class="h3">507 Wireshark Lab 515</a></p><p style="padding-left: 23pt;text-indent: 0pt;text-align: left;"><a href="#bookmark589" class="h3">Interview: Simon S. Lam 516</a></p><p style="padding-top: 3pt;text-indent: 0pt;text-align: center;"><a href="#bookmark591" class="s13">Chapter 7 Wireless and Mobile Networks 519</a></p><ol id="l46"><ol id="l47"><li style="padding-top: 4pt;padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark595" class="h3">Introduction 520</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark603" class="h3">Wireless Links and Network Characteristics 525</a></p><ol id="l48"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark604" class="h3">CDMA 528</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark624" class="h3">WiFi: 802.11 Wireless LANs 532</a></p><ol id="l49"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark611" class="h3">The 802.11 Architecture 533</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark615" class="h3">The 802.11 MAC Protocol 537</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark619" class="h3">The IEEE 802.11 Frame 542</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark621" class="h3">Mobility in the Same IP Subnet 546</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark622" class="h3">Advanced Features in 802.11 547</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark625" class="h3">Personal Area Networks: Bluetooth and Zigbee 548</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark635" class="h3">Cellular Internet Access 551</a></p><ol id="l50"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark630" class="h3">An Overview of Cellular Network Architecture 551</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark632" class="h3">3G Cellular Data Networks: Extending the Internet to Cellular Subscribers 554</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark636" class="h3">On to 4G: LTE 557</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark645" class="h3">Mobility Management: Principles 560</a></p><ol id="l51"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark641" class="h3">Addressing 562</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark646" class="h3">Routing to a Mobile Node 564</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark650" class="h3">Mobile IP 570</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark658" class="h3">Managing Mobility in Cellular Networks 574</a></p><ol id="l52"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark654" class="h3">Routing Calls to a Mobile User 576</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark659" class="h3">Handoffs in GSM 577</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark662" class="h3">Wireless and Mobility: Impact on Higher-Layer Protocols 580</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark664" class="h3">Summary 582</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;line-height: 195%;text-align: left;"><a href="#bookmark668" class="h3">Homework Problems and Questions </a><a href="#bookmark667" class="h3">583 Wireshark Lab 588</a></p><p style="padding-left: 23pt;text-indent: 0pt;text-align: left;"><a href="#bookmark669" class="h3">Interview: Deborah Estrin 589</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: center;"><a href="#bookmark671" class="s13">Chapter 8 Security in Computer Networks 593</a></p><ol id="l53"><ol id="l54"><li style="padding-top: 4pt;padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark674" class="h3">What Is Network Security? 594</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark685" class="h3">Principles of Cryptography 596</a></p><ol id="l55"><li style="padding-top: 4pt;padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark681" class="h3">Symmetric Key Cryptography 598</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 71pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark686" class="h3">Public Key Encryption 604</a></p></li></ol></li><li style="padding-top: 3pt;padding-left: 26pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark699" class="h3">Message Integrity and Digital Signatures 610</a></p><ol id="l56"><li style="padding-top: 4pt;padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark690" class="h3">Cryptographic Hash Functions 611</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark692" class="h3">Message Authentication Code 613</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark700" class="h3">Digital Signatures 614</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 26pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark711" class="h3">End-Point Authentication 621</a></p><ol id="l57"><li style="padding-top: 4pt;padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark704" class="h3">Authentication Protocol </a><a href="#bookmark704" class="s15">ap1.0 </a><a href="#bookmark704" class="h3">622</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark705" class="h3">Authentication Protocol </a><a href="#bookmark705" class="s15">ap2.0 </a><a href="#bookmark705" class="h3">622</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark707" class="h3">Authentication Protocol </a><a href="#bookmark707" class="s15">ap3.0 </a><a href="#bookmark707" class="h3">623</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark708" class="h3">Authentication Protocol </a><a href="#bookmark708" class="s15">ap3.1 </a><a href="#bookmark708" class="h3">623</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark712" class="h3">Authentication Protocol </a><a href="#bookmark712" class="s15">ap4.0 </a><a href="#bookmark712" class="h3">624</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 26pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark721" class="h3">Securing E-Mail 626</a></p><ol id="l58"><li style="padding-top: 4pt;padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark719" class="h3">Secure E-Mail 627</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark722" class="h3">PGP 630</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 26pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark731" class="h3">Securing TCP Connections: SSL 631</a></p><ol id="l59"><li style="padding-top: 4pt;padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark729" class="h3">The Big Picture 632</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark732" class="h3">A More Complete Picture 635</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 26pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark744" class="h3">Network-Layer Security: IPsec and Virtual Private Networks 637</a></p><ol id="l60"><li style="padding-top: 4pt;padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark735" class="h3">IPsec and Virtual Private Networks (VPNs) 638</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark736" class="h3">The AH and ESP Protocols 640</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark740" class="h3">Security Associations 640</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark743" class="h3">The IPsec Datagram 641</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark745" class="h3">IKE: Key Management in IPsec 645</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 26pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark751" class="h3">Securing Wireless LANs 646</a></p><ol id="l61"><li style="padding-top: 4pt;padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark748" class="h3">Wired Equivalent Privacy (WEP) 646</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark752" class="h3">IEEE 802.11i 648</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 26pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark765" class="h3">Operational Security: Firewalls and Intrusion Detection Systems 651</a></p><ol id="l62"><li style="padding-top: 4pt;padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark762" class="h3">Firewalls 651</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 54pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark766" class="h3">Intrusion Detection Systems 659</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 32pt;text-indent: -26pt;text-align: left;"><p style="display: inline;"><a href="#bookmark768" class="h3">Summary 662</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 195%;text-align: left;"><a href="#bookmark772" class="h3">Homework Problems and Questions </a><a href="#bookmark770" class="h3">664 Wireshark Lab 672</a></p><p style="padding-top: 3pt;padding-left: 24pt;text-indent: 0pt;text-align: left;"><a href="#bookmark771" class="h3">IPsec Lab 672</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p style="padding-left: 24pt;text-indent: 0pt;text-align: left;"><a href="#bookmark773" class="h3">Interview: Steven M. Bellovin 673</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: center;"><a href="#bookmark775" class="s13">Chapter 9 Multimedia Networking 675</a></p><ol id="l63"><ol id="l64"><li style="padding-top: 4pt;padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark781" class="h3">Multimedia Networking Applications 676</a></p><ol id="l65"><li style="padding-top: 4pt;padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark778" class="h3">Properties of Video 676</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark779" class="h3">Properties of Audio 677</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark782" class="h3">Types of Multimedia Network Applications 679</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark788" class="h3">Streaming Stored Video 681</a></p><ol id="l66"><li style="padding-top: 4pt;padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark785" class="h3">UDP Streaming 683</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark789" class="h3">HTTP Streaming 684</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark799" class="h3">Voice-over-IP 688</a></p><ol id="l67"><li style="padding-top: 4pt;padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark791" class="h3">Limitations of the Best-Effort IP Service 688</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark794" class="h3">Removing Jitter at the Receiver for Audio 691</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark796" class="h3">Recovering from Packet Loss 694</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark800" class="h3">Case Study: VoIP with Skype 697</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark809" class="h3">Protocols for Real-Time Conversational Applications 700</a></p><ol id="l68"><li style="padding-top: 4pt;padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark803" class="h3">RTP 700</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark810" class="h3">SIP 703</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark827" class="h3">Network Support for Multimedia 709</a></p><ol id="l69"><li style="padding-top: 4pt;padding-left: 41pt;text-indent: 0pt;text-align: left;"><p style="display: inline;"><a href="#bookmark814" class="h3">Dimensioning Best-Effort Networks 711</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark821" class="h3">Providing Multiple Classes of Service 712</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 72pt;text-indent: -30pt;text-align: left;"><p style="display: inline;"><a href="#bookmark825" class="h3">Diffserv 719</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p></li><li style="padding-left: 41pt;text-indent: 0pt;line-height: 130%;text-align: left;"><p style="display: inline;"><a href="#bookmark828" class="h3">Per-Connection Quality-of-Service (QoS) Guarantees: Resource Reservation and Call Admission 723</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 44pt;text-indent: -20pt;text-align: left;"><p style="display: inline;"><a href="#bookmark831" class="h3">Summary 726</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 23pt;text-indent: 0pt;line-height: 195%;text-align: left;"><a href="#bookmark835" class="h3">Homework Problems and Questions </a><a href="#bookmark834" class="h3">727 Programming Assignment </a><a href="#bookmark836" class="h3">735 Interview: Henning Schulzrinne 736</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s13">References 741</a></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark850" class="s13">Index 783</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="783" height="2" alt="image" src="计算机网络自顶向下7th-en/Image_022.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s16" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark2">Chapter </a><span class="h1">1 </span>Computer Networks and the Internet<a name="bookmark3">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="1" alt="image" src="计算机网络自顶向下7th-en/Image_023.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Today’s Internet is arguably the largest engineered system ever created by mankind, with hundreds of millions of connected computers, communication links, and switches; with billions of users who connect via laptops, tablets, and smartphones; and with an array of new Internet-connected “things” including game consoles, surveillance systems, watches, eye glasses, thermostats, body scales, and cars. Given that the Internet is so large and has so many diverse components and uses, is there any hope of understanding how it works? Are there guiding principles and structure that can provide a foundation for understanding such an amazingly large and complex system? And if so, is it possible that it actually</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">could be both interesting <i>and </i>fun to learn about computer networks? Fortunately, the answer to all of these questions is a resounding YES! Indeed, it’s our aim in this book to provide you with a modern introduction to the dynamic field of computer networking, giving you the principles and practical insights</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">you’ll need to understand not only today’s networks, but tomorrow’s as well.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">This first chapter presents a broad overview of computer networking and the Internet. Our goal here is to paint a broad picture and set the context for the rest of this book, to see the forest through the trees. We’ll cover a lot of ground in this introductory chapter and discuss a lot of the pieces of a computer network, without losing sight of the big picture.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark4">We’ll structure our overview of computer networks in this chapter as follows. After introducing some basic terminology and concepts, we’ll first examine the basic hardware and software components that make up a network. We’ll begin at the network’s edge and look at the end systems and network applications running in the network. We’ll then explore the core of a computer network, examining the links and the switches that transport data, as well as the access networks and physical media that connect end systems to the network core. We’ll learn that the Internet is a network of networks, and we’ll learn how these networks connect with each other.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">After having completed this overview of the edge and core of a computer network, we’ll take the broader and more abstract view in the second half of this chapter. We’ll examine delay, loss, and throughput of data in a computer network and provide simple quantitative models for end-to-end throughput and delay: models that take into account transmission, propagation, and queuing delays. We’ll then introduce some of the key architectural principles in computer networking, namely, protocol layering and service models. We’ll also learn that computer networks are vulnerable to many different types of attacks; we’ll survey</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark5">some of these attacks and consider how computer networks can be made more secure. Finally, we’ll close this chapter with a brief history of computer networking.</a></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l70"><ol id="l71"><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark6">What Is the Internet?</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">In this book, we’ll use the public Internet, a specific computer network, as our principal vehicle for discussing computer networks and their protocols. But what <i>is </i>the Internet? There are a couple of ways</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">to answer this question. First, we can describe the nuts and bolts of the Internet, that is, the basic hardware and software components that make up the Internet. Second, we can describe the Internet in terms of a networking infrastructure that provides services to distributed applications. Let’s begin with</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark8" class="s124">the nuts-and-bolts description, using </a><a href="#bookmark8" class="a">Figure 1.1</a> <span class="p">to illustrate our discussion.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><ol id="l72"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">A Nuts-and-Bolts Description</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The Internet is a computer network that interconnects billions of computing devices throughout the world. Not too long ago, these computing devices were primarily traditional desktop PCs, Linux workstations, and so-called servers that store and transmit information such as Web pages and e-mail messages. Increasingly, however, nontraditional Internet “things” such as laptops, smartphones, tablets, TVs, gaming consoles, thermostats, home security systems, home appliances, watches, eye glasses,</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">cars, traffic control systems and more are being connected to the Internet. Indeed, the term <i>computer network </i>is beginning to sound a bit dated, given the many nontraditional devices that are being hooked up to the Internet. In Internet jargon, all of these devices are called <span class="s20">hosts </span>or <span class="s20">end systems</span>. By some</p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark7">estimates, in 2015 there were about 5 billion devices connected to the Internet, and the number will reach 25 billion by 2020 </a><a href="#bookmark848" class="a">[Gartner </a>2014]<a href="#bookmark848" class="s124">. It is estimated that in 2015 there were over 3.2 billion Internet users worldwide, approximately 40% of the world population </a><a href="#bookmark848" class="a">[ITU 2015</a>]<span class="p">.</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="591" height="976" alt="image" src="计算机网络自顶向下7th-en/Image_024.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark8">Figure 1.1 Some pieces of the Internet</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a name="bookmark9"><span class="p">End systems are connected together by a network of </span></a>communication links <span class="p">and </span>packet switches<a href="#bookmark37" class="s124">. We’ll see in </a><a href="#bookmark37" class="a">Section 1.2</a> <span class="p">that there are many types of communication links, which are made up of</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">different types of physical media, including coaxial cable, copper wire, optical fiber, and radio spectrum. Different links can transmit data at different rates, with the <span class="s20">transmission rate </span>of a link measured in bits/second. When one end system has data to send to another end system, the sending end system segments the data and adds header bytes to each segment. The resulting packages of information, known as <span class="s20">packets </span>in the jargon of computer networks, are then sent through the network to the destination end system, where they are reassembled into the original data.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 147%;text-align: left;">A packet switch takes a packet arriving on one of its incoming communication links and forwards that packet on one of its outgoing communication links. Packet switches come in many shapes and flavors, but the two most prominent types in today’s Internet are <span class="s20">routers </span>and <span class="s20">link-layer switches</span>. Both types of switches forward packets toward their ultimate destinations. Link-layer switches are typically used in access networks, while routers are typically used in the network core. The sequence of communication links and packet switches traversed by a packet from the sending end system to the receiving end system is known as a <span class="s20">route </span>or <span class="s20">path </span>through the network. Cisco predicts annual global IP traffic will pass the zettabyte (10<span class="s21">21</span><span class="s22"> </span><a href="#bookmark848" class="s124">bytes) threshold by the end of 2016, and will reach 2 zettabytes per year by 2019 </a><a href="#bookmark848" class="a">[Cisco VNI 2015</a><span class="s20">]</span>.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Packet-switched networks (which transport packets) are in many ways similar to transportation networks of highways, roads, and intersections (which transport vehicles). Consider, for example, a factory that needs to move a large amount of cargo to some destination warehouse located thousands of kilometers away. At the factory, the cargo is segmented and loaded into a fleet of trucks. Each of the trucks then independently travels through the network of highways, roads, and intersections to the destination warehouse. At the destination warehouse, the cargo is unloaded and grouped with the rest of the cargo arriving from the same shipment. Thus, in many ways, packets are analogous to trucks, communication links are analogous to highways and roads, packet switches are analogous to intersections, and end systems are analogous to buildings. Just as a truck takes a path through the transportation network, a packet takes a path through a computer network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">End systems access the Internet through <span class="s20">Internet Service Providers (ISPs)</span>, including residential ISPs such as local cable or telephone companies; corporate ISPs; university ISPs; ISPs that provide WiFi access in airports, hotels, coffee shops, and other public places; and cellular data ISPs, providing mobile access to our smartphones and other devices. Each ISP is in itself a network of packet switches and communication links. ISPs provide a variety of types of network access to the end systems, including residential broadband access such as cable modem or DSL, high-speed local area network access, and mobile wireless access. ISPs also provide Internet access to content providers,  connecting Web sites and video servers directly to the Internet. The Internet is all about connecting end systems to each other, so the ISPs that provide access to end systems must also be interconnected. These lower-tier ISPs are interconnected through national and international upper-tier ISPs such as Level 3 Communications, AT&amp;T, Sprint, and NTT. An upper-tier ISP consists of high-speed routers interconnected with high-speed fiber-optic links. Each ISP network, whether upper-tier or lower-tier, is</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark59" class="s124" name="bookmark10">managed independently, runs the IP protocol (see below), and conforms to certain naming and address conventions. We’ll examine ISPs and their interconnection more closely in </a><a href="#bookmark59" class="a">Section 1.</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">End systems, packet switches, and other pieces of the Internet run <span class="s20">protocols </span>that control the sending and receiving of information within the Internet. The <span class="s20">Transmission Control Protocol (TCP) </span>and the <span class="s20">Internet Protocol (IP) </span>are two of the most important protocols in the Internet. The IP protocol specifies the format of the packets that are sent and received among routers and end systems. The Internet’s principal protocols are collectively known as <span class="s20">TCP/IP</span>. We’ll begin looking into protocols in this introductory chapter. But that’s just a start—much of this book is concerned with computer network protocols!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">Given the importance of protocols to the Internet, it’s important that everyone agree on what each and every protocol does, so that people can create systems and products that interoperate. This is where standards come into play. </span>Internet standards <a href="#bookmark848" class="s124">are developed by the Internet Engineering Task Force (IETF) </a><a href="#bookmark848" class="a">[IETF 2016</a>]<span class="p">. The IETF standards documents are called </span><span class="s23">requests</span> for comments (RFCs)<span class="p">. RFCs</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">started out as general requests for comments (hence the name) to resolve network and protocol design</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">problems that faced the precursor to the Internet </a><a href="#bookmark848" class="a">[Allman 2011</a>]<span class="p">. RFCs tend to be quite technical and detailed. They define protocols such as TCP, IP, HTTP (for the Web), and SMTP (for e-mail). There are currently more than 7,000 RFCs. Other bodies also specify standards for network components, most</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">notably for network links. The IEEE 802 LAN/MAN Standards Committee </a><a href="#bookmark848" class="a">[IEEE 802 </a>2016]<span class="p">, for example, specifies the Ethernet and wireless WiFi standards.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">A Services Description</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">Our discussion above has identified many of the pieces that make up the Internet. But we can also describe the Internet from an entirely different angle—namely, as <i>an infrastructure that provides services to applications</i>. In addition to traditional applications such as e-mail and Web surfing, Internet</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">applications include mobile smartphone and tablet applications, including Internet messaging, mapping</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">with real-time road-traffic information, music streaming from the cloud, movie and television streaming, online social networks, video conferencing, multi-person games, and location-based recommendation systems. The applications are said to be <span class="s20">distributed applications</span>, since they involve multiple end systems that exchange data with each other. Importantly, Internet applications run on end systems— they do not run in the packet switches in the network core. Although packet switches facilitate the exchange of data among end systems, they are not concerned with the application that is the source or sink of data.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark11">Let’s explore a little more what we mean by an infrastructure that provides services to applications. To this end, suppose you have an exciting new idea for a distributed Internet application, one that may greatly benefit humanity or one that may simply make you rich and famous. How might you go about</a></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark12">transforming this idea into an actual Internet application? Because applications run on end systems, you are going to need to write programs that run on the end systems. You might, for example, write your programs in Java, C, or Python. Now, because you are developing a distributed Internet application, the programs running on the different end systems will need to send data to each other. And here we get to a central issue—one that leads to the alternative way of describing the Internet as a platform for applications. How does one program running on one end system instruct the Internet to deliver data to another program running on another end system?</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">End systems attached to the Internet provide a <span class="s20">socket interface </span>that specifies how a program running on one end system asks the Internet infrastructure to deliver data to a specific destination program running on another end system. This Internet socket interface is a set of rules that the sending program must follow so that the Internet can deliver the data to the destination program. We’ll discuss the</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark138" class="s124">Internet socket interface in detail in </a><a href="#bookmark138" class="a">Chapter </a>2<span class="p">. For now, let’s draw upon a simple analogy, one that we will frequently use in this book. Suppose Alice wants to send a letter to Bob using the postal service. Alice, of course, can’t just write the letter (the data) and drop the letter out her window. Instead, the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">postal service requires that Alice put the letter in an envelope; write Bob’s full name, address, and zip code in the center of the envelope; seal the envelope; put a stamp in the upper-right-hand corner of the envelope; and finally, drop the envelope into an official postal service mailbox. Thus, the postal service has its own “postal service interface,” or set of rules, that Alice must follow to have the postal service deliver her letter to Bob. In a similar manner, the Internet has a socket interface that the program sending data must follow to have the Internet deliver the data to the program that will receive the data.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The postal service, of course, provides more than one service to its customers. It provides express delivery, reception confirmation, ordinary use, and many more services. In a similar manner, the Internet provides multiple services to its applications. When you develop an Internet application, you too must choose one of the Internet’s services for your application. We’ll describe the Internet’s services in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark138" class="a">Chapter </a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We have just given two descriptions of the Internet; one in terms of its hardware and software components, the other in terms of an infrastructure for providing services to distributed applications. But perhaps you are still confused as to what the Internet is. What are packet switching and TCP/IP? What are routers? What kinds of communication links are present in the Internet? What is a distributed application? How can a thermostat or body scale be attached to the Internet? If you feel a bit overwhelmed by all of this now, don’t worry—the purpose of this book is to introduce you to both the nuts and bolts of the Internet and the principles that govern how and why it works. We’ll explain these important terms and questions in the following sections and chapters.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">What Is a Protocol?</p></li></ol></li></ol></ol><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">Now that we’ve got a bit of a feel for what the Internet is, let’s consider another important buzzword in computer networking: <i>protocol</i>. What is a protocol? What does a protocol do<i>?</i></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">A Human Analogy</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark13" class="s124">It is probably easiest to understand the notion of a computer network protocol by first considering some human analogies, since we humans execute protocols all of the time. Consider what you do when you want to ask someone for the time of day. A typical exchange is shown in </a><a href="#bookmark13" class="a">Figure 1.</a>2<span class="p">. Human protocol (or</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark13" class="s124">good manners, at least) dictates that one first offer a greeting (the first “Hi” in </a><a href="#bookmark13" class="a">Figure 1.</a>2<span class="p">) to initiate</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">communication with someone else. The typical response to a “Hi” is a returned “Hi” message. Implicitly, one then takes a cordial “Hi” response as an indication that one can proceed and ask for the time of day. A different response to the initial “Hi” (such as “Don’t bother me!” or “I don’t speak English,” or some unprintable reply) might</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="802" height="550" alt="image" src="计算机网络自顶向下7th-en/Image_025.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark13">Figure 1.2 A human protocol and a computer network protocol</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a name="bookmark14">indicate an unwillingness or inability to communicate. In this case, the human protocol would be not to ask for the time of day. Sometimes one gets no response at all to a question, in which case one typically gives up asking that person for the time. Note that in our human protocol, </a><i>there are specific messages</i></p><p class="s17" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">we send, and specific actions we take in response to the received reply messages or other events <span class="p">(such as no reply within some given amount of time). Clearly, transmitted and received messages, and actions taken when these messages are sent or received or other events occur, play a central role in a human</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">protocol. If people run different protocols (for example, if one person has manners but the other does not, or if one understands the concept of time and the other does not) the protocols do not interoperate and no useful work can be accomplished. The same is true in networking—it takes two (or more) communicating entities running the same protocol in order to accomplish a task.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s consider a second human analogy. Suppose you’re in a college class (a computer networking class, for example!). The teacher is droning on about protocols and you’re confused. The teacher stops to ask, “Are there any questions?” (a message that is transmitted to, and received by, all students who are not sleeping). You raise your hand (transmitting an implicit message to the teacher). Your teacher acknowledges you with a smile, saying “Yes . . .” (a transmitted message encouraging you to ask your</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">question—teachers <i>love </i>to be asked questions), and you then ask your question (that is, transmit your message to your teacher). Your teacher hears your question (receives your question message) and answers (transmits a reply to you). Once again, we see that the transmission and receipt of messages,</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">and a set of conventional actions taken when these messages are sent and received, are at the heart of this question-and-answer protocol.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Network Protocols</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A network protocol is similar to a human protocol, except that the entities exchanging messages and taking actions are hardware or software components of some device (for example, computer, smartphone, tablet, router, or other network-capable device). All activity in the Internet that involves two or more communicating remote entities is governed by a protocol. For example, hardware-implemented protocols in two physically connected computers control the flow of bits on the “wire” between the two network interface cards; congestion-control protocols in end systems control the rate at which packets are transmitted between sender and receiver; protocols in routers determine a packet’s path from source to destination. Protocols are running everywhere in the Internet, and consequently much of this book is about computer network protocols.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark13" class="s124">As an example of a computer network protocol with which you are probably familiar, consider what happens when you make a request to a Web server, that is, when you type the URL of a Web page into your Web browser. The scenario is illustrated in the right half of </a><a href="#bookmark13" class="a">Figure 1.</a>2<span class="p">. First, your computer will</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">send a connection request message to the Web server and wait for a reply. The Web server will</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">eventually receive your connection request message and return a connection reply message. Knowing that it is now OK to request the Web document, your computer then sends the name of the Web page it wants to fetch from that Web server in a GET message. Finally, the Web server returns the Web page (file) to your computer.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark15">Given the human and networking examples above, the exchange of messages and the actions taken when these messages are sent and received are the key defining elements of a protocol:</a><a name="bookmark16">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="85" alt="image" src="计算机网络自顶向下7th-en/Image_026.png"/></span></p><p class="s17" style="padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">A <b>protocol </b>defines the format and the order of messages exchanged between two or more communicating entities, as well as the actions taken on the transmission and/or receipt of a message or other event.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The Internet, and computer networks in general, make extensive use of protocols. Different protocols are used to accomplish different communication tasks. As you read through this book, you will learn that some protocols are simple and straightforward, while others are complex and intellectually deep. Mastering the field of computer networking is equivalent to understanding the what, why, and how of networking protocols.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s18" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark17">1.2 The Network Edge</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the previous section we presented a high-level overview of the Internet and networking protocols. We are now going to delve a bit more deeply into the components of a computer network (and the Internet, in particular). We begin in this section at the edge of a network and look at the components with which we are most familiar—namely, the computers, smartphones and other devices that we use on a daily basis. In the next section we’ll move from the network edge to the network core and examine switching and routing in computer networks.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark19" class="s124">Recall from the previous section that in computer networking jargon, the computers and other devices connected to the Internet are often referred to as end systems. They are referred to as end systems because they sit at the edge of the Internet, as shown in </a><a href="#bookmark19" class="a">Figure 1.</a>3<span class="p">. The Internet’s end systems include</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">desktop computers (e.g., desktop PCs, Macs, and Linux boxes), servers (e.g., Web and e-mail servers),</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">and mobile devices (e.g., laptops, smartphones, and tablets). Furthermore, an increasing number of non-traditional “things” are being attached to the Internet as end systems (see the Case History feature).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a name="bookmark18">End systems are also referred to as </a><i>hosts </i>because they host (that is, run) application programs such as a Web browser program, a Web server program, an e-mail client program, or an e-mail server program. Throughout this book we will use the</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="667" height="858" alt="image" src="计算机网络自顶向下7th-en/Image_027.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;text-indent: 0pt;text-align: center;"><a name="bookmark19">Figure 1.3 End-system interaction</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="177" alt="image" src="计算机网络自顶向下7th-en/Image_028.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><a name="bookmark20">CASE HISTORY</a></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">THE INTERNET OF THINGS</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Can you imagine a world in which just about everything is wirelessly connected to the Internet? A world in which most people, cars, bicycles, eye glasses, watches, toys, hospital equipment, home sensors, classrooms, video surveillance systems, atmospheric sensors, store-shelf</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="718" alt="image" src="计算机网络自顶向下7th-en/Image_029.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark21">products, and pets are connected? This world of the Internet of Things (IoT) may actually be just around the corner.</a></p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">By some estimates, as of 2015 there are already 5 billion things connected to the Internet, and the number could reach 25 billion by 2020 </a><a href="#bookmark848" class="a">[Gartner </a>2014]<span class="p">. These things include our</span></p><p style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">smartphones, which already follow us around in our homes, offices, and cars, reporting our geo- locations and usage data to our ISPs and Internet applications. But in addition to our smartphones, a wide-variety of non-traditional “things” are already available as products. For example, there are Internet-connected wearables, including watches (from Apple and many others) and eye glasses. Internet-connected glasses can, for example, upload everything we see to the cloud, allowing us to share our visual experiences with people around the world in real- time. There are Internet-connected things already available for the smart home, including Internet-connected thermostats that can be controlled remotely from our smartphones, and Internet-connected body scales, enabling us to graphically review the progress of our diets from our smartphones. There are Internet-connected toys, including dolls that recognize and interpret a child’s speech and respond appropriately.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">The IoT offers potentially revolutionary benefits to users. But at the same time there are also huge security and privacy risks. For example, attackers, via the Internet, might be able to hack into IoT devices or into the servers collecting data from IoT devices. For example, an attacker could hijack an Internet-connected doll and talk directly with a child; or an attacker could hack into a database that stores personal health and activity information collected from wearable devices. These security and privacy concerns could undermine the consumer confidence necessary for the technologies to meet their full potential and may result in less widespread</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">adoption </a><a href="#bookmark848" class="a">[FTC 2015</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">terms hosts and end systems interchangeably; that is, <i>host = end system</i>. Hosts are sometimes further divided into two categories: <span class="s20">clients </span>and <span class="s20">servers</span>. Informally, clients tend to be desktop and mobile PCs, smartphones, and so on, whereas servers tend to be more powerful machines that store and distribute</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Web pages, stream video, relay e-mail, and so on. Today, most of the servers from which we receive search results, e-mail, Web pages, and videos reside in large <span class="s20">data centers</span>. For example, Google has 50-100 data centers, including about 15 large centers, each with more than 100,000 servers.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark22">1.2.1 Access Networks</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark23" class="s124">Having considered the applications and end systems at the “edge of the network,” let’s next consider the access network—the network that physically connects an end system to the first router (also known as the “edge router”) on a path from the end system to any other distant end system. </a><a href="#bookmark23" class="a">Figure 1.4</a> <span class="p">shows</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">several types of access</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="657" height="858" alt="image" src="计算机网络自顶向下7th-en/Image_030.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark23">Figure 1.4 Access networks</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark24">networks with thick, shaded lines and the settings (home, enterprise, and wide-area mobile wireless) in which they are used.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Home Access: DSL, Cable, FTTH, Dial-Up, and Satellite</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">In developed countries as of 2014, more than 78 percent of the households have Internet access, with Korea, Netherlands, Finland, and Sweden leading the way with more than 80 percent of households having Internet access, almost all via a high-speed broadband connection </a><a href="#bookmark848" class="a">[ITU 2015</a>]<span class="p">. Given this</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">widespread use of home access networks let’s begin our overview of access networks by considering</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">how homes connect to the Internet.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Today, the two most prevalent types of broadband residential access are <span class="s20">digital subscriber line (DSL) </span>and cable. A residence typically obtains DSL Internet access from the same local telephone company (telco) that provides its wired local phone access. Thus, when DSL is used, a customer’s telco is also its</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark25" class="s124">ISP. As shown in </a><a href="#bookmark25" class="a">Figure 1.</a>5<a href="#bookmark38" class="s124">, each customer’s DSL modem uses the existing telephone line (twisted- pair copper wire, which we’ll discuss in </a><a href="#bookmark38" class="a">Section 1.2.</a>2<span class="p">) to exchange data with a digital subscriber line access multiplexer (DSLAM) located in the telco’s local central office (CO). The home’s DSL modem</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">takes digital data and translates it to high-frequency tones for transmission over telephone wires to the CO; the analog signals from many such houses are translated back into digital format at the DSLAM.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The residential telephone line carries both data and traditional telephone signals simultaneously, which are encoded at different frequencies:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_031.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_032.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_033.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: justify;">A high-speed downstream channel, in the 50 kHz to 1 MHz band A medium-speed upstream channel, in the 4 kHz to 50 kHz band An ordinary two-way telephone channel, in the 0 to 4 kHz band</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">This approach makes the single DSL link appear as if there were three separate links, so that a telephone call and an Internet connection can share the DSL link at the same time.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="671" height="278" alt="image" src="计算机网络自顶向下7th-en/Image_034.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark25">Figure 1.5 DSL Internet access</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark49" class="s124" name="bookmark26">(We’ll describe this technique of frequency-division multiplexing in </a><a href="#bookmark49" class="a">Section 1.3.</a>1<span class="p">.) On the customer side, a splitter separates the data and telephone signals arriving to the home and forwards the data signal to</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">the DSL modem. On the telco side, in the CO, the DSLAM separates the data and phone signals and sends the data into the Internet. Hundreds or even thousands of households connect to a single DSLAM </a><a href="#bookmark848" class="a">[Dischinger 2007</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">The DSL standards define multiple transmission rates, including 12 Mbps downstream and 1.8 Mbps upstream </a><a href="#bookmark848" class="a">[ITU 1999</a>]<a href="#bookmark848" class="s124">, and 55 Mbps downstream and 15 Mbps upstream </a><a href="#bookmark848" class="a">[ITU 2006</a>]<span class="p">. Because the</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">downstream and upstream rates are different, the access is said to be asymmetric. The actual downstream and upstream transmission rates achieved may be less than the rates noted above, as the DSL provider may purposefully limit a residential rate when tiered service (different rates, available at different prices) are offered. The maximum rate is also limited by the distance between the home and the CO, the gauge of the twisted-pair line and the degree of electrical interference. Engineers have expressly designed DSL for short distances between the home and the CO; generally, if the residence is not located within 5 to 10 miles of the CO, the residence must resort to an alternative form of Internet access.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">While DSL makes use of the telco’s existing local telephone infrastructure, <span class="s20">cable Internet access </span><a href="#bookmark27" class="s124">makes use of the cable television company’s existing cable television infrastructure. A residence obtains cable Internet access from the same company that provides its cable television. As illustrated in </a><a href="#bookmark27" class="a">Figure</a></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark27" class="a">1.</a>6<span class="p">, fiber optics connect the cable head end to neighborhood-level junctions, from which traditional</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">coaxial cable is then used to reach individual houses and apartments. Each neighborhood junction typically supports 500 to 5,000 homes. Because both fiber and coaxial cable are employed in this system, it is often referred to as hybrid fiber coax (HFC).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="785" height="356" alt="image" src="计算机网络自顶向下7th-en/Image_035.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark27">Figure 1.6 A hybrid fiber-coaxial access network</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark28">Cable internet access requires special modems, called cable modems. As with a DSL modem, the cable</a></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">modem is typically an external device and connects to the home PC through an Ethernet port. (We will</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark513" class="s124">discuss Ethernet in great detail in </a><a href="#bookmark513" class="a">Chapter </a>6<span class="p">.) At the cable head end, the cable modem termination system (CMTS) serves a similar function as the DSL network’s DSLAM—turning the analog signal sent from the cable modems in many downstream homes back into digital format. Cable modems divide the</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">HFC network into two channels, a downstream and an upstream channel. As with DSL, access is typically asymmetric, with the downstream channel typically allocated a higher transmission rate than the upstream channel. The DOCSIS 2.0 standard defines downstream rates up to 42.8 Mbps and upstream rates of up to 30.7 Mbps. As in the case of DSL networks, the maximum achievable rate may not be realized due to lower contracted data rates or media impairments.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">One important characteristic of cable Internet access is that it is a shared broadcast medium. In particular, every packet sent by the head end travels downstream on every link to every home and every packet sent by a home travels on the upstream channel to the head end. For this reason, if several users are simultaneously downloading a video file on the downstream channel, the actual rate at which each user receives its video file will be significantly lower than the aggregate cable downstream rate. On the other hand, if there are only a few active users and they are all Web surfing, then each of the users may actually receive Web pages at the full cable downstream rate, because the users will rarely request a Web page at exactly the same time. Because the upstream channel is also shared, a distributed multiple access protocol is needed to coordinate transmissions and avoid collisions. (We’ll discuss this</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark513" class="s124">collision issue in some detail in </a><a href="#bookmark513" class="a">Chapter </a>6<span class="p">.)</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">Although DSL and cable networks currently represent more than 85 percent of residential broadband access in the United States, an up-and-coming technology that provides even higher speeds is </span>fiber to <span class="s23">the</span><a href="#bookmark848" class="a"> home (FTTH) [FTTH Council 2016</a>]<span class="p">. As the name suggests, the FTTH concept is simple—provide</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">an optical fiber path from the CO directly to the home. Many countries today—including the UAE, South</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">Korea, Hong Kong, Japan, Singapore, Taiwan, Lithuania, and Sweden—now have household penetration rates exceeding 30% </a><a href="#bookmark848" class="a">[FTTH Council 2016</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">There are several competing technologies for optical distribution from the CO to the homes. The simplest optical distribution network is called direct fiber, with one fiber leaving the CO for each home. More commonly, each fiber leaving the central office is actually shared by many homes; it is not until the fiber gets relatively close to the homes that it is split into individual customer-specific fibers. There are two competing optical-distribution network architectures that perform this splitting: active optical networks (AONs) and passive optical networks (PONs). AON is essentially switched Ethernet, which is</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark513" class="s124">discussed in </a><a href="#bookmark513" class="a">Chapter </a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark30" class="s124">Here, we briefly discuss PON, which is used in Verizon’s FIOS service. </a><a href="#bookmark30" class="a">Figure 1.7</a> <span class="p">shows FTTH using the PON distribution architecture. Each home has an optical network terminator (ONT), which is connected by dedicated optical fiber to a neighborhood splitter. The splitter combines a number of</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark29">homes (typically less</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="669" height="281" alt="image" src="计算机网络自顶向下7th-en/Image_036.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark30">Figure 1.7 FTTH Internet access</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">than 100) onto a single, shared optical fiber, which connects to an optical line terminator (OLT) in the telco’s CO. The OLT, providing conversion between optical and electrical signals, connects to the Internet via a telco router. In the home, users connect a home router (typically a wireless router) to the ONT and access the Internet via this home router. In the PON architecture, all packets sent from OLT to the splitter are replicated at the splitter (similar to a cable head end).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">FTTH can potentially provide Internet access rates in the gigabits per second range. However, most FTTH ISPs provide different rate offerings, with the higher rates naturally costing more money. The average downstream speed of US FTTH customers was approximately 20 Mbps in 2011 (compared with 13 Mbps for cable access networks and less than 5 Mbps for DSL) [FTTH Council 2011b].</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Two other access network technologies are also used to provide Internet access to the home. In locations where DSL, cable, and FTTH are not available (e.g., in some rural settings), a satellite link can be used to connect a residence to the Internet at speeds of more than 1 Mbps; StarBand and HughesNet are two such satellite access providers. Dial-up access over traditional phone lines is based on the same model as DSL—a home modem connects over a phone line to a modem in the ISP. Compared with DSL and other broadband access networks, dial-up access is excruciatingly slow at 56 kbps.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Access in the Enterprise (and the Home): Ethernet and WiFi</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">On corporate and university campuses, and increasingly in home settings, a local area network (LAN) is used to connect an end system to the edge router. Although there are many types of LAN technologies, Ethernet is by far the most prevalent access technology in corporate, university, and home networks. As</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark32" class="s124" name="bookmark31">shown in </a><a href="#bookmark32" class="a">Figure 1.</a>8<a href="#bookmark513" class="s124">, Ethernet users use twisted-pair copper wire to connect to an Ethernet switch, a technology discussed in detail in </a><a href="#bookmark513" class="a">Chapter </a>6<span class="p">. The Ethernet switch, or a network of such</span></p><p style="padding-top: 5pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="613" height="306" alt="image" src="计算机网络自顶向下7th-en/Image_037.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark32">Figure 1.8 Ethernet Internet access</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">interconnected switches, is then in turn connected into the larger Internet. With Ethernet access, users typically have 100 Mbps or 1 Gbps access to the Ethernet switch, whereas servers may have 1 Gbps or even 10 Gbps access.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark21" class="s124">Increasingly, however, people are accessing the Internet wirelessly from laptops, smartphones, tablets, and other “things” (see earlier sidebar on “</a><a href="#bookmark21" class="a">Internet of Thing</a>s<span class="p">”). In a wireless LAN setting, wireless</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">users transmit/receive packets to/from an access point that is connected into the enterprise’s network (most likely using wired Ethernet), which in turn is connected to the wired Internet. A wireless LAN user must typically be within a few tens of meters of the access point. Wireless LAN access based on IEEE</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">802.11 technology, more colloquially known as WiFi, is now just about everywhere—universities, business offices, cafes, airports, homes, and even in airplanes. In many cities, one can stand on a street corner and be within range of ten or twenty base stations (for a browseable global map of 802.11 base stations that have been discovered and logged on a Web site by people who take great enjoyment in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">doing such things, see </a><a href="#bookmark848" class="a">[wigle.net 2016</a>]<a href="#bookmark513" class="s124">). As discussed in detail in </a><a href="#bookmark513" class="a">Chapter </a>7<span class="p">, 802.11 today provides a shared transmission rate of up to more than 100 Mbps.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Even though Ethernet and WiFi access networks were initially deployed in enterprise (corporate, university) settings, they have recently become relatively common components of home networks. Many homes combine broadband residential access (that is, cable modems or DSL) with these inexpensive</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">wireless LAN technologies to create powerful home networks </a><a href="#bookmark848" class="a">[Edwards 2011</a>]<a href="#bookmark35" class="s124">. </a><a href="#bookmark35" class="a">Figure 1.9</a> <span class="p">shows a typical home network. This home network consists of a roaming laptop as well as a wired PC; a base station (the wireless access point), which communicates with the wireless PC and other wireless</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">devices in the home; a cable modem, providing broadband access to the Internet; and a router, which interconnects the base station and the stationary PC with the cable modem. This network allows household members to have broadband access to the Internet with one member roaming from the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark33">kitchen to the backyard to the bedrooms.</a><a name="bookmark34">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="669" height="224" alt="image" src="计算机网络自顶向下7th-en/Image_038.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark35">Figure 1.9 A typical home network</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Wide-Area Wireless Access: 3G and LTE</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Increasingly, devices such as iPhones and Android devices are being used to message, share photos in social networks, watch movies, and stream music while on the run. These devices employ the same wireless infrastructure used for cellular telephony to send/receive packets through a base station that is operated by the cellular network provider. Unlike WiFi, a user need only be within a few tens of kilometers (as opposed to a few tens of meters) of the base station.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Telecommunications companies have made enormous investments in so-called third-generation (3G) wireless, which provides packet-switched wide-area wireless Internet access at speeds in excess of 1 Mbps. But even higher-speed wide-area access technologies—a fourth-generation (4G) of wide-area wireless networks—are already being deployed. LTE (for “Long-Term Evolution”—a candidate for Bad Acronym of the Year Award) has its roots in 3G technology, and can achieve rates in excess of 10 Mbps. LTE downstream rates of many tens of Mbps have been reported in commercial deployments. We’ll cover the basic principles of wireless networks and mobility, as well as WiFi, 3G, and LTE</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark591" class="s124">technologies (and more!) in </a><a href="#bookmark591" class="a">Chapter </a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">1.2.2 Physical Media</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the previous subsection, we gave an overview of some of the most important network access technologies in the Internet. As we described these technologies, we also indicated the physical media used. For example, we said that HFC uses a combination of fiber cable and coaxial cable. We said that DSL and Ethernet use copper wire. And we said that mobile access networks use the radio spectrum. In this subsection we provide a brief overview of these and other transmission media that are commonly used in the Internet.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In order to define what is meant by a physical medium, let us reflect on the brief life of a bit. Consider a bit traveling from one end system, through a series of links and routers, to another end system. This poor bit gets kicked around and transmitted many, many times! The source end system first transmits the bit, and shortly thereafter the first router in the series receives the bit; the first router then transmits the bit, and shortly thereafter the second router receives the bit; and so on. Thus our bit, when traveling from source to destination, passes through a series of transmitter-receiver pairs. For each transmitter- receiver pair, the bit is sent by propagating electromagnetic waves or optical pulses across a <span class="s20">physical medium</span>. The physical medium can take many shapes and forms and does not have to be of the same type for each transmitter-receiver pair along the path. Examples of physical media include twisted-pair copper wire, coaxial cable, multimode fiber-optic cable, terrestrial radio spectrum, and satellite radio spectrum. Physical media fall into two categories: <span class="s20">guided media </span>and <span class="s20">unguided media</span>. With guided media, the waves are guided along a solid medium, such as a fiber-optic cable, a twisted-pair copper wire, or a coaxial cable. With unguided media, the waves propagate in the atmosphere and in outer space, such as in a wireless LAN or a digital satellite channel.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">But before we get into the characteristics of the various media types, let us say a few words about their costs. The actual cost of the physical link (copper wire, fiber-optic cable, and so on) is often relatively minor compared with other networking costs. In particular, the labor cost associated with the installation of the physical link can be orders of magnitude higher than the cost of the material. For this reason, many builders install twisted pair, optical fiber, and coaxial cable in every room in a building. Even if only one medium is initially used, there is a good chance that another medium could be used in the near future, and so money is saved by not having to lay additional wires in the future.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Twisted-Pair Copper Wire</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The least expensive and most commonly used guided transmission medium is twisted-pair copper wire. For over a hundred years it has been used by telephone networks. In fact, more than 99 percent of the wired connections from the telephone handset to the local telephone switch use twisted-pair copper wire. Most of us have seen twisted pair in our homes (or those of our parents or grandparents!) and work environments. Twisted pair consists of two insulated copper wires, each about 1 mm thick, arranged in a regular spiral pattern. The wires are twisted together to reduce the electrical interference from similar pairs close by. Typically, a number of pairs are bundled together in a cable by wrapping the pairs in a protective shield. A wire pair constitutes a single communication link. <span class="s20">Unshielded twisted pair (UTP) </span>is commonly used for computer networks within a building, that is, for LANs. Data rates for LANs using twisted pair today range from 10 Mbps to 10 Gbps. The data rates that can be achieved depend on the thickness of the wire and the distance between transmitter and receiver.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">When fiber-optic technology emerged in the 1980s, many people disparaged twisted pair because of its relatively low bit rates. Some people even felt that fiber-optic technology would completely replace twisted pair. But twisted pair did not give up so easily. Modern twisted-pair technology, such as category</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">6a cable, can achieve data rates of 10 Gbps for distances up to a hundred meters. In the end, twisted pair has emerged as the dominant solution for high-speed LAN networking.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark36">As discussed earlier, twisted pair is also commonly used for residential Internet access. We saw that dial-up modem technology enables access at rates of up to 56 kbps over twisted pair. We also saw that DSL (digital subscriber line) technology has enabled residential users to access the Internet at tens of Mbps over twisted pair (when users live close to the ISP’s central office).</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Coaxial Cable</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Like twisted pair, coaxial cable consists of two copper conductors, but the two conductors are concentric rather than parallel. With this construction and special insulation and shielding, coaxial cable can achieve high data transmission rates. Coaxial cable is quite common in cable television systems. As we saw earlier, cable television systems have recently been coupled with cable modems to provide residential users with Internet access at rates of tens of Mbps. In cable television and cable Internet access, the transmitter shifts the digital signal to a specific frequency band, and the resulting analog signal is sent from the transmitter to one or more receivers. Coaxial cable can be used as a guided <span class="s20">shared medium</span>. Specifically, a number of end systems can be connected directly to the cable, with each of the end systems receiving whatever is sent by the other end systems.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Fiber Optics</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">An optical fiber is a thin, flexible medium that conducts pulses of light, with each pulse representing a bit. A single optical fiber can support tremendous bit rates, up to tens or even hundreds of gigabits per second. They are immune to electromagnetic interference, have very low signal attenuation up to 100 kilometers, and are very hard to tap. These characteristics have made fiber optics the preferred long- haul guided transmission media, particularly for overseas links. Many of the long-distance telephone networks in the United States and elsewhere now use fiber optics exclusively. Fiber optics is also prevalent in the backbone of the Internet. However, the high cost of optical devices—such as transmitters, receivers, and switches—has hindered their deployment for short-haul transport, such as in a LAN or into the home in a residential access network. The Optical Carrier (OC) standard link speeds</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">range from 51.8 Mbps to 39.8 Gbps; these specifications are often referred to as OC-<i>n</i>, where the link speed equals <i>n </i><a href="#bookmark848" class="s124">∞ 51.8 Mbps. Standards in use today include OC-1, OC-3, OC-12, OC-24, OC-48, OC- 96, OC-192, OC-768. </a><a href="#bookmark848" class="a">[Mukherjee </a><span class="s20">2006</span><a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Ramaswami 2010]</a><span class="s20"> </span>provide coverage of various aspects of</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">optical networking.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Terrestrial Radio Channels</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Radio channels carry signals in the electromagnetic spectrum. They are an attractive medium because they require no physical wire to be installed, can penetrate walls, provide connectivity to a mobile user,</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark37">and can potentially carry a signal for long distances. The characteristics of a radio channel depend significantly on the propagation environment and the distance over which a signal is to be carried. Environmental considerations determine path loss and shadow fading (which decrease the signal strength as the signal travels over a distance and around/through obstructing objects), multipath fading (due to signal reflection off of interfering objects), and interference (due to other transmissions and electromagnetic signals).</a><a name="bookmark38">&zwnj;</a><a name="bookmark39">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Terrestrial radio channels can be broadly classified into three groups: those that operate over very short distance (e.g., with one or two meters); those that operate in local areas, typically spanning from ten to a few hundred meters; and those that operate in the wide area, spanning tens of kilometers. Personal devices such as wireless headsets, keyboards, and medical devices operate over short distances; the</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark33" class="s124">wireless LAN technologies described in </a><a href="#bookmark33" class="a">Section 1.2.1</a> <a href="#bookmark591" class="s124">use local-area radio channels; the cellular access technologies use wide-area radio channels. We’ll discuss radio channels in detail in </a><a href="#bookmark591" class="a">Chapter </a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Satellite Radio Channels</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">A communication satellite links two or more Earth-based microwave transmitter/ receivers, known as ground stations. The satellite receives transmissions on one frequency band, regenerates the signal using a repeater (discussed below), and transmits the signal on another frequency. Two types of satellites are used in communications: </span>geostationary satellites <span class="p">and </span>low-earth orbiting (LEO) <span class="s23">satellites</span><a href="#bookmark848" class="a"> [Wiki Satellite 2016</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Geostationary satellites permanently remain above the same spot on Earth. This stationary presence is achieved by placing the satellite in orbit at 36,000 kilometers above Earth’s surface. This huge distance from ground station through satellite back to ground station introduces a substantial signal propagation delay of 280 milliseconds. Nevertheless, satellite links, which can operate at speeds of hundreds of Mbps, are often used in areas without access to DSL or cable-based Internet access.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">LEO satellites are placed much closer to Earth and do not remain permanently above one spot on Earth. They rotate around Earth (just as the Moon does) and may communicate with each other, as well as with ground stations. To provide continuous coverage to an area, many satellites need to be placed in orbit. There are currently many low-altitude communication systems in development. LEO satellite technology may be used for Internet access sometime in the future.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l73"><ol id="l74"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark40">The Network Core</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark42" class="s124">Having examined the Internet’s edge, let us now delve more deeply inside the network core—the mesh of packet switches and links that interconnects the Internet’s end systems. </a><a href="#bookmark42" class="a">Figure 1.10</a> <span class="p">highlights the</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark41">network core with thick, shaded lines.</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="657" height="858" alt="image" src="计算机网络自顶向下7th-en/Image_039.png"/></span></p><h2 style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark42">Figure 1.10 The network core</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l75"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark43">Packet Switching</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">In a network application, end systems exchange </span>messages <a href="#bookmark13" class="s124">with each other. Messages can contain anything the application designer wants. Messages may perform a control function (for example, the “Hi” messages in our handshaking example in </a><a href="#bookmark13" class="a">Figure 1.</a>2<span class="p">) or can contain data, such as an e-mail message,</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">a JPEG image, or an MP3 audio file. To send a message from a source end system to a destination end</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">system, the source breaks long messages into smaller chunks of data known as <span class="s20">packets</span>. Between source and destination, each packet travels through communication links and <span class="s20">packet switches </span>(for which there are two predominant types, <span class="s20">routers </span>and <span class="s20">link-layer switches</span>). Packets are transmitted over</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">each communication link at a rate equal to the <i>full </i>transmission rate of the link. So, if a source end system or a packet switch is sending a packet of <i>L </i>bits over a link with transmission rate <i>R </i>bits/sec, then the time to transmit the packet is <i>L / R </i>seconds.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Store-and-Forward  Transmission</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Most packet switches use <span class="s20">store-and-forward transmission </span>at the inputs to the links. Store-and-forward transmission means that the packet switch must receive the entire packet before it can begin to transmit the first bit of the packet onto the outbound link. To explore store-and-forward transmission in more detail, consider a simple network consisting of two end systems connected by a single router, as shown</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark45" class="s124">in </a><a href="#bookmark45" class="a">Figure 1.1</a>1<span class="p">. A router will typically have many incident links, since its job is to switch an incoming packet onto an outgoing link; in this simple example, the router has the rather simple task of transferring a packet from one (input) link to the only other attached link. In this example, the source has three</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">packets, each consisting of <i>L </i><a href="#bookmark45" class="s124">bits, to send to the destination. At the snapshot of time shown in </a><a href="#bookmark45" class="a">Figure 1.1</a><span class="s20">1</span>, the source has transmitted some of packet 1, and the front of packet 1 has already arrived at the router. Because the router employs store-and-forwarding, at this instant of time, the router cannot</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">transmit the bits it has received; instead it must first buffer (i.e., “store”) the packet’s bits. Only after the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">router has received <i>all </i>of the packet’s bits can it begin to transmit (i.e., “forward”) the packet onto the outbound link. To gain some insight into store-and-forward transmission, let’s now calculate the amount of time that elapses from when the source begins to send the packet until the destination has received</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark79" class="s124">the entire packet. (Here we will ignore propagation delay—the time it takes for the bits to travel across the wire at near the speed of light—which will be discussed in </a><a href="#bookmark79" class="a">Section 1.</a><span class="s20">4</span>.) The source begins to transmit at time 0; at time <i>L</i>/<i>R </i>seconds, the source has transmitted the entire packet, and the entire</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">packet has been received and stored at the router (since there is no propagation delay). At time <i>L</i>/<i>R</i></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;">seconds, since the router has just received the entire packet, it can begin to transmit the packet onto the outbound link towards the destination; at time 2<i>L</i>/<i>R</i>, the router has transmitted the entire packet, and the</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark44">entire packet has been received by the destination. Thus, the total delay is 2</a><i>L</i>/<i>R</i>. If the</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="528" height="161" alt="image" src="计算机网络自顶向下7th-en/Image_040.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark45">Figure 1.11 Store-and-forward packet switching</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;">switch instead forwarded bits as soon as they arrive (without first receiving the entire packet), then the total delay would be <i>L</i>/<i>R </i><a href="#bookmark79" class="s124">since bits are not held up at the router. But, as we will discuss in </a><a href="#bookmark79" class="a">Section 1.</a><span class="s20">4</span>, routers need to receive, store, and <i>process </i>the entire packet before forwarding.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Now let’s calculate the amount of time that elapses from when the source begins to send the first packet until the destination has received all three packets. As before, at time <i>L</i>/<i>R</i>, the router begins to forward the first packet. But also at time <i>L</i>/<i>R </i>the source will begin to send the second packet, since it has just</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">finished sending the entire first packet. Thus, at time 2<i>L</i>/<i>R</i>, the destination has received the first packet</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">and the router has received the second packet. Similarly, at time 3<i>L</i>/<i>R</i>, the destination has received the first two packets and the router has received the third packet. Finally, at time 4<i>L</i>/<i>R </i>the destination has received all three packets!</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">Let’s now consider the general case of sending one packet from source to destination over a path consisting of <i>N </i>links each of rate <i>R </i>(thus, there are <i>N</i>-1 routers between source and destination).</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Applying the same logic as above, we see that the end-to-end delay is:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark46">dend-to-end=NLR                                                                                                                                     </a><span class="s27">(1.1)</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">You may now want to try to determine what the delay would be for <i>P </i>packets sent over a series of <i>N</i></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">links.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Queuing Delays and Packet Loss</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Each packet switch has multiple links attached to it. For each attached link, the packet switch has an <span class="s20">output buffer </span>(also called an <span class="s20">output queue</span>), which stores packets that the router is about to send into that link. The output buffers play a key role in packet switching. If an arriving packet needs to be transmitted onto a link but finds the link busy with the transmission of another packet, the arriving packet must wait in the output buffer. Thus, in addition to the store-and-forward delays, packets suffer output buffer <span class="s20">queuing delays</span>. These delays are variable and depend on the level of congestion in the network.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark47">Since the amount of buffer space is finite, an</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="549" height="345" alt="image" src="计算机网络自顶向下7th-en/Image_041.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark48">Figure 1.12 Packet switching</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">arriving packet may find that the buffer is completely full with other packets waiting for transmission. In this case, <span class="s20">packet loss </span>will occur—either the arriving packet or one of the already-queued packets will be dropped.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark48" class="a">Figure 1.12</a> <a href="#bookmark45" class="s124">illustrates a simple packet-switched network. As in </a><a href="#bookmark45" class="a">Figure 1.1</a>1<span class="p">, packets are represented by three-dimensional slabs. The width of a slab represents the number of bits in the packet. In this figure, all packets have the same width and hence the same length. Suppose Hosts A and B are sending</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">packets to Host E. Hosts A and B first send their packets along 100 Mbps Ethernet links to the first router. The router then directs these packets to the 15 Mbps link. If, during a short interval of time, the arrival rate of packets to the router (when converted to bits per second) exceeds 15 Mbps, congestion will occur at the router as packets queue in the link’s output buffer before being transmitted onto the link. For example, if Host A and B each send a burst of five packets back-to-back at the same time, then most of these packets will spend some time waiting in the queue. The situation is, in fact, entirely analogous to many common-day situations—for example, when we wait in line for a bank teller or wait in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark79" class="s124">front of a tollbooth. We’ll examine this queuing delay in more detail in </a><a href="#bookmark79" class="a">Section 1.</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Forwarding Tables and Routing Protocols</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Earlier, we said that a router takes a packet arriving on one of its attached communication links and forwards that packet onto another one of its attached communication links. But how does the router determine which link it should forward the packet onto? Packet forwarding is actually done in different ways in different types of computer networks. Here, we briefly describe how it is done in the Internet.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark49">In the Internet, every end system has an address called an IP address. When a source end system wants to send a packet to a destination end system, the source includes the destination’s IP address in the packet’s header. As with postal addresses, this address has a hierarchical structure. When a packet arrives at a router in the network, the router examines a portion of the packet’s destination address and forwards the packet to an adjacent router. More specifically, each router has a </a><span class="s20">forwarding table </span>that maps destination addresses (or portions of the destination addresses) to that router’s outbound links. When a packet arrives at a router, the router examines the address and searches its forwarding table, using this destination address, to find the appropriate outbound link. The router then directs the packet to this outbound link.<a name="bookmark50">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The end-to-end routing process is analogous to a car driver who does not use maps but instead prefers to ask for directions. For example, suppose Joe is driving from Philadelphia to 156 Lakeside Drive in Orlando, Florida. Joe first drives to his neighborhood gas station and asks how to get to 156 Lakeside Drive in Orlando, Florida. The gas station attendant extracts the Florida portion of the address and tells Joe that he needs to get onto the interstate highway I-95 South, which has an entrance just next to the gas station. He also tells Joe that once he enters Florida, he should ask someone else there. Joe then takes I-95 South until he gets to Jacksonville, Florida, at which point he asks another gas station attendant for directions. The attendant extracts the Orlando portion of the address and tells Joe that he should continue on I-95 to Daytona Beach and then ask someone else. In Daytona Beach, another gas station attendant also extracts the Orlando portion of the address and tells Joe that he should take I-4 directly to Orlando. Joe takes I-4 and gets off at the Orlando exit. Joe goes to another gas station attendant, and this time the attendant extracts the Lakeside Drive portion of the address and tells Joe the road he must follow to get to Lakeside Drive. Once Joe reaches Lakeside Drive, he asks a kid on a bicycle how to get to his destination. The kid extracts the 156 portion of the address and points to the house. Joe finally reaches his ultimate destination. In the above analogy, the gas station attendants and kids on bicycles are analogous to routers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We just learned that a router uses a packet’s destination address to index a forwarding table and determine the appropriate outbound link. But this statement begs yet another question: How do forwarding tables get set? Are they configured by hand in each and every router, or does the Internet</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark444" class="s124">use a more automated procedure? This issue will be studied in depth in </a><a href="#bookmark444" class="a">Chapter </a>5<span class="p">. But to whet your appetite here, we’ll note now that the Internet has a number of special </span>routing protocols <span class="p">that are used to automatically set the forwarding tables. A routing protocol may, for example, determine the shortest</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">path from each router to each destination and use the shortest path results to configure the forwarding tables in the routers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="http://www.traceroute.org/" class="s124" target="_blank">How would you actually like to see the end-to-end route that packets take in the Internet? We now invite you to get your hands dirty by interacting with the Trace-route program. Simply visit the site </a>www.traceroute.org<span class="p">, choose a source in a particular country, and trace the route from that source to</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark79" class="s124">your computer. (For a discussion of Traceroute, see </a><a href="#bookmark79" class="a">Section 1.</a>4<span class="p">.)</span></p></li><li style="padding-top: 2pt;padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark51">Circuit Switching</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">There are two fundamental approaches to moving data through a network of links and switches: <span class="s20">circuit switching </span>and <span class="s20">packet switching</span>. Having covered packet-switched networks in the previous subsection, we now turn our attention to circuit-switched networks.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">In circuit-switched networks, the resources needed along a path (buffers, link transmission rate) to provide for communication between the end systems are <i>reserved </i>for the duration of the communication session between the end systems. In packet-switched networks, these resources are <i>not </i>reserved; a</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">session’s messages use the resources on demand and, as a consequence, may have to wait (that is,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">queue) for access to a communication link. As a simple analogy, consider two restaurants, one that requires reservations and another that neither requires reservations nor accepts them. For the restaurant that requires reservations, we have to go through the hassle of calling before we leave home. But when we arrive at the restaurant we can, in principle, immediately be seated and order our meal. For the restaurant that does not require reservations, we don’t need to bother to reserve a table. But when we arrive at the restaurant, we may have to wait for a table before we can be seated.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Traditional telephone networks are examples of circuit-switched networks. Consider what happens when one person wants to send information (voice or facsimile) to another over a telephone network. Before the sender can send the information, the network must establish a connection between the</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">sender and the receiver. This is a <i>bona fide </i>connection for which the switches on the path between the sender and receiver maintain connection state for that connection. In the jargon of telephony, this connection is called a <span class="s20">circuit</span>. When the network establishes the circuit, it also reserves a constant</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">transmission rate in the network’s links (representing a fraction of each link’s transmission capacity) for the duration of the connection. Since a given transmission rate has been reserved for this sender-to- receiver connection, the sender can transfer the data to the receiver at the <i>guaranteed </i>constant rate.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark53" class="a">Figure 1.13</a> <span class="p">illustrates a circuit-switched network. In this network, the four circuit switches are interconnected by four links. Each of these links has four circuits, so that each link can support four simultaneous connections. The hosts (for example, PCs and workstations) are each directly connected</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark52">to one of the switches. When two hosts want to communicate, the network establishes a dedicated </a><span class="s20">end- to-end connection </span>between the two hosts. Thus, in order for Host A to communicate with Host B, the network must first reserve one circuit on each of two links. In this example, the dedicated end-to-end connection uses the second circuit in the first link and the fourth circuit in the second link. Because each link has four circuits, for each link used by the end-to-end connection, the connection gets one fourth of the link’s total transmission capacity for the duration of the connection. Thus, for example, if each link between adjacent switches has a transmission rate of 1 Mbps, then each end-to-end circuit-switch connection gets 250 kbps of dedicated transmission rate.</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="426" height="297" alt="image" src="计算机网络自顶向下7th-en/Image_042.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark53">Figure 1.13 A simple circuit-switched network consisting of four switches and four links</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In contrast, consider what happens when one host wants to send a packet to another host over a packet-switched network, such as the Internet. As with circuit switching, the packet is transmitted over a series of communication links. But different from circuit switching, the packet is sent into the network without reserving any link resources whatsoever. If one of the links is congested because other packets need to be transmitted over the link at the same time, then the packet will have to wait in a buffer at the sending side of the transmission link and suffer a delay. The Internet makes its best effort to deliver packets in a timely manner, but it does not make any guarantees.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Multiplexing in Circuit-Switched Networks</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A circuit in a link is implemented with either <span class="s20">frequency-division multiplexing (FDM) </span>or <span class="s20">time-division multiplexing (TDM)</span>. With FDM, the frequency spectrum of a link is divided up among the connections established across the link. Specifically, the link dedicates a frequency band to each connection for the duration of the connection. In telephone networks, this frequency band typically has a width of 4 kHz (that is, 4,000 hertz or 4,000 cycles per second). The width of the band is called, not surprisingly, the</p><p class="s28" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">bandwidth<span class="p">. FM radio stations also use FDM to share the frequency spectrum between 88 MHz and 108 MHz, with each station being allocated a specific frequency band.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark54">For a TDM link, time is divided into frames of fixed duration, and each frame is divided into a fixed number of time slots. When the network establishes a connection across a link, the network dedicates one time slot in every frame to this connection. These slots are dedicated for the sole use of that connection, with one time slot available for use (in every frame) to transmit the connection’s data.</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="378" height="132" alt="image" src="计算机网络自顶向下7th-en/Image_043.jpg"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="390" height="186" alt="image" src="计算机网络自顶向下7th-en/Image_044.jpg"/></span></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark55">Figure 1.14</a></h2><p class="s26" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">With FDM, each circuit continuously gets a fraction of the bandwidth. With TDM, each circuit gets all of the bandwidth periodically during brief intervals of time (that is, during slots)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark55" class="a">Figure 1.14</a> <span class="p">illustrates FDM and TDM for a specific network link supporting up to four circuits. For FDM, the frequency domain is segmented into four bands, each of bandwidth 4 kHz. For TDM, the time domain is segmented into frames, with four time slots in each frame; each circuit is assigned the same</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">dedicated slot in the revolving TDM frames. For TDM, the transmission rate of a circuit is equal to the frame rate multiplied by the number of bits in a slot. For example, if the link transmits 8,000 frames per second and each slot consists of 8 bits, then the transmission rate of each circuit is 64 kbps.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Proponents of packet switching have always argued that circuit switching is wasteful because the dedicated circuits are idle during <span class="s20">silent periods</span>. For example, when one person in a telephone call stops talking, the idle network resources (frequency bands or time slots in the links along the connection’s route) cannot be used by other ongoing connections. As another example of how these resources can be underutilized, consider a radiologist who uses a circuit-switched network to remotely access a series of x-rays. The radiologist sets up a connection, requests an image, contemplates the image, and then requests a new image. Network resources are allocated to the connection but are not used (i.e., are wasted) during the radiologist’s contemplation periods. Proponents of packet switching also enjoy pointing out that establishing end-to-end circuits and reserving end-to-end transmission capacity is complicated and requires complex signaling software to coordinate the operation of the switches along the end-to-end path.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before we finish our discussion of circuit switching, let’s work through a numerical example that should shed further insight on the topic. Let us consider how long it takes to send a file of 640,000 bits from Host A to Host B over a circuit-switched network. Suppose that all links in the network use TDM with 24 slots and have a bit rate of 1.536 Mbps. Also suppose that it takes 500 msec to establish an end-to-end circuit before Host A can begin to transmit the file. How long does it take to send the file? Each circuit has a transmission rate of (1.536 Mbps)/24=64 kbps, so it takes (640,000 bits)/(64 kbps)=10 seconds to transmit the file. To this 10 seconds we add the circuit establishment time, giving 10.5 seconds to send the file. Note that the transmission time is independent of the number of links: The transmission time would be 10 seconds if the end-to-end circuit passed through one link or a hundred links. (The actual</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark79" class="s124">end-to-end delay also includes a propagation delay; see </a><a href="#bookmark79" class="a">Section 1.</a>4<span class="p">.)</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Packet Switching Versus Circuit Switching</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having described circuit switching and packet switching, let us compare the two. Critics of packet switching have often argued that packet switching is not suitable for real-time services (for example, telephone calls and video conference calls) because of its variable and unpredictable end-to-end delays (due primarily to variable and unpredictable queuing delays). Proponents of packet switching argue that</p><ol id="l76"><li style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><p class="s20" style="display: inline;"><a href="#bookmark848" class="s124">it offers better sharing of transmission capacity than circuit switching and (2) it is simpler, more efficient, and less costly to implement than circuit switching. An interesting discussion of packet switching versus circuit switching is </a><a href="#bookmark848" class="a">[Molinero-Fernandez 2002</a>]<span class="p">. Generally speaking, people who do</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">not like to hassle with restaurant reservations prefer packet switching to circuit switching.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Why is packet switching more efficient? Let’s look at a simple example. Suppose users share a 1 Mbps link. Also suppose that each user alternates between periods of activity, when a user generates data at a constant rate of 100 kbps, and periods of inactivity, when a user generates no data. Suppose further that a user is active only 10 percent of the time (and is idly drinking coffee during the remaining 90</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">percent of the time). With circuit switching, 100 kbps must be <i>reserved </i>for <i>each </i>user at all times. For example, with circuit-switched TDM, if a one-second frame is divided into 10 time slots of 100 ms each, then each user would be allocated one time slot per frame.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Thus, the circuit-switched link can support only 10(=1 Mbps/100 kbps) simultaneous users. With packet switching, the probability that a specific user is active is 0.1 (that is, 10 percent). If there are 35 users, the probability that there are 11 or more simultaneously active users is approximately 0.0004.</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark127" class="s124">(</a><a href="#bookmark127" class="a">Homework Problem P8</a> <span class="p">outlines how this probability is obtained.) When there are 10 or fewer simultaneously active users (which happens with probability 0.9996), the aggregate arrival rate of data is less than or equal to 1 Mbps, the output rate of the link. Thus, when there are 10 or fewer active users,</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">users’ packets flow through the link essentially without delay, as is the case with circuit switching. When there are more than 10 simultaneously active users, then the aggregate arrival rate of packets exceeds the output capacity of the link, and the output queue will begin to grow. (It continues to grow until the aggregate input rate falls back below 1 Mbps, at which point the queue will begin to diminish in length.) Because the probability of having more than 10 simultaneously active users is minuscule in this</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">example, packet switching provides essentially the same performance as circuit switching, <i>but does so while allowing for more than three times the number of users.</i></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now consider a second simple example. Suppose there are 10 users and that one user suddenly generates one thousand 1,000-bit packets, while other users remain quiescent and do not generate packets. Under TDM circuit switching with 10 slots per frame and each slot consisting of 1,000 bits, the active user can only use its one time slot per frame to transmit data, while the remaining nine time slots in each frame remain idle. It will be 10 seconds before all of the active user’s one million bits of data has</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark56">been transmitted. In the case of packet switching, the active user can continuously send its packets at the full link rate of 1 Mbps, since there are no other users generating packets that need to be multiplexed with the active user’s packets. In this case, all of the active user’s data will be transmitted within 1 second.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The above examples illustrate two ways in which the performance of packet switching can be superior to that of circuit switching. They also highlight the crucial difference between the two forms of sharing a link’s transmission rate among multiple data streams. Circuit switching pre-allocates use of the transmission link regardless of demand, with allocated but unneeded link time going unused. Packet</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">switching on the other hand allocates link use <i>on demand. </i>Link transmission capacity will be shared on a packet-by-packet basis only among those users who have packets that need to be transmitted over the link.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although packet switching and circuit switching are both prevalent in today’s telecommunication networks, the trend has certainly been in the direction of packet switching. Even many of today’s circuit- switched telephone networks are slowly migrating toward packet switching. In particular, telephone networks often use packet switching for the expensive overseas portion of a telephone call.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">A Network of Networks</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We saw earlier that end systems (PCs, smartphones, Web servers, mail servers, and so on) connect into the Internet via an access ISP. The access ISP can provide either wired or wireless connectivity, using an array of access technologies including DSL, cable, FTTH, Wi-Fi, and cellular. Note that the access ISP does not have to be a telco or a cable company; instead it can be, for example, a university (providing Internet access to students, staff, and faculty), or a company (providing access for its employees). But connecting end users and content providers into an access ISP is only a small piece of solving the puzzle of connecting the billions of end systems that make up the Internet. To complete this</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark57">puzzle, the access ISPs themselves must be interconnected. This is done by creating a </a><i>network of networks</i>—understanding this phrase is the key to understanding the Internet.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Over the years, the network of networks that forms the Internet has evolved into a very complex structure. Much of this evolution is driven by economics and national policy, rather than by performance considerations. In order to understand today’s Internet network structure, let’s incrementally build a series of network structures, with each new structure being a better approximation of the complex Internet that we have today. Recall that the overarching goal is to interconnect the access ISPs so that all end systems can send packets to each other. One naive approach would be to have each access</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">ISP <i>directly </i>connect with every other access ISP. Such a mesh design is, of course, much too costly for the access ISPs, as it would require each access ISP to have a separate communication link to each of the hundreds of thousands of other access ISPs all over the world.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Our first network structure, <i>Network Structure 1</i>, interconnects all of the access ISPs with a <i>single global transit ISP</i>. Our (imaginary) global transit ISP is a network of routers and communication links that not only spans the globe, but also has at least one router near each of the hundreds of thousands of access</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">ISPs. Of course, it would be very costly for the global ISP to build such an extensive network. To be profitable, it would naturally charge each of the access ISPs for connectivity, with the pricing reflecting (but not necessarily directly proportional to) the amount of traffic an access ISP exchanges with the global ISP. Since the access ISP pays the global transit ISP, the access ISP is said to be a <span class="s20">customer </span>and the global transit ISP is said to be a <span class="s20">provider</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Now if some company builds and operates a global transit ISP that is profitable, then it is natural for other companies to build their own global transit ISPs and compete with the original global transit ISP. This leads to <i>Network Structure 2</i>, which consists of the hundreds of thousands of access ISPs and</p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">multiple <span class="p">global transit ISPs. The access ISPs certainly prefer Network Structure 2 over Network</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Structure 1 since they can now choose among the competing global transit providers as a function of their pricing and services. Note, however, that the global transit ISPs themselves must interconnect: Otherwise access ISPs connected to one of the global transit providers would not be able to communicate with access ISPs connected to the other global transit providers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Network Structure 2, just described, is a two-tier hierarchy with global transit providers residing at the top tier and access ISPs at the bottom tier. This assumes that global transit ISPs are not only capable of getting close to each and every access ISP, but also find it economically desirable to do so. In reality, although some ISPs do have impressive global coverage and do directly connect with many access ISPs, no ISP has presence in each and every city in the world. Instead, in any given region, there may be a <span class="s20">regional ISP </span>to which the access ISPs in the region connect. Each regional ISP then connects to <span class="s20">tier-1 ISPs</span>. Tier-1 ISPs are similar to our (imaginary) global transit ISP; but tier-1 ISPs, which actually do exist, do not have a presence in every city in the world. There are approximately a dozen tier-1 ISPs, including Level 3 Communications, AT&amp;T, Sprint, and NTT. Interestingly, no group officially sanctions tier-1 status; as the saying goes—if you have to ask if you’re a member of a group, you’re probably not.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Returning to this network of networks, not only are there multiple competing tier-1 ISPs, there may be multiple competing regional ISPs in a region. In such a hierarchy, each access ISP pays the regional ISP to which it connects, and each regional ISP pays the tier-1 ISP to which it connects. (An access ISP can also connect directly to a tier-1 ISP, in which case it pays the tier-1 ISP). Thus, there is customer- provider relationship at each level of the hierarchy. Note that the tier-1 ISPs do not pay anyone as they are at the top of the hierarchy. To further complicate matters, in some regions, there may be a larger regional ISP (possibly spanning an entire country) to which the smaller regional ISPs in that region connect; the larger regional ISP then connects to a tier-1 ISP. For example, in China, there are access ISPs in each city, which connect to provincial ISPs, which in turn connect to national ISPs, which finally</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">connect to tier-1 ISPs </a><a href="#bookmark848" class="a">[Tian 2012</a>]<span class="p">. We refer to this multi-tier hierarchy, which is still only a crude</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">approximation of today’s Internet, as <i>Network Structure 3</i>.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To build a network that more closely resembles today’s Internet, we must add points of presence (PoPs), multi-homing, peering, and Internet exchange points (IXPs) to the hierarchical Network  Structure 3. PoPs exist in all levels of the hierarchy, except for the bottom (access ISP) level. A <span class="s20">PoP </span>is simply a group of one or more routers (at the same location) in the provider’s network where customer ISPs can connect into the provider ISP. For a customer network to connect to a provider’s PoP, it can lease a high-speed link from a third-party telecommunications provider to directly connect one of its routers to a router at the PoP. Any ISP (except for tier-1 ISPs) may choose to <span class="s20">multi-home</span>, that is, to connect to two or more provider ISPs. So, for example, an access ISP may multi-home with two regional ISPs, or it may multi-home with two regional ISPs and also with a tier-1 ISP. Similarly, a regional ISP may multi-home with multiple tier-1 ISPs. When an ISP multi-homes, it can continue to send and receive packets into the Internet even if one of its providers has a failure.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">As we just learned, customer ISPs pay their provider ISPs to obtain global Internet interconnectivity. The amount that a customer ISP pays a provider ISP reflects the amount of traffic it exchanges with the provider. To reduce these costs, a pair of nearby ISPs at the same level of the hierarchy can </span>peer<a href="#bookmark848" class="s124">, that is, they can directly connect their networks together so that all the traffic between them passes over the direct connection rather than through upstream intermediaries. When two ISPs peer, it is typically settlement-free, that is, neither ISP pays the other. As noted earlier, tier-1 ISPs also peer with one another, settlement-free. For a readable discussion of peering and customer-provider relationships, see </a><a href="#bookmark848" class="a">[Van der Berg </a>2008]<span class="p">. Along these same lines, a third-party company can create an </span><span class="s23">Internet</span> Exchange</p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Point (IXP)<span class="p">, which is a meeting point where multiple ISPs can peer together. An IXP is typically in a</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">stand-alone building with its own switches </a><a href="#bookmark848" class="a">[Ager </a>2012]<a href="#bookmark848" class="s124">. There are over 400 IXPs in the Internet today </a><a href="#bookmark848" class="a">[IXP List 2016</a>]<span class="p">. We refer to this ecosystem—consisting of access ISPs, regional ISPs, tier-1 ISPs, PoPs, multi-homing, peering, and IXPs—as </span><span class="s17">Network Structure 4</span><span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 129%;text-align: left;"><a name="bookmark58">We now finally arrive at </a><i>Network Structure 5, </i><a href="#bookmark61" class="s124">which describes today’s Internet. Network Structure 5, illustrated in </a><a href="#bookmark61" class="a">Figure 1.1</a><span class="s20">5</span>, builds on top of Network Structure 4 by adding <span class="s23">content-provider</span><span class="s20"> networks</span>. Google is currently one of the leading examples of such a content-provider network. As of this writing, it</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">is estimated that Google has 50–100 data centers distributed across North America, Europe, Asia, South America, and Australia. Some of these data centers house over one hundred thousand servers, while other data centers are smaller, housing only hundreds of servers. The Google data centers are all interconnected via Google’s private TCP/IP network, which spans the entire globe but is nevertheless separate from the public Internet. Importantly, the Google private network only carries traffic to/from</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark61" class="s124">Google servers. As shown in </a><a href="#bookmark61" class="a">Figure 1.1</a>5<span class="p">, the Google private network attempts to “bypass” the upper tiers of the Internet by peering (settlement free) with lower-tier ISPs, either by directly connecting with</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">them or by connecting with them at IXPs </a><a href="#bookmark848" class="a">[Labovitz 2010</a>]<span class="p">. However, because many access ISPs can still only be reached by transiting through tier-1 networks, the Google network also connects to tier-1 ISPs, and pays those ISPs for the traffic it exchanges with them. By creating its own network, a content</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark228" class="s124" name="bookmark59">provider not only reduces its payments to upper-tier ISPs, but also has greater control of how its services are ultimately delivered to end users. Google’s network infrastructure is described in greater detail in </a><a href="#bookmark228" class="a">Section 2.</a>6<span class="p">.</span><a name="bookmark60">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In summary, today’s Internet—a network of networks—is complex, consisting of a dozen or so tier-1 ISPs and hundreds of thousands of lower-tier ISPs. The ISPs are diverse in their coverage, with some spanning multiple continents and oceans, and others limited to narrow geographic regions. The lower- tier ISPs connect to the higher-tier ISPs, and the higher-tier ISPs interconnect with one another. Users and content providers are customers of lower-tier ISPs, and lower-tier ISPs are customers of higher-tier ISPs. In recent years, major content providers have also created their own networks and connect directly into lower-tier ISPs where possible.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="671" height="293" alt="image" src="计算机网络自顶向下7th-en/Image_045.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark61">Figure 1.15 Interconnection of ISPs</a></h2><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li></ol></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark62">Delay, Loss, and Throughput in Packet-Switched Networks</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark15" class="s124">Back in </a><a href="#bookmark15" class="a">Section 1.1</a> <span class="p">we said that the Internet can be viewed as an infrastructure that provides services to distributed applications running on end systems. Ideally, we would like Internet services to be able to move as much data as we want between any two end systems, instantaneously, without any loss of</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">data. Alas, this is a lofty goal, one that is unachievable in reality. Instead, computer networks necessarily constrain throughput (the amount of data per second that can be transferred) between end systems, introduce delays between end systems, and can actually lose packets. On one hand, it is unfortunate that the physical laws of reality introduce delay and loss as well as constrain throughput. On the other hand, because computer networks have these problems, there are many fascinating issues surrounding how to deal with the problems—more than enough issues to fill a course on computer networking and to motivate thousands of PhD theses! In this section, we’ll begin to examine and quantify delay, loss, and throughput in computer networks.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l77"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Overview of Delay in Packet-Switched Networks</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">Recall that a packet starts in a host (the source), passes through a series of routers, and ends its journey in another host (the destination). As a packet travels from one node (host or router) to the subsequent node (host or router) along this path, the packet suffers from several types of delays at <i>each</i></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">node along the path. The most important of these delays are the <span class="s20">nodal processing delay</span>, <span class="s20">queuing</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">delay<span class="p">, </span>transmission delay<span class="p">, and </span>propagation delay<span class="p">; together, these delays accumulate to give a </span>total nodal delay<span class="p">. The performance of many Internet applications—such as search, Web browsing, e-mail, maps, instant messaging, and voice-over-IP—are greatly affected by network delays. In order to acquire a deep understanding of packet switching and computer networks, we must understand the nature and importance of these delays.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Types of Delay</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark64" class="s124">Let’s explore these delays in the context of </a><a href="#bookmark64" class="a">Figure 1.1</a>6<span class="p">. As part of its end-to-end route between source and destination, a packet is sent from the upstream node through router A to router B. Our goal is to characterize the nodal delay at router A. Note that router A has an outbound link leading to router B.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">This link is preceded by a queue (also known as a buffer). When the packet arrives at router A from the upstream node, router A examines the packet’s header to determine the appropriate outbound link for the packet and then directs the packet to this link. In this example, the outbound link for the packet is the one that leads to router B. A packet can be transmitted on a link only if there is no other packet currently</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark63">being transmitted on the link and if there are no other packets preceding it in the queue; if the link is</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="533" height="211" alt="image" src="计算机网络自顶向下7th-en/Image_046.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark64">Figure 1.16 The nodal delay at router A</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">currently busy or if there are other packets already queued for the link, the newly arriving packet will then join the queue.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Processing Delay</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The time required to examine the packet’s header and determine where to direct the packet is part of the <span class="s20">processing delay</span>. The processing delay can also include other factors, such as the time needed to check for bit-level errors in the packet that occurred in transmitting the packet’s bits from the upstream node to router A. Processing delays in high-speed routers are typically on the order of microseconds or less. After this nodal processing, the router directs the packet to the queue that precedes the link to</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark368" class="s124">router B. (In </a><a href="#bookmark368" class="a">Chapter 4</a> <span class="p">we’ll study the details of how a router operates.)</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Queuing Delay</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">At the queue, the packet experiences a <span class="s20">queuing delay </span>as it waits to be transmitted onto the link. The length of the queuing delay of a specific packet will depend on the number of earlier-arriving packets that are queued and waiting for transmission onto the link. If the queue is empty and no other packet is currently being transmitted, then our packet’s queuing delay will be zero. On the other hand, if the traffic is heavy and many other packets are also waiting to be transmitted, the queuing delay will be long. We will see shortly that the number of packets that an arriving packet might expect to find is a function of the intensity and nature of the traffic arriving at the queue. Queuing delays can be on the order of microseconds to milliseconds in practice.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Transmission Delay</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a name="bookmark65">Assuming that packets are transmitted in a first-come-first-served manner, as is common in packet- switched networks, our packet can be transmitted only after all the packets that have arrived before it have been transmitted. Denote the length of the packet by </a><i>L </i>bits, and denote the transmission rate of</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 129%;text-align: left;">the link from router A to router B by <i>R </i>bits/sec. For example, for a 10 Mbps Ethernet link, the rate is <span class="s27">R</span>=10 Mbps; for a 100 Mbps Ethernet link, the rate is <span class="s27">R</span>=100 Mbps. The <span class="s23">transmission</span><span class="s20"> delay </span>is <i>L/R. </i>This is the amount of time required to push (that is, transmit) all of the packet’s bits into the link.</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Transmission delays are typically on the order of microseconds to milliseconds in practice.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Propagation Delay</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Once a bit is pushed into the link, it needs to propagate to router B. The time required to propagate from the beginning of the link to router B is the <span class="s20">propagation delay</span>. The bit propagates at the propagation speed of the link. The propagation speed depends on the physical medium of the link (that is, fiber optics, twisted-pair copper wire, and so on) and is in the range of</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">2<span class="s29">⋅</span>108 meters/sec to 3<span class="s29">⋅</span>108 meters/sec</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">which is equal to, or a little less than, the speed of light. The propagation delay is the distance between two routers divided by the propagation speed. That is, the propagation delay is <i>d/s, </i>where <i>d </i>is the distance between router A and router B and <i>s </i>is the propagation speed of the link. Once the last bit of</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the packet propagates to node B, it and all the preceding bits of the packet are stored in router B. The</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">whole process then continues with router B now performing the forwarding. In wide-area networks, propagation delays are on the order of milliseconds.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Comparing Transmission and Propagation Delay</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Exploring propagation delay and transmission delay</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="787" height="199" alt="image" src="计算机网络自顶向下7th-en/Image_047.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Newcomers to the field of computer networking sometimes have difficulty understanding the difference between transmission delay and propagation delay. The difference is subtle but important. The transmission delay is the amount of time required for the router to push out the packet; it is a function of the packet’s length and the transmission rate of the link, but has nothing to do with the distance between the two routers. The propagation delay, on the other hand, is the time it takes a bit to propagate from one router to the next; it is a function of the distance between the two routers, but has nothing to do with the packet’s length or the transmission rate of the link.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark67" class="s124">An analogy might clarify the notions of transmission and propagation delay. Consider a highway that has a tollbooth every 100 kilometers, as shown in </a><a href="#bookmark67" class="a">Figure 1.1</a>7<span class="p">. You can think of the highway segments</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark66">between tollbooths as links and the tollbooths as routers. Suppose that cars travel (that is, propagate) on the highway at a rate of 100 km/hour (that is, when a car leaves a tollbooth, it instantaneously accelerates to 100 km/hour and maintains that speed between tollbooths). Suppose next that 10 cars, traveling together as a caravan, follow each other in a fixed order. You can think of each car as a bit and the caravan as a packet. Also suppose that each</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="673" height="133" alt="image" src="计算机网络自顶向下7th-en/Image_048.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark67">Figure 1.17 Caravan analogy</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">tollbooth services (that is, transmits) a car at a rate of one car per 12 seconds, and that it is late at night so that the caravan’s cars are the only cars on the highway. Finally, suppose that whenever the first car of the caravan arrives at a tollbooth, it waits at the entrance until the other nine cars have arrived and lined up behind it. (Thus the entire caravan must be stored at the tollbooth before it can begin to be forwarded.) The time required for the tollbooth to push the entire caravan onto the highway is</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">(10 cars)/(5 cars/minute)=2 minutes. This time is analogous to the transmission delay in a router. The time required for a car to travel from the exit of one tollbooth to the next tollbooth is</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">100 km/(100 km/hour)=1 hour. This time is analogous to propagation delay. Therefore, the time from when the caravan is stored in front of a tollbooth until the caravan is stored in front of the next tollbooth is the sum of transmission delay and propagation delay—in this example, 62 minutes.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s explore this analogy a bit more. What would happen if the tollbooth service time for a caravan were greater than the time for a car to travel between tollbooths? For example, suppose now that the cars travel at the rate of 1,000 km/hour and the tollbooth services cars at the rate of one car per minute. Then the traveling delay between two tollbooths is 6 minutes and the time to serve a caravan is 10 minutes. In this case, the first few cars in the caravan will arrive at the second tollbooth before the last cars in the caravan leave the first tollbooth. This situation also arises in packet-switched networks—the first bits in a packet can arrive at a router while many of the remaining bits in the packet are still waiting to be transmitted by the preceding router.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">If a picture speaks a thousand words, then an animation must speak a million words. The Web site for this textbook provides an interactive Java applet that nicely illustrates and contrasts transmission delay and propagation delay. The reader is highly encouraged to visit that applet. </a><a href="#bookmark848" class="a">[Smith 2009]</a> <span class="p">also provides</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">a very readable discussion of propagation, queueing, and transmission delays.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">If we let <i>d</i><span class="s22">proc</span>, <i>d</i><span class="s22">queue</span>, <i>d</i><span class="s22">trans</span>, and <i>d</i><span class="s22">prop </span>denote the processing, queuing, transmission, and propagation</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark68">delays, then the total nodal delay is given by</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">dnodal=dproc+dqueue+dtrans+dprop</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">The contribution of these delay components can vary significantly. For example, <i>d</i><span class="s22">prop  </span>can be negligible (for example, a couple of microseconds) for a link connecting two routers on the same university</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 147%;text-align: left;">campus; however, <i>d</i><span class="s22">prop  </span>is hundreds of milliseconds for two routers interconnected by a geostationary satellite link, and can be the dominant term in <i>d</i><span class="s22">nodal</span>. Similarly, <i>d</i><span class="s22">trans </span>can range from negligible to significant. Its contribution is typically negligible for transmission rates of 10 Mbps and higher (for example, for LANs); however, it can be hundreds of milliseconds for large Internet packets sent over</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 143%;text-align: left;">low-speed dial-up modem links. The processing delay, <i>d</i><span class="s22">proc</span>, is often negligible; however, it strongly influences a router’s maximum throughput, which is the maximum rate at which a router can forward packets.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Queuing Delay and Packet Loss</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 140%;text-align: left;">The most complicated and interesting component of nodal delay is the queuing delay, <i>d</i><span class="s22">queue</span>. In fact, queuing delay is so important and interesting in computer networking that thousands of papers and</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">numerous books have been written about it </a><a href="#bookmark848" class="a">[Bertsekas </a>1991<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Daigle 199</a>1<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Kleinrock 197</a>5<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Kleinrock </a>1976<span class="p">; Ross 1995]. We give only a high-level, intuitive discussion of queuing delay here; the more curious reader may want to browse through some of the books (or even eventually write a PhD thesis on</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;">the subject!). Unlike the other three delays (namely, <i>d</i><span class="s22">proc</span>, <i>d</i><span class="s22">trans</span>, and <i>d</i><span class="s22">prop</span>), the queuing delay can vary from packet to packet. For example, if 10 packets arrive at an empty queue at the same time, the first packet transmitted will suffer no queuing delay, while the last packet transmitted will suffer a relatively large queuing delay (while it waits for the other nine packets to be transmitted). Therefore, when characterizing queuing delay, one typically uses statistical measures, such as average queuing delay, variance of queuing delay, and the probability that the queuing delay exceeds some specified value.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">When is the queuing delay large and when is it insignificant? The answer to this question depends on the rate at which traffic arrives at the queue, the transmission rate of the link, and the nature of the arriving traffic, that is, whether the traffic arrives periodically or arrives in bursts. To gain some insight</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">here, let <i>a </i>denote the average rate at which packets arrive at the queue (<i>a </i>is in units of packets/sec). Recall that <i>R </i>is the transmission rate; that is, it is the rate (in bits/sec) at which bits are pushed out of the queue. Also suppose, for simplicity, that all packets consist of <i>L </i>bits. Then the average rate at which bits arrive at the queue is <i>La </i>bits/sec. Finally, assume that the queue is very big, so that it can hold</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 15pt;text-align: left;">essentially an infinite number of bits. The ratio <i>La/R, </i>called the <span class="s23">traffic</span><span class="s20"> intensity</span>, often plays an</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">important role in estimating the extent of the queuing delay. If <i>La/R </i>&gt; 1, then the average rate at which bits arrive at the queue exceeds the rate at which the bits can be transmitted from the queue. In this</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;">unfortunate situation, the queue will tend to increase without bound and the queuing delay will approach infinity! Therefore, one of the golden rules in traffic engineering is: <i>Design your system so that the traffic intensity is no greater than 1.</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a name="bookmark69">Now consider the case </a><i>La/R </i>≤ 1. Here, the nature of the arriving traffic impacts the queuing delay. For example, if packets arrive periodically—that is, one packet arrives every <i>L/R </i>seconds—then every packet will arrive at an empty queue and there will be no queuing delay. On the other hand, if packets</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;">arrive in bursts but periodically, there can be a significant average queuing delay. For example, suppose <i>N </i>packets arrive simultaneously every <i>(L/R)N </i>seconds. Then the first packet transmitted has no queuing delay; the second packet transmitted has a queuing delay of <i>L/R </i>seconds; and more generally, the <i>n</i>th</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">packet transmitted has a queuing delay of <span class="s27">(</span>n−1)<i>L/R </i>seconds. We leave it as an exercise for you to</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">calculate the average queuing delay in this example.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">The two examples of periodic arrivals described above are a bit academic. Typically, the arrival process to a queue is <i>random; </i>that is, the arrivals do not follow any pattern and the packets are spaced</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">apart by random amounts of time. In this more realistic case, the quantity <i>La/R </i>is not usually sufficient to</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">fully characterize the queuing delay statistics. Nonetheless, it is useful in gaining an intuitive understanding of the extent of the queuing delay. In particular, if the traffic intensity is close to zero, then packet arrivals are few and far between and it is unlikely that an arriving packet will find another packet in the queue. Hence, the average queuing delay will be close to zero. On the other hand, when the traffic intensity is close to 1, there will be intervals of time when the arrival rate exceeds the transmission capacity (due to variations in packet arrival rate), and a queue will form during these periods of time; when the arrival rate is less than the transmission capacity, the length of the queue will shrink. Nonetheless, as the traffic intensity approaches 1, the average queue length gets larger and larger. The</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark71" class="s124">qualitative dependence of average queuing delay on the traffic intensity is shown in </a><a href="#bookmark71" class="a">Figure 1.1</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark71" class="s124">One important aspect of </a><a href="#bookmark71" class="a">Figure 1.18</a> <span class="p">is the fact that as the traffic intensity approaches 1, the average queuing delay increases rapidly. A small percentage increase in the intensity will result in a much larger percentage-wise increase in delay. Perhaps you have experienced this phenomenon on the highway. If</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">you regularly drive on a road that is typically congested, the fact that the road is typically</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="318" height="291" alt="image" src="计算机网络自顶向下7th-en/Image_049.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark70">Figure 1.18 Dependence of average queuing delay on traffic intensity</a><a name="bookmark71">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">congested means that its traffic intensity is close to 1. If some event causes an even slightly larger-than- usual amount of traffic, the delays you experience can be huge.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To really get a good feel for what queuing delays are about, you are encouraged once again to visit the textbook Web site, which provides an interactive Java applet for a queue. If you set the packet arrival rate high enough so that the traffic intensity exceeds 1, you will see the queue slowly build up over time.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Packet Loss</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In our discussions above, we have assumed that the queue is capable of holding an infinite number of packets. In reality a queue preceding a link has finite capacity, although the queuing capacity greatly depends on the router design and cost. Because the queue capacity is finite, packet delays do not really approach infinity as the traffic intensity approaches 1. Instead, a packet can arrive to find a full queue. With no place to store such a packet, a router will <span class="s20">drop </span>that packet; that is, the packet will be <span class="s20">lost</span>. This overflow at a queue can again be seen in the Java applet for a queue when the traffic intensity is greater than 1.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">From an end-system viewpoint, a packet loss will look like a packet having been transmitted into the network core but never emerging from the network at the destination. The fraction of lost packets increases as the traffic intensity increases. Therefore, performance at a node is often measured not only in terms of delay, but also in terms of the probability of packet loss. As we’ll discuss in the subsequent chapters, a lost packet may be retransmitted on an end-to-end basis in order to ensure that all data are eventually transferred from source to destination.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">End-to-End Delay</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Our discussion up to this point has focused on the nodal delay, that is, the delay at a single router. Let’s now consider the total delay from source to destination. To get a handle on this concept, suppose there are N−1 routers between the source host and the destination host. Let’s also suppose for the moment that the network is uncongested (so that queuing delays are negligible), the processing delay at each</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 148%;text-align: left;">router and at the source host is <i>d</i><span class="s22">proc</span>, the transmission rate out of each router and out of the source host is <i>R </i>bits/sec, and the propagation on each link is <i>d</i><span class="s22">prop</span>. The nodal delays accumulate and give an end-to- end delay,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark72">dend−end=N(dproc+dtrans+dprop)                                                                                                          </a><span class="s27">(1.2)</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><span class="p">where, once again, </span><span class="s27">d</span><span class="p">trans=L/R, where </span><span class="s17">L </span><a href="#bookmark72" class="s124">is the packet size. Note that </a><a href="#bookmark72" class="a">Equation 1.2</a> <a href="#bookmark46" class="s124">is a generalization of </a><a href="#bookmark46" class="a">Equation 1.</a>1<a href="#bookmark72" class="s124">, which did not take into account processing and propagation delays. We leave it to you to generalize </a><a href="#bookmark72" class="a">Equation 1.2</a> <span class="p">to the case of heterogeneous delays at the nodes and to the presence of an average queuing delay at each node.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark73">Traceroute</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Using Traceroute to discover network paths and measure network delay</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="787" height="200" alt="image" src="计算机网络自顶向下7th-en/Image_050.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To get a hands-on feel for end-to-end delay in a computer network, we can make use of the Traceroute program. Traceroute is a simple program that can run in any Internet host. When the user specifies a destination hostname, the program in the source host sends multiple, special packets toward that destination. As these packets work their way toward the destination, they pass through a series of routers. When a router receives one of these special packets, it sends back to the source a short message that contains the name and address of the router.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">More specifically, suppose there are N−1 routers between the source and the destination. Then the source will send <i>N </i>special packets into the network, with each packet addressed to the ultimate destination. These <i>N </i>special packets are marked <i>1 </i>through <i>N, </i>with the first packet marked <i>1 </i>and the last</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">packet marked <i>N</i>. When the <i>n</i>th router receives the <i>n</i>th packet marked <i>n, </i>the router does not forward</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the packet toward its destination, but instead sends a message back to the source. When the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">destination host receives the <i>N</i>th packet, it too returns a message back to the source. The source records the time that elapses between when it sends a packet and when it receives the corresponding</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">return message; it also records the name and address of the router (or the destination host) that returns the message. In this manner, the source can reconstruct the route taken by packets flowing from source to destination, and the source can determine the round-trip delays to all the intervening routers.</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Traceroute actually repeats the experiment just described three times, so the source actually sends <i>3 </i>•</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">N <span class="p">packets to the destination. RFC 1393 describes Traceroute in detail.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="http://gaia.cs.umass.edu/" class="s124" target="_blank">Here is an example of the output of the Traceroute program, where the route was being traced from the source host </a><a href="http://gaia.cs.umass.edu/" class="a" target="_blank">gaia.cs.umass.edu</a> <a href="http://cis.poly.edu/" class="s124" target="_blank">(at the University of Massachusetts) to the host </a><a href="http://cis.poly.edu/" class="a" target="_blank">cis.poly.edu</a> <span class="p">(at Polytechnic University in Brooklyn). The output has six columns: the first column is the </span><span class="s17">n </span><span class="p">value</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">described above, that is, the number of the router along the route; the second column is the name of the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="526" alt="image" src="计算机网络自顶向下7th-en/Image_051.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">router; the third column is the address of the router (of the form xxx.xxx.xxx.xxx); the last three columns are the round-trip delays for three experiments. If the source receives fewer than three messages from any given router (due to packet loss in the network), Traceroute places an asterisk just after the router number and reports fewer than three round-trip times for that router.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">1  cs-gw (128.119.240.254) 1.009 ms 0.899 ms 0.993 ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">2  128.119.3.154 (128.119.3.154) 0.931 ms 0.441 ms 0.651 ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">3  -border4-rt-gi-1-3.gw.umass.edu (128.119.2.194) 1.032 ms 0.484 ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">0.451 ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">4  -acr1-ge-2-1-0.Boston.cw.net (208.172.51.129) 10.006 ms 8.150 ms 8.460</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">5  -agr4-loopback.NewYork.cw.net (206.24.194.104) 12.272 ms 14.344 ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">13.267 ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">6  -acr2-loopback.NewYork.cw.net (206.24.194.62) 13.225 ms 12.292 ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">12.148 ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">7  -pos10-2.core2.NewYork1.Level3.net (209.244.160.133) 12.218 ms 11.823</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">ms 11.793 ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">8   -gige9-1-52.hsipaccess1.NewYork1.Level3.net (64.159.17.39) 13.081 ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">11.556 ms 13.297 ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">9  -p0-0.polyu.bbnplanet.net (4.25.109.122) 12.716 ms 13.052 ms 12.786 ms</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">10 cis.poly.edu (128.238.32.126) 14.080 ms 13.035 ms 12.802 ms</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a name="bookmark74">In the trace above there are nine routers between the source and the destination. Most of these routers have a name, and all of them have addresses. For example, the name of Router 3 is </a><span class="s30">border4-rt-gi- 1-3.gw.umass.edu </span>and its address is <span class="s30">128.119.2.194 </span>. Looking at the data provided for this same</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">router, we see that in the first of the three trials the round-trip delay between the source and the router</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">was 1.03 msec. The round-trip delays for the subsequent two trials were 0.48 and 0.45 msec. These</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a name="bookmark75">round-trip delays include all of the delays just discussed, including transmission delays, propagation delays, router processing delays, and queuing delays. Because the queuing delay is varying with time, the round-trip delay of packet </a><i>n </i>sent to a router <i>n </i>can sometimes be longer than the round-trip delay of</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">packet <i>n+</i>1 sent to router <i>n+</i>1. Indeed, we observe this phenomenon in the above example: the delays</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">to Router 6 are larger than the delays to Router 7!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">Want to try out Traceroute for yourself? We <i>highly </i><a href="http://www.traceroute.org/" class="s124" target="_blank">recommended that you visit </a><a href="http://www.traceroute.org/" class="a" target="_blank">http:// </a><span class="s20">www.traceroute.org</span>, which provides a Web interface to an extensive list of sources for route tracing. You choose a source and supply the hostname for any destination. The Traceroute program then does</p><p class="s20" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">all the work. There are a number of free software programs that provide a graphical interface to Traceroute; one of our favorites is PingPlotter </a><a href="#bookmark848" class="a">[PingPlotter 2016</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">End System, Application, and Other Delays</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">In addition to processing, transmission, and propagation delays, there can be additional significant delays in the end systems. For example, an end system wanting to transmit a packet into a shared medium (e.g., as in a WiFi or cable modem scenario) may <i>purposefully </i>delay its transmission as part of</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">its protocol for sharing the medium with other end systems; we’ll consider such protocols in detail in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark513" class="a">Chapter </a>6<span class="p">. Another important delay is media packetization delay, which is present in Voice-over-IP (VoIP) applications. In VoIP, the sending side must first fill a packet with encoded digitized speech before passing the packet to the Internet. This time to fill a packet—called the packetization delay—can</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">be significant and can impact the user-perceived quality of a VoIP call. This issue will be further explored in a homework problem at the end of this chapter.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Throughput in Computer Networks</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark76">In addition to delay and packet loss, another critical performance measure in computer networks is end- to-end throughput. To define throughput, consider transferring a large file from Host A to Host B across a computer network. This transfer might be, for example, a large video clip from one peer to another in a P2P file sharing system. The </a><span class="s20">instantaneous throughput </span>at any instant of time is the rate (in bits/sec) at which Host B is receiving the file. (Many applications, including many P2P file sharing systems, display the instantaneous throughput during downloads in the user interface—perhaps you have observed this</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 129%;text-align: left;">before!) If the file consists of <i>F </i>bits and the transfer takes <i>T </i>seconds for Host B to receive all <i>F </i>bits, then the <span class="s23">average</span><span class="s20"> throughput </span>of the file transfer is <i>F/T </i>bits/sec. For some applications, such as Internet telephony, it is desirable to have a low delay and an instantaneous throughput consistently above some</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">threshold (for example, over 24 kbps for some Internet telephony applications and over 256 kbps for some real-time video applications). For other applications, including those involving file transfers, delay is not critical, but it is desirable to have the highest possible throughput.</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 147%;text-align: left;"><a href="#bookmark77" class="s124">To gain further insight into the important concept of throughput, let’s consider a few examples. </a><a href="#bookmark77" class="a">Figure 1.19(a)</a><span class="s20"> </span>shows two end systems, a server and a client, connected by two communication links and a router. Consider the throughput for a file transfer from the server to the client. Let <i>R</i><span class="s31">s </span>denote the rate of the link between the server and the router; and <i>R</i><span class="s31">c </span>denote the rate of the link between the router and the client. Suppose that the only bits being sent in the entire network are those from the server to the client. We now ask, in this ideal scenario, what is the server-to-client throughput? To answer this question, we</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 148%;text-align: left;">may think of bits as <i>fluid </i>and communication links as <i>pipes</i>. Clearly, the server cannot pump bits through its link at a rate faster than <i>R</i><span class="s31">s </span>bps; and the router cannot forward bits at a rate faster than <i>R</i><span class="s31">c </span>bps. If Rs&lt;Rc, then the bits pumped by the server will “flow” right through the router and arrive at the client at a rate of <i>R</i><span class="s31">s </span>bps, giving a throughput of <i>R</i><span class="s31">s </span>bps. If, on the other hand, <span class="s27">R</span>c&lt;Rs, then the router will not be able to forward bits as quickly as it receives them. In this case, bits will only leave the router at rate <i>R</i><span class="s31">c</span>, giving an end-to-end throughput of <i>R</i><span class="s31">c</span>. (Note also that if bits continue to arrive at the router at rate <i>R</i><span class="s31">s</span>, and continue to leave the router at <i>R</i><span class="s31">c</span>, the backlog of bits at the router waiting</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="540" height="289" alt="image" src="计算机网络自顶向下7th-en/Image_052.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark77">Figure 1.19 Throughput for a file transfer from server to client</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 147%;text-align: left;"><a name="bookmark78">for transmission to the client will grow and grow—a most undesirable situation!) Thus, for this simple two-link network, the throughput is min{</a><i>R</i><span class="s31">c</span>, <i>R</i><span class="s31">s</span>}, that is, it is the transmission rate of the <span class="s23">bottleneck</span><span class="s20"> link</span>.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">Having determined the throughput, we can now approximate the time it takes to transfer a large file of <i>F </i>bits from server to client as <i>F</i>/min{<i>R</i><span class="s31">s</span>, <i>R</i><span class="s31">c</span>}. For a specific example, suppose you are downloading an MP3 file of F=32 million bits, the server has a transmission rate of Rs=2 Mbps, and you have an access link of Rc=1 Mbps. The time needed to transfer the file is then 32 seconds. Of course, these expressions for throughput and transfer time are only approximations, as they do not account for store-and-forward and processing delays as well as protocol issues.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 127%;text-align: left;"><a href="#bookmark77" class="a">Figure 1.19(b)</a><span class="s20"> </span>now shows a network with <i>N </i>links between the server and the client, with the transmission rates of the <i>N </i>links being <span class="s27">R</span>1,R2,…, RN. Applying the same analysis as for the two-link network, we find that the throughput for a file transfer from server to client is min{R1,R2,…, RN}, which</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">is once again the transmission rate of the bottleneck link along the path between server and client.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark81" class="s124">Now consider another example motivated by today’s Internet. </a><a href="#bookmark81" class="a">Figure 1.20(a)</a> <span class="p">shows two end systems, a server and a client, connected to a computer network. Consider the throughput for a file transfer from</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 156%;text-align: justify;">the server to the client. The server is connected to the network with an access link of rate <i>R</i><span class="s31">s </span>and the client is connected to the network with an access link of rate <i>R</i><span class="s31">c</span>. Now suppose that all the links in the core of the communication network have very high transmission rates, much higher than <i>R</i><span class="s31">s </span>and <i>R</i><span class="s31">c</span>.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Indeed, today, the core of the Internet is over-provisioned with high speed links that experience little</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 144%;text-align: left;">congestion. Also suppose that the only bits being sent in the entire network are those from the server to the client. Because the core of the computer network is like a wide pipe in this example, the rate at which bits can flow from source to destination is again the minimum of <i>R</i><span class="s31">s </span>and <i>R</i><span class="s31">c</span>, that is, throughput <span class="s27">=</span> min{<i>R</i><span class="s31">s</span>, <i>R</i><span class="s31">c</span>}. Therefore, the constraining factor for throughput in today’s Internet is typically the access network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark81" class="s124">For a final example, consider </a><a href="#bookmark81" class="a">Figure 1.20(b)</a> <span class="p">in which there are 10 servers and 10 clients connected to the core of the computer network. In this example, there are 10 simultaneous downloads taking place, involving 10 client-server pairs. Suppose that these 10 downloads are the only traffic in the network at</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">the current time. As shown in the figure, there is a link in the core that is traversed by all 10 downloads. Denote <i>R </i>for the transmission rate of this link <i>R</i>. Let’s suppose that all server access links have the same rate <i>R</i><span class="s31">s</span>, all client access links have the same rate <i>R</i><span class="s31">c</span>, and the transmission rates of all the links in the core—except the one common link of rate <i>R—</i>are much larger than <i>R</i><span class="s31">s</span>, <i>R</i><span class="s31">c</span>, and <i>R</i>. Now we ask, what are the throughputs of the downloads? Clearly, if the rate of the common link, <i>R</i>, is large—say a hundred times larger than both <i>R</i><span class="s31">s </span>and <i>R</i><span class="s31">c</span>—then the throughput for each download will once again be min{<i>R</i><span class="s31">s</span>, <i>R</i><span class="s31">c</span>}. But what if the rate of the common link is of the same order as <i>R</i><span class="s31">s </span>and <i>R</i><span class="s31">c</span>? What will the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">throughput be in this case? Let’s take a look at a specific example. Suppose Rs=2 Mbps, Rc=1 Mbps,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">R=5 Mbps, and the</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="138" height="461" alt="image" src="计算机网络自顶向下7th-en/Image_053.jpg"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="288" height="461" alt="image" src="计算机网络自顶向下7th-en/Image_054.jpg"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark79">Figure 1.20 End-to-end throughput: (a) Client downloads a file from server; (b) 10 clients downloading with 10 servers</a><a name="bookmark80">&zwnj;</a><a name="bookmark81">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">common link divides its transmission rate equally among the 10 downloads. Then the bottleneck for each download is no longer in the access network, but is now instead the shared link in the core, which only provides each download with 500 kbps of throughput. Thus the end-to-end throughput for each download is now reduced to 500 kbps.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark77" class="s124">The examples in </a><a href="#bookmark77" class="a">Figure 1.19</a> <a href="#bookmark81" class="s124">and </a><a href="#bookmark81" class="a">Figure 1.20(a)</a> <span class="p">show that throughput depends on the transmission rates of the links over which the data flows. We saw that when there is no other intervening traffic, the throughput can simply be approximated as the minimum transmission rate along the path between</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark81" class="s124">source and destination. The example in </a><a href="#bookmark81" class="a">Figure 1.20(b)</a> <span class="p">shows that more generally the throughput depends not only on the transmission rates of the links along the path, but also on the intervening traffic. In particular, a link with a high transmission rate may nonetheless be the bottleneck link for a file transfer</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">if many other data flows are also passing through that link. We will examine throughput in computer networks more closely in the homework problems and in the subsequent chapters.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li></ol></li><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark82">Protocol Layers and Their Service Models</a><a name="bookmark83">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">From our discussion thus far, it is apparent that the Internet is an <i>extremely </i>complicated system. We have seen that there are many pieces to the Internet: numerous applications and protocols, various types of end systems, packet switches, and various types of link-level media. Given this enormous</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">complexity, is there any hope of organizing a network architecture, or at least our discussion of network architecture? Fortunately, the answer to both questions is yes.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l78"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Layered Architecture</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before attempting to organize our thoughts on Internet architecture, let’s look for a human analogy. Actually, we deal with complex systems all the time in our everyday life. Imagine if someone asked you to describe, for example, the airline system. How would you find the structure to describe this complex system that has ticketing agents, baggage checkers, gate personnel, pilots, airplanes, air traffic control, and a worldwide system for routing airplanes? One way to describe this system might be to describe the series of actions you take (or others take for you) when you fly on an airline. You purchase your ticket, check your bags, go to the gate, and eventually get loaded onto the plane. The plane takes off and is routed to its destination. After your plane lands, you deplane at the gate and claim your bags. If the trip was bad, you complain about the flight to the ticket agent (getting nothing for your effort). This scenario</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark84" class="s124">is shown in </a><a href="#bookmark84" class="a">Figure 1.2</a>1<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="420" height="329" alt="image" src="计算机网络自顶向下7th-en/Image_055.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark84">Figure 1.21 Taking an airplane trip: actions</a></h2><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="767" height="255" alt="image" src="计算机网络自顶向下7th-en/Image_056.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark85">Figure 1.22 Horizontal layering of airline functionality</a><a name="bookmark86">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Already, we can see some analogies here with computer networking: You are being shipped from source to destination by the airline; a packet is shipped from source host to destination host in the Internet. But this is not quite the analogy we are after. We are looking for some <i>structure </i><a href="#bookmark84" class="s124">in </a><a href="#bookmark84" class="a">Figure 1.2</a><span class="s20">1</span>.</p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark84" class="s124">Looking at </a><a href="#bookmark84" class="a">Figure 1.2</a>1<span class="p">, we note that there is a ticketing function at each end; there is also a baggage</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">function for already-ticketed passengers, and a gate function for already-ticketed and already-baggage- checked passengers. For passengers who have made it through the gate (that is, passengers who are already ticketed, baggage-checked, and through the gate), there is a takeoff and landing function, and while in flight, there is an airplane-routing function. This suggests that we can look at the functionality in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark84" class="a">Figure 1.21</a> <span class="p">in a </span><span class="s17">horizontal </span><a href="#bookmark85" class="s124">manner, as shown in </a><a href="#bookmark85" class="a">Figure 1.2</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark85" class="a">Figure 1.22</a> <span class="p">has divided the airline functionality into layers, providing a framework in which we can discuss airline travel. Note that each layer, combined with the layers below it, implements some</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">functionality, some <i>service. </i>At the ticketing layer and below, airline-counter-to-airline-counter transfer of a person is accomplished. At the baggage layer and below, baggage-check-to-baggage-claim transfer of a person and bags is accomplished. Note that the baggage layer provides this service only to an</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">already-ticketed person. At the gate layer, departure-gate-to-arrival-gate transfer of a person and bags is accomplished. At the takeoff/landing layer, runway-to-runway transfer of people and their bags is accomplished. Each layer provides its service by (1) performing certain actions within that layer (for example, at the gate layer, loading and unloading people from an airplane) and by (2) using the services of the layer directly below it (for example, in the gate layer, using the runway-to-runway passenger transfer service of the takeoff/landing layer).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark87">A layered architecture allows us to discuss a well-defined, specific part of a large and complex system. This simplification itself is of considerable value by providing modularity, making it much easier to change the implementation of the service provided by the layer. As long as the layer provides the same service to the layer above it, and uses the same services from the layer below it, the remainder of the system remains unchanged when a layer’s implementation is changed. (Note that changing the</a></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">implementation of a service is very different from changing the service itself!) For example, if the gate functions were changed (for instance, to have people board and disembark by height), the remainder of the airline system would remain unchanged since the gate layer still provides the same function (loading and unloading people); it simply implements that function in a different manner after the change. For large and complex systems that are constantly being updated, the ability to change the implementation of a service without affecting other components of the system is another important advantage of layering.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Protocol Layering</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">But enough about airlines. Let’s now turn our attention to network protocols. To provide structure to the design of network protocols, network designers organize protocols—and the network hardware and software that implement the protocols—in <span class="s20">layers</span>. Each protocol belongs to one of the layers, just as</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark85" class="s124">each function in the airline architecture in </a><a href="#bookmark85" class="a">Figure 1.22</a> <span class="p">belonged to a layer. We are again interested in the </span>services <span class="p">that a layer offers to the layer above—the so-called </span>service model <span class="p">of a layer. Just as in the case of our airline example, each layer provides its service by (1) performing certain actions within</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">that layer and by (2) using the services of the layer directly below it. For example, the services provided</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">by layer <i>n </i>may include reliable delivery of messages from one edge of the network to the other. This might be implemented by using an unreliable edge-to-edge message delivery service of layer n−1, and</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">adding layer <i>n </i>functionality to detect and retransmit lost messages.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">A protocol layer can be implemented in software, in hardware, or in a combination of the two. Application-layer protocols—such as HTTP and SMTP—are almost always implemented in software in the end systems; so are transport-layer protocols. Because the physical layer and data link layers are responsible for handling communication over a specific link, they are typically implemented in a network interface card (for example, Ethernet or WiFi interface cards) associated with a given link. The network layer is often a mixed implementation of hardware and software. Also note that just as the functions in the layered airline architecture were distributed among the various airports and flight control centers that</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;">make up the system, so too is a layer <i>n </i>protocol <i>distributed </i>among the end systems, packet switches, and other components that make up the network. That is, there’s often a piece of a layer <i>n </i>protocol in each of these network components.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">Protocol layering has conceptual and structural advantages </a><a href="#bookmark848" class="a">[RFC </a>3439]<span class="p">. As we have seen, layering provides a structured way to discuss system components. Modularity makes it easier to update system components. We mention, however, that some researchers and networking engineers are vehemently</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark88">opposed to layering </a><a href="#bookmark848" class="a">[Wakeman </a>1992]<span class="p">. One potential drawback of layering is that one layer may duplicate lower-layer functionality. For example, many protocol stacks provide error recovery</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="126" height="211" alt="image" src="计算机网络自顶向下7th-en/Image_057.jpg"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="126" height="270" alt="image" src="计算机网络自顶向下7th-en/Image_058.jpg"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark89">Figure 1.23 The Internet protocol stack (a) and OSI reference model (b)</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">on both a per-link basis and an end-to-end basis. A second potential drawback is that functionality at one layer may need information (for example, a timestamp value) that is present only in another layer; this violates the goal of separation of layers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><span class="p">When taken together, the protocols of the various layers are called the </span>protocol stack<a href="#bookmark89" class="s124">. The Internet protocol stack consists of five layers: the physical, link, network, transport, and application layers, as shown in </a><a href="#bookmark89" class="a">Figure 1.23(a</a>)<span class="p">. If you examine the Table of Contents, you will see that we have roughly</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">organized this book using the layers of the Internet protocol stack. We take a <span class="s20">top-down approach</span>, first</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">covering the application layer and then proceeding downward.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Application Layer</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The application layer is where network applications and their application-layer protocols reside. The Internet’s application layer includes many protocols, such as the HTTP protocol (which provides for Web document request and transfer), SMTP (which provides for the transfer of e-mail messages), and FTP (which provides for the transfer of files between two end systems). We’ll see that certain network</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="http://www.ietf.org/" class="s124" target="_blank">functions, such as the translation of human-friendly names for Internet end systems like </a><a href="http://www.ietf.org/" class="a" target="_blank">www.ietf.org</a> <span class="p">to a 32-bit network address, are also done with the help of a specific application-layer protocol, namely, the</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark138" class="s124">domain name system (DNS). We’ll see in </a><a href="#bookmark138" class="a">Chapter 2</a> <span class="p">that it is very easy to create and deploy our own new application-layer protocols.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">An application-layer protocol is distributed over multiple end systems, with the application in one end system using the protocol to exchange packets of information with the application in another end system. We’ll refer to this packet of information at the application layer as a <span class="s20">message</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark90">Transport Layer</a></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The Internet’s transport layer transports application-layer messages between application endpoints. In the Internet there are two transport protocols, TCP and UDP, either of which can transport application- layer messages. TCP provides a connection-oriented service to its applications. This service includes guaranteed delivery of application-layer messages to the destination and flow control (that is, sender/receiver speed matching). TCP also breaks long messages into shorter segments and provides a congestion-control mechanism, so that a source throttles its transmission rate when the network is congested. The UDP protocol provides a connectionless service to its applications. This is a no-frills service that provides no reliability, no flow control, and no congestion control. In this book, we’ll refer to a transport-layer packet as a <span class="s20">segment</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Network Layer</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The Internet’s network layer is responsible for moving network-layer packets known as <span class="s20">datagrams </span>from one host to another. The Internet transport-layer protocol (TCP or UDP) in a source host passes a transport-layer segment and a destination address to the network layer, just as you would give the postal service a letter with a destination address. The network layer then provides the service of delivering the segment to the transport layer in the destination host.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The Internet’s network layer includes the celebrated IP protocol, which defines the fields in the datagram as well as how the end systems and routers act on these fields. There is only one IP protocol, and all Internet components that have a network layer must run the IP protocol. The Internet’s network layer also contains routing protocols that determine the routes that datagrams take between sources and</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark59" class="s124">destinations. The Internet has many routing protocols. As we saw in </a><a href="#bookmark59" class="a">Section 1.</a>3<span class="p">, the Internet is a network of networks, and within a network, the network administrator can run any routing protocol desired. Although the network layer contains both the IP protocol and numerous routing protocols, it is</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">often simply referred to as the IP layer, reflecting the fact that IP is the glue that binds the Internet together.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Link Layer</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The Internet’s network layer routes a datagram through a series of routers between the source and destination. To move a packet from one node (host or router) to the next node in the route, the network layer relies on the services of the link layer. In particular, at each node, the network layer passes the datagram down to the link layer, which delivers the datagram to the next node along the route. At this next node, the link layer passes the datagram up to the network layer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The services provided by the link layer depend on the specific link-layer protocol that is employed over the link. For example, some link-layer protocols provide reliable delivery, from transmitting node, over one link, to receiving node. Note that this reliable delivery service is different from the reliable delivery service of TCP, which provides reliable delivery from one end system to another. Examples of link-layer</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">protocols include Ethernet, WiFi, and the cable access network’s DOCSIS protocol. As datagrams typically need to traverse several links to travel from source to destination, a datagram may be handled by different link-layer protocols at different links along its route. For example, a datagram may be handled by Ethernet on one link and by PPP on the next link. The network layer will receive a different service from each of the different link-layer protocols. In this book, we’ll refer to the link-layer packets as <span class="s20">frames</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Physical Layer</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">While the job of the link layer is to move entire frames from one network element to an adjacent network element, the job of the physical layer is to move the <i>individual bits </i>within the frame from one node to the</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">next. The protocols in this layer are again link dependent and further depend on the actual transmission medium of the link (for example, twisted-pair copper wire, single-mode fiber optics). For example, Ethernet has many physical-layer protocols: one for twisted-pair copper wire, another for coaxial cable, another for fiber, and so on. In each case, a bit is moved across the link in a different way.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The OSI Model</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having discussed the Internet protocol stack in detail, we should mention that it is not the only protocol stack around. In particular, back in the late 1970s, the International Organization for Standardization (ISO) proposed that computer networks be organized around seven layers, called the Open Systems</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">Interconnection (OSI) model </a><a href="#bookmark848" class="a">[ISO 2016</a>]<span class="p">. The OSI model took shape when the protocols that were to become the Internet protocols were in their infancy, and were but one of many different protocol suites under development; in fact, the inventors of the original OSI model probably did not have the Internet in</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">mind when creating it. Nevertheless, beginning in the late 1970s, many training and university courses picked up on the ISO mandate and organized courses around the seven-layer model. Because of its early impact on networking education, the seven-layer model continues to linger on in some networking textbooks and training courses.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark89" class="s124">The seven layers of the OSI reference model, shown in </a><a href="#bookmark89" class="a">Figure 1.23(b</a>)<span class="p">, are: application layer, presentation layer, session layer, transport layer, network layer, data link layer, and physical layer. The functionality of five of these layers is roughly the same as their similarly named Internet counterparts.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark91">Thus, let’s consider the two additional layers present in the OSI reference model—the presentation layer and the session layer. The role of the presentation layer is to provide services that allow communicating applications to interpret the meaning of data exchanged. These services include data compression and data encryption (which are self-explanatory) as well as data description (which frees the applications from having to worry about the internal format in which data are represented/stored—formats that may differ from one computer to another). The session layer provides for delimiting and synchronization of data exchange, including the means to build a checkpointing and recovery scheme.</a></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a name="bookmark92">The fact that the Internet lacks two layers found in the OSI reference model poses a couple of interesting questions: Are the services provided by these layers unimportant? What if an application </a><i>needs </i>one of these services? The Internet’s answer to both of these questions is the same—it’s up to</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the application developer. It’s up to the application developer to decide if a service is important, and if</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">the service <i>is </i>important, it’s up to the application developer to build that functionality into the application.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Encapsulation</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark93" class="a">Figure 1.24</a> <span class="p">shows the physical path that data takes down a sending end system’s protocol stack, up and down the protocol stacks of an intervening link-layer switch</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="464" alt="image" src="计算机网络自顶向下7th-en/Image_059.png"/></span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark93">Figure 1.24 Hosts, routers, and link-layer switches; each contains a different set of layers, reflecting their differences in functionality</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">and router, and then up the protocol stack at the receiving end system. As we discuss later in this book, routers and link-layer switches are both packet switches. Similar to end systems, routers and link-layer switches organize their networking hardware and software into layers. But routers and link-layer</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">switches do not implement <i>all </i><a href="#bookmark93" class="s124">of the layers in the protocol stack; they typically implement only the bottom layers. As shown in </a><a href="#bookmark93" class="a">Figure 1.2</a><span class="s20">4</span>, link-layer switches implement layers 1 and 2; routers implement layers 1 through 3. This means, for example, that Internet routers are capable of</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">implementing the IP protocol (a layer 3 protocol), while link-layer switches are not. We’ll see later that</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark94">while link-layer switches do not recognize IP addresses, they are capable of recognizing layer 2 addresses, such as Ethernet addresses. Note that hosts implement all five layers; this is consistent with the view that the Internet architecture puts much of its complexity at the edges of the network.</a><a name="bookmark95">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 127%;text-align: left;"><a href="#bookmark93" class="a">Figure 1.24</a> <span class="p">also illustrates the important concept of </span><span class="s23">encapsulation</span><span class="p">. At the sending host, an </span><span class="s23">application-layer</span> message <a href="#bookmark93" class="s124">(M in </a><a href="#bookmark93" class="a">Figure 1.2</a>4<span class="p">) is passed to the transport layer. In the simplest case, the transport layer takes the message and appends additional information (so-called transport-layer</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">header information, H<span class="s31">t </span><a href="#bookmark93" class="s124">in </a><a href="#bookmark93" class="a">Figure 1.2</a><span class="s20">4</span>) that will be used by the receiver-side transport layer. The application-layer message and the transport-layer header information together constitute the <span class="s20">transport- layer segment</span>. The transport-layer segment thus encapsulates the application-layer message. The added information might include information allowing the receiver-side transport layer to deliver the message up to the appropriate application, and error-detection bits that allow the receiver to determine whether bits in the message have been changed in route. The transport layer then passes the segment</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 144%;text-align: left;">to the network layer, which adds network-layer header information (H<span class="s31">n </span><a href="#bookmark93" class="s124">in </a><a href="#bookmark93" class="a">Figure 1.2</a><span class="s20">4</span>) such as source and destination end system addresses, creating a <span class="s20">network-layer datagram</span>. The datagram is then passed to the link layer, which (of course!) will add its own link-layer header information and create a <span class="s20">link-layer frame</span>. Thus, we see that at each layer, a packet has two types of fields: header fields and a <span class="s20">payload field</span>. The payload is typically a packet from the layer above.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;">A useful analogy here is the sending of an interoffice memo from one corporate branch office to another via the public postal service. Suppose Alice, who is in one branch office, wants to send a memo to Bob, who is in another branch office. The <i>memo </i>is analogous to the <i>application-layer message</i>. Alice puts the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">memo in an interoffice envelope with Bob’s name and department written on the front of the envelope.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">The <i>interoffice envelope </i>is analogous to a <i>transport-layer segment</i>—it contains header information (Bob’s name and department number) and it encapsulates the application-layer message (the memo). When the sending branch-office mailroom receives the interoffice envelope, it puts the interoffice</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">envelope inside yet another envelope, which is suitable for sending through the public postal service. The sending mailroom also writes the postal address of the sending and receiving branch offices on the postal envelope. Here, the <i>postal envelope </i>is analogous to the <i>datagram</i>—it encapsulates the transport-</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">layer segment (the interoffice envelope), which encapsulates the original message (the memo). The</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark96">postal service delivers the postal envelope to the receiving branch-office mailroom. There, the process of de-encapsulation is begun. The mailroom extracts the interoffice memo and forwards it to Bob. Finally, Bob opens the envelope and removes the memo.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The process of encapsulation can be more complex than that described above. For example, a large message may be divided into multiple transport-layer segments (which might themselves each be divided into multiple network-layer datagrams). At the receiving end, such a segment must then be reconstructed from its constituent datagrams.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l79"><ol id="l80"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark97">Networks Under Attack</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The Internet has become mission critical for many institutions today, including large and small companies, universities, and government agencies. Many individuals also rely on the Internet for many of their professional, social, and personal activities. Billions of “things,” including wearables and home devices, are currently being connected to the Internet. But behind all this utility and excitement, there is a dark side, a side where “bad guys” attempt to wreak havoc in our daily lives by damaging our Internet- connected computers, violating our privacy, and rendering inoperable the Internet services on which we depend.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The field of network security is about how the bad guys can attack computer networks and about how we, soon-to-be experts in computer networking, can defend networks against those attacks, or better yet, design new architectures that are immune to such attacks in the first place. Given the frequency and variety of existing attacks as well as the threat of new and more destructive future attacks, network security has become a central topic in the field of computer networking. One of the features of this textbook is that it brings network security issues to the forefront.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Since we don’t yet have expertise in computer networking and Internet protocols, we’ll begin here by surveying some of today’s more prevalent security-related problems. This will whet our appetite for more substantial discussions in the upcoming chapters. So we begin here by simply asking, what can go wrong? How are computer networks vulnerable? What are some of the more prevalent types of attacks today?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The Bad Guys Can Put Malware into Your Host Via the Internet</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark98">We attach devices to the Internet because we want to receive/send data from/to the Internet. This includes all kinds of good stuff, including Instagram posts, Internet search results, streaming music, video conference calls, streaming movies, and so on. But, unfortunately, along with all that good stuff comes malicious stuff—collectively known as </a><span class="s20">malware</span>—that can also enter and infect our devices. Once malware infects our device it can do all kinds of devious things, including deleting our files and installing spyware that collects our private information, such as social security numbers, passwords, and keystrokes, and then sends this (over the Internet, of course!) back to the bad guys. Our compromised host may also be enrolled in a network of thousands of similarly compromised devices, collectively known as a <span class="s20">botnet</span>, which the bad guys control and leverage for spam e-mail distribution or distributed denial-of-service attacks (soon to be discussed) against targeted hosts.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Much of the malware out there today is <span class="s20">self-replicating</span>: once it infects one host, from that host it seeks entry into other hosts over the Internet, and from the newly infected hosts, it seeks entry into yet more hosts. In this manner, self-replicating malware can spread exponentially fast. Malware can spread in the form of a virus or a worm. <span class="s20">Viruses </span>are malware that require some form of user interaction to infect the user’s device. The classic example is an e-mail attachment containing malicious executable code. If a user receives and opens such an attachment, the user inadvertently runs the malware on the device. Typically, such e-mail viruses are self-replicating: once executed, the virus may send an identical message with an identical malicious attachment to, for example, every recipient in the user’s address book. <span class="s20">Worms </span>are malware that can enter a device without any explicit user interaction. For example, a user may be running a vulnerable network application to which an attacker can send malware. In some cases, without any user intervention, the application may accept the malware from the Internet and run it, creating a worm. The worm in the newly infected device then scans the Internet, searching for other hosts running the same vulnerable network application. When it finds other vulnerable hosts, it sends a copy of itself to those hosts. Today, malware, is pervasive and costly to defend against. As you work through this textbook, we encourage you to think about the following question: What can computer network designers do to defend Internet-attached devices from malware attacks?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">The Bad Guys Can Attack Servers and Network Infrastructure</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">Another broad class of security threats are known as </span>denial-of-service (DoS) attacks<a href="#bookmark138" class="s124">. As the name suggests, a DoS attack renders a network, host, or other piece of infrastructure unusable by legitimate users. Web servers, e-mail servers, DNS servers (discussed in </a><a href="#bookmark138" class="a">Chapter </a>2<span class="p">), and institutional networks</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">can all be subject to DoS attacks. Internet DoS attacks are extremely common, with thousands of DoS</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">attacks occurring every year </a><a href="#bookmark848" class="a">[Moore 2001</a>]<a href="#bookmark848" class="s124">. The site Digital Attack Map allows use to visualize the top daily DoS attacks worldwide </a><a href="#bookmark848" class="a">[DAM </a>2016]<span class="p">. Most Internet DoS attacks fall into one of three categories:</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_060.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">Vulnerability attack. <span class="p">This involves sending a few well-crafted messages to a vulnerable application or operating system running on a targeted host. If the right sequence of packets is sent to a vulnerable application or operating system, the service can stop or, worse, the host can crash.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_061.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Bandwidth flooding. <span class="p">The attacker sends a deluge of packets to the targeted host—so many packets that the target’s access link becomes clogged, preventing legitimate packets from reaching the server.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_062.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Connection flooding. <a href="#bookmark254" class="s124">The attacker establishes a large number of half-open or fully open TCP connections (TCP connections are discussed in </a><a href="#bookmark254" class="a">Chapter </a><span style=" color: #1E79B8;">3</span><span class="p">) at the target host. The host can become so bogged down with these bogus connections that it stops accepting legitimate connections.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark70" class="s124">Let’s now explore the bandwidth-flooding attack in more detail. Recalling our delay and loss analysis discussion in </a><a href="#bookmark70" class="a">Section 1.4.</a><span class="s20">2</span>, it’s evident that if the server has an access rate of <i>R </i>bps, then the attacker will need to send traffic at a rate of approximately <i>R </i>bps to cause damage. If <i>R </i>is very large, a single</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">attack source may not be able to generate enough traffic to harm the server. Furthermore, if all the</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">traffic emanates from a single source, an upstream router may be able to detect the attack and block all traffic from that source before the traffic gets near the server. In a </span>distributed DoS (DDoS) <a href="#bookmark99" class="s124">attack, illustrated in </a><a href="#bookmark99" class="a">Figure 1.2</a>5<span class="p">, the attacker controls multiple sources and has each source blast traffic at the</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">target. With this approach, the aggregate traffic rate across all the controlled sources needs to be</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">approximately <i>R </i><a href="#bookmark848" class="s124">to cripple the service. DDoS attacks leveraging botnets with thousands of comprised hosts are a common occurrence today </a><a href="#bookmark848" class="a">[DAM </a><span class="s20">2016]</span>. DDos attacks are much harder to detect and defend against than a DoS attack from a single host.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We encourage you to consider the following question as you work your way through this book: What can computer network designers do to defend against DoS attacks? We will see that different defenses are needed for the three types of DoS attacks.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="383" alt="image" src="计算机网络自顶向下7th-en/Image_063.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark99">Figure 1.25 A distributed denial-of-service attack</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark100">The Bad Guys Can Sniff Packets</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark591" class="s124">Many users today access the Internet via wireless devices, such as WiFi-connected laptops or handheld devices with cellular Internet connections (covered in </a><a href="#bookmark591" class="a">Chapter </a>7<span class="p">). While ubiquitous Internet access is</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">extremely convenient and enables marvelous new applications for mobile users, it also creates a major security vulnerability—by placing a passive receiver in the vicinity of the wireless transmitter, that receiver can obtain a copy of every packet that is transmitted! These packets can contain all kinds of sensitive information, including passwords, social security numbers, trade secrets, and private personal messages. A passive receiver that records a copy of every packet that flies by is called a <span class="s20">packet sniffer</span>.</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark37" class="s124">Sniffers can be deployed in wired environments as well. In wired broadcast environments, as in many Ethernet LANs, a packet sniffer can obtain copies of broadcast packets sent over the LAN. As described in </a><a href="#bookmark37" class="a">Section 1.</a>2<span class="p">, cable access technologies also broadcast packets and are thus vulnerable to sniffing.</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Furthermore, a bad guy who gains access to an institution’s access router or access link to the Internet</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">may be able to plant a sniffer that makes a copy of every packet going to/from the organization. Sniffed packets can then be analyzed offline for sensitive information.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">Packet-sniffing software is freely available at various Web sites and as commercial products. Professors teaching a networking course have been known to assign lab exercises that involve writing a packet- sniffing and application-layer data reconstruction program. Indeed, the Wireshark </a><a href="#bookmark848" class="a">[Wireshark 2016]</a></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark129" class="s124">labs associated with this text (see the introductory </a><a href="#bookmark129" class="a">Wireshark lab</a> <span class="p">at the end of this chapter) use exactly</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">such a packet sniffer!</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Because packet sniffers are passive—that is, they do not inject packets into the channel—they are difficult to detect. So, when we send packets into a wireless channel, we must accept the possibility that some bad guy may be recording copies of our packets. As you may have guessed, some of the best defenses against packet sniffing involve cryptography. We will examine cryptography as it applies to</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark671" class="s124">network security in </a><a href="#bookmark671" class="a">Chapter </a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The Bad Guys Can Masquerade as Someone You Trust</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">It is surprisingly easy (<i>you </i>will have the knowledge to do so shortly as you proceed through this text!) to create a packet with an arbitrary source address, packet content, and destination address and then transmit this hand-crafted packet into the Internet, which will dutifully forward the packet to its</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">destination. Imagine the unsuspecting receiver (say an Internet router) who receives such a packet, takes the (false) source address as being truthful, and then performs some command embedded in the packet’s contents (say modifies its forwarding table). The ability to inject packets into the Internet with a false source address is known as <span class="s20">IP spoofing</span>, and is but one of many ways in which one user can masquerade as another user.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">To solve this problem, we will need <i>end-point authentication, </i>that is, a mechanism that will allow us to determine with certainty if a message originates from where we think it does. Once again, we encourage you to think about how this can be done for network applications and protocols as you progress through</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark671" class="s124">the chapters of this book. We will explore mechanisms for end-point authentication in </a><a href="#bookmark671" class="a">Chapter </a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">In closing this section, it’s worth considering how the Internet got to be such an insecure place in the first place. The answer, in essence, is that the Internet was originally designed to be that way, based on the model of “a group of mutually trusting users attached to a transparent network” </a><a href="#bookmark848" class="a">[Blumenthal 2001</a>]<span class="p">—a</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">model in which (by definition) there is no need for security. Many aspects of the original Internet</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">architecture deeply reflect this notion of mutual trust. For example, the ability for one user to send a</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark101">packet to any other user is the default rather than a requested/granted capability, and user identity is taken at declared face value, rather than being authenticated by default.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">But today’s Internet certainly does not involve “mutually trusting users.” Nonetheless, today’s users still need to communicate when they don’t necessarily trust each other, may wish to communicate anonymously, may communicate indirectly through third parties (e.g., Web caches, which we’ll study in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark138" class="a">Chapter </a>2<a href="#bookmark591" class="s124">, or mobility-assisting agents, which we’ll study in </a><a href="#bookmark591" class="a">Chapter </a>7<span class="p">), and may distrust the hardware, software, and even the air through which they communicate. We now have many security-related challenges before us as we progress through this book: We should seek defenses against sniffing, end-</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">point masquerading, man-in-the-middle attacks, DDoS attacks, malware, and more. We should keep in mind that communication among mutually trusted users is the exception rather than the rule. Welcome to the world of modern computer networking!</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark102">History of Computer Networking and the Internet</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark15" class="a">Sections 1.1</a> <a href="#bookmark101" class="s124">through </a><a href="#bookmark101" class="a">1.6</a> <span class="p">presented an overview of the technology of computer networking and the Internet. You should know enough now to impress your family and friends! However, if you really want to be a big hit at the next cocktail party, you should sprinkle your discourse with tidbits about the</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">fascinating history of the Internet </a><a href="#bookmark848" class="a">[Segaller 1998</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><ol id="l81"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The Development of Packet Switching: 1961–1972</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark59" class="s124">The field of computer networking and today’s Internet trace their beginnings back to the early 1960s, when the telephone network was the world’s dominant communication network. Recall from </a><a href="#bookmark59" class="a">Section 1.3</a></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark103">that the telephone network uses circuit switching to transmit information from a sender to a receiver—an appropriate choice given that voice is transmitted at a constant rate between sender and receiver. Given the increasing importance of computers in the early 1960s and the advent of timeshared computers, it was perhaps natural to consider how to hook computers together so that they could be shared among</a></p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">geographically distributed users. The traffic generated by such users was likely to be <i>bursty</i>—intervals of activity, such as the sending of a command to a remote computer, followed by periods of inactivity while waiting for a reply or while contemplating the received response.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">Three research groups around the world, each unaware of the others’ work </a><a href="#bookmark848" class="a">[Leiner 1998</a>]<span class="p">, began inventing packet switching as an efficient and robust alternative to circuit switching. The first published</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">work on packet-switching techniques was that of Leonard Kleinrock </a><a href="#bookmark848" class="a">[Kleinrock </a>1961<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Kleinrock 1964</a>]<span class="p">, then a graduate student at MIT. Using queuing theory, Kleinrock’s work elegantly demonstrated the</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark848" class="s124">effectiveness of the packet-switching approach for bursty traffic sources. In 1964, Paul Baran </a><a href="#bookmark848" class="a">[Baran 1964]</a> <span class="p">at the Rand Institute had begun investigating the use of packet switching for secure voice over military networks, and at the National Physical Laboratory in England, Donald Davies and Roger</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Scantlebury were also developing their ideas on packet switching.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">The work at MIT, Rand, and the NPL laid the foundations for today’s Internet. But the Internet also has a long history of a let’s-build-it-and-demonstrate-it attitude that also dates back to the 1960s. J. C. R. Licklider </a><a href="#bookmark848" class="a">[DEC 1990]</a> <span class="p">and Lawrence Roberts, both colleagues of Kleinrock’s at MIT, went on to lead the</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">computer science program at the Advanced Research Projects Agency (ARPA) in the United States.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">Roberts published an overall plan for the ARPAnet </a><a href="#bookmark848" class="a">[Roberts </a>1967]<span class="p">, the first packet-switched computer network and a direct ancestor of today’s public Internet. On Labor Day in 1969, the first packet switch was installed at UCLA under Kleinrock’s supervision, and three additional packet switches were installed</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark104">shortly thereafter at the Stanford Research Institute (SRI), UC Santa Barbara, and the University of Utah</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark105" class="s124">(</a><a href="#bookmark105" class="a">Figure 1.2</a>6<span class="p">). The fledgling precursor to the Internet was four nodes large by the end of 1969. Kleinrock recalls the very first use of the network to perform a remote login from UCLA to SRI, crashing the</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">system </a><a href="#bookmark848" class="a">[Kleinrock 2004</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">By 1972, ARPAnet had grown to approximately 15 nodes and was given its first public demonstration by Robert Kahn. The first host-to-host protocol between ARPAnet end systems, known as the network- control protocol (NCP), was completed </a><a href="#bookmark848" class="a">[RFC 001</a>]<span class="p">. With an end-to-end protocol available, applications</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">could now be written. Ray Tomlinson wrote the first e-mail program in 1972.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Proprietary Networks and Internetworking: 1972–1980</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The initial ARPAnet was a single, closed network. In order to communicate with an ARPAnet host, one had to be actually attached to another ARPAnet IMP. In the early to mid-1970s, additional stand-alone packet-switching networks besides ARPAnet came into being: ALOHANet, a microwave network linking</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">universities on the Hawaiian islands </a><a href="#bookmark848" class="a">[Abramson </a>1970]<a href="#bookmark848" class="s124">, as well as DARPA’s packet-satellite </a><a href="#bookmark848" class="a">[RFC 829]</a></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="612" height="864" alt="image" src="计算机网络自顶向下7th-en/Image_064.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark105">Figure 1.26 An early packet switch</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">and packet-radio networks </a><a href="#bookmark848" class="a">[Kahn 1978</a>]<span class="p">; Telenet, a BBN commercial packet-switching network based on ARPAnet technology; Cyclades, a French packet-switching network pioneered by Louis Pouzin</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="a">[Think 2012</a>]<a href="#bookmark848" class="s124">; Time-sharing networks such as Tymnet and the GE Information Services network, among others, in the late 1960s and early 1970s </a><a href="#bookmark848" class="a">[Schwartz </a>1977]<a href="#bookmark848" class="s124">; IBM’s SNA (1969–1974), which paralleled the ARPAnet work </a><a href="#bookmark848" class="a">[Schwartz </a>1977]<span class="p">.</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark106">The number of networks was growing. With perfect hindsight we can see that the time was ripe for developing an encompassing architecture for connecting networks together. Pioneering work on interconnecting networks (under the sponsorship of the Defense Advanced Research Projects Agency</a></p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark107">(DARPA)), in essence creating a </a><i>network of networks, </i><a href="#bookmark848" class="s124">was done by Vinton Cerf and Robert Kahn </a><a href="#bookmark848" class="a">[Cerf </a><span class="s20">1974]</span>; the term <i>internetting </i>was coined to describe this work.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">These architectural principles were embodied in TCP. The early versions of TCP, however, were quite different from today’s TCP. The early versions of TCP combined a reliable in-sequence delivery of data via end-system retransmission (still part of today’s TCP) with forwarding functions (which today are performed by IP). Early experimentation with TCP, combined with the recognition of the importance of an unreliable, non-flow-controlled, end-to-end transport service for applications such as packetized voice, led to the separation of IP out of TCP and the development of the UDP protocol. The three key Internet protocols that we see today—TCP, UDP, and IP—were conceptually in place by the end of the 1970s.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In addition to the DARPA Internet-related research, many other important networking activities were underway. In Hawaii, Norman Abramson was developing ALOHAnet, a packet-based radio network that allowed multiple remote sites on the Hawaiian Islands to communicate with each other. The ALOHA</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">protocol </a><a href="#bookmark848" class="a">[Abramson 1970]</a> <span class="p">was the first multiple-access protocol, allowing geographically distributed users to share a single broadcast communication medium (a radio frequency). Metcalfe and Boggs</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">built on Abramson’s multiple-access protocol work when they developed the Ethernet protocol </a><a href="#bookmark848" class="a">[Metcalfe 1976]</a> <a href="#bookmark848" class="s124">for wire-based shared broadcast networks. Interestingly, Metcalfe and Boggs’ Ethernet protocol was motivated by the need to connect multiple PCs, printers, and shared disks </a><a href="#bookmark848" class="a">[Perkins </a>1994]<span class="p">. Twenty-</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">five years ago, well before the PC revolution and the explosion of networks, Metcalfe and Boggs were</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">laying the foundation for today’s PC LANs.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">A Proliferation of Networks: 1980–1990</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">By the end of the 1970s, approximately two hundred hosts were connected to the ARPAnet. By the end of the 1980s the number of hosts connected to the public Internet, a confederation of networks looking much like today’s Internet, would reach a hundred thousand. The 1980s would be a time of tremendous growth.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Much of that growth resulted from several distinct efforts to create computer networks linking universities together. BITNET provided e-mail and file transfers among several universities in the Northeast. CSNET (computer science network) was formed to link university researchers who did not have access to ARPAnet. In 1986, NSFNET was created to provide access to NSF-sponsored supercomputing centers. Starting with an initial backbone speed of 56 kbps, NSFNET’s backbone would be running at 1.5 Mbps by the end of the decade and would serve as a primary backbone linking regional networks.</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark108">In the ARPAnet community, many of the final pieces of today’s Internet architecture were falling into place. January 1, 1983 saw the official deployment of TCP/IP as the new standard host protocol for ARPAnet (replacing the NCP protocol). The transition </a><a href="#bookmark848" class="a">[RFC 801]</a> <span class="p">from NCP to TCP/IP was a flag day</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">event—all hosts were required to transfer over to TCP/IP as of that day. In the late 1980s, important</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark109">extensions were made to TCP to implement host-based congestion control </a><a href="#bookmark848" class="a">[Jacobson 1988</a>]<span class="p">. The DNS, used to map between a human-readable Internet name (for example, gaia.cs.umass.edu) and its 32-bit</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">IP address, was also developed </a><a href="#bookmark848" class="a">[RFC </a>1034]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Paralleling this development of the ARPAnet (which was for the most part a US effort), in the early 1980s the French launched the Minitel project, an ambitious plan to bring data networking into everyone’s home. Sponsored by the French government, the Minitel system consisted of a public packet-switched network (based on the X.25 protocol suite), Minitel servers, and inexpensive terminals with built-in low-speed modems. The Minitel became a huge success in 1984 when the French government gave away a free Minitel terminal to each French household that wanted one. Minitel sites included free sites—such as a telephone directory site—as well as private sites, which collected a usage-based fee from each user. At its peak in the mid 1990s, it offered more than 20,000 services, ranging from home banking to specialized research databases. The Minitel was in a large proportion of French homes 10 years before most Americans had ever heard of the Internet.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The Internet Explosion: The 1990s</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The 1990s were ushered in with a number of events that symbolized the continued evolution and the soon-to-arrive commercialization of the Internet. ARPAnet, the progenitor of the Internet, ceased to exist. In 1991, NSFNET lifted its restrictions on the use of NSFNET for commercial purposes. NSFNET itself would be decommissioned in 1995, with Internet backbone traffic being carried by commercial Internet Service Providers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The main event of the 1990s was to be the emergence of the World Wide Web application, which brought the Internet into the homes and businesses of millions of people worldwide. The Web served as a platform for enabling and deploying hundreds of new applications that we take for granted today, including search (e.g., Google and Bing) Internet commerce (e.g., Amazon and eBay) and social networks (e.g., Facebook).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">The Web was invented at CERN by Tim Berners-Lee between 1989 and 1991 </a><a href="#bookmark848" class="a">[Berners-Lee </a>1989]<a href="#bookmark848" class="s124">, based on ideas originating in earlier work on hypertext from the 1940s by Vannevar Bush </a><a href="#bookmark848" class="a">[Bush </a>1945] <a href="#bookmark848" class="s124">and since the 1960s by Ted Nelson </a><a href="#bookmark848" class="a">[Xanadu 2012</a>]<span class="p">. Berners-Lee and his associates developed initial</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">versions of HTML, HTTP, a Web server, and a browser—the four key components of the Web. Around</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">the end of 1993 there were about two hundred Web servers in operation, this collection of servers being</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark110">just a harbinger of what was about to come. At about this time several researchers were developing Web browsers with GUI interfaces, including Marc Andreessen, who along with Jim Clark, formed Mosaic Communications, which later became Netscape Communications Corporation </a><a href="#bookmark848" class="a">[Cusumano</a></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">1998<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Quittner 1998</a>]<span class="p">. By 1995, university students were using Netscape browsers to surf the Web on a</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark111">daily basis. At about this time companies—big and small—began to operate Web servers and transact commerce over the Web. In 1996, Microsoft started to make browsers, which started the browser war between Netscape and Microsoft, which Microsoft won a few years later </a><a href="#bookmark848" class="a">[Cusumano 1998</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The second half of the 1990s was a period of tremendous growth and innovation for the Internet, with major corporations and thousands of startups creating Internet products and services. By the end of the millennium the Internet was supporting hundreds of popular applications, including four killer applications:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_065.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_066.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_067.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">E-mail, including attachments and Web-accessible e-mail The Web, including Web browsing and Internet commerce Instant messaging, with contact lists</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_068.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">Peer-to-peer file sharing of MP3s, pioneered by Napster</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Interestingly, the first two killer applications came from the research community, whereas the last two were created by a few young entrepreneurs.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The period from 1995 to 2001 was a roller-coaster ride for the Internet in the financial markets. Before they were even profitable, hundreds of Internet startups made initial public offerings and started to be traded in a stock market. Many companies were valued in the billions of dollars without having any significant revenue streams. The Internet stocks collapsed in 2000–2001, and many startups shut down. Nevertheless, a number of companies emerged as big winners in the Internet space, including Microsoft, Cisco, Yahoo, e-Bay, Google, and Amazon.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The New Millennium</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Innovation in computer networking continues at a rapid pace. Advances are being made on all fronts, including deployments of faster routers and higher transmission speeds in both access networks and in network backbones. But the following developments merit special attention:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_069.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Since the beginning of the millennium, we have been seeing aggressive deployment of broadband Internet access to homes—not only cable modems and DSL but also fiber to the home, as discussed</p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark37" class="s124">in </a><a href="#bookmark37" class="a">Section 1.</a>2<span class="p">. This high-speed Internet access has set the stage for a wealth of video applications, including the distribution of user-generated video (for example, YouTube), on-demand streaming of movies and television shows (e.g., Netflix), and multi-person video conference (e.g., Skype,</span></p><p style="padding-top: 3pt;padding-left: 19pt;text-indent: 0pt;text-align: left;"><a name="bookmark112">Facetime, and Google Hangouts).</a><a name="bookmark113">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_070.png"/></span></p><p style="padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;">The increasing ubiquity of high-speed (54 Mbps and higher) public WiFi networks and medium- speed (tens of Mbps) Internet access via 4G cellular telephony networks is not only making it possible to remain constantly connected while on the move, but also enabling new location-specific</p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark114">applications such as Yelp, Tinder, Yik Yak, and Waz. The number of wireless devices connecting to the Internet surpassed the number of wired devices in 2011. This high-speed wireless access has set the stage for the rapid emergence of hand-held computers (iPhones, Androids, iPads, and so on), which enjoy constant and untethered access to the Internet.</a></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_071.png"/></span></p><p style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;">Online social networks—such as Facebook, Instagram, Twitter, and WeChat (hugely popular in China)—have created massive people networks on top of the Internet. Many of these social networks are extensively used for messaging as well as photo sharing. Many Internet users today</p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">“live” primarily within one or more social networks. Through their APIs, the online social networks create platforms for new networked applications and distributed games.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_072.png"/></span></p><p class="s20" style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark60" class="s124">As discussed in </a><a href="#bookmark60" class="a">Section 1.3.</a>3<span class="p">, online service providers, such as Google and Microsoft, have deployed their own extensive private networks, which not only connect together their globally distributed data centers, but are used to bypass the Internet as much as possible by peering directly</span></p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">with lower-tier ISPs. As a result, Google provides search results and e-mail access almost instantaneously, as if their data centers were running within one’s own computer.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_073.png"/></span></p><p style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;">Many Internet commerce companies are now running their applications in the “cloud”—such as in Amazon’s EC2, in Google’s Application Engine, or in Microsoft’s Azure. Many companies and universities have also migrated their Internet applications (e.g., e-mail and Web hosting) to the</p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">cloud. Cloud companies not only provide applications scalable computing and storage environments, but also provide the applications implicit access to their high-performance private networks.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l82"><ol id="l83"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark115">Summary</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this chapter we’ve covered a tremendous amount of material! We’ve looked at the various pieces of hardware and software that make up the Internet in particular and computer networks in general. We started at the edge of the network, looking at end systems and applications, and at the transport service provided to the applications running on the end systems. We also looked at the link-layer technologies and physical media typically found in the access network. We then dove deeper inside the network, into the network core, identifying packet switching and circuit switching as the two basic approaches for transporting data through a telecommunication network, and we examined the strengths and weaknesses of each approach. We also examined the structure of the global Internet, learning that the Internet is a network of networks. We saw that the Internet’s hierarchical structure, consisting of higher- and lower-tier ISPs, has allowed it to scale to include thousands of networks.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the second part of this introductory chapter, we examined several topics central to the field of computer networking. We first examined the causes of delay, throughput and packet loss in a packet- switched network. We developed simple quantitative models for transmission, propagation, and queuing delays as well as for throughput; we’ll make extensive use of these delay models in the homework problems throughout this book. Next we examined protocol layering and service models, key architectural principles in networking that we will also refer back to throughout this book. We also surveyed some of the more prevalent security attacks in the Internet day. We finished our introduction to networking with a brief history of computer networking. The first chapter in itself constitutes a mini- course in computer networking.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">So, we have indeed covered a tremendous amount of ground in this first chapter! If you’re a bit overwhelmed, don’t worry. In the following chapters we’ll revisit all of these ideas, covering them in much more detail (that’s a promise, not a threat!). At this point, we hope you leave this chapter with a still-developing intuition for the pieces that make up a network, a still-developing command of the vocabulary of networking (don’t be shy about referring back to this chapter), and an ever-growing desire to learn more about networking. That’s the task ahead of us for the rest of this book.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Road-Mapping This Book</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before starting any trip, you should always glance at a road map in order to become familiar with the major roads and junctures that lie ahead. For the trip we are about to embark on, the ultimate destination is a deep understanding of the how, what, and why of computer networks. Our road map is</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark116">the sequence of chapters of this book:</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><ol id="l84"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Computer Networks and the Internet</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Application Layer</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Transport Layer</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Network Layer: Data Plane</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Network Layer: Control Plane</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The Link Layer and LANs</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Wireless and Mobile Networks</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Security in Computer Networks</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Multimedia Networking</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark138" class="a">Chapters 2</a> <a href="#bookmark513" class="s124">through </a><a href="#bookmark513" class="a">6</a> <span class="p">are the five core chapters of this book. You should notice that these chapters are organized around the top four layers of the five-layer Internet protocol. Further note that our journey will begin at the top of the Internet protocol stack, namely, the application layer, and will work its way</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">downward. The rationale behind this top-down journey is that once we understand the applications, we can understand the network services needed to support these applications. We can then, in turn, examine the various ways in which such services might be implemented by a network architecture. Covering applications early thus provides motivation for the remainder of the text.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark591" class="s124" name="bookmark117">The second half of the book—</a><a href="#bookmark591" class="a">Chapters 7</a> <a href="#bookmark775" class="s124">through </a>9<a href="#bookmark591" class="s124">—zooms in on three enormously important (and somewhat independent) topics in modern computer networking. In </a><a href="#bookmark591" class="a">Chapter </a>7<span class="p">, we examine wireless and mobile networks, including wireless LANs (including WiFi and Bluetooth), Cellular telephony networks</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark671" class="s124">(including GSM, 3G, and 4G), and mobility (in both IP and GSM networks). </a><a href="#bookmark671" class="a">Chapter </a>8<span class="p">, which addresses security in computer networks, first looks at the underpinnings of encryption and network security, and then we examine how the basic theory is being applied in a broad range of Internet contexts. The last</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">chapter, which addresses multimedia networking, examines audio and video applications such as Internet phone, video conferencing, and streaming of stored media. We also look at how a packet- switched network can be designed to provide consistent quality of service to audio and video applications.</p><p class="s18" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark118">Homework Problems and Questions</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Chapter 1 Review Questions</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 1.1</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R1. What is the difference between a host and an end system? List several different types of end systems. Is a Web server an end system?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R2. The word <i>protocol </i>is often used to describe diplomatic relations. How does Wikipedia describe diplomatic protocol?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R3. Why are standards important for protocols?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 1.2</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R4. List six access technologies. Classify each one as home access, enterprise access, or wide- area wireless access.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R5. Is HFC transmission rate dedicated or shared among users? Are collisions possible in a downstream HFC channel? Why or why not?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R6. List the available residential access technologies in your city. For each type of access, provide the advertised downstream rate, upstream rate, and monthly price.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R7. What is the transmission rate of Ethernet LANs?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">R8. What are some of the physical media that Ethernet can run over?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R9. Dial-up modems, HFC, DSL and FTTH are all used for residential access. For each of these access technologies, provide a range of transmission rates and comment on whether the transmission rate is shared or dedicated.</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R10. Describe the most popular wireless Internet access technologies today. Compare and contrast them.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 1.3</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R11. Suppose there is exactly one packet switch between a sending host and a receiving host. The transmission rates between the sending host and the switch and between the switch and the</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 156%;text-align: left;">receiving host are <i>R</i><span class="s22">1  </span>and <i>R</i><span class="s22">2</span>, respectively. Assuming that the switch uses store-and-forward packet switching, what is the total end-to-end delay to send a packet of length <i>L</i>? (Ignore</p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 11pt;text-align: left;">queuing, propagation delay, and processing delay.)</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R12. What advantage does a circuit-switched network have over a packet-switched network? What advantages does TDM have over FDM in a circuit-switched network?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R13. Suppose users share a 2 Mbps link. Also suppose each user transmits continuously at 1 Mbps when transmitting, but each user transmits only 20 percent of the time. (See the</p><p class="s20" style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;"><a href="#bookmark59" class="s124">discussion of statistical multiplexing in </a><a href="#bookmark59" class="a">Section 1.3</a> <span class="p">.)</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l85"><li style="padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">When circuit switching is used, how many users can be supported?</p></li><li style="padding-top: 4pt;padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">For the remainder of this problem, suppose packet switching is used. Why will there be essentially no queuing delay before the link if two or fewer users transmit at the same</p><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;text-align: left;">time? Why will there be a queuing delay if three users transmit at the same time?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Find the probability that a given user is transmitting.</p></li><li style="padding-top: 4pt;padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose now there are three users. Find the probability that at any given time, all three users are transmitting simultaneously. Find the fraction of time during which the queue</p></li></ol></li></ol></li></ol></ol><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;text-align: left;">grows.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R14. Why will two ISPs at the same level of the hierarchy often peer with each other? How does an IXP earn money?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R15. Some content providers have created their own networks. Describe Google’s network. What motivates content providers to create these networks?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 1.4</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R16. Consider sending a packet from a source host to a destination host over a fixed route. List the delay components in the end-to-end delay. Which of these delays are constant and which are variable?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R17. Visit the Transmission Versus Propagation Delay applet at the companion Web site. Among the rates, propagation delay, and packet sizes available, find a combination for which the sender finishes transmitting before the first bit of the packet reaches the receiver. Find another</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">combination for which the first bit of the packet reaches the receiver before the sender finishes transmitting.</p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;line-height: 118%;text-align: left;">R18. How long does it take a packet of length 1,000 bytes to propagate over a link of distance 2,500 km, propagation speed 2.5<span class="s29">⋅</span>108 m/s, and transmission rate 2 Mbps? More generally, how</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a name="bookmark119">long does it take a packet of length </a><i>L </i>to propagate over a link of distance <i>d</i>, propagation speed <i>s</i>, and transmission rate <i>R </i>bps? Does this delay depend on packet length? Does this delay depend on transmission rate?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R19. Suppose Host A wants to send a large file to Host B. The path from Host A to Host B has three links, of rates R1=500 kbps, R2=2 Mbps, and R3=1 Mbps.</p><ol id="l86"><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Assuming no other traffic in the network, what is the throughput for the file transfer?</p></li><li style="padding-top: 4pt;padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose the file is 4 million bytes. Dividing the file size by the throughput, roughly how long will it take to transfer the file to Host B?</p></li><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Repeat (a) and (b), but now with <i>R</i><span class="s22">2 </span>reduced to 100 kbps.</p></li></ol><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R20. Suppose end system A wants to send a large file to end system B. At a very high level, describe how end system A creates packets from the file. When one of these packets arrives to a router, what information in the packet does the router use to determine the link onto which the</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">packet is forwarded? Why is packet switching in the Internet analogous to driving from one city to another and asking directions along the way?</p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R21. Visit the Queuing and Loss applet at the companion Web site. What is the maximum emission rate and the minimum transmission rate? With those rates, what is the traffic intensity? Run the applet with these rates and determine how long it takes for packet loss to occur. Then</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">repeat the experiment a second time and determine again how long it takes for packet loss to occur. Are the values different? Why or why not?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 1.5</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R22. List five tasks that a layer can perform. Is it possible that one (or more) of these tasks could be performed by two (or more) layers?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R23. What are the five layers in the Internet protocol stack? What are the principal responsibilities of each of these layers?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R24. What is an application-layer message? A transport-layer segment? A network-layer datagram? A link-layer frame?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R25. Which layers in the Internet protocol stack does a router process? Which layers does a link-layer switch process? Which layers does a host process?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 1.6</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R26. What is the difference between a virus and a worm?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">R27. Describe how a botnet can be created and how it can be used for a DDoS attack. R28. Suppose Alice and Bob are sending packets to each other over a computer network.</p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Suppose Trudy positions herself in the network so that she can capture all the packets sent by</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">Alice and send whatever she wants to Bob; she can also capture all the packets sent by Bob and send whatever she wants to Alice. List some of the malicious things Trudy can do from this position.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark120">Problems</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">P1. Design and describe an application-level protocol to be used between an automatic teller machine and a bank’s centralized computer. Your protocol should allow a user’s card and password to be verified, the account balance (which is maintained at the centralized computer)</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">to be queried, and an account withdrawal to be made (that is, money disbursed to the user).</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Your protocol entities should be able to handle the all-too-common case in which there is not enough money in the account to cover the withdrawal. Specify your protocol by listing the messages exchanged and the action taken by the automatic teller machine or the bank’s centralized computer on transmission and receipt of messages. Sketch the operation of your protocol for the case of a simple withdrawal with no errors, using a diagram similar to that in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark13" class="a">Figure 1.2</a> <span class="p">. Explicitly state the assumptions made by your protocol about the underlying end-to- end transport service.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark46" class="s124">P2. </a><a href="#bookmark46" class="a">Equation 1.1</a><span class="s20"> </span>gives a formula for the end-to-end delay of sending one packet of length <i>L </i>over <i>N </i>links of transmission rate <i>R</i>. Generalize this formula for sending <i>P </i>such packets back-to- back over the <i>N </i>links.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P3. Consider an application that transmits data at a steady rate (for example, the sender generates an <i>N</i>-bit unit of data every <i>k </i>time units, where <i>k </i>is small and fixed). Also, when such an application starts, it will continue running for a relatively long period of time. Answer the</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">following questions, briefly justifying your answer:</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l87"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Would a packet-switched network or a circuit-switched network be more appropriate for this application? Why?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose that a packet-switched network is used and the only traffic in this network comes from such applications as described above. Furthermore, assume that the sum of</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">the application data rates is less than the capacities of each and every link. Is some form of congestion control needed? Why?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark53" class="s124">P4. Consider the circuit-switched network in </a><a href="#bookmark53" class="a">Figure 1.13</a> <span class="p">. Recall that there are 4 circuits on each link. Label the four switches A, B, C, and D, going in the clockwise direction.</span></p><ol id="l88"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">What is the maximum number of simultaneous connections that can be in progress at any one time in this network?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose that all connections are between switches A and C. What is the maximum number of simultaneous connections that can be in progress?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose we want to make four connections between switches A and C, and another four connections between switches B and D. Can we route these calls through the four links</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">to accommodate all eight connections?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark79" class="s124" name="bookmark121">P5. Review the car-caravan analogy in </a><a href="#bookmark79" class="a">Section 1.4</a> <span class="p">. Assume a propagation speed of 100 km/hour.</span></p><ol id="l89"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose the caravan travels 150 km, beginning in front of one tollbooth, passing through a second tollbooth, and finishing just after a third tollbooth. What is the end-to-end delay?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Repeat (a), now assuming that there are eight cars in the caravan instead of ten.</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P6. This elementary problem begins to explore propagation delay and transmission delay, two central concepts in data networking. Consider two hosts, A and B, connected by a single link of</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">rate <i>R </i>bps. Suppose that the two hosts are separated by <i>m </i>meters, and suppose the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">propagation speed along the link is <i>s </i>meters/sec. Host A is to send a packet of size <i>L </i>bits to Host B.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Exploring propagation delay and transmission delay</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="730" height="199" alt="image" src="计算机网络自顶向下7th-en/Image_074.png"/></span></p><ol id="l90"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Express the propagation delay, <i>d</i><span class="s22">prop</span>, in terms of <i>m </i>and <i>s</i>.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Determine the transmission time of the packet, <i>d</i><span class="s22">trans</span>, in terms of <i>L </i>and <i>R</i>.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Ignoring processing and queuing delays, obtain an expression for the end-to-end delay.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 133%;text-align: left;"><p style="display: inline;">Suppose Host A begins to transmit the packet at time <span class="s27">t=</span>0. At time <span class="s27">t=</span> <i>d</i><span class="s22">trans</span>, where is the last bit of the packet?</p></li><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Suppose <i>d</i><span class="s22">prop </span>is greater than <i>d</i><span class="s22">trans</span>. At time <span class="s27">t=</span>dtrans, where is the first bit of the packet?</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -15pt;text-align: left;"><p style="display: inline;">Suppose <i>d</i><span class="s22">prop </span>is less than <i>d</i><span class="s22">trans</span>. At time <span class="s27">t=</span>dtrans, where is the first bit of the packet?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Suppose <span class="s27">s=</span>2.5<span class="s29">⋅</span>108, <span class="s27">L</span>=120 bits, and <span class="s27">R</span>=56 kbps. Find the distance <i>m </i>so that <i>d</i><span class="s22">prop </span>equals</p></li></ol><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 48pt;text-indent: 0pt;text-align: left;">d<span class="s22">trans</span><span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P7. In this problem, we consider sending real-time voice from Host A to Host B over a packet- switched network (VoIP). Host A converts analog voice to a digital 64 kbps bit stream on the fly. Host A then groups the bits into 56-byte packets. There is one link between Hosts A and B; its</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">transmission rate is 2 Mbps and its propagation delay is 10 msec. As soon as Host A gathers a packet, it sends it to Host B. As soon as Host B receives an entire packet, it converts the packet’s bits to an analog signal. How much time elapses from the time a bit is created (from the original analog signal at Host A) until the bit is decoded (as part of the analog signal at Host B)?</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P8. Suppose users share a 3 Mbps link. Also suppose each user requires 150 kbps when transmitting, but each user transmits only 10 percent of the time. (See the discussion of packet</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark59" class="s124">switching versus circuit switching in </a><a href="#bookmark59" class="a">Section 1.3</a> <span class="p">.)</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l91"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">When circuit switching is used, how many users can be supported?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">For the remainder of this problem, suppose packet switching is used. Find the probability that a given user is transmitting.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 139%;text-align: left;"><p style="display: inline;"><a name="bookmark122">Suppose there are 120 users. Find the probability that at any given time, exactly </a><i>n </i>users are transmitting simultaneously. (<i>Hint</i>: Use the binomial distribution.)</p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 16pt;text-align: left;"><p style="display: inline;">Find the probability that there are 21 or more users transmitting simultaneously.</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark59" class="s124">P9. Consider the discussion in </a><a href="#bookmark59" class="a">Section 1.3</a> <span class="p">of packet switching versus circuit switching in which an example is provided with a 1 Mbps link. Users are generating data at a rate of 100 kbps when busy, but are busy generating data only with probability p=0.1. Suppose that the 1 Mbps link is</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">replaced by a 1 Gbps link.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l92"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">What is <i>N, </i>the maximum number of users that can be supported simultaneously under circuit switching?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 139%;text-align: left;"><p style="display: inline;">Now consider packet switching and a user population of <i>M </i>users. Give a formula (in terms of <i>p</i>, <i>M</i>, <i>N</i>) for the probability that more than <i>N </i>users are sending data.</p></li></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 143%;text-align: left;">P10. Consider a packet of length <i>L </i>that begins at end system A and travels over three links to a destination end system. These three links are connected by two packet switches. Let <i>d</i><span class="s31">i</span>, <i>s</i><span class="s31">i</span>, and <i>R</i><span class="s31">i </span>denote the length, propagation speed, and the transmission rate of link <i>i, </i>for <span class="s27">i</span>=1,2,3. The packet switch delays each packet by <i>d</i><span class="s22">proc</span>. Assuming no queuing delays, in terms of <i>d</i><span class="s31">i</span>, <i>s</i><span class="s31">i</span>, <i>R</i><span class="s31">i</span>, <span class="s27">(</span>i=1,2,3), and <i>L, </i>what is the total end-to-end delay for the packet? Suppose now the packet is</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">1,500 bytes, the propagation speed on all three links is 2.5<span class="s29">⋅</span>108m/s, the transmission rates of all</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">three links are 2 Mbps, the packet switch processing delay is 3 msec, the length of the first link is 5,000 km, the length of the second link is 4,000 km, and the length of the last link is 1,000 km. For these values, what is the end-to-end delay?</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">P11. In the above problem, suppose <span class="s27">R</span>1=R2=R3=R and <span class="s27">d</span>proc=0. Further suppose the packet</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">switch does not store-and-forward packets but instead immediately transmits each bit it receives before waiting for the entire packet to arrive. What is the end-to-end delay?</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P12. A packet switch receives a packet and determines the outbound link to which the packet should be forwarded. When the packet arrives, one other packet is halfway done being transmitted on this outbound link and four other packets are waiting to be transmitted. Packets</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">are transmitted in order of arrival. Suppose all packets are 1,500 bytes and the link rate is 2 Mbps. What is the queuing delay for the packet? More generally, what is the queuing delay when all packets have length <i>L</i>, the transmission rate is <i>R</i>, <i>x </i>bits of the currently-being-transmitted</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">packet have been transmitted, and <i>n </i>packets are already in the queue?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P13.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l93"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 142%;text-align: left;"><p style="display: inline;">Suppose <i>N </i>packets arrive simultaneously to a link at which no packets are currently being transmitted or queued. Each packet is of length <i>L </i>and the link has transmission rate <i>R</i>. What is the average queuing delay for the <i>N </i>packets?</p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 15pt;text-align: left;"><p style="display: inline;">Now suppose that <i>N </i>such packets arrive to the link every <i>LN/R </i>seconds. What is the</p></li></ol><p style="padding-top: 4pt;text-indent: 0pt;text-align: center;">average queuing delay of a packet?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 126%;text-align: left;">P14. Consider the queuing delay in a router buffer. Let <i>I </i>denote traffic intensity; that is, <span class="s27">I=</span>La/R. Suppose that the queuing delay takes the form IL/R(1−I) for I&lt;1.</p><ol id="l94"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Provide a formula for the total delay, that is, the queuing delay plus the transmission delay.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Plot the total delay as a function of <i>L /R</i>.</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P15. Let <i>a </i>denote the rate of packets arriving at a link in packets/sec, and let <i>µ </i>denote the link’s transmission rate in packets/sec. Based on the formula for the total delay (i.e., the queuing delay</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">plus the transmission delay) derived in the previous problem, derive a formula for the total delay in terms of <i>a </i>and <i>µ</i>.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">P16. Consider a router buffer preceding an outbound link. In this problem, you will use Little’s</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">formula, a famous formula from queuing theory. Let <i>N </i>denote the average number of packets in the buffer plus the packet being transmitted. Let <i>a </i>denote the rate of packets arriving at the link. Let <i>d </i>denote the average total delay (i.e., the queuing delay plus the transmission delay)</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">experienced by a packet. Little’s formula is N=a<span class="s29">⋅</span>d. Suppose that on average, the buffer contains</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">10 packets, and the average packet queuing delay is 10 msec. The link’s transmission rate is 100 packets/sec. Using Little’s formula, what is the average packet arrival rate, assuming there is no packet loss?</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">P17.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l95"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p class="s20" style="display: inline;"><a href="#bookmark72" class="s124">Generalize </a><a href="#bookmark72" class="a">Equation 1.2</a> <a href="#bookmark75" class="s124">in </a><a href="#bookmark75" class="a">Section 1.4.3</a> <span class="p">for heterogeneous processing rates, transmission rates, and propagation delays.</span></p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 134%;text-align: left;"><p style="display: inline;">Repeat (a), but now also suppose that there is an average queuing delay of <i>d</i><span class="s22">queue </span>at each node.</p></li></ol><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P18. Perform a Traceroute between source and destination on the same continent at three different hours of the day.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Using Traceroute to discover network paths and measure network delay</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="730" height="200" alt="image" src="计算机网络自顶向下7th-en/Image_075.png"/></span></p><ol id="l96"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Find the average and standard deviation of the round-trip delays at each of the three hours.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Find the number of routers in the path at each of the three hours. Did the paths change during any of the hours?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Try to identify the number of ISP networks that the Traceroute packets pass through from source to destination. Routers with similar names and/or similar IP addresses should be</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">considered as part of the same ISP. In your experiments, do the largest delays occur at the peering interfaces between adjacent ISPs?</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Repeat the above for a source and destination on different continents. Compare the intra-continent and inter-continent results.</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark123">P19.</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l97"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p class="s20" style="display: inline;"><a href="http://www.traceroute.org/" class="s124" target="_blank">Visit the site </a><a href="http://www.traceroute.org/" class="a" target="_blank">www.traceroute.org</a> <span class="p">and perform traceroutes from two different cities in France to the same destination host in the United States. How many links are the same</span></p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">in the two traceroutes? Is the transatlantic link the same?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Repeat (a) but this time choose one city in France and another city in Germany.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Pick a city in the United States, and perform traceroutes to two hosts, each in a different city in China. How many links are common in the two traceroutes? Do the two</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">traceroutes diverge before reaching China?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 143%;text-align: left;"><a href="#bookmark81" class="s124">P20. Consider the throughput example corresponding to </a><a href="#bookmark81" class="a">Figure 1.20(b)</a><span class="s20"> </span>. Now suppose that there are <i>M </i>client-server pairs rather than 10. Denote <i>R</i><span class="s31">s</span>, <i>R</i><span class="s31">c</span>, and <i>R </i>for the rates of the server links, client links, and network link. Assume all other links have abundant capacity and that there</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">is no other traffic in the network besides the traffic generated by the <i>M </i>client-server pairs. Derive a general expression for throughput in terms of <i>R</i><span class="s31">s</span>, <i>R</i><span class="s31">c</span>, <i>R</i>, and <i>M</i>.</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 127%;text-align: left;"><a href="#bookmark77" class="s124">P21. Consider </a><a href="#bookmark77" class="a">Figure 1.19(b)</a><span class="s20"> </span>. Now suppose that there are <i>M </i>paths between the server and the client. No two paths share any link. Path <span class="s27">k(k</span>=1,…,M) consists of <i>N </i>links with transmission rates R1k,R2k,…,RNk. If the server can only use one path to send data to the client, what is the</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">maximum throughput that the server can achieve? If the server can use all <i>M </i>paths to send data, what is the maximum throughput that the server can achieve?</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark77" class="s124">P22. Consider </a><a href="#bookmark77" class="a">Figure 1.19(b)</a><span class="s20"> </span>. Suppose that each link between the server and the client has a packet loss probability <i>p, </i>and the packet loss probabilities for these links are independent. What is the probability that a packet (sent by the server) is successfully received by the receiver? If a</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">packet is lost in the path from the server to the client, then the server will re-transmit the packet. On average, how many times will the server re-transmit the packet in order for the client to successfully receive the packet?</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 143%;text-align: left;"><a href="#bookmark77" class="s124">P23. Consider </a><a href="#bookmark77" class="a">Figure 1.19(a)</a><span class="s20"> </span>. Assume that we know the bottleneck link along the path from the server to the client is the first link with rate <i>R</i><span class="s31">s </span>bits/sec. Suppose we send a pair of packets back to back from the server to the client, and there is no other traffic on this path. Assume each</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">packet of size <i>L </i>bits, and both links have the same propagation delay <i>d</i><span class="s22">prop</span>.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l98"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">What is the packet inter-arrival time at the destination? That is, how much time elapses from when the last bit of the first packet arrives until the last bit of the second packet</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">arrives?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 124%;text-align: left;"><p style="display: inline;">Now assume that the second link is the bottleneck link (i.e., <span class="s27">R</span>c&lt;Rs). Is it possible that the second packet queues at the input queue of the second link? Explain. Now suppose</p></li></ol><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">that the server sends the second packet <i>T </i>seconds after sending the first packet. How large must <i>T </i>be to ensure no queuing before the second link? Explain.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P24. Suppose you would like to urgently deliver 40 terabytes data from Boston to Los Angeles. You have available a 100 Mbps dedicated link for data transfer. Would you prefer to transmit the data via this link or instead use FedEx over-night delivery? Explain.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 118%;text-align: left;">P25. Suppose two hosts, A and B, are separated by 20,000 kilometers and are connected by a direct link of R=2 Mbps. Suppose the propagation speed over the link is 2.5<span class="s29">⋅</span>108 meters/sec.</p><ol id="l99"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Calculate the bandwidth-delay product, <span class="s27">R</span><span class="s29">⋅</span>dprop.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Consider sending a file of 800,000 bits from Host A to Host B. Suppose the file is sent continuously as one large message. What is the maximum number of bits that will be in</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">the link at any given time?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Provide an interpretation of the bandwidth-delay product.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the width (in meters) of a bit in the link? Is it longer than a football field?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 139%;text-align: left;"><p style="display: inline;">Derive a general expression for the width of a bit in terms of the propagation speed <i>s, </i>the transmission rate <i>R, </i>and the length of the link <i>m</i>.</p></li></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P26. Referring to problem P25, suppose we can modify <i>R</i>. For what value of <i>R </i>is the width of a bit as long as the length of the link?</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">P27. Consider problem P25 but now with a link of <span class="s27">R</span>=1 Gbps.</p><ol id="l100"><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Calculate the bandwidth-delay product, <span class="s27">R</span><span class="s29">⋅</span>dprop.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Consider sending a file of 800,000 bits from Host A to Host B. Suppose the file is sent continuously as one big message. What is the maximum number of bits that will be in the</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">link at any given time?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the width (in meters) of a bit in the link?</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P28. Refer again to problem P25.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l101"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">How long does it take to send the file, assuming it is sent continuously?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose now the file is broken up into 20 packets with each packet containing 40,000 bits. Suppose that each packet is acknowledged by the receiver and the transmission</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">time of an acknowledgment packet is negligible. Finally, assume that the sender cannot send a packet until the preceding one is acknowledged. How long does it take to send the file?</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Compare the results from (a) and (b).</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 132%;text-align: justify;">P29. Suppose there is a 10 Mbps microwave link between a geostationary satellite and its base station on Earth. Every minute the satellite takes a digital photo and sends it to the base station. Assume a propagation speed of 2.4<span class="s29">⋅</span>108 meters/sec.</p><ol id="l102"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the propagation delay of the link?</p></li><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the bandwidth-delay product, <span class="s27">R</span><span class="s29">⋅</span>dprop?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Let <i>x </i>denote the size of the photo. What is the minimum value of <i>x </i>for the microwave link to be continuously transmitting?</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark94" class="s124" name="bookmark124">P30. Consider the airline travel analogy in our discussion of layering in </a><a href="#bookmark94" class="a">Section 1.5</a> <span class="p">, and the addition of headers to protocol data units as they flow down the protocol stack. Is there an equivalent notion of header information that is added to passengers and baggage as they move</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">down the airline protocol stack?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P31. In modern packet-switched networks, including the Internet, the source host segments long, application-layer messages (for example, an image or a music file) into smaller packets</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">and sends the packets into the network. The receiver then reassembles the packets back into</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">the original message. We refer to this process as <i>message segmentation</i><a href="#bookmark125" class="s124">. </a><a href="#bookmark125" class="a">Figure 1.27</a><span class="s20"> </span>illustrates the end-to-end transport of a message with and without message segmentation. Consider a message that is <span class="s27">8</span><span class="s29">⋅</span><a href="#bookmark125" class="s124">106 bits long that is to be sent from source to destination in </a><a href="#bookmark125" class="a">Figure 1.27</a><span class="s20"> </span>. Suppose each link in the figure is 2 Mbps. Ignore propagation, queuing, and processing delays.</p><ol id="l103"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Consider sending the message from source to destination <i>without </i>message segmentation. How long does it take to move the message from the source host to the</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">first packet switch? Keeping in mind that each switch uses store-and-forward packet switching, what is the total time to move the message from source host to destination host?</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Now suppose that the message is segmented into 800 packets, with each packet being 10,000 bits long. How long does it take to move the first packet from source host to the</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">first switch? When the first packet is being sent from the first switch to the second switch, the second packet is being sent from the source host to the first switch. At what time will the second packet be fully received at the first switch?</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">How long does it take to move the file from source host to destination host when message segmentation is used? Compare this result with your answer in part (a) and</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">comment.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;"><span><img width="505" height="86" alt="image" src="计算机网络自顶向下7th-en/Image_076.jpg"/></span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;"><span><img width="497" height="95" alt="image" src="计算机网络自顶向下7th-en/Image_077.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-left: 48pt;text-indent: 0pt;text-align: left;"><a name="bookmark125">Figure 1.27 End-to-end message transport: (a) without message segmentation;</a></h2><h2 style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">(b) with message segmentation</h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;"><a name="bookmark126">In addition to reducing delay, what are reasons to use message segmentation?</a></p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Discuss the drawbacks of message segmentation.</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P32. Experiment with the Message Segmentation applet at the book’s Web site. Do the delays in the applet correspond to the delays in the previous problem? How do link propagation delays affect the overall end-to-end delay for packet switching (with message segmentation) and for</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">message switching?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P33. Consider sending a large file of <i>F </i>bits from Host A to Host B. There are three links (and two switches) between A and B, and the links are uncongested (that is, no queuing delays). Host A</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 129%;text-align: left;"><a name="bookmark127">segments the file into segments of </a><i>S </i>bits each and adds 80 bits of header to each segment, forming packets of <span class="s27">L</span>=80 + <i>S </i>bits. Each link has a transmission rate of <i>R </i>bps. Find the value of <i>S </i>that minimizes the delay of moving the file from Host A to Host B. Disregard propagation delay.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="942" alt="image" src="计算机网络自顶向下7th-en/Image_078.png"/></span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P34. Skype offers a service that allows you to make a phone call from a PC to an ordinary phone. This means that the voice call must pass through both the Internet and through a telephone network. Discuss how this might be done.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Wireshark Lab</h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s32" style="padding-left: 31pt;text-indent: 0pt;line-height: 119%;text-align: left;">“Tell me and I forget. Show me and I remember. Involve me and I understand.”</p><p class="s33" style="padding-top: 4pt;padding-left: 34pt;text-indent: 0pt;text-align: left;">Chinese proverb</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">One’s understanding of network protocols can often be greatly deepened by seeing them in action and by playing around with them—observing the sequence of messages exchanged between two protocol entities, delving into the details of protocol operation, causing protocols to perform certain actions, and observing these actions and their consequences. This can be done in simulated scenarios or in a real network  environment such as the Internet. The Java applets at the textbook Web site take the first approach. In the Wireshark labs, we’ll take the latter approach. You’ll run network applications in various scenarios using a computer on your desk, at home, or in a lab. You’ll observe the network protocols in your computer, interacting and exchanging messages with protocol entities executing elsewhere in the Internet. Thus, you and your computer will be an integral part of these live labs. You’ll observe—and you’ll learn—by doing.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The basic tool for observing the messages exchanged between executing protocol entities is called a <span class="s20">packet sniffer</span>. As the name suggests, a packet sniffer passively copies (sniffs) messages being sent from and received by your computer; it also displays the contents of the various protocol fields of these captured messages. A screenshot of</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark130" class="s124" name="bookmark128">the Wireshark packet sniffer is shown in </a><a href="#bookmark130" class="a">Figure 1.2</a>8<span class="p">. Wireshark is a free packet sniffer that runs on Windows, Linux/Unix, and Mac computers.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_079.png"/></span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 156%;text-align: left;"><a name="bookmark129">Figure 1.28 A Wireshark screenshot (Wireshark screenshot reprinted by permission of the Wireshark Foundation.)</a><a name="bookmark130">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">Throughout the textbook, you will find Wireshark labs that allow you to explore a number of the protocols studied in the chapter. In this first Wireshark lab, you’ll obtain and install a copy of Wireshark, access a Web site, and capture and examine the protocol messages being exchanged between your Web browser and the Web server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="http://www.pearsonhighered.com/cs-" class="s124" target="_blank">You can find full details about this first Wireshark lab (including instructions about how to obtain and install Wireshark) at the Web site </a><a href="http://www.pearsonhighered.com/cs-" class="a" target="_blank">http://www.pearsonhighered.com/</a>cs- resources/<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark131">AN INTERVIEW WITH…</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Leonard Kleinrock</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Leonard Kleinrock is a professor of computer science at the University of California, Los Angeles. In 1969, his computer at UCLA became the first node of the Internet. His creation of packet-switching principles in 1961 became the technology behind the Internet. He received his</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">B.E.E. from the City College of New York (CCNY) and his masters and PhD in electrical engineering from MIT.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_080.png"/></span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><span><img width="168" height="221" alt="image" src="计算机网络自顶向下7th-en/Image_081.jpg"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s26" style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">What made you decide to specialize in networking/Internet technology?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">As a PhD student at MIT in 1959, I looked around and found that most of my classmates were doing research in the area of information theory and coding theory. At MIT, there was the great researcher, Claude Shannon, who had launched these fields and had solved most of the important problems already. The research problems that were left were hard and of lesser consequence. So I decided to launch out in a new area that no one else had yet conceived of. Remember that at MIT I was surrounded by lots of computers, and it was clear to me that soon these machines would need to communicate with each other. At the time, there was no effective way for them to do so, so I decided to develop the technology that would permit efficient and reliable data networks to be created.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What was your first job in the computer industry? What did it entail?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">I went to the evening session at CCNY from 1951 to 1957 for my bachelor’s degree in electrical engineering. During the day, I worked first as a technician and then as an engineer at a small, industrial electronics firm called Photobell. While there, I introduced digital technology to their product line. Essentially, we were using photoelectric devices to detect the presence of certain</p><p style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;">items (boxes, people, etc.) and the use of a circuit known then as a <i>bistable multivibrator </i>was just the kind of technology we needed to bring digital processing into this field of detection. These circuits happen to be the building blocks for computers, and have come to be known as</p><p class="s17" style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">flip-flops <span class="p">or </span>switches <span class="p">in today’s vernacular.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What was going through your mind when you sent the first host-to-host message (from UCLA to</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">the Stanford Research Institute)?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Frankly, we had no idea of the importance of that event. We had not prepared a special message of historic significance, as did so many inventors of the past (Samuel Morse with “What hath God wrought.” or Alexander Graham Bell with “Watson, come here! I want you.” or Neal Amstrong with “That’s one small step for a man, one giant leap for mankind.”) Those guys were</p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_082.png"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a name="bookmark132">smart</a><span class="p">! They understood media and public relations. All we wanted to do was to login to the SRI computer. So we typed the “L”, which was correctly received, we typed the “o” which was received, and then we typed the “g” which caused the SRI host computer to crash! So, it turned</span></p><p style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">out that our message was the shortest and perhaps the most prophetic message ever, namely “Lo!” as in “Lo and behold!”</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Earlier that year, I was quoted in a UCLA press release saying that once the network was up and running, it would be possible to gain access to computer utilities from our homes and offices as easily as we gain access to electricity and telephone connectivity. So my vision at that time was that the Internet would be ubiquitous, always on, always available, anyone with any device could connect from any location, and it would be invisible. However, I never anticipated that my 99-year-old mother would use the Internet—and indeed she did!</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What is your vision for the future of networking?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">The easy part of the vision is to predict the infrastructure itself. I anticipate that we see considerable deployment of nomadic computing, mobile devices, and smart spaces. Indeed, the availability of lightweight, inexpensive, high-performance, portable computing, and communication devices (plus the ubiquity of the Internet) has enabled us to become nomads. Nomadic computing refers to the technology that enables end users who travel from place to place to gain access to Internet services in a transparent fashion, no matter where they travel and no matter what device they carry or gain access to. The harder part of the vision is to predict the applications and services, which have consistently surprised us in dramatic ways (e-mail, search technologies, the World Wide Web, blogs, social networks, user generation, and sharing of music, photos, and videos, etc.). We are on the verge of a new class of surprising and innovative mobile applications delivered to our hand-held devices.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">The next step will enable us to move out from the netherworld of cyberspace to the physical world of smart spaces. Our environments (desks, walls, vehicles, watches, belts, and so on) will come alive with technology, through actuators, sensors, logic, processing, storage, cameras, microphones, speakers, displays, and communication. This embedded technology will allow our environment to provide the IP services we want. When I walk into a room, the room will know I entered. I will be able to communicate with my environment naturally, as in spoken English; my requests will generate replies that present Web pages to me from wall displays, through my eyeglasses, as speech, holograms, and so forth.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Looking a bit further out, I see a networking future that includes the following additional key components. I see intelligent software agents deployed across the network whose function it is to mine data, act on that data, observe trends, and carry out tasks dynamically and adaptively. I see considerably more network traffic generated not so much by humans, but by these embedded devices and these intelligent software agents. I see large collections of self- organizing systems controlling this vast, fast network. I see huge amounts of information flashing</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="436" alt="image" src="计算机网络自顶向下7th-en/Image_083.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark133">across this network instantaneously with this information undergoing enormous processing and filtering. The Internet will essentially be a pervasive global nervous system. I see all these things and more as we move headlong through the twenty-first century.</a><a name="bookmark134">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What people have inspired you professionally?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">By far, it was Claude Shannon from MIT, a brilliant researcher who had the ability to relate his mathematical ideas to the physical world in highly intuitive ways. He was on my PhD thesis committee.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Do you have any advice for students entering the networking/Internet field?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark135">The Internet and all that it enables is a vast new frontier, full of amazing challenges. There is room for great innovation. Don’t be constrained by today’s technology. Reach out and imagine what could be and then make it happen.</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="783" height="2" alt="image" src="计算机网络自顶向下7th-en/Image_084.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s16" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark136">Chapter </a><span class="h1">2 </span>Application Layer<a name="bookmark137">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="1" alt="image" src="计算机网络自顶向下7th-en/Image_085.png"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">Network applications are the <i>raisons d’être </i>of a computer network—if we couldn’t conceive of any useful applications, there wouldn’t be any need for networking infrastructure and protocols to support them. Since the Internet’s inception, numerous useful and entertaining applications have indeed been created.</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">These applications have been the driving force behind the Internet’s success, motivating people in homes, schools, governments, and businesses to make the Internet an integral part of their daily activities.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">Internet applications include the classic text-based applications that became popular in the 1970s and 1980s: text e-mail, remote access to computers, file transfers, and newsgroups. They include <i>the </i>killer</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">application of the mid-1990s, the World Wide Web, encompassing Web surfing, search, and electronic commerce. They include instant messaging and P2P file sharing, the two killer applications introduced at the end of the millennium. In the new millennium, new and highly compelling applications continue to emerge, including voice over IP and video conferencing such as Skype, Facetime, and Google Hangouts; user generated video such as YouTube and movies on demand such as Netflix; multiplayer online games such as Second Life and World of Warcraft. During this same period, we have seen the emergence of a new generation of social networking applications—such as Facebook, Instagram, Twitter, and WeChat—which have created engaging human networks on top of the Internet’s network or routers and communication links. And most recently, along with the arrival of the smartphone, there has been a profusion of location based mobile apps, including popular check-in, dating, and road-traffic forecasting apps (such as Yelp, Tinder, Waz, and Yik Yak). Clearly, there has been no slowing down of new and exciting Internet applications. Perhaps some of the readers of this text will create the next generation of killer Internet applications!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this chapter we study the conceptual and implementation aspects of network applications. We begin by defining key application-layer concepts, including network services required by applications, clients and servers, processes, and transport-layer interfaces. We examine several network applications in detail, including the Web, e-mail, DNS, peer-to-peer (P2P) file distribution, and video streaming.</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark775" class="s124">(</a><a href="#bookmark775" class="a">Chapter 9</a> <span class="p">will further examine multimedia applications, including streaming video and VoIP.) We then cover network application development, over both TCP and UDP. In particular, we study the socket interface and walk through some simple client-server applications in Python. We also provide several</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">fun and interesting socket programming assignments at the end of the chapter.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark138">The application layer is a particularly good place to start our study of protocols. It’s familiar ground. We’re acquainted with many of the applications that rely on the protocols we’ll study. It will give us a good feel for what protocols are all about and will introduce us to many of the same issues that we’ll see again when we study transport, network, and link layer protocols.</a></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l104"><ol id="l105"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark139">Principles of Network Applications</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Suppose you have an idea for a new network application. Perhaps this application will be a great service to humanity, or will please your professor, or will bring you great wealth, or will simply be fun to develop. Whatever the motivation may be, let’s now examine how you transform the idea into a real-world network application.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">At the core of network application development is writing programs that run on different end systems and communicate with each other over the network. For example, in the Web application there are two distinct programs that communicate with each other: the browser program running in the user’s host (desktop, laptop, tablet, smartphone, and so on); and the Web server program running in the Web server host. As another example, in a P2P file-sharing system there is a program in each host that participates in the file-sharing community. In this case, the programs in the various hosts may be similar or identical.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Thus, when developing your new application, you need to write software that will run on multiple end systems. This software could be written, for example, in C, Java, or Python. Importantly, you do not need to write software that runs on network-core devices, such as routers or link-layer switches. Even if you wanted to write application software for these network-core devices, you wouldn’t be able to do so.</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark5" class="s124">As we learned in </a><a href="#bookmark5" class="a">Chapter </a>1<a href="#bookmark93" class="s124">, and as shown earlier in </a><a href="#bookmark93" class="a">Figure 1.2</a>4<span class="p">, network-core devices do not function at the application layer but instead function at lower layers—specifically at the network layer and below.</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark140" class="s124">This basic design—namely, confining application software to the end systems—as shown in </a><a href="#bookmark140" class="a">Figure 2.</a>1<span class="p">, has facilitated the rapid development and deployment of a vast array of network applications.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="799" height="921" alt="image" src="计算机网络自顶向下7th-en/Image_086.png"/></span></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark140">Figure 2.1 Communication for a network application takes place between end systems at the application layer</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><ol id="l106"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark141">Network Application Architectures</a></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark5" class="s124">Before diving into software coding, you should have a broad architectural plan for your application. Keep in mind that an application’s architecture is distinctly different from the network architecture (e.g., the five-layer Internet architecture discussed in </a><a href="#bookmark5" class="a">Chapter </a>1<span class="p">). From the application developer’s perspective,</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the network architecture is fixed and provides a specific set of services to applications. The <span class="s20">application</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">architecture<span class="p">, on the other hand, is designed by the application developer and dictates how the application is structured over the various end systems. In choosing the application architecture, an application developer will likely draw on one of the two predominant architectural paradigms used in modern network applications: the client-server architecture or the peer-to-peer (P2P) architecture.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;">In a <span class="s23">client-server</span><span class="s20"> architecture</span>, there is an always-on host, called the <i>server</i>, which services requests from many other hosts, called <i>clients</i>. A classic example is the Web application for which an always-on Web server services requests from browsers running on client hosts. When a Web server receives a request for an object from a client host, it responds by sending the requested object to the client host.</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Note that with the client-server architecture, clients do not directly communicate with each other; for example, in the Web application, two browsers do not directly communicate. Another characteristic of the client-server architecture is that the server has a fixed, well-known address, called an IP address (which we’ll discuss soon). Because the server has a fixed, well-known address, and because the server is always on, a client can always contact the server by sending a packet to the server’s IP address. Some of the better-known applications with a client-server architecture include the Web, FTP, Telnet,</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark143" class="s124">and e-mail. The client-server architecture is shown in </a><a href="#bookmark143" class="a">Figure 2.2(a</a>)<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Often in a client-server application, a single-server host is incapable of keeping up with all the requests from clients. For example, a popular social-networking site can quickly become overwhelmed if it has only one server handling all of its requests. For this reason, a <span class="s20">data center</span>, housing a large number of hosts, is often used to create a powerful virtual server. The most popular Internet services—such as search engines (e.g., Google, Bing, Baidu), Internet commerce (e.g., Amazon, eBay, Alibaba), Web- based e-mail (e.g., Gmail and Yahoo Mail), social networking (e.g., Facebook, Instagram, Twitter, and</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark60" class="s124">WeChat)—employ one or more data centers. As discussed in </a><a href="#bookmark60" class="a">Section 1.3.</a>3<span class="p">, Google has 30 to 50 data centers distributed around the world, which collectively handle search, YouTube, Gmail, and other services. A data center can have hundreds of thousands of servers, which must be powered and</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">maintained. Additionally, the service providers must pay recurring interconnection and bandwidth costs for sending data from their data centers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">In a <span class="s20">P2P architecture</span>, there is minimal (or no) reliance on dedicated servers in data centers. Instead the application exploits direct communication between pairs of intermittently connected hosts, called <i>peers</i>. The peers are not owned by the service provider, but are instead desktops and laptops controlled</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;"><a name="bookmark142">by users, with most of the</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="362" height="503" alt="image" src="计算机网络自顶向下7th-en/Image_087.jpg"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="362" height="506" alt="image" src="计算机网络自顶向下7th-en/Image_088.jpg"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark143">Figure 2.2 (a) Client-server architecture; (b) P2P architecture</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="362" height="506" alt="image" src="计算机网络自顶向下7th-en/Image_089.jpg"/></span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark144">peers residing in homes, universities, and offices. Because the peers communicate without passing through a dedicated server, the architecture is called peer-to-peer. Many of today’s most popular and traffic-intensive applications are based on P2P architectures. These applications include file sharing (e.g., BitTorrent), peer-assisted download acceleration (e.g., Xunlei), and Internet telephony and video</a></p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark143" class="s124">conference (e.g., Skype). The P2P architecture is illustrated in </a><a href="#bookmark143" class="a">Figure </a>2.2(b)<span class="p">. We mention that some applications have hybrid architectures, combining both client-server and P2P elements. For example, for many instant messaging applications, servers are used to track the IP addresses of users, but user-to-</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">user messages are sent directly between user hosts (without passing through intermediate servers).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark145">One of the most compelling features of P2P architectures is their </a><span class="s20">self-scalability</span>. For example, in a P2P file-sharing application, although each peer generates workload by requesting files, each peer also adds service capacity to the system by distributing files to other peers. P2P architectures are also cost effective, since they normally don’t require significant server infrastructure and server bandwidth (in contrast with clients-server designs with datacenters). However, P2P applications face challenges of security, performance, and reliability due to their highly decentralized structure.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Processes Communicating</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before building your network application, you also need a basic understanding of how the programs, running in multiple end systems, communicate with each other. In the jargon of operating systems, it is not actually programs but <span class="s20">processes </span>that communicate. A process can be thought of as a program that is running within an end system. When processes are running on the same end system, they can communicate with each other with interprocess communication, using rules that are governed by the end system’s operating system. But in this book we are not particularly interested in how processes in</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">the same host communicate, but instead in how processes running on <i>different </i>hosts (with potentially different operating systems) communicate.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Processes on two different end systems communicate with each other by exchanging <span class="s20">messages </span><a href="#bookmark140" class="s124">across the computer network. A sending process creates and sends messages into the network; a receiving process receives these messages and possibly responds by sending messages back. </a><a href="#bookmark140" class="a">Figure 2.1</a></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">illustrates that processes communicating with each other reside in the application layer of the five-layer</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">protocol stack.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Client and Server Processes</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A network application consists of pairs of processes that send messages to each other over a network. For example, in the Web application a client browser process exchanges messages with a Web server</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">process. In a P2P file-sharing system, a file is transferred from a process in one peer to a process in another peer. For each pair of communicating processes, we typically label one of the two processes as the <span class="s20">client </span>and the other process as the <span class="s20">server</span>. With the Web, a browser is a client process and a Web server is a server process. With P2P file sharing, the peer that is downloading the file is labeled as the client, and the peer that is uploading the file is labeled as the server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">You may have observed that in some applications, such as in P2P file sharing, a process can be both a client and a server. Indeed, a process in a P2P file-sharing system can both upload and download files. Nevertheless, in the context of any given communication session between a pair of processes, we can still label one process as the client and the other process as the server. We define the client and server processes as follows:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="85" alt="image" src="计算机网络自顶向下7th-en/Image_090.png"/></span></p><p class="s17" style="padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: justify;">In the context of a communication session between a pair of processes, the process that initiates the communication (that is, initially contacts the other process at the beginning of the session) is labeled as the <span class="p">client. </span>The process that waits to be contacted to begin the session is the <span class="p">server.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the Web, a browser process initializes contact with a Web server process; hence the browser process is the client and the Web server process is the server. In P2P file sharing, when Peer A asks Peer B to send a specific file, Peer A is the client and Peer B is the server in the context of this specific communication session. When there’s no confusion, we’ll sometimes also use the terminology “client side and server side of an application.” At the end of this chapter, we’ll step through simple code for both the client and server sides of network applications.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The Interface Between the Process and the Computer Network</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">As noted above, most applications consist of pairs of communicating processes, with the two processes in each pair sending messages to each other. Any message sent from one process to another must go through the underlying network. A process sends messages into, and receives messages from, the network through a software interface called a <span class="s20">socket</span>. Let’s consider an analogy to help us understand processes and sockets. A process is analogous to a house and its socket is analogous to its door. When a process wants to send a message to another process on another host, it shoves the message out its door (socket). This sending process assumes that there is a transportation infrastructure on the other side of its door that will transport the message to the door of the destination process. Once the message arrives at the destination host, the message passes through the receiving process’s door (socket), and the receiving process then acts on the message.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark146" class="a">Figure 2.3</a> <a href="#bookmark146" class="s124">illustrates socket communication between two processes that communicate over the Internet. (</a><a href="#bookmark146" class="a">Figure 2.3</a> <span class="p">assumes that the underlying transport protocol used by the processes is the Internet’s TCP protocol.) As shown in this figure, a socket is the interface between the application layer and the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">transport layer within a host. It is also referred to as the <span class="s20">Application Programming Interface (API)</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">between the application and the network, since the socket is the programming interface with which network applications are built. The application developer has control of everything on the application- layer side of the socket but has little control of the transport-layer side of the socket. The only control that the application developer has on the transport-layer side is (1) the choice of transport protocol and</p><ol id="l107"><li style="padding-left: 24pt;text-indent: -19pt;text-align: left;"><p style="display: inline;">perhaps the ability to fix a few transport-layer parameters such as maximum buffer and maximum</p></li></ol><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark254" class="s124">segment sizes (to be covered in </a><a href="#bookmark254" class="a">Chapter </a>3<span class="p">). Once the application developer chooses a transport protocol (if a choice is available), the application is built using the transport-layer services provided by</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark239" class="s124">that protocol. We’ll explore sockets in some detail in </a><a href="#bookmark239" class="a">Section 2.</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Addressing Processes</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In order to send postal mail to a particular destination, the destination needs to have an address. Similarly, in order for a process running on one host to send packets to a process running on another host, the receiving process needs to have an address.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="784" height="357" alt="image" src="计算机网络自顶向下7th-en/Image_091.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark146">Figure 2.3 Application processes, sockets, and underlying transport protocol</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To identify the receiving process, two pieces of information need to be specified: (1) the address of the host and (2) an identifier that specifies the receiving process in the destination host.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">In the Internet, the host is identified by its <span class="s20">IP address</span>. We’ll discuss IP addresses in great detail in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark368" class="a">Chapter </a>4<span class="p">. For now, all we need to know is that an IP address is a 32-bit quantity that we can think of as uniquely identifying the host. In addition to knowing the address of the host to which a message is destined, the sending process must also identify the receiving process (more specifically, the receiving</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">socket) running in the host. This information is needed because in general a host could be running many network applications. A destination <span class="s20">port number </span>serves this purpose. Popular applications have been</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="http://www.iana.org/" class="s124" target="_blank" name="bookmark147">assigned specific port numbers. For example, a Web server is identified by port number 80. A mail server process (using the SMTP protocol) is identified by port number 25. A list of well-known port numbers for all Internet standard protocols can be found at </a>www.iana.org<span class="p">. We’ll examine port numbers</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark254" class="s124">in detail in </a><a href="#bookmark254" class="a">Chapter </a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Transport Services Available to Applications</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Recall that a socket is the interface between the application process and the transport-layer protocol. The application at the sending side pushes messages through the socket. At the other side of the socket, the transport-layer protocol has the responsibility of getting the messages to the socket of the receiving process.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark148">Many networks, including the Internet, provide more than one transport-layer protocol. When you develop an application, you must choose one of the available transport-layer protocols. How do you make this choice? Most likely, you would study the services provided by the available transport-layer protocols, and then pick the protocol with the services that best match your application’s needs. The situation is similar to choosing either train or airplane transport for travel between two cities. You have to choose one or the other, and each transportation mode offers different services. (For example, the train offers downtown pickup and drop-off, whereas the plane offers shorter travel time.)</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">What are the services that a transport-layer protocol can offer to applications invoking it? We can broadly classify the possible services along four dimensions: reliable data transfer, throughput, timing, and security.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Reliable Data Transfer</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark5" class="s124">As discussed in </a><a href="#bookmark5" class="a">Chapter </a>1<span class="p">, packets can get lost within a computer network. For example, a packet can overflow a buffer in a router, or can be discarded by a host or router after having some of its bits corrupted. For many applications—such as electronic mail, file transfer, remote host access, Web</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">document transfers, and financial applications—data loss can have devastating consequences (in the latter case, for either the bank or the customer!). Thus, to support these applications, something has to be done to guarantee that the data sent by one end of the application is delivered correctly and completely to the other end of the application. If a protocol provides such a guaranteed data delivery service, it is said to provide <span class="s20">reliable data transfer</span>. One important service that a transport-layer protocol can potentially provide to an application is process-to-process reliable data transfer. When a transport protocol provides this service, the sending process can just pass its data into the socket and know with complete confidence that the data will arrive without errors at the receiving process.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">When a transport-layer protocol doesn’t provide reliable data transfer, some of the data sent by the</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">sending process may never arrive at the receiving process. This may be acceptable for <span class="s20">loss-tolerant applications</span>, most notably multimedia applications such as conversational audio/video that can tolerate some amount of data loss. In these multimedia applications, lost data might result in a small glitch in the audio/video—not a crucial impairment.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Throughput</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark5" class="s124">In </a><a href="#bookmark5" class="a">Chapter 1</a> <span class="p">we introduced the concept of available throughput, which, in the context of a communication session between two processes along a network path, is the rate at which the sending process can deliver bits to the receiving process. Because other sessions will be sharing the bandwidth</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">along the network path, and because these other sessions will be coming and going, the available throughput can fluctuate with time. These observations lead to another natural service that a transport- layer protocol could provide, namely, guaranteed available throughput at some specified rate. With such</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">a service, the application could request a guaranteed throughput of <i>r </i>bits/sec, and the transport protocol would then ensure that the available throughput is always at least <i>r </i>bits/sec. Such a guaranteed throughput service would appeal to many applications. For example, if an Internet telephony application</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">encodes voice at 32 kbps, it needs to send data into the network and have data delivered to the receiving application at this rate. If the transport protocol cannot provide this throughput, the application would need to encode at a lower rate (and receive enough throughput to sustain this lower coding rate) or may have to give up, since receiving, say, half of the needed throughput is of little or no use to this Internet telephony application. Applications that have throughput requirements are said to be <span class="s20">bandwidth-sensitive applications</span>. Many current multimedia applications are bandwidth sensitive, although some multimedia applications may use adaptive coding techniques to encode digitized voice or video at a rate that matches the currently available throughput.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">While bandwidth-sensitive applications have specific throughput requirements, <span class="s20">elastic applications </span>can make use of as much, or as little, throughput as happens to be available. Electronic mail, file transfer, and Web transfers are all elastic applications. Of course, the more throughput, the better. There’san adage that says that one cannot be too rich, too thin, or have too much throughput!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Timing</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">A transport-layer protocol can also provide timing guarantees. As with throughput guarantees, timing guarantees can come in many shapes and forms. An example guarantee might be that every bit that the sender pumps into the socket arrives at the receiver’s socket no more than 100 msec later. Such a service would be appealing to interactive real-time applications, such as Internet telephony, virtual environments, teleconferencing, and multiplayer games, all of which require tight timing constraints on</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark775" class="s124">data delivery in order to be effective. (See </a><a href="#bookmark775" class="a">Chapter </a>9<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">[Gauthier 199</a>9<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Ramjee </a>1994]<span class="p">.) Long delays in Internet telephony, for example, tend to result in unnatural pauses in the conversation; in a multiplayer game or virtual interactive environment, a long delay between taking an action and seeing the response</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark149">from the environment (for example, from another player at the end of an end-to-end connection) makes the application feel less realistic. For non-real-time applications, lower delay is always preferable to higher delay, but no tight constraint is placed on the end-to-end delays.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Security</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Finally, a transport protocol can provide an application with one or more security services. For example, in the sending host, a transport protocol can encrypt all data transmitted by the sending process, and in the receiving host, the transport-layer protocol can decrypt the data before delivering the data to the receiving process. Such a service would provide confidentiality between the two processes, even if the data is somehow observed between sending and receiving processes. A transport protocol can also provide other security services in addition to confidentiality, including data integrity and end-point</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark775" class="s124">authentication, topics that we’ll cover in detail in </a><a href="#bookmark775" class="a">Chapter </a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Transport Services Provided by the Internet</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Up until this point, we have been considering transport services that a computer network <i>could </i>provide in general. Let’s now get more specific and examine the type of transport services provided by the Internet. The Internet (and, more generally, TCP/IP networks) makes two transport protocols available to</p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark150" class="s124">applications, UDP and TCP. When you (as an application developer) create a new network application for the Internet, one of the first decisions you have to make is whether to use UDP or TCP. Each of these protocols offers a different set of services to the invoking applications. </a><a href="#bookmark150" class="a">Figure 2.4</a> <span class="p">shows the</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">service requirements for some selected applications.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">TCP Services</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The TCP service model includes a connection-oriented service and a reliable data transfer service. When an application invokes TCP as its transport protocol, the application receives both of these services from TCP.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_092.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>Connection-oriented service. </b>TCP has the client and server exchange transport-layer control information with each other <i>before </i>the application-level messages begin to flow. This so-called handshaking procedure alerts the client and server, allowing them to prepare for an onslaught of</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">packets. After the handshaking phase, a <span class="s20">TCP connection </span>is said to exist between the sockets</p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;text-align: left;"><span><img width="673" height="335" alt="image" src="计算机网络自顶向下7th-en/Image_093.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: left;"><a name="bookmark150">Figure 2.4 Requirements of selected network applications</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 27pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark254" class="s124" name="bookmark151">of the two processes. The connection is a full-duplex connection in that the two processes can send messages to each other over the connection at the same time. When the application finishes sending messages, it must tear down the connection. In </a><a href="#bookmark254" class="a">Chapter 3</a> <span class="p">we’ll discuss connection-oriented</span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 11pt;text-align: left;">service in detail and examine how it is implemented.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_094.png"/></span></p><p class="s28" style="padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">Reliable data transfer service. <span class="p">The communicating processes can rely on TCP to deliver all data sent without error and in the proper order. When one side of the application passes a stream of bytes into a socket, it can count on TCP to deliver the same stream of bytes to the receiving socket,</span></p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">with no missing or duplicate bytes.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">TCP also includes a congestion-control mechanism, a service for the general welfare of the Internet rather than for the direct benefit of the communicating processes. The TCP congestion-control mechanism throttles a sending process (client or server) when the network is congested between sender and receiver. As we will see</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="308" alt="image" src="计算机网络自顶向下7th-en/Image_095.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">FOCUS ON SECURITY</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">SECURING TCP</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Neither TCP nor UDP provides any encryption—the data that the sending process passes into its socket is the same data that travels over the network to the destination process. So, for example, if the sending process sends a password in cleartext (i.e., unencrypted) into its socket, the cleartext password will travel over all the links between sender and receiver, potentially getting sniffed and discovered at any of the intervening links. Because privacy and other security issues have become critical for many applications, the Internet community has developed an enhancement for TCP, called <span class="s20">Secure Sockets Layer (SSL)</span>. TCP-enhanced-with-SSL not only</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="406" alt="image" src="计算机网络自顶向下7th-en/Image_096.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">does everything that traditional TCP does but also provides critical process-to-process security services, including encryption, data integrity, and end-point authentication. We emphasize that SSL is not a third Internet transport protocol, on the same level as TCP and UDP, but instead is an enhancement of TCP, with the enhancements being implemented in the application layer. In particular, if an application wants to use the services of SSL, it needs to include SSL code (existing, highly optimized libraries and classes) in both the client and server sides of the application. SSL has its own socket API that is similar to the traditional TCP socket API. When an application uses SSL, the sending process passes cleartext data to the SSL socket; SSL in the sending host then encrypts the data and passes the encrypted data to the TCP socket. The encrypted data travels over the Internet to the TCP socket in the receiving process. The receiving socket passes the encrypted data to SSL, which decrypts the data. Finally, SSL passes the cleartext data through its SSL socket to the receiving process. We’ll cover SSL in</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;text-align: left;"><a href="#bookmark671" class="s124">some detail in </a><a href="#bookmark671" class="a">Chapter </a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark254" class="s124" name="bookmark152">in </a><a href="#bookmark254" class="a">Chapter </a>3<span class="p">, TCP congestion control also attempts to limit each TCP connection to its fair share of network bandwidth.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">UDP Services</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">UDP is a no-frills, lightweight transport protocol, providing minimal services. UDP is connectionless, so there is no handshaking before the two processes start to communicate. UDP provides an unreliable data transfer service—that is, when a process sends a message into a UDP socket, UDP provides <i>no</i></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">guarantee that the message will ever reach the receiving process. Furthermore, messages that do arrive</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">at the receiving process may arrive out of order.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">UDP does not include a congestion-control mechanism, so the sending side of UDP can pump data into the layer below (the network layer) at any rate it pleases. (Note, however, that the actual end-to-end throughput may be less than this rate due to the limited transmission capacity of intervening links or due to congestion).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Services Not Provided by Internet Transport Protocols</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We have organized transport protocol services along four dimensions: reliable data transfer, throughput, timing, and security. Which of these services are provided by TCP and UDP? We have already noted that TCP provides reliable end-to-end data transfer. And we also know that TCP can be easily enhanced at the application layer with SSL to provide security services. But in our brief description of TCP and</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">UDP, conspicuously missing was any mention of throughput or timing guarantees— services <i>not </i>provided by today’s Internet transport protocols. Does this mean that time-sensitive applications such as Internet telephony cannot run in today’s Internet? The answer is clearly no—the Internet has been</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">hosting time-sensitive applications for many years. These applications often work fairly well because</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark153">they have been designed to cope, to the greatest extent possible, with this lack of guarantee. We’ll</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark775" class="s124">investigate several of these design tricks in </a><a href="#bookmark775" class="a">Chapter </a>9<span class="p">. Nevertheless, clever design has its limitations when delay is excessive, or the end-to-end throughput is limited. In summary, today’s Internet can often provide satisfactory service to time-sensitive applications, but it cannot provide any timing or throughput</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">guarantees.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark155" class="a">Figure 2.5</a> <span class="p">indicates the transport protocols used by some popular Internet applications. We see that e- mail, remote terminal access, the Web, and file transfer all use TCP. These applications have chosen TCP primarily because TCP provides reliable data transfer, guaranteeing that all data will eventually get</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark154">to its destination. Because Internet telephony applications (such as Skype) can often tolerate some loss but require a minimal rate to be effective, developers of Internet telephony applications usually prefer to run their applications over UDP, thereby circumventing TCP’s congestion control mechanism and packet overheads. But because many firewalls are configured to block (most types of) UDP traffic, Internet telephony applications often are designed to use TCP as a backup if UDP communication fails.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="274" alt="image" src="计算机网络自顶向下7th-en/Image_097.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark155">Figure 2.5 Popular Internet applications, their application-layer protocols, and their underlying transport protocols</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Application-Layer Protocols</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We have just learned that network processes communicate with each other by sending messages into sockets. But how are these messages structured? What are the meanings of the various fields in the messages? When do the processes send the messages? These questions bring us into the realm of application-layer protocols. An <span class="s20">application-layer protocol </span>defines how an application’s processes, running on different end systems, pass messages to each other. In particular, an application-layer protocol defines:</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_098.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark156">The types of messages exchanged, for example, request messages and response messages</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_099.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">The syntax of the various message types, such as the fields in the message and how the fields are delineated</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_100.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">The semantics of the fields, that is, the meaning of the information in the fields</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_101.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">Rules for determining when and how a process sends messages and responds to messages</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Some application-layer protocols are specified in RFCs and are therefore in the public domain. For</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">example, the Web’s application-layer protocol, HTTP (the HyperText Transfer Protocol </a><a href="#bookmark848" class="a">[RFC </a>2616]<span class="p">), is available as an RFC. If a browser developer follows the rules of the HTTP RFC, the browser will be able to retrieve Web pages from any Web server that has also followed the rules of the HTTP RFC. Many</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">other application-layer protocols are proprietary and intentionally not available in the public domain. For example, Skype uses proprietary application-layer protocols.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">It is important to distinguish between network applications and application-layer protocols. An application-layer protocol is only one piece of a network application (albeit, a very important piece of the application from our point of view!). Let’s look at a couple of examples. The Web is a client-server application that allows users to obtain documents from Web servers on demand. The Web application consists of many components, including a standard for document formats (that is, HTML), Web browsers (for example, Firefox and Microsoft Internet Explorer), Web servers (for example, Apache and Microsoft servers), and an application-layer protocol. The Web’s application-layer protocol, HTTP, defines the format and sequence of messages exchanged between browser and Web server. Thus, HTTP is only one piece (albeit, an important piece) of the Web application. As another example, an Internet e-mail application also has many components, including mail servers that house user mailboxes; mail clients (such as Microsoft Outlook) that allow users to read and create messages; a standard for defining the structure of an e-mail message; and application-layer protocols that define how messages are passed between servers, how messages are passed between servers and mail clients, and how the contents of message headers are to be interpreted. The principal application-layer protocol</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">for electronic mail is SMTP (Simple Mail Transfer Protocol) </a><a href="#bookmark848" class="a">[RFC </a>5321]<span class="p">. Thus, e-mail’s principal application-layer protocol, SMTP, is only one piece (albeit an important piece) of the e-mail application.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Network Applications Covered in This Book</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">New public domain and proprietary Internet applications are being developed every day. Rather than covering a large number of Internet applications in an encyclopedic manner, we have chosen to focus on a small number of applications that are both pervasive and important. In this chapter we discuss five important applications: the Web, electronic mail, directory service video streaming, and P2P applications. We first discuss the Web, not only because it is an enormously popular application, but also because its application-layer protocol, HTTP, is straightforward and easy to understand. We then discuss electronic mail, the Internet’s first killer application. E-mail is more complex than the Web in the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark157">sense that it makes use of not one but several application-layer protocols. After e-mail, we cover DNS, which provides a directory service for the Internet. Most users do not interact with DNS directly; instead, users invoke DNS indirectly through other applications (including the Web, file transfer, and electronic mail). DNS illustrates nicely how a piece of core network functionality (network-name to network- address translation) can be implemented at the application layer in the Internet. We then discuss P2P file sharing applications, and complete our application study by discussing video streaming on demand,</a><a name="bookmark158">&zwnj;</a></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark775" class="s124">including distributing stored video over content distribution networks. In </a><a href="#bookmark775" class="a">Chapter </a>9<span class="p">, we’ll cover multimedia applications in more depth, including voice over IP and video conferencing.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l108"><ol id="l109"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark159">The Web and HTTP</a><a name="bookmark160">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Until the early 1990s the Internet was used primarily by researchers, academics, and university students to log in to remote hosts, to transfer files from local hosts to remote hosts and vice versa, to receive and send news, and to receive and send electronic mail. Although these applications were (and continue to be) extremely useful, the Internet was essentially unknown outside of the academic and research communities. Then, in the early 1990s, a major new application arrived on the scene—the World Wide</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">Web </a><a href="#bookmark848" class="a">[Berners-Lee </a>1994]<span class="p">. The Web was the first Internet application that caught the general public’s eye. It dramatically changed, and continues to change, how people interact inside and outside their work environments. It elevated the Internet from just one of many data networks to essentially the one and</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">only data network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Perhaps what appeals the most to users is that the Web operates <i>on demand</i>. Users receive what they want, when they want it. This is unlike traditional broadcast radio and television, which force users to tune in when the content provider makes the content available. In addition to being available on</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">demand, the Web has many other wonderful features that people love and cherish. It is enormously easy for any individual to make information available over the Web—everyone can become a publisher at extremely low cost. Hyperlinks and search engines help us navigate through an ocean of information. Photos and videos stimulate our senses. Forms, JavaScript, Java applets, and many other devices enable us to interact with pages and sites. And the Web and its protocols serve as a platform for YouTube, Web-based e-mail (such as Gmail), and most mobile Internet applications, including Instagram and Google Maps.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l110"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Overview of HTTP</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><span class="p">The </span>HyperText Transfer Protocol (HTTP)<a href="#bookmark848" class="s124">, the Web’s application-layer protocol, is at the heart of the Web. It is defined in </a><a href="#bookmark848" class="a">[RFC 1945]</a> <a href="#bookmark848" class="s124">and </a><a href="#bookmark848" class="a">[RFC </a>2616]<span class="p">. HTTP is implemented in two programs: a client</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">program and a server program. The client program and server program, executing on different end systems, talk to each other by exchanging HTTP messages. HTTP defines the structure of these messages and how the client and server exchange the messages. Before explaining HTTP in detail, we should review some Web terminology.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A <span class="s20">Web page </span>(also called a document) consists of objects. An <span class="s20">object </span>is simply a file—such as an HTML file, a JPEG image, a Java applet, or a video clip—that is addressable by a single URL. Most Web pages consist of a <span class="s20">base HTML file </span>and several referenced objects. For example, if a Web page</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_102.png"/></span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">contains HTML text and five JPEG images, then the Web page has six objects: the base HTML file plus the five images. The base HTML file references the other objects in the page with the objects’ URLs. Each URL has two components: the hostname of the server that houses the object and the object’s path name. For example, the URL</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: center;"><a href="http://www.someSchool.edu/someDepartment/picture.gif" class="s34" target="_blank">http://www.someSchool.edu/someDepartment/picture.gif</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 139%;text-align: left;"><a href="http://www.someSchool.edu/" class="s124" target="_blank">has  </a><a href="http://www.someSchool.edu/" class="s34" target="_blank">www.someSchool.edu</a><span class="s38"> </span>for a hostname and  <span class="s30">/someDepartment/picture.gif </span>for a path name. Because <span class="s20">Web browsers </span>(such as Internet Explorer and Firefox) implement the client side of HTTP, in the context of the Web, we will use the words <i>browser </i>and <i>client </i>interchangeably. <span class="s23">Web</span></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">servers<span class="p">, which implement the server side of HTTP, house Web objects, each addressable by a URL.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Popular Web servers include Apache and Microsoft Internet Information Server.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark162" class="s124">HTTP defines how Web clients request Web pages from Web servers and how servers transfer Web pages to clients. We discuss the interaction between client and server in detail later, but the general idea is illustrated in </a><a href="#bookmark162" class="a">Figure 2.</a>6<span class="p">. When a user requests a Web page (for example, clicks on a hyperlink),</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the browser sends HTTP request messages for the objects in the page to the server. The server</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">receives the requests and responds with HTTP response messages that contain the objects.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark157" class="s124">HTTP uses TCP as its underlying transport protocol (rather than running on top of UDP). The HTTP client first initiates a TCP connection with the server. Once the connection is established, the browser and the server processes access TCP through their socket interfaces. As described in </a><a href="#bookmark157" class="a">Section 2.</a>1<span class="p">, on</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the client side the socket interface is the door between the client process and the TCP connection; on</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">the server side it is the door between the server process and the TCP connection. The client sends HTTP request messages into its socket interface and receives HTTP response messages from its socket interface. Similarly, the HTTP server receives request messages</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="441" height="322" alt="image" src="计算机网络自顶向下7th-en/Image_103.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark161">Figure 2.6 HTTP request-response behavior</a><a name="bookmark162">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark157" class="s124">from its socket interface and sends response messages into its socket interface. Once the client sends a message into its socket interface, the message is out of the client’s hands and is “in the hands” of TCP. Recall from </a><a href="#bookmark157" class="a">Section 2.1</a> <span class="p">that TCP provides a reliable data transfer service to HTTP. This implies that</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">each HTTP request message sent by a client process eventually arrives intact at the server; similarly,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">each HTTP response message sent by the server process eventually arrives intact at the client. Here we see one of the great advantages of a layered architecture—HTTP need not worry about lost data or the details of how TCP recovers from loss or reordering of data within the network. That is the job of TCP and the protocols in the lower layers of the protocol stack.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">It is important to note that the server sends requested files to clients without storing any state information about the client. If a particular client asks for the same object twice in a period of a few seconds, the server does not respond by saying that it just served the object to the client; instead, the server resends the object, as it has completely forgotten what it did earlier. Because an HTTP server maintains no information about the clients, HTTP is said to be a <span class="s20">stateless protocol</span>. We also remark</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark157" class="s124">that the Web uses the client-server application architecture, as described in </a><a href="#bookmark157" class="a">Section 2.</a>1<span class="p">. A Web server is always on, with a fixed IP address, and it services requests from potentially millions of different browsers.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Non-Persistent and Persistent Connections</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In many Internet applications, the client and server communicate for an extended period of time, with the client making a series of requests and the server responding to each of the requests. Depending on the application and on how the application is being used, the series of requests may be made back-to-back, periodically at regular intervals, or intermittently. When this client-server interaction is taking place over TCP, the application developer needs to make an important decision—should each request/response</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">pair be sent over a <i>separate </i>TCP connection, or should all of the requests and their corresponding responses be sent over the <i>same </i>TCP connection? In the former approach, the application is said to use <span class="s20">non-persistent connections</span>; and in the latter approach, <span class="s20">persistent connections</span>. To gain a deep</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">understanding of this design issue, let’s examine the advantages and disadvantages of persistent connections in the context of a specific application, namely, HTTP, which can use both non-persistent connections and persistent connections. Although HTTP uses persistent connections in its default mode, HTTP clients and servers can be configured to use non-persistent connections instead.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">HTTP with Non-Persistent Connections</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_104.png"/></span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s walk through the steps of transferring a Web page from server to client for the case of non- persistent connections. Let’s suppose the page consists of a base HTML file and 10 JPEG images, and that all 11 of these objects reside on the same server. Further suppose the URL for the base HTML file is</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 32pt;text-indent: 0pt;text-align: left;"><a href="http://www.someSchool.edu/someDepartment/home.index" class="s34" target="_blank">http://www.someSchool.edu/someDepartment/home.index</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Here is what happens:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><ol id="l111"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 137%;text-align: left;"><p class="s38" style="display: inline;"><a href="http://www.someSchool.edu/" class="s124" target="_blank">The HTTP client process initiates a TCP connection to the server </a><a href="http://www.someSchool.edu/" class="s34" target="_blank">www.someSchool.edu</a> <span class="p">on port number 80, which is the default port number for HTTP. Associated with the TCP connection, there will be a socket at the client and a socket at the server.</span></p></li><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;line-height: 135%;text-align: left;"><p style="display: inline;">The HTTP client sends an HTTP request message to the server via its socket. The request message includes the path name  <span class="s30">/someDepartment/home .index </span>. (We will discuss HTTP messages in some detail below.)</p></li><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The HTTP server process receives the request message via its socket, retrieves the object</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 48pt;text-indent: 2pt;line-height: 130%;text-align: left;">/someDepartment/home.index <span class="p">from its storage (RAM or disk), encapsulates the object in an HTTP response message, and sends the response message to the client via its socket.</span></p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The HTTP server process tells TCP to close the TCP connection. (But TCP doesn’t actually terminate the connection until it knows for sure that the client has received the response</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">message intact.)</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The HTTP client receives the response message. The TCP connection terminates. The message indicates that the encapsulated object is an HTML file. The client extracts the file from</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">the response message, examines the HTML file, and finds references to the 10 JPEG objects.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The first four steps are then repeated for each of the referenced JPEG objects.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">As the browser receives the Web page, it displays the page to the user. Two different browsers may interpret (that is, display to the user) a Web page in somewhat different ways. HTTP has nothing to do with how a Web page is interpreted by a client. The HTTP specifications (</a><a href="#bookmark848" class="a">[RFC 1945]</a> <a href="#bookmark848" class="s124">and </a><a href="#bookmark848" class="a">[RFC </a>2616]<span class="p">)</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">define only the communication protocol between the client HTTP program and the server HTTP</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">program.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The steps above illustrate the use of non-persistent connections, where each TCP connection is closed after the server sends the object—the connection does not persist for other objects. Note that each TCP connection transports exactly one request message and one response message. Thus, in this example, when a user requests the Web page, 11 TCP connections are generated.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">In the steps described above, we were intentionally vague about whether the client obtains the 10</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">JPEGs over 10 serial TCP connections, or whether some of the JPEGs are obtained over parallel TCP connections. Indeed, users can configure modern browsers to control the degree of parallelism. In their default modes, most browsers open 5 to 10 parallel TCP connections, and each of these connections handles one request-response transaction. If the user prefers, the maximum number of parallel connections can be set to one, in which case the 10 connections are established serially. As we’ll see in the next chapter, the use of parallel connections shortens the response time.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before continuing, let’s do a back-of-the-envelope calculation to estimate the amount of time that elapses from when a client requests the base HTML file until the entire file is received by the client. To this end, we define the <span class="s20">round-trip time (RTT)</span>, which is the time it takes for a small packet to travel from client to server and then back to the client. The RTT includes packet-propagation delays, packet- queuing delays in intermediate routers and switches, and packet-processing delays. (These delays were</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark79" class="s124">discussed in </a><a href="#bookmark79" class="a">Section 1.</a>4<a href="#bookmark164" class="s124">.) Now consider what happens when a user clicks on a hyperlink. As shown in </a><a href="#bookmark164" class="a">Figure 2.</a>7<span class="p">, this causes the browser to initiate a TCP connection between the browser and the Web server; this involves a “three-way handshake”—the client sends a small TCP segment to the server, the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">server acknowledges and responds with a small TCP segment, and, finally, the client acknowledges back to the server. The first two parts of the three-way handshake take one RTT. After completing the first two parts of the handshake, the client sends the HTTP request message combined with the third part of the three-way handshake (the acknowledgment) into the TCP connection. Once the request message arrives at</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="660" height="524" alt="image" src="计算机网络自顶向下7th-en/Image_105.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark163">Figure 2.7 Back-of-the-envelope calculation for the time needed to request and receive an HTML file</a><a name="bookmark164">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">the server, the server sends the HTML file into the TCP connection. This HTTP request/response eats up another RTT. Thus, roughly, the total response time is two RTTs plus the transmission time at the server of the HTML file.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">HTTP with Persistent Connections</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">Non-persistent connections have some shortcomings. First, a brand-new connection must be established and maintained for <i>each requested object</i>. For each of these connections, TCP buffers must</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">be allocated and TCP variables must be kept in both the client and server. This can place a significant burden on the Web server, which may be serving requests from hundreds of different clients simultaneously. Second, as we just described, each object suffers a delivery delay of two RTTs—one RTT to establish the TCP connection and one RTT to request and receive an object.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">With HTTP 1.1 persistent connections, the server leaves the TCP connection open after sending a response. Subsequent requests and responses between the same client and server can be sent over the same connection. In particular, an entire Web page (in the example above, the base HTML file and the 10 images) can be sent over a single persistent TCP connection. Moreover, multiple Web pages residing on the same server can be sent from the server to the same client over a single persistent TCP connection. These requests for objects can be made back-to-back, without waiting for replies to pending requests (pipelining). Typically, the HTTP server closes a connection when it isn’t used for a certain time (a configurable timeout interval). When the server receives the back-to-back requests, it sends the objects back-to-back. The default mode of HTTP uses persistent connections with pipelining. Most</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">recently, HTTP/2 </a><a href="#bookmark848" class="a">[RFC 7540]</a><span class="s20"> </span>builds on HTTP 1.1 by allowing multiple requests and replies to be interleaved in the <i>same </i>connection, and a mechanism for prioritizing HTTP message requests and replies within this connection. We’ll quantitatively compare the performance of non-persistent and</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark138" class="s124">persistent connections in the homework problems of </a><a href="#bookmark138" class="a">Chapters 2</a> <a href="#bookmark254" class="s124">and </a>3<span class="p">. You are also encouraged to see</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="a">[Heidemann </a>1997<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Nielsen 199</a>7<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC </a>7540]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">HTTP Message Format</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">The HTTP specifications </a><a href="#bookmark848" class="a">[RFC </a>1945<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 261</a>6<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 7540]</a> <span class="p">include the definitions of the HTTP message formats. There are two types of HTTP messages, request messages and response messages, both of which are discussed below.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">HTTP Request Message</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="190" alt="image" src="计算机网络自顶向下7th-en/Image_106.png"/></span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Below we provide a typical HTTP request message:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 1pt;line-height: 148%;text-align: left;"><a href="http://www.someschool.edu/" class="s35" target="_blank" name="bookmark165">GET /somedir/page.html HTTP/1.1 Host: </a>www.someschool.edu Connection: close</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">User-agent: Mozilla/5.0 Accept-language: fr</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We can learn a lot by taking a close look at this simple request message. First of all, we see that the message is written in ordinary ASCII text, so that your ordinary computer-literate human being can read it. Second, we see that the message consists of five lines, each followed by a carriage return and a line feed. The last line is followed by an additional carriage return and line feed. Although this particular request message has five lines, a request message can have many more lines or as few as one line. The first line of an HTTP request message is called the <span class="s20">request line</span>; the subsequent lines are called the <span class="s20">header lines</span>. The request line has three fields: the method field, the URL field, and the HTTP</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;">version field. The method field can take on several different values, including <span class="s30">GET, POST, HEAD, PUT, </span>and <span class="s30">DELETE </span>. The great majority of HTTP request messages use the <span class="s30">GET </span>method. The <span class="s30">GET </span>method is used when the browser requests an object, with the requested object identified in the URL</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">field. In this example, the browser is requesting the object  <span class="s30">/somedir/page.html </span>. The version is self- explanatory; in this example, the browser implements version HTTP/1.1.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Now let’s look at the header lines in the example. The header line <a href="http://www.someschool.edu/" class="s35" target="_blank">Host: </a><a href="http://www.someschool.edu/" class="s34" target="_blank">www.someschool.edu</a></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark177" class="s124">specifies the host on which the object resides. You might think that this header line is unnecessary, as there is already a TCP connection in place to the host. But, as we’ll see in </a><a href="#bookmark177" class="a">Section 2.2.</a>5<span class="p">, the information provided by the host header line is required by Web proxy caches. By including the </span><span class="s30">Connection:</span></p><p class="s30" style="padding-left: 6pt;text-indent: 0pt;line-height: 14pt;text-align: left;">close <span class="p">header line, the browser is telling the server that it doesn’t want to bother with persistent</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 140%;text-align: left;">connections; it wants the server to close the connection after sending the requested object. The <span class="s30">User- agent: </span>header line specifies the user agent, that is, the browser type that is making the request to the server. Here the user agent is Mozilla/5.0, a Firefox browser. This header line is useful because the server can actually send different versions of the same object to different types of user agents. (Each of</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">the versions is addressed by the same URL.) Finally, the  <span class="s30">Accept-language: </span>header indicates that the user prefers to receive a French version of the object, if such an object exists on the server;</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">otherwise, the server should send its default version. The <span class="s30">Accept-language: </span>header is just one of many content negotiation headers available in HTTP.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Having looked at an example, let’s now look at the general format of a request message, as shown in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark166" class="a">Figure 2.</a>8<span class="p">. We see that the general format closely follows our earlier example. You may have noticed,</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">however, that after the header lines (and the additional carriage return and line feed) there is an “entity body.” The entity body is empty with the <span class="s30">GET </span>method, but is used with the <span class="s30">POST </span>method. An HTTP client often uses the <span class="s30">POST </span>method when the user fills out a form—for example, when a user provides</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 14pt;text-align: left;">search words to a search engine. With a <span class="s30">POST </span>message, the user is still requesting a Web page from</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the server, but the specific contents of the Web page</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="612" height="337" alt="image" src="计算机网络自顶向下7th-en/Image_107.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark166">Figure 2.8 General format of an HTTP request message</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">depend on what the user entered into the form fields. If the value of the method field is <span class="s30">POST </span>, then the entity body contains what the user entered into the form fields.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">We would be remiss if we didn’t mention that a request generated with a form does not necessarily use the <span class="s30">POST </span>method. Instead, HTML forms often use the <span class="s30">GET </span>method and include the inputted data (in the form fields) in the requested URL. For example, if a form uses the <span class="s30">GET </span>method, has two fields, and</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 14pt;text-align: left;">the inputs to the two fields are <span class="s30">monkeys </span>and <span class="s30">bananas </span>, then the URL will have the structure</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s42" style="padding-left: 5pt;text-indent: 2pt;line-height: 124%;text-align: left;"><a href="http://www.somesite.com/animalsearch?monkeys&amp;bananas" class="s36" target="_blank">www.somesite.com/animalsearch?monkeys&amp;bananas</a> <span class="s37">.</span><span class="p"> In your day-to-day Web surfing, you have probably noticed extended URLs of this sort.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The <span class="s30">HEAD </span>method is similar to the <span class="s30">GET </span>method. When a server receives a request with the <span class="s30">HEAD</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">method, it responds with an HTTP message but it leaves out the requested object. Application</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">developers often use the <span class="s30">HEAD </span>method for debugging. The <span class="s30">PUT </span>method is often used in conjunction with Web publishing tools. It allows a user to upload an object to a specific path (directory) on a specific</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">Web server. The <span class="s30">PUT </span>method is also used by applications that need to upload objects to Web servers. The <span class="s30">DELETE </span>method allows a user, or an application, to delete an object on a Web server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">HTTP Response Message</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="302" alt="image" src="计算机网络自顶向下7th-en/Image_108.png"/></span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Below we provide a typical HTTP response message. This response message could be the response to the example request message just discussed.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 31pt;text-indent: 0pt;text-align: left;">HTTP/1.1 200 OK</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">Connection: close</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">Date: Tue, 18 Aug 2015 15:44:04 GMT</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">Server: Apache/2.2.3 (CentOS)</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">Last-Modified: Tue, 18 Aug 2015 15:11:03 GMT</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;line-height: 148%;text-align: left;">Content-Length: 6821 Content-Type: text/html</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">(data data data data data ...)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Let’s take a careful look at this response message. It has three sections: an initial <span class="s20">status line</span>, six <span class="s20">header lines</span>, and then the <span class="s20">entity body</span>. The entity body is the meat of the message—it contains the requested object itself (represented by <span class="s30">data data data data data ... </span>). The status line has</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">three fields: the protocol version field, a status code, and a corresponding status message. In this</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">example, the status line indicates that the server is using HTTP/1.1 and that everything is OK (that is, the server has found, and is sending, the requested object).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">Now let’s look at the header lines. The server uses the <span class="s30">Connection: close </span>header line to tell the client that it is going to close the TCP connection after sending the message. The <span class="s30">Date: </span>header line indicates the time and date when the HTTP response was created and sent by the server. Note that this is not the time when the object was created or last modified; it is the time when the server retrieves the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">object from its file system, inserts the object into the response message, and sends the response message. The <span class="s30">Server: </span>header line indicates that the message was generated by an Apache Web server; it is analogous to the <span class="s30">User-agent: </span>header line in the HTTP request message. The <span class="s30">Last-</span></p><p class="s30" style="padding-left: 5pt;text-indent: 0pt;line-height: 14pt;text-align: left;">Modified: <span class="p">header line indicates the time and date when the object was created or last modified. The</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 5pt;text-indent: 2pt;line-height: 140%;text-align: left;">Last-Modified: <span class="p">header, which we will soon cover in more detail, is critical for object caching, both in the local client and in network cache servers (also known as proxy servers). The  </span>Content-Length: <span class="p">header line indicates the number of bytes in the object being sent. The </span>Content-Type: <span class="p">header line indicates that the object in the entity body is HTML text. (The object type is officially indicated by the</span></p><p class="s30" style="padding-top: 3pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">Content-Type: <span class="p">header and not by the file extension.)</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark167" class="s124">Having looked at an example, let’s now examine the general format of a response message, which is shown in </a><a href="#bookmark167" class="a">Figure 2.</a>9<span class="p">. This general format of the response message matches the previous example of a</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">response message. Let’s say a few additional words about status codes and their phrases. The status</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">code and associated phrase indicate the result of the request. Some common status codes and associated phrases include:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_109.png"/></span></p><p class="s30" style="padding-top: 3pt;padding-left: 29pt;text-indent: 0pt;text-align: justify;">200 OK: <span class="p">Request succeeded and the information is returned in the response.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_110.png"/></span></p><p class="s30" style="padding-left: 27pt;text-indent: 2pt;line-height: 138%;text-align: justify;">301 Moved Permanently: <span class="p">Requested object has been permanently moved; the new URL is specified in </span>Location <span class="p">: header of the response message. The client software will automatically retrieve the new URL.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_111.png"/></span></p><p class="s30" style="padding-top: 3pt;padding-left: 26pt;text-indent: 2pt;line-height: 130%;text-align: left;">400 Bad Request: <span class="p">This is a generic error code indicating that the request could not be understood by the server.</span></p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;text-align: left;"><span><img width="612" height="337" alt="image" src="计算机网络自顶向下7th-en/Image_112.png"/></span></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><h2 style="padding-left: 27pt;text-indent: 0pt;text-align: justify;"><a name="bookmark167">Figure 2.9 General format of an HTTP response message</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_113.png"/></span></p><p class="s30" style="padding-top: 3pt;padding-left: 29pt;text-indent: 0pt;text-align: left;">404 Not Found: <span class="p">The requested document does not exist on this server.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_114.png"/></span></p><p class="s30" style="padding-left: 26pt;text-indent: 2pt;line-height: 130%;text-align: left;">505 HTTP Version Not Supported: <span class="p">The requested HTTP protocol version is not supported by the server.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="787" height="200" alt="image" src="计算机网络自顶向下7th-en/Image_115.png"/></span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">How would you like to see a real HTTP response message? This is highly recommended and very easy to do! First Telnet into your favorite Web server. Then type in a one-line request message for some object that is housed on the server. For example, if you have access to a command prompt, type:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Using Wireshark to investigate the HTTP protocol</p><p class="s30" style="padding-top: 4pt;padding-left: 32pt;text-indent: 0pt;text-align: left;"><a name="bookmark168">telnet gaia.cs.umass.edu 80</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">GET /kurose_ross/interactive/index.php HTTP/1.1 Host: gaia.cs.umass.edu</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="162" alt="image" src="计算机网络自顶向下7th-en/Image_116.png"/></span></p><p class="s37" style="padding-left: 5pt;text-indent: 0pt;line-height: 25pt;text-align: left;"><span class="p">(Press the carriage return twice after typing the last line.) This opens a TCP connection to port 80 of the </span>host<a href="http://cis.poly.edu/" class="s124" target="_blank"> </a><a href="http://cis.poly.edu/" class="s36" target="_blank">gaia.cs.umass.edu</a><span class="s42"> </span>and<span class="p"> then sends the HTTP request message. You should see a response</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">message that includes the base HTML file for the interactive homework problems for this textbook. If you’d rather just see the HTTP message lines and not receive the object itself, replace <span class="s30">GET </span>with <span class="s30">HEAD </span>.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section we discussed a number of header lines that can be used within HTTP request and response messages. The HTTP specification defines many, many more header lines that can be inserted by browsers, Web servers, and network cache servers. We have covered only a small number of the totality of header lines. We’ll cover a few more below and another small number when we discuss</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark177" class="s124">network Web caching in </a><a href="#bookmark177" class="a">Section 2.2.</a>5<a href="#bookmark848" class="s124">. A highly readable and comprehensive discussion of the HTTP protocol, including its headers and status codes, is given in </a><a href="#bookmark848" class="a">[Krishnamurthy </a>2001]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">How does a browser decide which header lines to include in a request message? How does a Web server decide which header lines to include in a response message? A browser will generate header lines as a function of the browser type and version (for example, an HTTP/1.0 browser will not generate any 1.1 header lines), the user configuration of the browser (for example, preferred language), and whether the browser currently has a cached, but possibly out-of-date, version of the object. Web servers behave similarly: There are different products, versions, and configurations, all of which influence which header lines are included in response messages.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">User-Server Interaction: Cookies</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We mentioned above that an HTTP server is stateless. This simplifies server design and has permitted engineers to develop high-performance Web servers that can handle thousands of simultaneous TCP connections. However, it is often desirable for a Web site to identify users, either because the server wishes to restrict user access or because it wants to serve content as a function of the user identity. For</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">these purposes, HTTP uses cookies. Cookies, defined in </a><a href="#bookmark848" class="a">[RFC </a>6265]<span class="p">, allow sites to keep track of users. Most major commercial Web sites use cookies today.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark170" class="s124">As shown in </a><a href="#bookmark170" class="a">Figure 2.1</a>0<span class="p">, cookie technology has four components: (1) a cookie header line in the HTTP response message; (2) a cookie header line in the HTTP request message; (3) a cookie file kept on the</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark170" class="s124">user’s end system and managed by the user’s browser; and (4) a back-end database at the Web site. Using </a><a href="#bookmark170" class="a">Figure 2.1</a>0<a href="http://amazon.com/" class="s124" target="_blank">, let’s walk through an example of how cookies work. Suppose Susan, who always accesses the Web using Internet Explorer from her home PC, contacts </a><a href="http://amazon.com/" class="a" target="_blank">Amazon.com</a> <span class="p">for the first time.</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Let us suppose that in the past she has already visited the eBay site. When the request comes into the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Amazon Web server, the server creates a unique identification number and creates an entry in its back- end database that is indexed by the identification number. The Amazon Web server then responds to Susan’s browser, including in the HTTP response a  <span class="s30">Set-cookie: </span>header, which contains the</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_117.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">identification number. For example, the header line might be:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 31pt;text-indent: 0pt;text-align: left;">Set-cookie: 1678</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">When Susan’s browser receives the HTTP response message, it sees the  <span class="s30">Set-cookie: </span>header. The browser then appends a line to the special cookie file that it manages. This line includes the hostname</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">of the server and the identification number in the <span class="s30">Set-cookie: </span>header. Note that the cookie file already has an entry for eBay, since Susan has visited that site in the past. As Susan continues to browse the Amazon site, each time she requests a Web page, her browser consults her cookie file,</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark169">extracts her identification number for this site, and puts a cookie header line that</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="801" height="748" alt="image" src="计算机网络自顶向下7th-en/Image_118.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark170">Figure 2.10 Keeping user state with cookies</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_119.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">includes the identification number in the HTTP request. Specifically, each of her HTTP requests to the Amazon server includes the header line:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 31pt;text-indent: 0pt;text-align: left;">Cookie: 1678</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this manner, the Amazon server is able to track Susan’s activity at the Amazon site. Although the Amazon Web site does not necessarily know Susan’s name, it knows exactly which pages user 1678 visited, in which order, and at what times! Amazon uses cookies to provide its shopping cart service— Amazon can maintain a list of all of Susan’s intended purchases, so that she can pay for them</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark171">collectively at the end of the session.</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">If Susan returns to Amazon’s site, say, one week later, her browser will continue to put the header line</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 6pt;text-indent: 2pt;line-height: 138%;text-align: left;">Cookie: 1678 <span class="p">in the request messages. Amazon also recommends products to Susan based on Web pages she has visited at Amazon in the past. If Susan also registers herself with Amazon— providing full name, e-mail address, postal address, and credit card information—Amazon can then</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">include this information in its database, thereby associating Susan’s name with her identification number (and all of the pages she has visited at the site in the past!). This is how Amazon and other e-commerce sites provide “one-click shopping”—when Susan chooses to purchase an item during a subsequent visit, she doesn’t need to re-enter her name, credit card number, or address.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">From this discussion we see that cookies can be used to identify a user. The first time a user visits a site, the user can provide a user identification (possibly his or her name). During the subsequent sessions, the browser passes a cookie header to the server, thereby identifying the user to the server. Cookies can thus be used to create a user session layer on top of stateless HTTP. For example, when a user logs in to a Web-based e-mail application (such as Hotmail), the browser sends cookie information to the server, permitting the server to identify the user throughout the user’s session with the application.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although cookies often simplify the Internet shopping experience for the user, they are controversial because they can also be considered as an invasion of privacy. As we just saw, using a combination of cookies and user-supplied account information, a Web site can learn a lot about a user and potentially</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">sell this information to a third party. Cookie Central </a><a href="#bookmark848" class="a">[Cookie Central 2016]</a> <span class="p">includes extensive information on the cookie controversy.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Web Caching</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">A </span>Web cache<span class="p">—also called a </span>proxy server<a href="#bookmark172" class="s124">—is a network entity that satisfies HTTP requests on the behalf of an origin Web server. The Web cache has its own disk storage and keeps copies of recently requested objects in this storage. As shown in </a><a href="#bookmark172" class="a">Figure 2.1</a>1<span class="p">, a user’s browser can be configured so that</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">all of the user’s HTTP requests are first directed to the Web cache. Once a browser is configured, each</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s38" style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="http://www.someschool.edu/campus.gif" class="s124" target="_blank">browser request for an object is first directed to the Web cache. As an example, suppose a browser is requesting the object  </a><a href="http://www.someschool.edu/campus.gif" class="s34" target="_blank">http://www.someschool.edu/campus.gif</a> <span class="p">. Here is what happens:</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l112"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The browser establishes a TCP connection to the Web cache and sends an HTTP request for the object to the Web cache.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The Web cache checks to see if it has a copy of the object stored locally. If it does, the Web cache returns the object within an HTTP response message to the client browser.</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;"><span><img width="428" height="305" alt="image" src="计算机网络自顶向下7th-en/Image_120.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;"><a name="bookmark172">Figure 2.11 Clients requesting objects through a Web cache</a></h2><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 138%;text-align: left;"><p class="s38" style="display: inline;"><a href="http://www.someschool.edu/" class="s124" target="_blank">If the Web cache does not have the object, the Web cache opens a TCP connection to the origin server, that is, to </a><a href="http://www.someschool.edu/" class="s34" target="_blank">www.someschool.edu</a> <span class="p">. The Web cache then sends an HTTP request for the object into the cache-to-server TCP connection. After receiving this request, the origin server sends the object within an HTTP response to the Web cache.</span></p></li><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">When the Web cache receives the object, it stores a copy in its local storage and sends a copy, within an HTTP response message, to the client browser (over the existing TCP connection</p></li></ol></li></ol></li></ol></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">between the client browser and the Web cache).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Note that a cache is both a server and a client at the same time. When it receives requests from and sends responses to a browser, it is a server. When it sends requests to and receives responses from an origin server, it is a client.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Typically a Web cache is purchased and installed by an ISP. For example, a university might install a cache on its campus network and configure all of the campus browsers to point to the cache. Or a major residential ISP (such as Comcast) might install one or more caches in its network and preconfigure its shipped browsers to point to the installed caches.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Web caching has seen deployment in the Internet for two reasons. First, a Web cache can substantially reduce the response time for a client request, particularly if the bottleneck bandwidth between the client and the origin server is much less than the bottleneck bandwidth between the client and the cache. If there is a high-speed connection between the client and the cache, as there often is, and if the cache has the requested object, then the cache will be able to deliver the object rapidly to the client. Second, as we will soon illustrate with an example, Web caches can substantially reduce traffic on an institution’s access link to the Internet. By reducing traffic, the institution (for example, a company or a university) does not have to upgrade bandwidth as quickly, thereby reducing costs. Furthermore, Web caches can</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">substantially reduce Web traffic in the Internet as a whole, thereby improving performance for all applications.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">To gain a deeper understanding of the benefits of caches, let’s consider an example in the context of</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark173" class="a">Figure 2.1</a>2<span class="p">. This figure shows two networks—the institutional network and the rest of the public Internet. The institutional network is a high-speed LAN. A router in the institutional network and a router in the Internet are connected by a 15 Mbps link. The origin servers are attached to the Internet but are</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">located all over the globe. Suppose that the average object size is 1 Mbits and that the average request rate from the institution’s browsers to the origin servers is 15 requests per second. Suppose that the HTTP request messages are negligibly small and thus create no traffic in the networks or in the access link (from institutional router to Internet router). Also suppose that the amount of time it takes from when</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark173" class="s124">the router on the Internet side of the access link in </a><a href="#bookmark173" class="a">Figure 2.12</a> <span class="p">forwards an HTTP request (within an IP datagram) until it receives the response (typically within many IP datagrams) is two seconds on average. Informally, we refer to this last delay as the “Internet delay.”</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="373" height="555" alt="image" src="计算机网络自顶向下7th-en/Image_121.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark173">Figure 2.12 Bottleneck between an institutional network and the Internet</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The total response time—that is, the time from the browser’s request of an object until its receipt of the object—is the sum of the LAN delay, the access delay (that is, the delay between the two routers), and</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark70" class="s124">the Internet delay. Let’s now do a very crude calculation to estimate this delay. The traffic intensity on the LAN (see </a><a href="#bookmark70" class="a">Section 1.4.</a>2<span class="p">) is</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">(15 requests/sec)<span class="s29">⋅</span>(1 Mbits/request)/(100 Mbps)=0.15</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">whereas the traffic intensity on the access link (from the Internet router to institution router) is</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">(15 requests/sec)<span class="s29">⋅</span>(1 Mbits/request)/(15 Mbps)=1</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark70" class="s124">A traffic intensity of 0.15 on a LAN typically results in, at most, tens of milliseconds of delay; hence, we can neglect the LAN delay. However, as discussed in </a><a href="#bookmark70" class="a">Section 1.4.</a>2<a href="#bookmark173" class="s124">, as the traffic intensity approaches 1 (as is the case of the access link in </a><a href="#bookmark173" class="a">Figure 2.1</a>2<span class="p">), the delay on a link becomes very large and grows</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">without bound. Thus, the average response time to satisfy requests is going to be on the order of</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">minutes, if not more, which is unacceptable for the institution’s users. Clearly something must be done.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">One possible solution is to increase the access rate from 15 Mbps to, say, 100 Mbps. This will lower the traffic intensity on the access link to 0.15, which translates to negligible delays between the two routers. In this case, the total response time will roughly be two seconds, that is, the Internet delay. But this solution also means that the institution must upgrade its access link from 15 Mbps to 100 Mbps, a costly proposition.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark174" class="s124">Now consider the alternative solution of not upgrading the access link but instead installing a Web cache in the institutional network. This solution is illustrated in </a><a href="#bookmark174" class="a">Figure 2.1</a>3<span class="p">. Hit rates—the fraction of requests</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">that are satisfied by a cache— typically range from 0.2 to 0.7 in practice. For illustrative purposes, let’s suppose that the cache provides a hit rate of 0.4 for this institution. Because the clients and the cache are connected to the same high-speed LAN, 40 percent of the requests will be satisfied almost immediately, say, within 10 milliseconds, by the cache. Nevertheless, the remaining 60 percent of the requests still need to be satisfied by the origin servers. But with only 60 percent of the requested objects passing through the access link, the traffic intensity on the access link is reduced from 1.0 to 0.6. Typically, a traffic intensity less than 0.8 corresponds to a small delay, say, tens of milliseconds, on a 15 Mbps link. This delay is negligible compared with the two-second Internet delay. Given these considerations, average delay therefore is</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">0.4<span class="s29">⋅</span>(0.01 seconds)+0.6<span class="s29">⋅</span>(2.01 seconds)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">which is just slightly greater than 1.2 seconds. Thus, this second solution provides an even lower response time than the first solution, and it doesn’t require the institution</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="450" height="601" alt="image" src="计算机网络自顶向下7th-en/Image_122.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark174">Figure 2.13 Adding a cache to the institutional network</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">to upgrade its link to the Internet. The institution does, of course, have to purchase and install a Web cache. But this cost is low—many caches use public-domain software that runs on inexpensive PCs.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Through the use of <span class="s20">Content Distribution Networks (CDNs)</span>, Web caches are increasingly playing an important role in the Internet. A CDN company installs many geographically distributed caches throughout the Internet, thereby localizing much of the traffic. There are shared CDNs (such as Akamai and Limelight) and dedicated CDNs (such as Google and Netflix). We will discuss CDNs in more detail</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark228" class="s124">in </a><a href="#bookmark228" class="a">Section 2.</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The Conditional GET</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark175">Although caching can reduce user-perceived response times, it introduces a new problem—the copy of an object residing in the cache may be stale. In other words, the object housed in the Web server may have been modified since the copy was cached at the client. Fortunately, HTTP has a mechanism that allows a cache to verify that its objects are up to date. This mechanism is called the </a><span class="s20">conditional GET</span>.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">An HTTP request message is a so-called conditional GET message if (1) the request message uses the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">GET <span class="p">method and (2) the request message includes an  </span>If-Modified-Since: <span class="p">header line.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="106" alt="image" src="计算机网络自顶向下7th-en/Image_123.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To illustrate how the conditional GET operates, let’s walk through an example. First, on the behalf of a requesting browser, a proxy cache sends a request message to a Web server:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 30pt;text-indent: 1pt;line-height: 148%;text-align: left;"><a href="http://www.exotiquecuisine.com/" class="s35" target="_blank">GET /fruit/kiwi.gif HTTP/1.1 Host: www.exotiquecuisine.com</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="246" alt="image" src="计算机网络自顶向下7th-en/Image_124.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Second, the Web server sends a response message with the requested object to the cache:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">HTTP/1.1 200 OK</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">Date: Sat, 3 Oct 2015 15:39:29</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">Server: Apache/1.3.0 (Unix)</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">Last-Modified: Wed, 9 Sep 2015 09:23:24 Content-Type: image/gif</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">(data data data data data ...)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="134" alt="image" src="计算机网络自顶向下7th-en/Image_125.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The cache forwards the object to the requesting browser but also caches the object locally. Importantly, the cache also stores the last-modified date along with the object. Third, one week later, another browser requests the same object via the cache, and the object is still in the cache. Since this object may have been modified at the Web server in the past week, the cache performs an up-to-date check by issuing a conditional GET. Specifically, the cache sends:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 30pt;text-indent: 1pt;line-height: 148%;text-align: left;"><a href="http://www.exotiquecuisine.com/" class="s35" target="_blank">GET /fruit/kiwi.gif HTTP/1.1 Host: www.exotiquecuisine.com</a></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">If-modified-since: Wed, 9 Sep 2015 09:23:24</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 140%;text-align: left;">Note that the value of the <span class="s30">If-modified-since: </span>header line is exactly equal to the value of the <span class="s30">Last-Modified: </span>header line that was sent by the server one week ago. This conditional GET is telling the server to send the object only if the object has been modified since the specified date. Suppose the object has not been modified since 9 Sep 2015 09:23:24. Then, fourth, the Web server</p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">sends a response message to the cache:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="782" height="11" alt="image" src="计算机网络自顶向下7th-en/Image_126.png"/></span></p><p class="s30" style="padding-top: 3pt;padding-left: 30pt;text-indent: 1pt;line-height: 148%;text-align: left;"><a name="bookmark176">HTTP/1.1 304 Not Modified Date: Sat, 10 Oct 2015 15:39:29</a><a name="bookmark177">&zwnj;</a></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="181" alt="image" src="计算机网络自顶向下7th-en/Image_127.png"/></span></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 296%;text-align: left;">Server: Apache/1.3.0 (Unix) (empty entity body)</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark178">We see that in response to the conditional GET, the Web server still sends a response message but does not include the requested object in the response message. Including the requested object would only waste bandwidth and increase user-perceived response time, particularly if the object is large. Note</a></p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">that this last response message has <span class="s30">304 Not Modified </span>in the status line, which tells the cache that it can go ahead and forward its (the proxy cache’s) cached copy of the object to the requesting browser.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">This ends our discussion of HTTP, the first Internet protocol (an application-layer protocol) that we’ve studied in detail. We’ve seen the format of HTTP messages and the actions taken by the Web client and server as these messages are sent and received. We’ve also studied a bit of the Web’s application infrastructure, including caches, cookies, and back-end databases, all of which are tied in some way to the HTTP protocol.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l113"><ol id="l114"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark179">Electronic Mail in the Internet</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">Electronic mail has been around since the beginning of the Internet. It was the most popular application when the Internet was in its infancy </a><a href="#bookmark848" class="a">[Segaller </a>1998]<span class="p">, and has become more elaborate and powerful over</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the years. It remains one of the Internet’s most important and utilized applications.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">As with ordinary postal mail, e-mail is an asynchronous communication medium—people send and read messages when it is convenient for them, without having to coordinate with other people’s schedules. In contrast with postal mail, electronic mail is fast, easy to distribute, and inexpensive. Modern e-mail has many powerful features, including messages with attachments, hyperlinks, HTML-formatted text, and embedded photos.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section, we examine the application-layer protocols that are at the heart of Internet e-mail. But before we jump into an in-depth discussion of these protocols, let’s take a high-level view of the Internet mail system and its key components.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark180" class="a">Figure 2.14</a> <span class="p">presents a high-level view of the Internet mail system. We see from this diagram that it has three major components: </span>user agents<span class="p">, </span>mail servers<span class="p">, and the </span>Simple Mail Transfer Protocol (SMTP)<span class="p">. We now describe each of these components in the context of a sender, Alice, sending an e-mail</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">message to a recipient, Bob. User agents allow users to read, reply to, forward, save, and compose messages. Microsoft Outlook and Apple Mail are examples of user agents for e-mail. When Alice is finished composing her message, her user agent sends the message to her mail server, where the message is placed in the mail server’s outgoing message queue. When Bob wants to read a message, his user agent retrieves the message from his mailbox in his mail server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Mail servers form the core of the e-mail infrastructure. Each recipient, such as Bob, has a <span class="s20">mailbox</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">located in one of the mail servers. Bob’s mailbox manages and</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="706" height="620" alt="image" src="计算机网络自顶向下7th-en/Image_128.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark180">Figure 2.14 A high-level view of the Internet e-mail system</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">maintains the messages that have been sent to him. A typical message starts its journey in the sender’s user agent, travels to the sender’s mail server, and travels to the recipient’s mail server, where it is deposited in the recipient’s mailbox. When Bob wants to access the messages in his mailbox, the mail server containing his mailbox authenticates Bob (with usernames and passwords). Alice’s mail server must also deal with failures in Bob’s mail server. If Alice’s server cannot deliver mail to Bob’s server, Alice’s server holds the message in a <span class="s20">message queue </span>and attempts to transfer the message later. Reattempts are often done every 30 minutes or so; if there is no success after several days, the server removes the message and notifies the sender (Alice) with an e-mail message.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark181">SMTP is the principal application-layer protocol for Internet electronic mail. It uses the reliable data transfer service of TCP to transfer mail from the sender’s mail server to the recipient’s mail server. As with most application-layer protocols, SMTP has two sides: a client side, which executes on the sender’s mail server, and a server side, which executes on the recipient’s mail server. Both the client and server sides of SMTP run on every mail server. When a mail server sends mail to other mail servers, it acts as an SMTP client. When a mail server receives mail from other mail servers, it acts as an SMTP server.</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l115"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">SMTP</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">SMTP, defined in RFC 5321, is at the heart of Internet electronic mail. As mentioned above, SMTP transfers messages from senders’ mail servers to the recipients’ mail servers. SMTP is much older than HTTP. (The original SMTP RFC dates back to 1982, and SMTP was around long before that.) Although SMTP has numerous wonderful qualities, as evidenced by its ubiquity in the Internet, it is nevertheless a legacy technology that possesses certain archaic characteristics. For example, it restricts the body (not just the headers) of all mail messages to simple 7-bit ASCII. This restriction made sense in the early 1980s when transmission capacity was scarce and no one was e-mailing large attachments or large image, audio, or video files. But today, in the multimedia era, the 7-bit ASCII restriction is a bit of a pain</p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark176" class="s124">—it requires binary multimedia data to be encoded to ASCII before being sent over SMTP; and it requires the corresponding ASCII message to be decoded back to binary after SMTP transport. Recall from </a><a href="#bookmark176" class="a">Section 2.2</a> <span class="p">that HTTP does not require multimedia data to be ASCII encoded before transfer.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">To illustrate the basic operation of SMTP, let’s walk through a common scenario. Suppose Alice wants to send Bob a simple ASCII message.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l116"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 131%;text-align: left;"><p class="s42" style="display: inline;"><a href="mailto:bob@someschool.edu" class="s124" target="_blank">Alice invokes her user agent for e-mail, provides Bob’s e-mail address (for example, </a><a href="mailto:bob@someschool.edu" class="s36" target="_blank">bob@someschool.edu</a> <span class="s37">),</span><span class="p"> composes a message, and instructs the user agent to send the message.</span></p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Alice’s user agent sends the message to her mail server, where it is placed in a message queue.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The client side of SMTP, running on Alice’s mail server, sees the message in the message queue. It opens a TCP connection to an SMTP server, running on Bob’s mail server.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">After some initial SMTP handshaking, the SMTP client sends Alice’s message into the TCP connection.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">At Bob’s mail server, the server side of SMTP receives the message. Bob’s mail server then places the message in Bob’s mailbox.</p></li><li style="padding-top: 3pt;padding-left: 5pt;text-indent: 24pt;line-height: 269%;text-align: left;"><p class="s20" style="display: inline;"><a href="#bookmark183" class="s124">Bob invokes his user agent to read the message at his convenience. The scenario is summarized in </a><a href="#bookmark183" class="a">Figure 2.1</a>5<span class="p">.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark182">It is important to observe that SMTP does not normally use intermediate mail servers for sending mail, even when the two mail servers are located at opposite ends of the world. If Alice’s server is in Hong Kong and Bob’s server is in St. Louis, the TCP</a></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="788" height="250" alt="image" src="计算机网络自顶向下7th-en/Image_129.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark183">Figure 2.15 Alice sends a message to Bob</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">connection is a direct connection between the Hong Kong and St. Louis servers. In particular, if Bob’s mail server is down, the message remains in Alice’s mail server and waits for a new attempt—the message does not get placed in some intermediate mail server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now take a closer look at how SMTP transfers a message from a sending mail server to a receiving mail server. We will see that the SMTP protocol has many similarities with protocols that are used for face-to-face human interaction. First, the client SMTP (running on the sending mail server host) has TCP establish a connection to port 25 at the server SMTP (running on the receiving mail server host). If the server is down, the client tries again later. Once this connection is established, the server and client perform some application-layer handshaking—just as humans often introduce themselves before transferring information from one to another, SMTP clients and servers introduce themselves before transferring information. During this SMTP handshaking phase, the SMTP client indicates the e- mail address of the sender (the person who generated the message) and the e-mail address of the recipient. Once the SMTP client and server have introduced themselves to each other, the client sends the message. SMTP can count on the reliable data transfer service of TCP to get the message to the server without errors. The client then repeats this process over the same TCP connection if it has other messages to send to the server; otherwise, it instructs TCP to close the connection.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s37" style="padding-left: 6pt;text-indent: 0pt;line-height: 160%;text-align: left;"><span class="p">Let’s next take a look at an example transcript of messages exchanged between an SMTP client (C) </span>and<a href="http://crepes.fr/" class="s124" target="_blank"> an SMTP server (S). The hostname of the client is </a><a href="http://crepes.fr/" class="s36" target="_blank">crepes.fr</a><span class="s42"> </span>and<span class="p"> the hostname of the server is</span></p><p style="padding-left: 8pt;text-indent: 0pt;line-height: 12pt;text-align: left;"><span class="s38">hamburger.edu </span>. The ASCII text lines prefaced with <span class="s30">C: </span>are exactly the lines the client sends into its</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="107" alt="image" src="计算机网络自顶向下7th-en/Image_130.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">TCP socket, and the ASCII text lines prefaced with <span class="s30">S: </span>are exactly the lines the server sends into its TCP socket. The following transcript begins as soon as the TCP connection is established.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 1pt;line-height: 148%;text-align: left;">S:  220 hamburger.edu C:  HELO crepes.fr</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;"><a name="bookmark184">S:  250 Hello crepes.fr, pleased to meet you</a></p><p style="padding-top: 3pt;padding-left: 30pt;text-indent: 0pt;text-align: left;"><a href="mailto:alice@crepes.fr" class="s35" target="_blank">C:  MAIL FROM: &lt;alice@crepes.fr&gt;</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;"><a href="mailto:alice@crepes.fr" class="s35" target="_blank">S:  250 alice@crepes.fr</a><a href="mailto:bob@hamburger.edu" class="s35" target="_blank"> ... Sender ok C:  RCPT TO: &lt;bob@hamburger.edu&gt;</a></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;"><a href="mailto:bob@hamburger.edu" class="s35" target="_blank">S:  250 bob@hamburger.edu</a> ... Recipient ok C:  DATA</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">S:  354 Enter mail, end with ”.” on a line by itself C:  Do you like ketchup?</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">C:  How about pickles? C:  .</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">S:  250 Message accepted for delivery C:  QUIT</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">S:  221 hamburger.edu closing connection</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="365" alt="image" src="计算机网络自顶向下7th-en/Image_131.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;">In the example above, the client sends a message (“ <span class="s30">Do you like ketchup? How about </span><span class="s39">pickles?</span><span class="s30"> </span><a href="http://crepes.fr/" class="s124" target="_blank">”) from mail server </a><a href="http://crepes.fr/" class="s36" target="_blank">crepes.fr</a><span class="s42"> </span><span class="s37">to</span> mail server <span class="s38">hamburger.edu </span>. As part of the dialogue, the client issued five commands: <span class="s30">HELO </span>(an abbreviation for HELLO), <span class="s30">MAIL FROM </span>, <span class="s30">RCPT TO </span>, <span class="s30">DATA </span>, and <span class="s30">QUIT </span>. These commands are self-explanatory. The client also sends a line consisting of a single period, which indicates the end of the message to the server. (In ASCII jargon, each message ends with</p><p class="s30" style="padding-top: 3pt;padding-left: 6pt;text-indent: 2pt;line-height: 138%;text-align: left;">CRLF.CRLF <span class="p">, where </span>CR <span class="p">and </span>LF <span class="p">stand for carriage return and line feed, respectively.) The server issues replies to each command, with each reply having a reply code and some (optional) English- language explanation. We mention here that SMTP uses persistent connections: If the sending mail</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;">server has several messages to send to the same receiving mail server, it can send all of the messages over the same TCP connection. For each message, the client begins the process with a new <span class="s30">MAIL</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 14pt;text-align: left;"><span class="s39">FROM:</span><a href="http://crepes.fr/" class="s35" target="_blank"> </a><a href="http://crepes.fr/" class="s36" target="_blank">crepes.fr</a><span class="s42"> </span><span class="s37">,</span> designates the end of message with an isolated period, and issues <span class="s30">QUIT </span>only</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">after all messages have been sent.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_132.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">It is highly recommended that you use Telnet to carry out a direct dialogue with an SMTP server. To do this, issue</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">telnet serverName 25</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">where <span class="s30">serverName </span>is the name of a local mail server. When you do this, you are simply establishing a TCP connection between your local host and the mail server. After typing this line, you should</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 140%;text-align: left;">immediately receive the <span class="s30">220 </span>reply from the server. Then issue the SMTP commands <span class="s30">HELO </span>, <span class="s30">MAIL FROM </span>, <span class="s30">RCPT TO </span>, <span class="s30">DATA </span>, <span class="s30">CRLF.CRLF </span>, and <span class="s30">QUIT </span>at the appropriate times. It is also highly recommended that you do Programming Assignment 3 at the end of this chapter. In that assignment, you’ll build a simple user agent that implements the client side of SMTP. It will allow you to send an e-</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark185">mail message to an arbitrary recipient via a local mail server.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark186">Comparison with HTTP</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now briefly compare SMTP with HTTP. Both protocols are used to transfer files from one host to another: HTTP transfers files (also called objects) from a Web server to a Web client (typically a browser); SMTP transfers files (that is, e-mail messages) from one mail server to another mail server. When transferring the files, both persistent HTTP and SMTP use persistent connections. Thus, the two protocols have common characteristics. However, there are important differences. First, HTTP is mainly a <span class="s20">pull protocol</span>—someone loads information on a Web server and users use HTTP to pull the information from the server at their convenience. In particular, the TCP connection is initiated by the machine that wants to receive the file. On the other hand, SMTP is primarily a <span class="s20">push protocol</span>—the sending mail server pushes the file to the receiving mail server. In particular, the TCP connection is initiated by the machine that wants to send the file.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">A second difference, which we alluded to earlier, is that SMTP requires each message, including the body of each message, to be in 7-bit ASCII format. If the message contains characters that are not 7-bit ASCII (for example, French characters with accents) or contains binary data (such as an image file), then the message has to be encoded into 7-bit ASCII. HTTP data does not impose this restriction.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark176" class="s124">A third important difference concerns how a document consisting of text and images (along with possibly other media types) is handled. As we learned in </a><a href="#bookmark176" class="a">Section 2.</a>2<span class="p">, HTTP encapsulates each object in its own</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">HTTP response message. SMTP places all of the message’s objects into one message.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Mail Message Formats</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">When Alice writes an ordinary snail-mail letter to Bob, she may include all kinds of peripheral header information at the top of the letter, such as Bob’s address, her own return address, and the date. Similarly, when an e-mail message is sent from one person to another, a header containing peripheral information precedes the body of the message itself. This peripheral information is contained in a series of header lines, which are defined in RFC 5322. The header lines and the body of the message are</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">separated by a blank line (that is, by <span class="s30">CRLF </span>). RFC 5322 specifies the exact format for mail header lines as well as their semantic interpretations. As with HTTP, each header line contains readable text, consisting of a keyword followed by a colon followed by a value. Some of the keywords are required and</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;">others are optional. Every header must have a <span class="s30">From: </span>header line and a <span class="s30">To: </span>header line; a header may include a <span class="s30">Subject: </span>header line as well as other optional header lines. It is important to note that these header lines are <i>different </i><a href="#bookmark196" class="s124">from the SMTP commands we studied in </a><a href="#bookmark196" class="a">Section 2.4.1</a><span class="s20"> </span>(even though</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a name="bookmark187">they contain some common words such as “</a><i>from</i>” and “<i>to</i>”). The commands in that section were part of the SMTP handshaking protocol; the header lines examined in this section are part of the mail message itself.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="134" alt="image" src="计算机网络自顶向下7th-en/Image_133.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark188">A typical message header looks like this:</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 29pt;text-indent: 1pt;line-height: 148%;text-align: left;"><a href="mailto:alice@crepes.fr" class="s35" target="_blank">From: </a><a href="mailto:bob@hamburger.edu" class="s35" target="_blank">alice@crepes.fr To: bob@hamburger.edu</a></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">Subject: Searching for the meaning of life.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">After the message header, a blank line follows; then the message body (in ASCII) follows. You should use Telnet to send a message to a mail server that contains some header lines, including the <span class="s30">Subject: </span>header line. To do this, issue <span class="s30">telnet serverName 25, </span><a href="#bookmark196" class="s124">as discussed in </a><a href="#bookmark196" class="a">Section 2.4.</a><span class="s20">1</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Mail Access Protocols</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Once SMTP delivers the message from Alice’s mail server to Bob’s mail server, the message is placed in Bob’s mailbox. Throughout this discussion we have tacitly assumed that Bob reads his mail by logging onto the server host and then executing a mail reader that runs on that host. Up until the early 1990s this was the standard way of doing things. But today, mail access uses a client-server architecture—the typical user reads e-mail with a client that executes on the user’s end system, for example, on an office PC, a laptop, or a smartphone. By executing a mail client on a local PC, users enjoy a rich set of features, including the ability to view multimedia messages and attachments.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Given that Bob (the recipient) executes his user agent on his local PC, it is natural to consider placing a mail server on his local PC as well. With this approach, Alice’s mail server would dialogue directly with Bob’s PC. There is a problem with this approach, however. Recall that a mail server manages mailboxes and runs the client and server sides of SMTP. If Bob’s mail server were to reside on his local PC, then Bob’s PC would have to remain always on, and connected to the Internet, in order to receive new mail, which can arrive at any time. This is impractical for many Internet users. Instead, a typical user runs a user agent on the local PC but accesses its mailbox stored on an always-on shared mail server. This mail server is shared with other users and is typically maintained by the user’s ISP (for example, university or company).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">Now let’s consider the path an e-mail message takes when it is sent from Alice to Bob. We just learned that at some point along the path the e-mail message needs to be deposited in Bob’s mail server. This could be done simply by having Alice’s user agent send the message directly to Bob’s mail server. And</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark190" class="s124">this could be done with SMTP—indeed, SMTP has been designed for pushing e-mail from one host to another. However, typically the sender’s user agent does not dialogue directly with the recipient’s mail server. Instead, as shown in </a><a href="#bookmark190" class="a">Figure 2.1</a>6<span class="p">, Alice’s user agent uses SMTP to push the e-mail message</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: justify;">into her mail server, then Alice’s mail server uses SMTP (as an SMTP client) to relay the e-mail</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark189">message to Bob’s mail server. Why the two-step procedure? Primarily because without relaying through Alice’s mail server, Alice’s user agent doesn’t have any recourse to an unreachable destination</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="785" height="153" alt="image" src="计算机网络自顶向下7th-en/Image_134.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark190">Figure 2.16 E-mail protocols and their communicating entities</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">mail server. By having Alice first deposit the e-mail in her own mail server, Alice’s mail server can repeatedly try to send the message to Bob’s mail server, say every 30 minutes, until Bob’s mail server becomes operational. (And if Alice’s mail server is down, then she has the recourse of complaining to her system administrator!) The SMTP RFC defines how the SMTP commands can be used to relay a message across multiple SMTP servers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">But there is still one missing piece to the puzzle! How does a recipient like Bob, running a user agent on his local PC, obtain his messages, which are sitting in a mail server within Bob’s ISP? Note that Bob’s user agent can’t use SMTP to obtain the messages because obtaining the messages is a pull operation, whereas SMTP is a push protocol. The puzzle is completed by introducing a special mail access protocol that transfers messages from Bob’s mail server to his local PC. There are currently a number of popular mail access protocols, including <span class="s20">Post Office Protocol—Version 3 (POP3)</span>, <span class="s20">Internet Mail Access Protocol (IMAP)</span>, and HTTP.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark190" class="a">Figure 2.16</a> <span class="p">provides a summary of the protocols that are used for Internet mail: SMTP is used to transfer mail from the sender’s mail server to the recipient’s mail server; SMTP is also used to transfer mail from the sender’s user agent to the sender’s mail server. A mail access protocol, such as POP3, is</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">used to transfer mail from the recipient’s mail server to the recipient’s user agent.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">POP3</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">POP3 is an extremely simple mail access protocol. It is defined in </a><a href="#bookmark848" class="a">[RFC </a>1939]<span class="p">, which is short and quite readable. Because the protocol is so simple, its functionality is rather limited. POP3 begins when the user agent (the client) opens a TCP connection to the mail server (the server) on port 110. With the TCP</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">connection established, POP3 progresses through three phases: authorization, transaction, and update. During the first phase, authorization, the user agent sends a username and a password (in the clear) to authenticate the user. During the second phase, transaction, the user agent retrieves messages; also during this phase, the user agent can mark messages for deletion, remove deletion marks, and obtain</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">mail statistics. The third phase, update, occurs after the client has issued the <span class="s30">quit </span>command, ending the POP3 session; at this time, the mail server deletes the messages that were marked for deletion.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a name="bookmark191">In a POP3 transaction, the user agent issues commands, and the server responds to each command with a reply. There are two possible responses:  </a><span class="s30">+OK </span>(sometimes followed by server-to-client data), used by the server to indicate that the previous command was fine; and <span class="s30">-ERR </span>, used by the server to</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">indicate that something was wrong with the previous command.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">The authorization phase has two principal commands: <span class="s30">user &lt;username&gt; </span>and <span class="s30">pass &lt;password&gt; </span>. To illustrate these two commands, we suggest that you Telnet directly into a POP3 server, using port</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="218" alt="image" src="计算机网络自顶向下7th-en/Image_135.png"/></span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">110, and issue these commands. Suppose that <span class="s30">mailServer </span>is the name of your mail server. You will see something like:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 31pt;text-indent: 0pt;text-align: left;">telnet mailServer 110</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;line-height: 148%;text-align: left;">+OK POP3 server ready user bob</p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">+OK</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">pass hungry</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">+OK user successfully logged on</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">If you misspell a command, the POP3 server will reply with an <span class="s30">-ERR </span>message.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now let’s take a look at the transaction phase. A user agent using POP3 can often be configured (by the user) to “download and delete” or to “download and keep.” The sequence of commands issued by a POP3 user agent depends on which of these two modes the user agent is operating in. In the download-</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="119" alt="image" src="计算机网络自顶向下7th-en/Image_136.png"/></span></p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">and-delete mode, the user agent will issue the <span class="s30">list </span>, <span class="s30">retr </span>, and <span class="s30">dele </span>commands. As an example, suppose the user has two messages in his or her mailbox. In the dialogue below, <span class="s30">C: </span>(standing for client) is the user agent and <span class="s30">S: </span>(standing for server) is the mail server. The transaction will look something like:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 1pt;line-height: 148%;text-align: left;">C: list S: 1 498</p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">S: 2 912</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="439" alt="image" src="计算机网络自顶向下7th-en/Image_137.png"/></span></p><p class="s30" style="padding-top: 4pt;padding-left: 29pt;text-indent: 0pt;text-align: left;">S: .</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">C: retr 1</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">S: (blah blah ...</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;line-height: 148%;text-align: left;">S: ................. S: ..........blah) S: .</p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">C: dele 1</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">C: retr 2</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">S: (blah blah ...</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;line-height: 148%;text-align: left;">S: ................. S: ..........blah) S: .</p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;line-height: 148%;text-align: left;">C: dele 2 C: quit</p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">S: +OK POP3 server signing off</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">The user agent first asks the mail server to list the size of each of the stored messages. The user agent then retrieves and deletes each message from the server. Note that after the authorization phase, the user agent employed only four commands: <span class="s30">list </span>, <span class="s30">retr </span>, <span class="s30">dele </span>, and <span class="s30">quit </span>. The syntax for these</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 14pt;text-align: left;">commands is defined in RFC 1939. After processing the <span class="s30">quit </span>command, the POP3 server enters the</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">update phase and removes messages 1 and 2 from the mailbox.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A problem with this download-and-delete mode is that the recipient, Bob, may be nomadic and may want to access his mail messages from multiple machines, for example, his office PC, his home PC, and his portable computer. The download-and-delete mode partitions Bob’s mail messages over these three machines; in particular, if Bob first reads a message on his office PC, he will not be able to reread the message from his portable at home later in the evening. In the download-and-keep mode, the user agent leaves the messages on the mail server after downloading them. In this case, Bob can reread messages from different machines; he can access a message from work and access it again later in the week from home.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">During a POP3 session between a user agent and the mail server, the POP3 server maintains some state information; in particular, it keeps track of which user messages have been marked deleted. However, the POP3 server does not carry state information across POP3 sessions. This lack of state information across sessions greatly simplifies the implementation of a POP3 server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">IMAP</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">With POP3 access, once Bob has downloaded his messages to the local machine, he can create mail</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark192">folders and move the downloaded messages into the folders. Bob can then delete messages, move messages across folders, and search for messages (by sender name or subject). But this paradigm— namely, folders and messages in the local machine—poses a problem for the nomadic user, who would prefer to maintain a folder hierarchy on a remote server that can be accessed from any computer. This is not possible with POP3—the POP3 protocol does not provide any means for a user to create remote folders and assign messages to folders.</a><a name="bookmark193">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">To solve this and other problems, the IMAP protocol, defined in </a><a href="#bookmark848" class="a">[RFC </a>3501]<span class="p">, was invented. Like POP3, IMAP is a mail access protocol. It has many more features than POP3, but it is also significantly more complex. (And thus the client and server side implementations are significantly more complex.)</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark194">An IMAP server will associate each message with a folder; when a message first arrives at the server, it is associated with the recipient’s INBOX folder. The recipient can then move the message into a new, user-created folder, read the message, delete the message, and so on. The IMAP protocol provides commands to allow users to create folders and move messages from one folder to another. IMAP also provides commands that allow users to search remote folders for messages matching specific criteria. Note that, unlike POP3, an IMAP server maintains user state information across IMAP sessions—for example, the names of the folders and which messages are associated with which folders.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Another important feature of IMAP is that it has commands that permit a user agent to obtain components of messages. For example, a user agent can obtain just the message header of a message or just one part of a multipart MIME message. This feature is useful when there is a low-bandwidth connection (for example, a slow-speed modem link) between the user agent and its mail server. With a low-bandwidth connection, the user may not want to download all of the messages in its mailbox, particularly avoiding long messages that might contain, for example, an audio or video clip.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Web-Based E-Mail</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">More and more users today are sending and accessing their e-mail through their Web browsers. Hotmail introduced Web-based access in the mid 1990s. Now Web-based e-mail is also provided by Google, Yahoo!, as well as just about every major university and corporation. With this service, the user agent is an ordinary Web browser, and the user communicates with its remote mailbox via HTTP. When a recipient, such as Bob, wants to access a message in his mailbox, the e-mail message is sent from Bob’s mail server to Bob’s browser using the HTTP protocol rather than the POP3 or IMAP protocol. When a sender, such as Alice, wants to send an e-mail message, the e-mail message is sent from her browser to her mail server over HTTP rather than over SMTP. Alice’s mail server, however, still sends messages to, and receives messages from, other mail servers using SMTP.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l117"><ol id="l118"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark195">DNS—The Internet’s Directory Service</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We human beings can be identified in many ways. For example, we can be identified by the names that appear on our birth certificates. We can be identified by our social security numbers. We can be identified by our driver’s license numbers. Although each of these identifiers can be used to identify people, within a given context one identifier may be more appropriate than another. For example, the computers at the IRS (the infamous tax-collecting agency in the United States) prefer to use fixed-length social security numbers rather than birth certificate names. On the other hand, ordinary people prefer the more mnemonic birth certificate names rather than social security numbers. (Indeed, can you imagine saying, “Hi. My name is 132-67-9875. Please meet my husband, 178-87-1146.”)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Just as humans can be identified in many ways, so too can Internet hosts. One identifier for a host is its</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s23" style="padding-left: 5pt;text-indent: 0pt;line-height: 131%;text-align: left;">hostnam<span class="s20">e</span><a href="http://www.facebook.com/" class="s124" target="_blank">. Hostnames—such as  </a><a href="http://www.facebook.com/" class="s34" target="_blank">www.facebook.com</a><a href="http://www.facebook.com/" class="s35" target="_blank">,</a><a href="http://www.google.com/" class="s35" target="_blank"> </a><a href="http://www.google.com/" class="s34" target="_blank">www.google.com</a><span class="s38"> </span><a href="http://gaia.cs.umass.edu/" class="s124" target="_blank">, </a><a href="http://gaia.cs.umass.edu/" class="s36" target="_blank">gaia.cs.umass.edu</a><span class="s42"> </span><span class="s37">—are</span><span class="p"> mnemonic and are therefore appreciated by humans. However, hostnames provide little, if any, information about the location within the Internet of the host. (A</span></p><p class="s37" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 124%;text-align: left;">hostname<a href="http://www.eurecom.fr/" class="s124" target="_blank"> such as </a><a href="http://www.eurecom.fr/" class="s36" target="_blank">www.eurecom.fr</a><span class="s42"> </span>,<span class="p"> which ends with the country code </span><span class="s30">.fr </span><span class="p">, tells us that the host is probably in France, but doesn’t say much more.) Furthermore, because hostnames can consist of</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">variable-length alphanumeric characters, they would be difficult to process by routers. For these reasons, hosts are also identified by so-called <span class="s20">IP addresses</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark368" class="s124">We discuss IP addresses in some detail in </a><a href="#bookmark368" class="a">Chapter </a>4<span class="p">, but it is useful to say a few brief words about them now. An IP address consists of four bytes and has a rigid hierarchical structure. An IP address</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">looks like <span class="s30">121.7.106.83 </span>, where each period separates one of the bytes expressed in decimal notation from 0 to 255. An IP address is hierarchical because as we scan the address from left to right, we obtain more and more specific information about where the host is located in the Internet (that is,</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">within which network, in the network of networks). Similarly, when we scan a postal address from bottom to top, we obtain more and more specific information about where the addressee is located.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l119"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Services Provided by DNS</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We have just seen that there are two ways to identify a host—by a hostname and by an IP address. People prefer the more mnemonic hostname identifier, while routers prefer fixed-length, hierarchically structured IP addresses. In order to reconcile these preferences, we need a directory service that</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">translates hostnames to IP addresses. This is the main task of the Internet’s <b>domain name system (DNS)</b>. The DNS is (1) a distributed database implemented in a hierarchy of <b>DNS servers</b>, and (2) an</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">application-layer protocol that allows hosts to query the distributed database. The DNS servers are often</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">UNIX machines running the Berkeley Internet Name Domain (BIND) software </a><a href="#bookmark848" class="a">[BIND </a>2016]<span class="p">. The DNS protocol runs over UDP and uses port 53.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">DNS is commonly employed by other application-layer protocols—including HTTP and SMTP to translate user-supplied hostnames to IP addresses. As an example, consider what happens when a browser (that is, an HTTP client), running on some user’s host, requests the URL</p><p class="s38" style="padding-top: 2pt;padding-left: 5pt;text-indent: 2pt;line-height: 145%;text-align: justify;"><a href="http://www.someschool.edu/index.html" class="s34" target="_blank">www.someschool.edu/index.html</a> <a href="http://www.someschool.edu/" class="s124" target="_blank">. In order for the user’s host to be able to send an HTTP request message to the Web server </a><a href="http://www.someschool.edu/" class="s34" target="_blank">www.someschool.edu</a> <a href="http://www.someschool.edu/" class="s124" target="_blank">, the user’s host must first obtain the IP address of </a><a href="http://www.someschool.edu/" class="s34" target="_blank">www.someschool.edu</a> <span class="p">. This is done as follows.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l120"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The same user machine runs the client side of the DNS application.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 128%;text-align: left;"><p class="s38" style="display: inline;"><a href="http://www.someschool.edu/" class="s124" target="_blank">The browser extracts the hostname, </a><a href="http://www.someschool.edu/" class="s34" target="_blank">www.someschool.edu</a> <span class="p">, from the URL and passes the hostname to the client side of the DNS application.</span></p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The DNS client sends a query containing the hostname to a DNS server.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The DNS client eventually receives a reply, which includes the IP address for the hostname.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Once the browser receives the IP address from DNS, it can initiate a TCP connection to the HTTP server process located at port 80 at that IP address.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We see from this example that DNS adds an additional delay—sometimes substantial—to the Internet applications that use it. Fortunately, as we discuss below, the desired IP address is often cached in a “nearby” DNS server, which helps to reduce DNS network traffic as well as the average DNS delay.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">DNS provides a few other important services in addition to translating hostnames to IP addresses:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_138.png"/></span></p><p class="s37" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 142%;text-align: left;"><span class="s23">Host</span><span class="s20"> aliasing. </span><span class="p">A host with a complicated hostname can have one or more alias names. For example, a hostname such as  </span><span class="s38">relay1.west-coast.enterprise.com </span><span class="p">could have, say, two </span>aliases<a href="http://enterprise.com/" class="s124" target="_blank"> such as  </a><a href="http://enterprise.com/" class="s36" target="_blank">enterprise.com</a><span class="s42"> </span>and<a href="http://www.enterprise.com/" class="s124" target="_blank">  </a><a href="http://www.enterprise.com/" class="s36" target="_blank">www.enterprise.com</a><span class="s42"> </span>.<span class="p"> In this case, the hostname</span></p><p style="padding-left: 29pt;text-indent: 0pt;line-height: 15pt;text-align: left;"><span class="s38">relay1.west-coast.enterprise.com </span>is said to be a <span class="s23">canonical</span><span class="s20"> hostname</span>. Alias hostnames,</p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">when present, are typically more mnemonic than canonical hostnames. DNS can be invoked by an application to obtain the canonical hostname for a supplied alias hostname as well as the IP address of the host.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_139.png"/></span></p><p class="s23" style="padding-left: 27pt;text-indent: 0pt;line-height: 126%;text-align: left;">Mail<span class="s20"> server aliasing. </span><span class="p">For obvious reasons, it is highly desirable that e-mail addresses be mnemonic. For example, if Bob has an account with Yahoo Mail, Bob’s e-mail address might be as simple as</span></p><p class="s42" style="padding-top: 4pt;padding-left: 27pt;text-indent: 2pt;line-height: 139%;text-align: left;"><a href="mailto:bob@hotmail.com" class="s36" target="_blank">bob@yahoo.mail</a> <span class="s37">.</span><a href="http://hotmail.com/" class="s124" target="_blank"> However, the hostname of the Yahoo mail server is more complicated and much less mnemonic than simply  </a><a href="http://hotmail.com/" class="s36" target="_blank">yahoo.com</a> <span class="s37">(for</span><span class="p"> example, the canonical hostname might be something like  </span><span class="s38">relay1.west-coast.yahoo.com </span><span class="p">). DNS can be invoked by a mail application to obtain the canonical hostname for a supplied alias hostname as well as the IP address of the host. In fact, the MX record (see below) permits a company’s mail server and Web server to have identical (aliased) hostnames; for example, a company’s Web server and mail server can both be called</span></p><p class="s42" style="padding-top: 3pt;padding-left: 29pt;text-indent: 0pt;text-align: left;"><a href="http://enterprise.com/" class="s36" target="_blank" name="bookmark196">enterprise.com</a> <span class="s37">.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_140.png"/></span></p><p class="s37" style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 131%;text-align: left;"><span class="s23">Load</span><span class="s20"> distribution. </span><span class="p">DNS is also used to perform load distribution among replicated servers, such as </span>replicated<a href="http://cnn.com/" class="s124" target="_blank"> Web servers. Busy sites, such as </a><a href="http://cnn.com/" class="s36" target="_blank">cnn.com</a><span class="s42"> </span>,<span class="p"> are replicated over multiple servers, with each server running on a different end system and each having a different IP address. For replicated</span></p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">Web servers, a <i>set </i>of IP addresses is thus associated with one canonical hostname. The DNS database contains this set of IP addresses. When clients make a DNS query for a name mapped to a set of addresses, the server responds with the entire set of IP addresses, but rotates the ordering</p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">of the addresses within each reply. Because a client typically sends its HTTP request message to the IP address that is listed first in the set, DNS rotation distributes the traffic among the replicated servers. DNS rotation is also used for e-mail so that multiple mail servers can have the same alias name. Also, content distribution companies such as Akamai have used DNS in more sophisticated</p><p class="s20" style="padding-top: 2pt;padding-left: 27pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">ways </a><a href="#bookmark848" class="a">[Dilley 2002]</a> <a href="#bookmark223" class="s124">to provide Web content distribution (see </a><a href="#bookmark223" class="a">Section 2.6.</a>3<span class="p">).</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The DNS is specified in RFC 1034 and RFC 1035, and updated in several additional RFCs. It is a complex system, and we only touch upon key aspects of its</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="445" alt="image" src="计算机网络自顶向下7th-en/Image_141.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">PRINCIPLES IN PRACTICE</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">DNS: CRITICAL NETWORK FUNCTIONS VIA THE CLIENT-SERVER PARADIGM</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Like HTTP, FTP, and SMTP, the DNS protocol is an application-layer protocol since it (1) runs between communicating end systems using the client-server paradigm and (2) relies on an underlying end-to-end transport protocol to transfer DNS messages between communicating end systems. In another sense, however, the role of the DNS is quite different from Web, file transfer, and e-mail applications. Unlike these applications, the DNS is not an application with which a user directly interacts. Instead, the DNS provides a core Internet function—namely, translating hostnames to their underlying IP addresses, for user applications and other software</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark37" class="s124">in the Internet. We noted in </a><a href="#bookmark37" class="a">Section 1.2</a> <span class="p">that much of the complexity in the Internet architecture is located at the “edges” of the network. The DNS, which implements the critical name-to- address translation process using clients and servers located at the edge of the network, is yet</span></p><p style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">another example of that design philosophy.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">operation here. The interested reader is referred to these RFCs and the book by Albitz and Liu </a><a href="#bookmark848" class="a">[Albitz </a>1993]<a href="#bookmark848" class="s124">; see also the retrospective paper </a><a href="#bookmark848" class="a">[Mockapetris </a>1988]<a href="#bookmark848" class="s124">, which provides a nice description of the what and why of DNS, and </a><a href="#bookmark848" class="a">[Mockapetris </a>2005]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Overview of How DNS Works</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">We now present a high-level overview of how DNS works. Our discussion will focus on the hostname-to-</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">IP-address translation service.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Suppose that some application (such as a Web browser or a mail reader) running in a user’s host needs to translate a hostname to an IP address. The application will invoke the client side of DNS, specifying the hostname that needs to be translated. (On many UNIX-based machines,  <span class="s30">gethostbyname() </span>is the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">function call that an application calls in order to perform the translation.) DNS in the user’s host then</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">takes over, sending a query message into the network. All DNS query and reply messages are sent within UDP datagrams to port 53. After a delay, ranging from milliseconds to seconds, DNS in the user’s host receives a DNS reply message that provides the desired mapping. This mapping is then passed to the invoking application. Thus, from the perspective of the invoking application in the user’s host, DNS is a black box providing a simple, straightforward translation service. But in fact, the black box that implements the service is complex, consisting of a large number of DNS servers distributed around the globe, as well as an application-layer protocol that specifies how the DNS servers and querying hosts communicate.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A simple design for DNS would have one DNS server that contains all the mappings. In this centralized design, clients simply direct all queries to the single DNS server, and the DNS server responds directly to the querying clients. Although the simplicity of this design is attractive, it is inappropriate for today’s Internet, with its vast (and growing) number of hosts. The problems with a centralized design include:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_142.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">A single point of failure<span class="p">. If the DNS server crashes, so does the entire Internet!</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_143.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Traffic volume<span class="p">. A single DNS server would have to handle all DNS queries (for all the HTTP requests and e-mail messages generated from hundreds of millions of hosts).</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_144.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Distant centralized database<span class="p">. A single DNS server cannot be “close to” all the querying clients. If we put the single DNS server in New York City, then all queries from Australia must travel to the other side of the globe, perhaps over slow and congested links. This can lead to significant delays.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_145.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Maintenance<span class="p">. The single DNS server would have to keep records for all Internet hosts. Not only would this centralized database be huge, but it would have to be updated frequently to account for every new host.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">In summary, a centralized database in a single DNS server simply <i>doesn’t scale. </i>Consequently, the DNS is distributed by design. In fact, the DNS is a wonderful example of how a distributed database can be implemented in the Internet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">A Distributed, Hierarchical Database</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In order to deal with the issue of scale, the DNS uses a large number of servers, organized in a hierarchical fashion and distributed around the world. No single DNS server has all of the mappings for all of the hosts in the Internet. Instead, the mappings are distributed across the DNS servers. To a first approximation, there are three classes of DNS servers—root DNS servers, top-level domain (TLD) DNS</p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark197" class="s124">servers, and authoritative DNS servers—organized in a hierarchy as shown in </a><a href="#bookmark197" class="a">Figure 2.1</a>7<span class="p">. To understand how these three classes of servers interact, suppose a DNS client wants to determine the IP</span></p><p class="s37" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">address<a href="http://www.amazon.com/" class="s124" target="_blank"> for the hostname </a><a href="http://www.amazon.com/" class="s36" target="_blank">www.amazon.com</a><span class="s42"> </span>.<span class="p"> To a first</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="669" height="242" alt="image" src="计算机网络自顶向下7th-en/Image_146.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark197">Figure 2.17 Portion of the hierarchy of DNS servers</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 152%;text-align: left;"><a name="bookmark198">approximation, the following events will take place. The client first contacts one of the root servers, which returns IP addresses for TLD servers for the top-level domain </a><span class="s30">com </span>. The client then contacts one <span class="s37">of</span><a href="http://amazon.com/" class="s124" target="_blank"> these TLD servers, which returns the IP address of an authoritative server for </a><a href="http://amazon.com/" class="s36" target="_blank">amazon.com</a><span class="s42"> </span><span class="s37">.</span> Finally,</p><p class="s37" style="padding-left: 6pt;text-indent: 0pt;line-height: 14pt;text-align: left;">the<a href="http://amazon.com/" class="s124" target="_blank"> client contacts one of the authoritative servers for </a><a href="http://amazon.com/" class="s36" target="_blank">amazon.com</a><span class="s42"> </span>,<span class="p"> which returns the IP address for</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s37" style="padding-left: 5pt;text-indent: 0pt;line-height: 124%;text-align: left;">the<a href="http://www.amazon.com/" class="s124" target="_blank"> hostname </a><a href="http://www.amazon.com/" class="s36" target="_blank">www.amazon.com</a><span class="s42"> </span>.<span class="p"> We’ll soon examine this DNS lookup process in more detail. But let’s first take a closer look at these three classes of DNS servers:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_147.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">Root DNS servers. <a href="#bookmark199" class="s124">There are over 400 root name servers scattered all over the world. </a><a href="#bookmark199" class="a">Figure </a><span style=" color: #1E79B8;">2.18 </span><span class="p">shows the countries that have root names servers, with countries having more than ten darkly shaded. These root name servers are managed by 13 different organizations. The full list of root</span></p><p class="s20" style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">name servers, along with the organizations that manage them and their IP addresses can be found at </a><a href="#bookmark848" class="a">[Root Servers </a>2016]<span class="p">. Root name servers provide the IP addresses of the TLD servers.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_148.png"/></span></p><p class="s28" style="padding-left: 27pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Top-level domain (TLD) servers<span class="p">. For each of the top-level domains — top-level domains such as</span></p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 153%;text-align: left;">com, org, net, edu, and gov, and all of the country top-level domains such as uk, fr, ca, and jp — there is TLD server (or server cluster). The company Verisign Global Registry Services maintains the TLD servers for the <span class="s30">com </span>top-level domain, and the company Educause maintains the TLD</p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 14pt;text-align: left;">servers for the <span class="s30">edu </span>top-level domain. The network infrastructure supporting a TLD can be large and</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">complex; see </a><a href="#bookmark848" class="a">[Osterweil 2012]</a> <a href="#bookmark848" class="s124">for a nice overview of the Verisign network. See </a><a href="#bookmark848" class="a">[TLD list 2016]</a> <span class="p">for a list of all top-level domains. TLD servers provide the IP addresses for authoritative DNS servers.</span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="759" height="382" alt="image" src="计算机网络自顶向下7th-en/Image_149.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark199">Figure 2.18 DNS root servers in 2016</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_150.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Authoritative DNS servers<span class="p">. Every organization with publicly accessible hosts (such as Web servers and mail servers) on the Internet must provide publicly accessible DNS records that map the names of those hosts to IP addresses. An organization’s authoritative DNS server houses these DNS</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">records. An organization can choose to implement its own authoritative DNS server to hold these records; alternatively, the organization can pay to have these records stored in an authoritative DNS server of some service provider. Most universities and large companies implement and maintain their own primary and secondary (backup) authoritative DNS server.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">The root, TLD, and authoritative DNS servers all belong to the hierarchy of DNS servers, as shown in</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 136%;text-align: left;"><a href="#bookmark197" class="a">Figure 2.1</a>7<span class="p">. There is another important type of DNS server called the </span><span class="s23">local</span> DNS server<span class="p">. A local DNS server does not strictly belong to the hierarchy of servers but is nevertheless central to the DNS architecture. Each ISP—such as a residential ISP or an institutional ISP—has a local DNS server (also</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark368" class="s124">called a default name server). When a host connects to an ISP, the ISP provides the host with the IP addresses of one or more of its local DNS servers (typically through DHCP, which is discussed in </a><a href="#bookmark368" class="a">Chapter </a>4<span class="p">). You can easily determine the IP address of your local DNS server by accessing network</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">status windows in Windows or UNIX. A host’s local DNS server is typically “close to” the host. For an</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">institutional ISP, the local DNS server may be on the same LAN as the host; for a residential ISP, it is typically separated from the host by no more than a few routers. When a host makes a DNS query, the query is sent to the local DNS server, which acts a proxy, forwarding the query into the DNS server hierarchy, as we’ll discuss in more detail below.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Let’s take a look at a simple example. Suppose the host <span class="s38">cse.nyu.edu </span>desires the IP address of</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 7pt;text-indent: 0pt;text-align: left;"><a href="http://gaia.cs.umass.edu/" class="s36" target="_blank">gaia.cs.umass.edu</a><span class="s42"> </span><span class="s37">.</span> Also suppose that NYU’s ocal DNS server for  <span class="s38">cse.nyu.edu </span>is called</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 2pt;line-height: 142%;text-align: left;"><span class="s40">dns.nyu.edu</span><span class="s38"> </span><a href="http://gaia.cs.umass.edu/" class="s124" target="_blank">and that an authoritative DNS server for  </a><a href="http://gaia.cs.umass.edu/" class="s36" target="_blank">gaia.cs.umass.edu</a><span class="s42"> </span><span class="s37">is</span> called <span class="s38">dns.umass.edu </span><a href="#bookmark201" class="s124">. As shown in </a><a href="#bookmark201" class="a">Figure 2.1</a><span class="s20">9</span>, the host <span class="s38">cse.nyu.edu </span>first sends a DNS query message to its local DNS server, <span class="s38">dns.nyu.edu </span>. The query message contains the hostname to be <span class="s37">translated,</span><a href="http://gaia.cs.umass.edu/" class="s124" target="_blank"> namely,  </a><a href="http://gaia.cs.umass.edu/" class="s36" target="_blank">gaia.cs.umass.edu</a><span class="s42"> </span><span class="s37">.</span> The local DNS server forwards the query message to a</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">root DNS server. The root DNS server takes note of the edu suffix and returns to the local DNS server a</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 134%;text-align: left;">list of IP addresses for TLD servers responsible for <span class="s30">edu </span>. The local DNS server then resends the query <span class="s37">message</span><a href="http://umass.edu/" class="s124" target="_blank"> to one of these TLD servers. The TLD server takes note of the </a><a href="http://umass.edu/" class="s36" target="_blank">umass.edu</a><span class="s42"> </span><span class="s37">suffix</span> and responds with the IP address of the authoritative DNS server for the University of Massachusetts,</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 134%;text-align: left;">namely, <span class="s38">dns.umass.edu </span>. Finally, the local DNS server resends the query message directly to <span class="s40">dns.umass.edu</span><span class="s38"> </span><a href="http://gaia.cs.umass.edu/" class="s124" target="_blank">, which responds with the IP address of  </a><a href="http://gaia.cs.umass.edu/" class="s36" target="_blank">gaia.cs.umass.edu</a><span class="s42"> </span><span class="s37">.</span> Note that in this example, in order to obtain the mapping for one hostname, eight DNS messages were sent: four query</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">messages and four reply messages! We’ll soon see how DNS caching reduces this query traffic.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark200">Our previous example assumed that the TLD server knows the authoritative DNS server for the hostname. In general this not always true. Instead, the TLD server</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="417" height="587" alt="image" src="计算机网络自顶向下7th-en/Image_151.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark201">Figure 2.19 Interaction of the various DNS servers</a></h2><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">may know only of an intermediate DNS server, which in turn knows the authoritative DNS server for the hostname. For example, suppose again that the University of Massachusetts has a DNS server for the university, called <span class="s38">dns.umass.edu </span>. Also suppose that each of the departments at the University of</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Massachusetts has its own DNS server, and that each departmental DNS server is authoritative for all</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 139%;text-align: left;">hosts in the department. In this case, when the intermediate DNS server, <span class="s38">dns.umass.edu </span>, receives a <span class="s37">query</span><a href="http://cs.umass.edu/" class="s124" target="_blank"> for a host with a hostname ending with </a><a href="http://cs.umass.edu/" class="s36" target="_blank">cs.umass.edu</a><span class="s42"> </span><span class="s37">,</span> it returns to <span class="s38">dns.nyu.edu </span>the IP address of  <span class="s38">dns.cs.umass.edu </span><a href="http://cs.umass.edu/" class="s124" target="_blank">, which is authoritative for all hostnames ending with  </a><a href="http://cs.umass.edu/" class="s36" target="_blank">cs.umass.edu</a><span class="s42"> </span><span class="s37">.</span> The local DNS server <span class="s38">dns.nyu.edu </span>then sends the query to the authoritative DNS server, which returns the desired mapping to the local DNS server, which in turn returns the mapping to the requesting host. In this case, a total of 10 DNS messages are sent!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 144%;text-align: left;"><a href="#bookmark201" class="s124">The example shown in </a><a href="#bookmark201" class="a">Figure 2.19</a><span class="s20"> </span>makes use of both <span class="s23">recursive</span><span class="s20"> queries </span>and <span class="s23">iterative</span><span class="s20"> queries</span>. The query sent from <span class="s38">cse.nyu.edu </span>to <span class="s38">dns.nyu.edu </span>is a recursive query, since the query asks <span class="s30">dns.nyu.edu </span>to obtain the mapping on its behalf. But the subsequent three queries are iterative since all of the replies are directly returned to <span class="s38">dns.nyu.edu </span><a href="#bookmark202" class="s124">. In theory, any DNS query can be iterative or recursive. For example, </a><a href="#bookmark202" class="a">Figure 2.20</a><span class="s20"> </span><a href="#bookmark201" class="s124">shows a DNS query chain for which all of the queries are recursive. In practice, the queries typically follow the pattern in </a><a href="#bookmark201" class="a">Figure 2.1</a><span class="s20">9</span>: The query from the requesting host to</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">the local DNS server is recursive, and the remaining queries are iterative.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">DNS Caching</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">Our discussion thus far has ignored <span class="s20">DNS caching</span>, a critically important feature of the DNS system. In truth, DNS extensively exploits DNS caching in order to improve the delay performance and to reduce the number of DNS messages</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="432" height="628" alt="image" src="计算机网络自顶向下7th-en/Image_152.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark202">Figure 2.20 Recursive queries in DNS</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark201" class="s124">ricocheting around the Internet. The idea behind DNS caching is very simple. In a query chain, when a DNS server receives a DNS reply (containing, for example, a mapping from a hostname to an IP address), it can cache the mapping in its local memory. For example, in </a><a href="#bookmark201" class="a">Figure 2.1</a>9<span class="p">, each time the local</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 15pt;text-align: left;">DNS server <span class="s38">dns.nyu.edu </span>receives a reply from some DNS server, it can cache any of the information</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">contained in the reply. If a hostname/IP address pair is cached in a DNS server and another query arrives to the DNS server for the same hostname, the DNS server can provide the desired IP address, even if it is not authoritative for the hostname. Because hosts and mappings between hostnames and IP addresses are by no means permanent, DNS servers discard cached information after a period of time (often set to two days).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 141%;text-align: left;">As an example, suppose that a host <span class="s38">apricot.nyu.edu </span>queries <span class="s38">dns.nyu.edu </span>for the IP address for <span class="s37">the</span><a href="http://cnn.com/" class="s124" target="_blank"> hostname </a><a href="http://cnn.com/" class="s36" target="_blank">cnn.com</a><span class="s42"> </span><span class="s37">.</span> Furthermore, suppose that a few hours later, another NYU host, say, <span class="s38">kiwi.nyu.edu </span>, also queries  <span class="s38">dns.nyu.edu </span>with the same hostname. Because of caching, the local <span class="s37">DNS</span><a href="http://cnn.com/" class="s124" target="_blank"> server will be able to immediately return the IP address of </a><a href="http://cnn.com/" class="s36" target="_blank">cnn.com</a><span class="s42"> </span><span class="s37">to</span> this second requesting</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark203">host without having to query any other DNS servers. A local DNS server can also cache the IP addresses of TLD servers, thereby allowing the local DNS server to bypass the root DNS servers in a query chain. In fact, because of caching, root servers are bypassed for all but a very small fraction of DNS queries.</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">DNS Records and Messages</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The DNS servers that together implement the DNS distributed database store <span class="s20">resource records (RRs)</span>, including RRs that provide hostname-to-IP address mappings. Each DNS reply message carries one or more resource records. In this and the following subsection, we provide a brief overview of DNS</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">resource records and messages; more details can be found in </a><a href="#bookmark848" class="a">[Albitz 1993]</a> <a href="#bookmark848" class="s124">or in the DNS RFCs </a><a href="#bookmark848" class="a">[RFC </a>1034<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 1035</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_153.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">A resource record is a four-tuple that contains the following fields:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="text-indent: 0pt;text-align: center;">(Name, Value, Type, TTL)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 6pt;text-indent: 2pt;line-height: 145%;text-align: justify;">TTL <span class="p">is the time to live of the resource record; it determines when a resource should be removed from a cache. In the example records given below, we ignore the </span>TTL <span class="p">field. The meaning of </span>Name <span class="p">and </span>Value <span class="p">depend on </span>Type <span class="p">:</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_154.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">If <span class="s30">Type=A </span>, then <span class="s30">Name </span>is a hostname and <span class="s30">Value </span>is the IP address for the hostname. Thus, a Type A record provides the standard hostname-to-IP address mapping. As an example,</p><p class="s42" style="padding-top: 4pt;padding-left: 29pt;text-indent: 0pt;text-align: left;"><a href="http://relay1.bar.foo.com/" style=" color: #468173; font-family:&quot;Courier New&quot;, monospace; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt; vertical-align: 1pt;" target="_blank">(</a>relay1.bar.foo.com<span class="s39">,</span><span class="s30"> 145.37.93.126, A) </span><span class="p">is a Type A record.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_155.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 124%;text-align: left;"><a name="bookmark204"><span class="s37">If</span></a> <span class="s30">Type=NS </span>, then <span class="s30">Name </span><a href="http://foo.com/" class="s124" target="_blank">is a domain (such as </a><a href="http://foo.com/" class="s36" target="_blank">foo.com</a><span class="s42"> </span><span class="s37">)</span> and <span class="s30">Value </span>is the hostname of an authoritative DNS server that knows how to obtain the IP addresses for hosts in the domain. This</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s37" style="padding-left: 26pt;text-indent: 0pt;text-align: left;">record<span class="p"> is used to route DNS queries further along in the query chain. As an example, </span><a href="http://foo.com/" class="s35" target="_blank">(</a><span class="s42">foo.com</span><span class="s39">,</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s42" style="padding-left: 26pt;text-indent: 0pt;text-align: left;">dns.foo.com<span class="s39">,</span><span class="s30"> NS) </span><span class="p">is a Type NS record.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_156.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 140%;text-align: left;">If <span class="s30">Type=CNAME </span>, then <span class="s30">Value </span>is a canonical hostname for the alias hostname <span class="s30">Name </span>. This record <span class="s37">can</span> provide querying hosts the canonical name for a hostname. As an example, <a href="http://foo.com/" class="s35" target="_blank">(</a><span class="s42">foo.com</span><span class="s39">,</span><a href="http://relay1.bar.foo.com/" class="s35" target="_blank"> </a><span class="s42">relay1.bar.foo.com</span><span class="s39">,</span><span class="s30"> CNAME) </span>is a CNAME record.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_157.png"/></span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 15pt;text-align: left;">If <span class="s30">Type=MX </span>, then <span class="s30">Value </span>is the canonical name of a mail server that has an alias hostname <span class="s30">Name </span>.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s42" style="padding-left: 27pt;text-indent: 0pt;line-height: 124%;text-align: left;"><span class="s37">As</span><span class="p"> an example, </span><a href="http://foo.com/" class="s35" target="_blank">(</a>foo.com<span class="s39">,</span><a href="http://mail.bar.foo.com/" class="s35" target="_blank"> </a>mail.bar.foo.com<span class="s39">,</span><span class="s30"> MX) </span><span class="p">is an MX record. MX records allow the hostnames of mail servers to have simple aliases. Note that by using the MX record, a company can</span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">have the same aliased name for its mail server and for one of its other servers (such as its Web server). To obtain the canonical name for the mail server, a DNS client would query for an MX</p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">record; to obtain the canonical name for the other server, the DNS client would query for the CNAME record.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">If a DNS server is authoritative for a particular hostname, then the DNS server will contain a Type A record for the hostname. (Even if the DNS server is not authoritative, it may contain a Type A record in its cache.) If a server is not authoritative for a hostname, then the server will contain a Type NS record for the domain that includes the hostname; it will also contain a Type A record that provides the IP</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 141%;text-align: left;">address of the DNS server in the <span class="s30">Value </span>field of the NS record. As an example, suppose an edu TLD <span class="s37">server</span><a href="http://gaia.cs.umass.edu/" class="s124" target="_blank"> is not authoritative for the host </a><a href="http://gaia.cs.umass.edu/" class="s36" target="_blank">gaia.cs.umass.edu</a><span class="s42"> </span><span class="s37">.</span><a href="http://gaia.cs.umass.edu/" class="s124" target="_blank"> Then this server will contain a record for a domain that includes the host  </a><a href="http://gaia.cs.umass.edu/" class="s36" target="_blank">gaia.cs.umass.edu</a><span class="s42"> </span><span class="s37">,</span> for example,  <a href="http://umass.edu/" class="s35" target="_blank">(</a><span class="s42">umass.edu</span><span class="s39">,</span><span class="s30"> </span><span class="s38">dns.umass.edu</span><span class="s30">, NS) </span>. The edu TLD server would also contain a Type A record, which maps the DNS server  <span class="s38">dns.umass.edu </span>to an IP address, for example,  <span class="s30">(</span><span class="s38">dns.umass.edu</span><span class="s30">, 128.119.40.111, A) </span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">DNS Messages</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark205" class="s124">Earlier in this section, we referred to DNS query and reply messages. These are the only two kinds of DNS messages. Furthermore, both query and reply messages have the same format, as shown in </a><a href="#bookmark205" class="a">Figure 2.2</a>1<span class="p">.The semantics of the various fields in a DNS message are as follows:</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_158.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">The first 12 bytes is the <i>header section</i>, which has a number of fields. The first field is a 16-bit number that identifies the query. This identifier is copied into the reply message to a query, allowing the client to match received replies with sent queries. There are a number of flags in the flag field. A</p><p style="text-indent: 0pt;text-align: left;"><span><img width="672" height="400" alt="image" src="计算机网络自顶向下7th-en/Image_159.png"/></span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">1-bit query/reply flag indicates whether the message is a query (0) or a reply (1). A 1-bit authoritative flag is</p><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark205">Figure 2.21 DNS message format</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">set in a reply message when a DNS server is an authoritative server for a queried name. A 1-bit recursion-desired flag is set when a client (host or DNS server) desires that the DNS server perform recursion when it doesn’t have the record. A 1-bit recursion-available field is set in a reply if the DNS server supports recursion. In the header, there are also four number-of fields. These fields indicate the number of occurrences of the four types of data sections that follow the header.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_160.png"/></span></p><p style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">The <i>question section </i>contains information about the query that is being made. This section includes</p><p style="padding-top: 4pt;padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">(1) a name field that contains the name that is being queried, and (2) a type field that indicates the type of question being asked about the name—for example, a host address associated with a name (Type A) or the mail server for a name (Type MX).</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_161.png"/></span></p><p style="padding-top: 2pt;padding-left: 25pt;text-indent: 0pt;line-height: 140%;text-align: left;">In a reply from a DNS server, the <i>answer section </i>contains the resource records for the name that was originally queried. Recall that in each resource record there is the <span class="s30">Type </span>(for example, A, NS, CNAME, and MX), the <span class="s30">Value </span>, and the <span class="s30">TTL </span>. A reply can return multiple RRs in the answer, since a hostname can have multiple IP addresses (for example, for replicated Web servers, as discussed</p><p style="padding-left: 25pt;text-indent: 0pt;text-align: left;">earlier in this section).</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_162.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">The <i>authority section </i>contains records of other authoritative servers.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_163.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">The <i>additional section </i>contains other helpful records. For example, the answer field in a reply to an MX query contains a resource record providing the canonical hostname of a mail server. The additional section contains a Type A record providing the IP address for the canonical hostname of</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">the mail server.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">How would you like to send a DNS query message directly from the host you’re working on to some DNS server? This can easily be done with the <span class="s20">nslookup program</span>, which is available from most Windows and UNIX platforms. For example, from a Windows host, open the Command Prompt and invoke the nslookup program by simply typing “nslookup.” After invoking nslookup, you can send a DNS query to any DNS server (root, TLD, or authoritative). After receiving the reply message from the DNS server, nslookup will display the records included in the reply (in a human-readable format). As an alternative to running nslookup from your own host, you can visit one of many Web sites that allow you to remotely employ nslookup. (Just type “nslookup” into a search engine and you’ll be brought to one of these sites.) The DNS Wireshark lab at the end of this chapter will allow you to explore the DNS in much more detail.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Inserting Records into the DNS Database</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The discussion above focused on how records are retrieved from the DNS database. You might be wondering how records get into the database in the first place. Let’s look at how this is done in the context of a specific example. Suppose you have just created an exciting new startup company called Network Utopia. The first thing you’ll surely want to do is register the domain name</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 2pt;line-height: 121%;text-align: left;"><a href="http://networkutopia.com/" class="s36" target="_blank">networkutopia.com</a><span class="s42"> </span>at a registrar. A <span class="s41">registrar</span><span class="s20"> </span>is a commercial entity that verifies the uniqueness of the domain name, enters the domain name into the DNS database (as discussed below), and collects a</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">small fee from you for its services. Prior to 1999, a single registrar, Network Solutions, had a monopoly</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">on domain name registration for <span class="s30">com </span>, <span class="s30">net </span>, and <span class="s30">org </span>domains. But now there are many registrars competing for customers, and the Internet Corporation for Assigned Names and Numbers (ICANN)</p><p class="s37" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 136%;text-align: left;">accredits<a href="http://www.internic.net/" class="s124" target="_blank"> the various registrars. A complete list of accredited registrars is available at </a><a href="http://www.internic.net/" class="s36" target="_blank">http:// www.internic.net</a><span class="s42"> </span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s37" style="padding-left: 6pt;text-indent: 0pt;line-height: 124%;text-align: left;">When<a href="http://networkutopia.com/" class="s124" target="_blank"> you register the domain name  </a><a href="http://networkutopia.com/" class="s36" target="_blank">networkutopia.com</a><span class="s42"> </span>with<span class="p"> some registrar, you also need to provide the registrar with the names and IP addresses of your primary and secondary authoritative DNS</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s37" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">servers.<a href="http://dns1.networkutopia.com/" class="s124" target="_blank"> Suppose the names and IP addresses are  </a><a href="http://dns1.networkutopia.com/" class="s36" target="_blank">dns1.networkutopia.com</a><span class="s42"> </span>,<a href="http://dns2.networkutopia.com/" class="s124" target="_blank"> </a><a href="http://dns2.networkutopia.com/" class="s36" target="_blank">dns2.networkutopia.com</a><span class="s42"> </span>,<span class="p">  </span><span class="s30">212.2.212.1, </span><span class="p">and  </span><span class="s30">212.212.212.2. </span><span class="p">For each of these two authoritative DNS servers, the registrar would then make sure that a Type NS and a Type A record are</span></p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">entered into the TLD com servers. Specifically, for the primary authoritative server for</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="106" alt="image" src="计算机网络自顶向下7th-en/Image_164.png"/></span></p><p class="s42" style="padding-left: 6pt;text-indent: 2pt;line-height: 124%;text-align: left;"><a href="http://networkutopia.com/" class="s36" target="_blank">networkutopia.com</a> <span class="s37">,</span><span class="p"> the registrar would insert the following two resource records into the DNS system:</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 1pt;line-height: 148%;text-align: left;">(networkutopia.com, dns1.networkutopia.com, NS) (dns1.networkutopia.com, 212.212.212.1, A)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">You’ll also have to make sure that the Type A resource record for your Web server</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s42" style="padding-left: 8pt;text-indent: 0pt;text-align: left;"><a href="http://www.networkutopia.com/" class="s36" target="_blank">www.networkutopia.com</a> <span class="s37">and</span><span class="p"> the Type MX resource record for your mail server</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s42" style="padding-left: 8pt;text-indent: 0pt;text-align: left;"><a href="http://mail.networkutopia.com/" class="s36" target="_blank">mail.networkutopia.com</a> <span class="s37">are</span><span class="p"> entered into your authoritative DNS</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="398" alt="image" src="计算机网络自顶向下7th-en/Image_165.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">FOCUS ON SECURITY</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">DNS VULNERABILITIES</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">We have seen that DNS is a critical component of the Internet infrastructure, with many important services—including the Web and e-mail—simply incapable of functioning without it. We therefore naturally ask, how can DNS be attacked? Is DNS a sitting duck, waiting to be knocked out of service, while taking most Internet applications down with it?</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark101" class="s124">The first type of attack that comes to mind is a DDoS bandwidth-flooding attack (see </a><a href="#bookmark101" class="a">Section 1.</a>6<span class="p">) against DNS servers. For example, an attacker could attempt to send to each DNS root server a deluge of packets, so many that the majority of legitimate DNS queries never get</span></p><p style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">answered. Such a large-scale DDoS attack against DNS root servers actually took place on October 21, 2002. In this attack, the attackers leveraged a botnet to send truck loads of ICMP ping messages to each of the 13 DNS root IP addresses. (ICMP messages are discussed in</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="641" alt="image" src="计算机网络自顶向下7th-en/Image_166.png"/></span></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark496" class="a">Section 5.</a>6<span class="p">. For now, it suffices to know that ICMP packets are special types of IP datagrams.) Fortunately, this large-scale attack caused minimal damage, having little or no impact on users’ Internet experience. The attackers did succeed at directing a deluge of packets at the root</span></p><p style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">servers. But many of the DNS root servers were protected by packet filters, configured to always block all ICMP ping messages directed at the root servers. These protected servers were thus spared and functioned as normal. Furthermore, most local DNS servers cache the IP addresses of top-level-domain servers, allowing the query process to often bypass the DNS root servers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">A potentially more effective DDoS attack against DNS would be send a deluge of DNS queries  to top-level-domain servers, for example, to all the top-level-domain servers that handle the .com domain. It would be harder to filter DNS queries directed to DNS servers; and top-level-domain servers are not as easily bypassed as are root servers. But the severity of such an attack would be partially mitigated by caching in local DNS servers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">DNS could potentially be attacked in other ways. In a man-in-the-middle attack, the attacker intercepts queries from hosts and returns bogus replies. In the DNS poisoning attack, the attacker sends bogus replies to a DNS server, tricking the server into accepting bogus records into its cache. Either of these attacks could be used, for example, to redirect an unsuspecting Web user to the attacker’s Web site. These attacks, however, are difficult to implement, as they</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">require intercepting packets or throttling servers </a><a href="#bookmark848" class="a">[Skoudis 2006</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">In summary, DNS has demonstrated itself to be surprisingly robust against attacks. To date, there hasn’t been an attack that has successfully impeded the DNS service.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">servers. (Until recently, the contents of each DNS server were configured statically, for example, from a configuration file created by a system manager. More recently, an UPDATE option has been added to the DNS protocol to allow data to be dynamically added or deleted from the database via DNS</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">messages. </a><a href="#bookmark848" class="a">[RFC 2136]</a> <a href="#bookmark848" class="s124">and </a><a href="#bookmark848" class="a">[RFC 3007]</a> <span class="p">specify DNS dynamic updates.)</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s37" style="padding-left: 5pt;text-indent: 0pt;line-height: 150%;text-align: left;"><span class="p">Once all of these steps are completed, people will be able to visit your Web site and send e-mail to the employees at your company. Let’s conclude our discussion of DNS by verifying that this statement is true. This verification also helps to solidify what we have learned about DNS. Suppose Alice in Australia </span>wants<a href="http://www.networkutopia.com/" class="s124" target="_blank"> to view the Web page </a><a href="http://www.networkutopia.com/" class="s36" target="_blank">www.networkutopia.com</a><span class="s42"> </span>.<span class="p"> As discussed earlier, her host will first send</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 14pt;text-align: left;">a DNS query to her local DNS server. The local DNS server will then contact a TLD <span class="s30">com </span>server. (The</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">local DNS server will also have to contact a root DNS server if the address of a TLD <span class="s30">com </span>server is not cached.) This TLD server contains the Type NS and Type A resource records listed above, because the registrar had these resource records inserted into all of the TLD com servers. The TLD com server</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 152%;text-align: left;">sends a reply to Alice’s local DNS server, with the reply containing the two resource records. The local DNS server then sends a DNS query to <span class="s30">212.212.212.1 </span>, asking for the Type A record corresponding <span class="s37">to</span><a href="http://www.networkutopia.com/" class="s124" target="_blank"> </a><a href="http://www.networkutopia.com/" class="s36" target="_blank">www.networkutopia.com</a><span class="s42"> </span><span class="s37">.</span> This record provides the IP address of the desired Web server, say,</p><p class="s30" style="padding-left: 8pt;text-indent: 0pt;line-height: 13pt;text-align: left;">212.212.71.4 <span class="p">, which the local DNS server passes back to Alice’s host. Alice’s browser can now</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark206">initiate a TCP connection to the host </a><span class="s30">212.212.71.4 </span>and send an HTTP request over the connection. Whew! There’s a lot more going on than what meets the eye when one surfs the Web!<a name="bookmark207">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l121"><ol id="l122"><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark208">Peer-to-Peer File Distribution</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark144" class="s124">The applications described in this chapter thus far—including the Web, e-mail, and DNS—all employ client-server architectures with significant reliance on always-on infrastructure servers. Recall from </a><a href="#bookmark144" class="a">Section 2.1.1</a> <span class="p">that with a P2P architecture, there is minimal (or no) reliance on always-on infrastructure</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">servers. Instead, pairs of intermittently connected hosts, called peers, communicate directly with each</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">other. The peers are not owned by a service provider, but are instead desktops and laptops controlled by users.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section we consider a very natural P2P application, namely, distributing a large file from a single server to a large number of hosts (called peers). The file might be a new version of the Linux operating system, a software patch for an existing operating system or application, an MP3 music file, or an MPEG video file. In client-server file distribution, the server must send a copy of the file to each of the peers—placing an enormous burden on the server and consuming a large amount of server bandwidth. In P2P file distribution, each peer can redistribute any portion of the file it has received to any other peers, thereby assisting the server in the distribution process. As of 2016, the most popular P2P file distribution protocol is BitTorrent. Originally developed by Bram Cohen, there are now many different independent BitTorrent clients conforming to the BitTorrent protocol, just as there are a number of Web browser clients that conform to the HTTP protocol. In this subsection, we first examine the self- scalability of P2P architectures in the context of file distribution. We then describe BitTorrent in some detail, highlighting its most important characteristics and features.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Scalability of P2P Architectures</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark209" class="s124">To compare client-server architectures with peer-to-peer architectures, and illustrate the inherent self- scalability of P2P, we now consider a simple quantitative model for distributing a file to a fixed set of peers for both architecture types. As shown in </a><a href="#bookmark209" class="a">Figure 2.2</a>2<span class="p">, the server and the peers are connected to</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">the Internet with access links. Denote the upload rate of the server’s access link by <i>u</i><span class="s31">s</span>, the upload rate of</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 156%;text-align: left;">the <i>i</i>th peer’s access link by <i>u</i><span class="s31">i</span>, and the download rate of the <i>i</i>th peer’s access link by <i>d</i><span class="s31">i</span>. Also denote the size of the file to be distributed (in bits) by <i>F </i>and the number of peers that want to obtain a copy of the</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">file by <i>N</i>. The <span class="s23">distribution</span><span class="s20"> time </span>is the time it takes to get</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="533" height="473" alt="image" src="计算机网络自顶向下7th-en/Image_167.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark209">Figure 2.22 An illustrative file distribution problem</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">a copy of the file to all <i>N </i><a href="#bookmark848" class="s124">peers. In our analysis of the distribution time below, for both client-server and P2P architectures, we make the simplifying (and generally accurate </a><a href="#bookmark848" class="a">[Akella </a><span class="s20">2003]</span>) assumption that the Internet core has abundant bandwidth, implying that all of the bottlenecks are in access networks. We</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">also suppose that the server and clients are not participating in any other network applications, so that all of their upload and download access bandwidth can be fully devoted to distributing this file.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 143%;text-align: left;">Let’s first determine the distribution time for the client-server architecture, which we denote by <i>D</i><span class="s31">cs</span>. In the client-server architecture, none of the peers aids in distributing the file. We make the following observations:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_168.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_169.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 151%;text-align: left;">The server must transmit one copy of the file to each of the <i>N </i>peers. Thus the server must transmit <i>NF </i>bits. Since the server’s upload rate is <i>u</i><span class="s31">s</span>, the time to distribute the file must be at least <i>NF/u</i><span class="s31">s</span>. Let <i>d</i><span class="s22">min </span>denote the download rate of the peer with the lowest download rate, that is,</p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 15pt;text-align: left;"><span class="s27">d</span>min=min{d1,dp,. . .,dN}. The peer with the lowest download rate cannot obtain all <i>F </i>bits of the file in</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">less than <i>F</i>/<i>d</i><span class="s22">min </span>seconds. Thus the minimum distribution time is at least <i>F</i>/<i>d</i><span class="s22">min</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Putting these two observations together, we obtain</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Dcs≥max{NFus,Fdmin}.</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">This provides a lower bound on the minimum distribution time for the client-server architecture. In the homework problems you will be asked to show that the server can schedule its transmissions so that the lower bound is actually achieved. So let’s take this lower bound provided above as the actual distribution time, that is,</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark210">Dcs=max{NFus,Fdmin}                                                                                                                            </a><span class="s27">(2.1)</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 156%;text-align: left;"><a href="#bookmark210" class="s124">We see from </a><a href="#bookmark210" class="a">Equation 2.1</a><span class="s20"> </span>that for <i>N </i>large enough, the client-server distribution time is given by <i>NF</i>/<i>u</i><span class="s31">s</span>. Thus, the distribution time increases linearly with the number of peers <i>N</i>. So, for example, if the number</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">of peers from one week to the next increases a thousand-fold from a thousand to a million, the time</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">required to distribute the file to all peers increases by 1,000.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now go through a similar analysis for the P2P architecture, where each peer can assist the server in distributing the file. In particular, when a peer receives some file data, it can use its own upload capacity to redistribute the data to other peers. Calculating the distribution time for the P2P architecture is somewhat more complicated than for the client-server architecture, since the distribution time depends on how each peer distributes portions of the file to the other peers. Nevertheless, a simple</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark211">expression for the minimal distribution time can be obtained </a><a href="#bookmark848" class="a">[Kumar </a>2006]<span class="p">. To this end, we first make the following observations:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_170.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">At the beginning of the distribution, only the server has the file. To get this file into the community of peers, the server must send each bit of the file at least once into its access link. Thus, the minimum</p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 140%;text-align: left;">distribution time is at least <i>F</i>/<i>u</i><span class="s31">s</span>. (Unlike the client-server scheme, a bit sent once by the server may not have to be sent by the server again, as the peers may redistribute the bit among themselves.)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_171.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">As with the client-server architecture, the peer with the lowest download rate cannot obtain all <i>F </i>bits of the file in less than <i>F</i>/<i>d</i><span class="s22">min </span>seconds. Thus the minimum distribution time is at least <i>F</i>/<i>d</i><span class="s22">min</span>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_172.png"/></span></p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 118%;text-align: left;">Finally, observe that the total upload capacity of the system as a whole is equal to the upload rate of the server plus the upload rates of each of the individual peers, that is, utotal=us+u1+<span class="s29">⋯</span>+uN. The</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 137%;text-align: left;">system must deliver (upload) <i>F </i>bits to each of the <i>N </i>peers, thus delivering a total of <i>NF </i>bits. This cannot be done at a rate faster than <i>u</i><span class="s22">total</span>. Thus, the minimum distribution time is also at least NF/(us+u1+<span class="s29">⋯</span>+uN).</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Putting these three observations together, we obtain the minimum distribution time for P2P, denoted by</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">D<span class="s22">P2P</span><span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark212">DP2P≥max{Fus,Fdmin,NFus+∑i=1Nui}                                                                                                   </a><span class="s27">(2.2)</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark212" class="a">Equation 2.2</a> <span class="p">provides a lower bound for the minimum distribution time for the P2P architecture. It turns out that if we imagine that each peer can redistribute a bit as soon as it receives the bit, then there is a</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">redistribution scheme that actually achieves this lower bound </a><a href="#bookmark848" class="a">[Kumar </a>2006]<span class="p">. (We will prove a special case of this result in the homework.) In reality, where chunks of the file are redistributed rather than</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark212" class="s124">individual bits, </a><a href="#bookmark212" class="a">Equation 2.2</a> <a href="#bookmark212" class="s124">serves as a good approximation of the actual minimum distribution time. Thus, let’s take the lower bound provided by </a><a href="#bookmark212" class="a">Equation 2.2</a> <span class="p">as the actual minimum distribution time, that is,</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">DP2P=max{Fus,Fdmin,NFus+∑i=1Nui}                                                                                                   <span class="s27">(2.3)</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 127%;text-align: left;"><a href="#bookmark213" class="a">Figure 2.23</a><span class="s20"> </span>compares the minimum distribution time for the client-server and P2P architectures assuming that all peers have the same upload rate <i>u</i><a href="#bookmark213" class="s124">. In </a><a href="#bookmark213" class="a">Figure 2.2</a><span class="s20">3</span>, we have set <span class="s27">F/</span>u=1 hour, us=10u, and dmin≥us. Thus, a peer can transmit the entire file in one hour, the server transmission rate is 10</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">times the peer upload rate,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="551" height="367" alt="image" src="计算机网络自顶向下7th-en/Image_173.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark213">Figure 2.23 Distribution time for P2P and client-server architectures</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark213" class="s124">and (for simplicity) the peer download rates are set large enough so as not to have an effect. We see from </a><a href="#bookmark213" class="a">Figure 2.23</a> <span class="p">that for the client-server architecture, the distribution time increases linearly and</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">without bound as the number of peers increases. However, for the P2P architecture, the minimal distribution time is not only always less than the distribution time of the client-server architecture; it is also less than one hour for <i>any </i>number of peers <i>N</i>. Thus, applications with the P2P architecture can be</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">self-scaling. This scalability is a direct consequence of peers being redistributors as well as consumers</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">of bits.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">BitTorrent</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">BitTorrent is a popular P2P protocol for file distribution </a><a href="#bookmark848" class="a">[Chao 2011</a>]<span class="p">. In BitTorrent lingo, the collection of</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">all peers participating in the distribution of a particular file is called a <i>torrent</i>. Peers in a torrent download equal-size <i>chunks </i>of the file from one another, with a typical chunk size of 256 KBytes. When a peer first joins a torrent, it has no chunks. Over time it accumulates more and more chunks. While it</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">downloads chunks it also uploads chunks to other peers. Once a peer has acquired the entire file, it may (selfishly) leave the torrent, or (altruistically) remain in the torrent and continue to upload chunks to other peers. Also, any peer may leave the torrent at any time with only a subset of chunks, and later rejoin the torrent.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now take a closer look at how BitTorrent operates. Since BitTorrent is a rather complicated protocol and system, we’ll only describe its most important mechanisms, sweeping some of the details under the rug; this will allow us to see the forest through the trees. Each torrent has an infrastructure</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark214">node called a </a><i>tracker</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="668" height="512" alt="image" src="计算机网络自顶向下7th-en/Image_174.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark215">Figure 2.24 File distribution with BitTorrent</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">When a peer joins a torrent, it registers itself with the tracker and periodically informs the tracker that it is still in the torrent. In this manner, the tracker keeps track of the peers that are participating in the torrent. A given torrent may have fewer than ten or more than a thousand peers participating at any instant of time.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark215" class="s124">As shown in </a><a href="#bookmark215" class="a">Figure 2.2</a>4<span class="p">, when a new peer, Alice, joins the torrent, the tracker randomly selects a subset of peers (for concreteness, say 50) from the set of participating peers, and sends the IP addresses of these 50 peers to Alice. Possessing this list of peers, Alice attempts to establish</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">concurrent TCP connections with all the peers on this list. Let’s call all the peers with which Alice</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark215" class="s124">succeeds in establishing a TCP connection “neighboring peers.” (In </a><a href="#bookmark215" class="a">Figure 2.2</a>4<span class="p">, Alice is shown to have only three neighboring peers. Normally, she would have many more.) As time evolves, some of these peers may leave and other peers (outside the initial 50) may attempt to establish TCP connections with</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Alice. So a peer’s neighboring peers will fluctuate over time.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">At any given time, each peer will have a subset of chunks from the file, with different peers having different subsets. Periodically, Alice will ask each of her neighboring peers (over the TCP connections) for the list of the chunks they have. If Alice has <i>L </i>different neighbors, she will obtain <i>L </i>lists of chunks.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">With this knowledge, Alice will issue requests (again over the TCP connections) for chunks she currently</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">does not have.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">So at any given instant of time, Alice will have a subset of chunks and will know which chunks her neighbors have. With this information, Alice will have two important decisions to make. First, which chunks should she request first from her neighbors? And second, to which of her neighbors should she send requested chunks? In deciding which chunks to request, Alice uses a technique called <span class="s20">rarest first</span>. The idea is to determine, from among the chunks she does not have, the chunks that are the rarest among her neighbors (that is, the chunks that have the fewest repeated copies among her neighbors) and then request those rarest chunks first. In this manner, the rarest chunks get more quickly redistributed, aiming to (roughly) equalize the numbers of copies of each chunk in the torrent.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">To determine which requests she responds to, BitTorrent uses a clever trading algorithm. The basic idea is that Alice gives priority to the neighbors that are currently supplying her data <i>at the highest rate</i>.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Specifically, for each of her neighbors, Alice continually measures the rate at which she receives bits and determines the four peers that are feeding her bits at the highest rate. She then reciprocates by sending chunks to these same four peers. Every 10 seconds, she recalculates the rates and possibly modifies the set of four peers. In BitTorrent lingo, these four peers are said to be <span class="s20">unchoked</span>.  Importantly, every 30 seconds, she also picks one additional neighbor at random and sends it chunks. Let’s call the randomly chosen peer Bob. In BitTorrent lingo, Bob is said to be <span class="s20">optimistically unchoked</span>. Because Alice is sending data to Bob, she may become one of Bob’s top four uploaders, in which case Bob would start to send data to Alice. If the rate at which Bob sends data to Alice is high enough, Bob could then, in turn, become one of Alice’s top four uploaders. In other words, every 30 seconds, Alice will randomly choose a new trading partner and initiate trading with that partner. If the two peers are satisfied with the trading, they will put each other in their top four lists and continue trading with each other until one of the peers finds a better partner. The effect is that peers capable of uploading at compatible rates tend to find each other. The random neighbor selection also allows new peers to get chunks, so that they can have something to trade. All other neighboring peers besides these five peers</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;"><a name="bookmark216">(four “top” peers and one probing peer) are “choked,” that is, they do not receive any chunks from Alice. BitTorrent has a number of interesting mechanisms that are not discussed here, including pieces (mini- chunks), pipelining, random first selection, endgame mode, and anti-snubbing [Cohen 2003].</a><a name="bookmark217">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">The incentive mechanism for trading just described is often referred to as tit-for-tat [Cohen 2003]. It has been shown that this incentive scheme can be circumvented </a><a href="#bookmark848" class="a">[Liogkas 200</a>6<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Locher 200</a>6<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Piatek </a>2007]<span class="p">. Nevertheless, the BitTorrent ecosystem is wildly successful, with millions of simultaneous peers</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">actively sharing files in hundreds of thousands of torrents. If BitTorrent had been designed without tit-for-</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">tat (or a variant), but otherwise exactly the same, BitTorrent would likely not even exist now, as the majority of the users would have been freeriders </a><a href="#bookmark848" class="a">[Saroiu 2002</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="787" height="200" alt="image" src="计算机网络自顶向下7th-en/Image_175.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We close our discussion on P2P by briefly mentioning another application of P2P, namely, Distributed Hast Table (DHT). A distributed hash table is a simple database, with the database records being distributed over the peers in a P2P system. DHTs have been widely implemented (e.g., in BitTorrent) and have been the subject of extensive research. An overview is provided in a Video Note in the companion website.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Walking though distributed hash tables</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark218">Video Streaming and Content Distribution Networks</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">Streaming prerecorded video now accounts for the majority of the traffic in residential ISPs in North America. In particular, the Netflix and YouTube services alone consumed a whopping 37% and 16%, respectively, of residential ISP traffic in 2015 </a><a href="#bookmark848" class="a">[Sandvine 2015</a>]<span class="p">. In this section we will provide an</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">overview of how popular video streaming services are implemented in today’s Internet. We will see they</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">are implemented using application-level protocols and servers that function in some ways like a cache.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark671" class="s124">In </a><a href="#bookmark671" class="a">Chapter </a>9<span class="p">, devoted to multimedia networking, we will further examine Internet video as well as other Internet multimedia services.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l123"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Internet Video</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In streaming stored video applications, the underlying medium is prerecorded video, such as a movie, a television show, a prerecorded sporting event, or a prerecorded user-generated video (such as those commonly seen on YouTube). These prerecorded videos are placed on servers, and users send</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">requests to the servers to view the videos <i>on demand</i>. Many Internet companies today provide streaming video, including, Netflix, YouTube (Google), Amazon, and Youku.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">But before launching into a discussion of video streaming, we should first get a quick feel for the video medium itself. A video is a sequence of images, typically being displayed at a constant rate, for example, at 24 or 30 images per second. An uncompressed, digitally encoded image consists of an array of pixels, with each pixel encoded into a number of bits to represent luminance and color. An important characteristic of video is that it can be compressed, thereby trading off video quality with bit rate. Today’s off-the-shelf compression algorithms can compress a video to essentially any bit rate desired. Of course, the higher the bit rate, the better the image quality and the better the overall user viewing experience.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">From a networking perspective, perhaps the most salient characteristic of video is its high bit rate. Compressed Internet video typically ranges from 100 kbps for low-quality video to over 3 Mbps for streaming high-definition movies; 4K streaming envisions a bitrate of more than 10 Mbps. This can translate to huge amount of traffic and storage, particularly for high-end video. For example, a single 2 Mbps video with a duration of 67 minutes will consume 1 gigabyte of storage and traffic. By far, the most important performance measure for streaming video is average end-to-end throughput. In order to provide continuous playout, the network must provide an average throughput to the streaming application that is at least as large as the bit rate of the compressed video.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark219">We can also use compression to create multiple versions of the same video, each at a different quality level. For example, we can use compression to create, say, three versions of the same video, at rates of 300 kbps, 1 Mbps, and 3 Mbps. Users can then decide which version they want to watch as a function of their current available bandwidth. Users with high-speed Internet connections might choose the 3 Mbps version; users watching the video over 3G with a smartphone might choose the 300 kbps version.</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">HTTP Streaming and DASH</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;">In HTTP streaming, the video is simply stored at an HTTP server as an ordinary file with a specific URL. When a user wants to see the video, the client establishes a TCP connection with the server and issues an HTTP <span class="s30">GET </span>request for that URL. The server then sends the video file, within an HTTP response</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">message, as quickly as the underlying network protocols and traffic conditions will allow. On the client</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">side, the bytes are collected in a client application buffer. Once the number of bytes in this buffer exceeds a predetermined threshold, the client application begins playback—specifically, the streaming video application periodically grabs video frames from the client application buffer, decompresses the frames, and displays them on the user’s screen. Thus, the video streaming application is displaying video as it is receiving and buffering frames corresponding to latter parts of the video.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although HTTP streaming, as described in the previous paragraph, has been extensively deployed in practice (for example, by YouTube since its inception), it has a major shortcoming: All clients receive the same encoding of the video, despite the large variations in the amount of bandwidth available to a client, both across different clients and also over time for the same client. This has led to the development of a new type of HTTP-based streaming, often referred to as <span class="s20">Dynamic Adaptive Streaming over HTTP (DASH)</span>. In DASH, the video is encoded into several different versions, with each version having a different bit rate and, correspondingly, a different quality level. The client dynamically requests chunks of video segments of a few seconds in length. When the amount of available bandwidth is high, the client naturally selects chunks from a high-rate version; and when the available bandwidth is low, it naturally selects from a low-rate version. The client selects different chunks one at a time with HTTP GET request</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">messages </a><a href="#bookmark848" class="a">[Akhshabi 2011</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">DASH allows clients with different Internet access rates to stream in video at different encoding rates. Clients with low-speed 3G connections can receive a low bit-rate (and low-quality) version, and clients with fiber connections can receive a high-quality version. DASH also allows a client to adapt to the available bandwidth if the available end-to-end bandwidth changes during the session. This feature is particularly important for mobile users, who typically see their bandwidth availability fluctuate as they move with respect to the base stations.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">With DASH, each video version is stored in the HTTP server, each with a different URL. The HTTP</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark220">server also has a </a><span class="s20">manifest file</span>, which provides a URL for each version along with its bit rate. The client first requests the manifest file and learns about the various versions. The client then selects one chunk at a time by specifying a URL and a byte range in an HTTP GET request message for each chunk. While downloading chunks, the client also measures the received bandwidth and runs a rate determination algorithm to select the chunk to request next. Naturally, if the client has a lot of video buffered and if the measured receive bandwidth is high, it will choose a chunk from a high-bitrate version. And naturally if the client has little video buffered and the measured received bandwidth is low, it will choose a chunk from a low-bitrate version. DASH therefore allows the client to freely switch among different quality levels.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Content Distribution Networks</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Today, many Internet video companies are distributing on-demand multi-Mbps streams to millions of users on a daily basis. YouTube, for example, with a library of hundreds of millions of videos, distributes hundreds of millions of video streams to users around the world every day. Streaming all this traffic to locations all over the world while providing continuous playout and high interactivity is clearly a challenging task.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">For an Internet video company, perhaps the most straightforward approach to providing streaming video service is to build a single massive data center, store all of its videos in the data center, and stream the videos directly from the data center to clients worldwide. But there are three major problems with this approach. First, if the client is far from the data center, server-to-client packets will cross many communication links and likely pass through many ISPs, with some of the ISPs possibly located on different continents. If one of these links provides a throughput that is less than the video consumption rate, the end-to-end throughput will also be below the consumption rate, resulting in annoying freezing</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark5" class="s124">delays for the user. (Recall from </a><a href="#bookmark5" class="a">Chapter 1</a> <span class="p">that the end-to-end throughput of a stream is governed by the throughput at the bottleneck link.) The likelihood of this happening increases as the number of links in the end-to-end path increases. A second drawback is that a popular video will likely be sent many</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">times over the same communication links. Not only does this waste network bandwidth, but the Internet</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">video company itself will be paying its provider ISP (connected to the data center) for sending the <i>same </i>bytes into the Internet over and over again. A third problem with this solution is that a single data center represents a single point of failure—if the data center or its links to the Internet goes down, it would not</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">be able to distribute <i>any </i>video streams.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In order to meet the challenge of distributing massive amounts of video data to users distributed around the world, almost all major video-streaming companies make use of <span class="s20">Content Distribution Networks (CDNs)</span>. A CDN manages servers in multiple geographically distributed locations, stores copies of the videos (and other types of Web content, including documents, images, and audio) in its servers, and attempts to direct each user request to a CDN location that will provide the best user experience. The</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">CDN may be a <span class="s20">private CDN</span>, that is, owned by the content provider itself; for example, Google’s CDN distributes YouTube videos and other types of content. The CDN may alternatively be a <span class="s20">third-party CDN </span>that distributes content on behalf of multiple content providers; Akamai, Limelight and Level-3 all</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 292%;text-align: left;"><a href="#bookmark848" class="s124">operate third-party CDNs. A very readable overview of modern CDNs is </a><a href="#bookmark848" class="a">[Leighton 200</a>9<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Nygren 2010</a>]<a href="#bookmark848" class="s124">. CDNs typically adopt one of two different server placement philosophies </a><a href="#bookmark848" class="a">[Huang 2008</a>]<span class="p">:</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_176.png"/></span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;"><b>Enter Deep. </b>One philosophy, pioneered by Akamai, is to <i>enter deep </i>into the access networks of Internet Service Providers, by deploying server clusters in access ISPs all over the world. (Access</p><p class="s20" style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark59" class="s124">networks are described in </a><a href="#bookmark59" class="a">Section 1.</a>3<span class="p">.) Akamai takes this approach with clusters in approximately 1,700 locations. The goal is to get close to end users, thereby improving user-perceived delay and throughput by decreasing the number of links and routers between the end user and the CDN server</span></p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">from which it receives content. Because of this highly distributed design, the task of maintaining and managing the clusters becomes challenging.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_177.png"/></span></p><p style="padding-top: 2pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>Bring Home. </b>A second design philosophy, taken by Limelight and many other CDN companies, is to <i>bring the ISPs home </i>by building large clusters at a smaller number (for example, tens) of sites. Instead of getting inside the access ISPs, these CDNs typically place their clusters in Internet</p><p class="s20" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark59" class="s124">Exchange Points (IXPs) (see </a><a href="#bookmark59" class="a">Section 1.</a>3<span class="p">). Compared with the enter-deep design philosophy, the bring-home design typically results in lower maintenance and management overhead, possibly at the expense of higher delay and lower throughput to end users.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Once its clusters are in place, the CDN replicates content across its clusters. The CDN may not want to place a copy of every video in each cluster, since some videos are rarely viewed or are only popular in some countries. In fact, many CDNs do not push videos to their clusters but instead use a simple pull strategy: If a client requests a video from a cluster that is not storing the video, then the cluster retrieves the video (from a central repository or from another cluster) and stores a copy locally while streaming</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark177" class="s124">the video to the client at the same time. Similar Web caching (see </a><a href="#bookmark177" class="a">Section 2.2.</a>5<span class="p">), when a cluster’s storage becomes full, it removes videos that are not frequently requested.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">CDN Operation</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having identified the two major approaches toward deploying a CDN, let’s now dive down into the nuts and bolts of how a CDN operates. When a browser in a user’s</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="181" alt="image" src="计算机网络自顶向下7th-en/Image_178.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><a name="bookmark221">CASE STUDY</a></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">GOOGLE’S NETWORK INFRASTRUCTURE</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">To support its vast array of cloud services—including search, Gmail, calendar, YouTube video, maps, documents, and social networks—Google has deployed an extensive private network and CDN infrastructure. Google’s CDN infrastructure has three tiers of server clusters:</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="672" alt="image" src="计算机网络自顶向下7th-en/Image_179.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_180.png"/></span></p><p class="s20" style="padding-top: 3pt;padding-left: 49pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">Fourteen “mega data centers,” with eight in North America, four in Europe, and two in Asia </a><a href="#bookmark848" class="a">[Google Locations 2016</a>]<span class="p">, with each data center having on the order of 100,000 servers. These mega data centers are responsible for serving dynamic (and often personalized)</span></p><p style="padding-top: 1pt;padding-left: 49pt;text-indent: 0pt;text-align: left;">content, including search results and Gmail messages.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_181.png"/></span></p><p class="s20" style="padding-left: 49pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">An estimated 50 clusters in IXPs scattered throughout the world, with each cluster consisting on the order of 100–500 servers </a><a href="#bookmark848" class="a">[Adhikari </a>2011a]<a href="#bookmark848" class="s124">. These clusters are responsible for serving static content, including YouTube videos </a><a href="#bookmark848" class="a">[Adhikari </a>2011a]<span class="p">.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_182.png"/></span></p><p style="padding-left: 49pt;text-indent: 0pt;line-height: 130%;text-align: left;">Many hundreds of “enter-deep” clusters located within an access ISP. Here a cluster typically consists of tens of servers within a single rack. These enter-deep servers perform</p><p class="s20" style="padding-top: 4pt;padding-left: 49pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark355" class="s124">TCP splitting (see </a><a href="#bookmark355" class="a">Section 3.</a>7<a href="#bookmark848" class="s124">) and serve static content </a><a href="#bookmark848" class="a">[Chen 2011</a>]<span class="p">, including the static portions of Web pages that embody search results.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">All of these data centers and cluster locations are networked together with Google’s own private network. When a user makes a search query, often the query is first sent over the local ISP to a nearby enter-deep cache, from where the static content is retrieved; while providing the static content to the client, the nearby cache also forwards the query over Google’s private network to one of the mega data centers, from where the personalized search results are retrieved. For a YouTube video, the video itself may come from one of the bring-home caches, whereas portions of the Web page surrounding the video may come from the nearby enter-deep cache, and the advertisements surrounding the video come from the data centers. In summary, except for the local ISPs, the Google cloud services are largely provided by a network infrastructure that is independent of the public Internet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">host is instructed to retrieve a specific video (identified by a URL), the CDN must intercept the request so that it can (1) determine a suitable CDN server cluster for that client at that time, and (2) redirect the client’s request to a server in that cluster. We’ll shortly discuss how a CDN can determine a suitable cluster. But first let’s examine the mechanics behind intercepting and redirecting a request.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">Most CDNs take advantage of DNS to intercept and redirect requests; an interesting discussion of such a use of the DNS is </a><a href="#bookmark848" class="a">[Vixie 2009</a>]<span class="p">. Let’s consider a simple example to illustrate how the DNS is typically</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">involved. Suppose a content provider, NetCinema, employs the third-party CDN company, KingCDN, to distribute its videos to its customers. On the NetCinema Web pages, each of its videos is assigned a URL that includes the string “video” and a unique identifier for the video itself; for example, Transformers</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="http://video.netcinema.com/6Y7B23V" class="s124" target="_blank">7 might be assigned </a><a href="http://video.netcinema.com/6Y7B23V" class="a" target="_blank">http://video.netcinema.com/6Y7B23</a>V<a href="#bookmark222" class="s124">. Six steps then occur, as shown in </a><a href="#bookmark222" class="a">Figure 2.2</a>5<span class="p">:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l124"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The user visits the Web page at NetCinema.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 139%;text-align: left;"><p class="s20" style="display: inline;"><a href="http://video.netcinema.com/6Y7B23V" class="s124" target="_blank">When the user clicks on the link </a><a href="http://video.netcinema.com/6Y7B23V" class="a" target="_blank">http://video.netcinema.com/6Y7B23</a>V<a href="http://video.netcinema.com/" class="s124" target="_blank">, the user’s host sends a DNS query for </a>video.netcinema.com<span class="p">.</span></p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 138%;text-align: left;"><p class="s20" style="display: inline;"><a href="http://video.netcinema.com/" class="s124" target="_blank">The user’s Local DNS Server (LDNS) relays the DNS query to an authoritative DNS server for NetCinema, which observes the string “video” in the hostname </a>video.netcinema.com<span class="p">. To “hand over” the DNS query to KingCDN, instead of returning an IP address, the NetCinema authoritative DNS server returns to the LDNS a hostname in the KingCDN’s domain, for</span></p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">example, <span style=" color: #AAA;">a1105.kingcdn.com</span>.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="535" height="406" alt="image" src="计算机网络自顶向下7th-en/Image_183.png"/></span></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 140%;text-align: left;"><p style="display: inline;">From this point on, the DNS query enters into KingCDN’s private DNS infrastructure. The user’s LDNS then sends a second query, now for <span style=" color: #AAA;">a1105.kingcdn.com</span>, and KingCDN’s DNS system eventually returns the IP addresses of a KingCDN content server to the LDNS. It is thus here, within the KingCDN’s DNS system, that the CDN server from which the client will receive its content is specified.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-left: 48pt;text-indent: 0pt;text-align: left;"><a name="bookmark222">Figure 2.25 DNS redirects a user’s request to a CDN server</a></h2><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The LDNS forwards the IP address of the content-serving CDN node to the user’s host.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Once the client receives the IP address for a KingCDN content server, it establishes a direct TCP connection with the server at that IP address and issues an HTTP GET request for the</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">video. If DASH is used, the server will first send to the client a manifest file with a list of URLs, one for each version of the video, and the client will dynamically select chunks from the different versions.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Cluster Selection Strategies</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">At the core of any CDN deployment is a <span class="s20">cluster selection strategy</span>, that is, a mechanism for dynamically directing clients to a server cluster or a data center within the CDN. As we just saw, the</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark223">CDN learns the IP address of the client’s LDNS server via the client’s DNS lookup. After learning this IP address, the CDN needs to select an appropriate cluster based on this IP address. CDNs generally employ proprietary cluster selection strategies. We now briefly survey a few approaches, each of which has its own advantages and disadvantages.</a></p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><span class="p">One simple strategy is to assign the client to the cluster that is </span>geographically closest<a href="#bookmark848" class="s124">. Using commercial geo-location databases (such as Quova </a><a href="#bookmark848" class="a">[Quova 2016]</a> <a href="#bookmark848" class="s124">and Max-Mind </a><a href="#bookmark848" class="a">[MaxMind 2016</a>]<span class="p">),</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">each LDNS IP address is mapped to a geographic location. When a DNS request is received from a particular LDNS, the CDN chooses the geographically closest cluster, that is, the cluster that is the fewest kilometers from the LDNS “as the bird flies.” Such a solution can work reasonably well for a large</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">fraction of the clients </a><a href="#bookmark848" class="a">[Agarwal </a>2009]<span class="p">. However, for some clients, the solution may perform poorly, since the geographically closest cluster may not be the closest cluster in terms of the length or number of hops of the network path. Furthermore, a problem inherent with all DNS-based approaches is that some</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">end-users are configured to use remotely located LDNSs </a><a href="#bookmark848" class="a">[Shaikh 200</a>1<span class="p">; Mao 2002], in which case the LDNS location may be far from the client’s location. Moreover, this simple strategy ignores the variation in delay and available bandwidth over time of Internet paths, always assigning the same cluster to a</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">particular client.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">In order to determine the best cluster for a client based on the <i>current </i>traffic conditions, CDNs can instead perform periodic <span class="s20">real-time measurements </span>of delay and loss performance between their clusters and clients. For instance, a CDN can have each of its clusters periodically send probes (for</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">example, ping messages or DNS queries) to all of the LDNSs around the world. One drawback of this approach is that many LDNSs are configured to not respond to such probes.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Case Studies: Netflix, YouTube, and Kankan</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We conclude our discussion of streaming stored video by taking a look at three highly successful large- scale deployments: Netflix, YouTube, and Kankan. We’ll see that each of these systems take a very different approach, yet employ many of the underlying principles discussed in this section.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Netflix</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">Generating 37% of the downstream traffic in residential ISPs in North America in 2015, Netflix has become the leading service provider for online movies and TV series in the United States </a><a href="#bookmark848" class="a">[Sandvine </a>2015]<span class="p">. As we discuss below, Netflix video distribution has two major components: the Amazon cloud</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">and its own private CDN infrastructure.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark224" class="s124">Netflix has a Web site that handles numerous functions, including user registration and login, billing, movie catalogue for browsing and searching, and a movie recommendation system. As shown in </a><a href="#bookmark224" class="a">Figure</a></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark224" class="a">2.2</a>6<span class="p">, this Web site (and its associated backend databases) run entirely on Amazon servers in the Amazon cloud. Additionally, the Amazon cloud handles the following critical functions:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_184.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Content ingestion. <span class="p">Before Netflix can distribute a movie to its customers, it must first ingest and process the movie. Netflix receives studio master versions of movies and uploads them to hosts in the Amazon cloud.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_185.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Content processing. <span class="p">The machines in the Amazon cloud create many different formats for each movie, suitable for a diverse array of client video players running on desktop computers, smartphones, and game consoles connected to televisions. A different version is created for each of</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">these formats and at multiple bit rates, allowing for adaptive streaming over HTTP using DASH.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_186.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Uploading versions to its CDN. <span class="p">Once all of the versions of a movie have been created, the hosts in the Amazon cloud upload the versions to its CDN.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="545" height="429" alt="image" src="计算机网络自顶向下7th-en/Image_187.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark224">Figure 2.26 Netflix video streaming platform</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark225">When Netflix first rolled out its video streaming service in 2007, it employed three third-party CDN companies to distribute its video content. Netflix has since created its own private CDN, from which it now streams all of its videos. (Netflix still uses Akamai to distribute its Web pages, however.) To create its own CDN, Netflix has installed server racks both in IXPs and within residential ISPs themselves.</a></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">Netflix currently has server racks in over 50 IXP locations; see </a><a href="#bookmark848" class="a">[Netflix Open Connect 2016]</a> <span class="p">for a current list of IXPs housing Netflix racks. There are also hundreds of ISP locations housing Netflix racks;</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">also see </a><a href="#bookmark848" class="a">[Netflix Open Connect 2016</a>]<span class="p">, where Netflix provides to potential ISP partners instructions about installing a (free) Netflix rack for their networks. Each server in the rack has several 10 Gbps</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Ethernet ports and over 100 terabytes of storage. The number of servers in a rack varies: IXP installations often have tens of servers and contain the entire Netflix streaming video library, including multiple versions of the videos to support DASH; local IXPs may only have one server and contain only</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark177" class="s124">the most popular videos. Netflix does not use pull-caching (</a><a href="#bookmark177" class="a">Section 2.2.</a>5<span class="p">) to populate its CDN servers in the IXPs and ISPs. Instead, Netflix distributes by pushing the videos to its CDN servers during off- peak hours. For those locations that cannot hold the entire library, Netflix pushes only the most popular</span></p><p class="s20" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">videos, which are determined on a day-to-day basis. The Netflix CDN design is described in some detail in the YouTube videos </a><a href="#bookmark848" class="a">[Netflix Video 1]</a> <a href="#bookmark848" class="s124">and </a><a href="#bookmark848" class="a">[Netflix Video 2</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having described the components of the Netflix architecture, let’s take a closer look at the interaction between the client and the various servers that are involved in movie delivery. As indicated earlier, the Web pages for browsing the Netflix video library are served from servers in the Amazon cloud. When a user selects a movie to play, the Netflix software, running in the Amazon cloud, first determines which of its CDN servers have copies of the movie. Among the servers that have the movie, the software then determines the “best” server for that client request. If the client is using a residential ISP that has a Netflix CDN server rack installed in that ISP, and this rack has a copy of the requested movie, then a server in this rack is typically selected. If not, a server at a nearby IXP is typically selected.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Once Netflix determines the CDN server that is to deliver the content, it sends the client the IP address of the specific server as well as a manifest file, which has the URLs for the different versions of the requested movie. The client and that CDN server then directly interact using a proprietary version of</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark220" class="s124">DASH. Specifically, as described in </a><a href="#bookmark220" class="a">Section 2.6.</a>2<span class="p">, the client uses the byte-range header in HTTP GET request messages, to request chunks from the different versions of the movie. Netflix uses chunks that</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">are approximately four-seconds long </a><a href="#bookmark848" class="a">[Adhikari 2012</a>]<span class="p">. While the chunks are being downloaded, the client measures the received throughput and runs a rate-determination algorithm to determine the quality of the next chunk to request.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Netflix embodies many of the key principles discussed earlier in this section, including adaptive streaming and CDN distribution. However, because Netflix uses its own private CDN, which distributes only video (and not Web pages), Netflix has been able to simplify and tailor its CDN design. In particular,</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark223" class="s124" name="bookmark226">Netflix does not need to employ DNS redirect, as discussed in </a><a href="#bookmark223" class="a">Section 2.6.</a>3<span class="p">, to connect a particular client to a CDN server; instead, the Netflix software (running in the Amazon cloud) directly tells the client to use a particular CDN server. Furthermore, the Netflix CDN uses push caching rather than pull</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark177" class="s124">caching (</a><a href="#bookmark177" class="a">Section 2.2.</a>5<span class="p">): content is pushed into the servers at scheduled times at off-peak hours, rather than dynamically during cache misses.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">YouTube</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">With 300 hours of video uploaded to YouTube every minute and several billion video views per day</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark840" class="a">[YouTube 2016</a>]<span class="p">, YouTube is indisputably the world’s largest video-sharing site. YouTube began its</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark847" class="s124">service in April 2005 and was acquired by Google in November 2006. Although the Google/YouTube design and protocols are proprietary, through several independent measurement efforts we can gain a basic understanding about how YouTube operates </a><a href="#bookmark847" class="a">[Zink 200</a>9<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Torres </a>2011<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Adhikari 2011a</a>]<span class="p">. As with</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark848" class="s124">Netflix, YouTube makes extensive use of CDN technology to distribute its videos </a><a href="#bookmark848" class="a">[Torres </a>2011]<span class="p">. Similar</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">to Netflix, Google uses its own private CDN to distribute YouTube videos, and has installed server clusters in many hundreds of different IXP and ISP locations. From these locations and directly from its huge data centers, Google distributes YouTube videos </a><a href="#bookmark848" class="a">[Adhikari </a>2011a]<span class="p">. Unlike Netflix, however,</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark177" class="s124">Google uses pull caching, as described in </a><a href="#bookmark177" class="a">Section 2.2.</a>5<a href="#bookmark223" class="s124">, and DNS redirect, as described in </a><a href="#bookmark223" class="a">Section</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark223" class="a">2.6.</a>3<span class="p">. Most of the time, Google’s cluster-selection strategy directs the client to the cluster for which the RTT between client and cluster is the lowest; however, in order to balance the load across clusters,</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">sometimes the client is directed (via DNS) to a more distant cluster </a><a href="#bookmark848" class="a">[Torres </a>2011]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">YouTube employs HTTP streaming, often making a small number of different versions available for a video, each with a different bit rate and corresponding quality level. YouTube does not employ adaptive streaming (such as DASH), but instead requires the user to manually select a version. In order to save bandwidth and server resources that would be wasted by repositioning or early termination, YouTube uses the HTTP byte range request to limit the flow of transmitted data after a target amount of video is prefetched.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Several million videos are uploaded to YouTube every day. Not only are YouTube videos streamed from server to client over HTTP, but YouTube uploaders also upload their videos from client to server over HTTP. YouTube processes each video it receives, converting it to a YouTube video format and creating multiple versions at different bit rates. This processing takes place entirely within Google data centers.</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark223" class="s124">(See the case study on Google’s network infrastructure in </a><a href="#bookmark223" class="a">Section 2.6.</a>3<span class="p">.)</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Kankan</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark227">We just saw that dedicated servers, operated by private CDNs, stream Netflix and YouTube videos to clients. Netflix and YouTube have to pay not only for the server hardware but also for the bandwidth the servers use to distribute the videos. Given the scale of these services and the amount of bandwidth they are consuming, such a CDN deployment can be costly.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We conclude this section by describing an entirely different approach for providing video on demand over the Internet at a large scale—one that allows the service provider to significantly reduce its infrastructure and bandwidth costs. As you might suspect, this approach uses P2P delivery instead of (or along with) client-server delivery. Since 2011, Kankan (owned and operated by Xunlei) has been</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark846" class="s124">deploying P2P video delivery with great success, with tens of millions of users every month </a><a href="#bookmark846" class="a">[Zhang </a>2015]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">At a high level, P2P video streaming is very similar to BitTorrent file downloading. When a peer wants to</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark228">see a video, it contacts a tracker to discover other peers in the system that have a copy of that video. This requesting peer then requests chunks of the video in parallel from the other peers that have the video. Different from downloading with BitTorrent, however, requests are preferentially made for chunks</a><a name="bookmark229">&zwnj;</a></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">that are to be played back in the near future in order to ensure continuous playback </a><a href="#bookmark848" class="a">[Dhungel 2012</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark846" class="s124">Recently, Kankan has migrated to a hybrid CDN-P2P streaming system </a><a href="#bookmark846" class="a">[Zhang 2015</a>]<span class="p">. Specifically, Kankan now deploys a few hundred servers within China and pushes video content to these servers. This Kankan CDN plays a major role in the start-up stage of video streaming. In most cases, the client</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">requests the beginning of the content from CDN servers, and in parallel requests content from peers. When the total P2P traffic is sufficient for video playback, the client will cease streaming from the CDN and only stream from peers. But if the P2P streaming traffic becomes insufficient, the client will restart CDN connections and return to the mode of hybrid CDN-P2P streaming. In this manner, Kankan can ensure short initial start-up delays while minimally relying on costly infrastructure servers and bandwidth.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l125"><ol id="l126"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark230">Socket Programming: Creating Network Applications</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark157" class="s124">Now that we’ve looked at a number of important network applications, let’s explore how network application programs are actually created. Recall from </a><a href="#bookmark157" class="a">Section 2.1</a> <span class="p">that a typical network application</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">consists of a pair of programs—a client program and a server program—residing in two different end systems. When these two programs are executed, a client process and a server process are created, and these processes communicate with each other by reading from, and writing to, sockets. When creating a network application, the developer’s main task is therefore to write the code for both the client and server programs.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">There are two types of network applications. One type is an implementation whose operation is specified in a protocol standard, such as an RFC or some other standards document; such an application is sometimes referred to as “open,” since the rules specifying its operation are known to all. For such an implementation, the client and server programs must conform to the rules dictated by the RFC. For example, the client program could be an implementation of the client side of the HTTP</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark176" class="s124">protocol, described in </a><a href="#bookmark176" class="a">Section 2.2</a> <span class="p">and precisely defined in RFC 2616; similarly, the server program could be an implementation of the HTTP server protocol, also precisely defined in RFC 2616. If one developer writes code for the client program and another developer writes code for the server program,</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">and both developers carefully follow the rules of the RFC, then the two programs will be able to interoperate. Indeed, many of today’s network applications involve communication between client and server programs that have been created by independent developers—for example, a Google Chrome browser communicating with an Apache Web server, or a BitTorrent client communicating with BitTorrent tracker.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">The other type of network application is a proprietary network application. In this case the client and server programs employ an application-layer protocol that has <i>not </i>been openly published in an RFC or</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">elsewhere. A single developer (or development team) creates both the client and server programs, and the developer has complete control over what goes in the code. But because the code does not implement an open protocol, other independent developers will not be able to develop code that interoperates with the application.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section, we’ll examine the key issues in developing a client-server application, and we’ll “get our hands dirty” by looking at code that implements a very simple client-server application. During the development phase, one of the first decisions the developer must make is whether the application is to run over TCP or over UDP. Recall that TCP is connection oriented and provides a reliable byte-stream channel through which data flows between two end systems. UDP is connectionless and sends independent packets of data from one end system to the other, without any guarantees about delivery.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Recall also that when a client or server program implements a protocol defined by an RFC, it should use the well-known port number associated with the protocol; conversely, when developing a proprietary application, the developer must be careful to avoid using such well-known port numbers. (Port numbers</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark157" class="s124">were briefly discussed in </a><a href="#bookmark157" class="a">Section 2.</a>1<a href="#bookmark254" class="s124">. They are covered in more detail in </a><a href="#bookmark254" class="a">Chapter </a>3<span class="p">.)</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We introduce UDP and TCP socket programming by way of a simple UDP application and a simple TCP application. We present the simple UDP and TCP applications in Python 3. We could have written the code in Java, C, or C++, but we chose Python mostly because Python clearly exposes the key socket concepts. With Python there are fewer lines of code, and each line can be explained to the novice programmer without difficulty. But there’s no need to be frightened if you are not familiar with Python. You should be able to easily follow the code if you have experience programming in Java, C, or C++.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">If you are interested in client-server programming with Java, you are encouraged to see the Companion Website for this textbook; in fact, you can find there all the examples in this section (and associated labs) in Java. For readers who are interested in client-server programming in C, there are several good</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">references available </a><a href="#bookmark848" class="a">[Donahoo 200</a>1<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Stevens </a>1997<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Frost 199</a>4<span class="p">; Kurose 1996]; our Python examples below have a similar look and feel to C.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l127"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Socket Programming with UDP</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this subsection, we’ll write simple client-server programs that use UDP; in the following section, we’ll write similar programs that use TCP.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark157" class="s124">Recall from </a><a href="#bookmark157" class="a">Section 2.1</a> <span class="p">that processes running on different machines communicate with each other by sending messages into sockets. We said that each process is analogous to a house and the process’s socket is analogous to a door. The application resides on one side of the door in the house; the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">transport-layer protocol resides on the other side of the door in the outside world. The application developer has control of everything on the application-layer side of the socket; however, it has little control of the transport-layer side.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now let’s take a closer look at the interaction between two communicating processes that use UDP sockets. Before the sending process can push a packet of data out the socket door, when using UDP, it must first attach a destination address to the packet. After the packet passes through the sender’s socket, the Internet will use this destination address to route the packet through the Internet to the socket in the receiving process. When the packet arrives at the receiving socket, the receiving process will retrieve the packet through the socket, and then inspect the packet’s contents and take appropriate action.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">So you may be now wondering, what goes into the destination address that is attached to the packet?</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">As you might expect, the destination host’s IP address is part of the destination address. By including the destination IP address in the packet, the routers in the Internet will be able to route the packet through the Internet to the destination host. But because a host may be running many network application processes, each with one or more sockets, it is also necessary to identify the particular</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">socket in the destination host. When a socket is created, an identifier, called a <b>port number</b>, is assigned to it. So, as you might expect, the packet’s destination address also includes the socket’s port number. In summary, the sending process attaches to the packet a destination address, which consists of the</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">destination host’s IP address and the destination socket’s port number. Moreover, as we shall soon see, the sender’s source address—consisting of the IP address of the source host and the port number of the source socket—are also attached to the packet. However, attaching the source address to the packet is</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">typically <i>not </i>done by the UDP application code; instead it is automatically done by the underlying operating system.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We’ll use the following simple client-server application to demonstrate socket programming for both UDP and TCP:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l128"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The client reads a line of characters (data) from its keyboard and sends the data to the server.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The server receives the data and converts the characters to uppercase.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The server sends the modified data to the client.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The client receives the modified data and displays the line on its screen.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark231" class="a">Figure 2.27</a> <span class="p">highlights the main socket-related activity of the client and server that communicate over the UDP transport service.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now let’s get our hands dirty and take a look at the client-server program pair for a UDP implementation of this simple application. We also provide a detailed, line-by-line analysis after each program. We’ll begin with the UDP client, which will send a simple application-level message to the server. In order for</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="673" height="571" alt="image" src="计算机网络自顶向下7th-en/Image_188.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark231">Figure 2.27 The client-server application using UDP</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the server to be able to receive and reply to the client’s message, it must be ready and running—that is, it must be running as a process before the client sends its message.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The client program is called UDPClient.py, and the server program is called UDPServer.py. In order to emphasize the key issues, we intentionally provide code that is minimal. “Good code” would certainly have a few more auxiliary lines, in particular for handling error cases. For this application, we have arbitrarily chosen 12000 for the server port number.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">UDPClient.py</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="124" alt="image" src="计算机网络自顶向下7th-en/Image_189.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Here is the code for the client side of the application:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 1pt;line-height: 148%;text-align: left;">from socket import * serverName = ’hostname’ serverPort = 12000</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="187" alt="image" src="计算机网络自顶向下7th-en/Image_190.png"/></span></p><p class="s30" style="padding-top: 4pt;padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">clientSocket = socket(AF_INET, SOCK_DGRAM) message = raw_input(’Input lowercase sentence:’)</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">clientSocket.sendto(message.encode(),(serverName,  serverPort)) modifiedMessage, serverAddress = clientSocket.recvfrom(2048) print(modifiedMessage.decode())</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">clientSocket.close()</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_191.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Now let’s take a look at the various lines of code in UDPClient.py.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">from socket import *</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="106" alt="image" src="计算机网络自顶向下7th-en/Image_192.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">The <span class="s30">socket </span>module forms the basis of all network communications in Python. By including this line, we will be able to create sockets within our program.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 1pt;line-height: 148%;text-align: left;">serverName = ’hostname’ serverPort = 12000</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">The first line sets the variable <span class="s30">serverName </span>to the string ‘hostname’. Here, we provide a string containing either the IP address of the server (e.g., “128.138.32.126”) or the hostname of the server (e.g., “cis.poly.edu”). If we use the hostname, then a DNS lookup will automatically be performed to get</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_193.png"/></span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the IP address.) The second line sets the integer variable <span class="s30">serverPort </span>to 12000.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">clientSocket = socket(AF_INET, SOCK_DGRAM)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;"><a name="bookmark232">This line creates the client’s socket, called </a><span class="s30">clientSocket </span>. The first parameter indicates the address family; in particular, <span class="s30">AF_INET </span><a href="#bookmark368" class="s124">indicates that the underlying network is using IPv4. (Do not worry about this now—we will discuss IPv4 in </a><a href="#bookmark368" class="a">Chapter </a><span class="s20">4</span>.) The second parameter indicates that the socket is of type <span class="s30">SOCK_DGRAM </span>, which means it is a UDP socket (rather than a TCP socket). Note that we are not</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">specifying the port number of the client socket when we create it; we are instead letting the operating</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="73" alt="image" src="计算机网络自顶向下7th-en/Image_194.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">system do this for us. Now that the client process’s door has been created, we will want to create a message to send through the door.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">message = raw_input(’Input lowercase sentence:’)</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_195.png"/></span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-top: 3pt;padding-left: 6pt;text-indent: 2pt;line-height: 130%;text-align: left;">raw_input() <span class="p">is a built-in function in Python. When this command is executed, the user at the client is prompted with the words “Input lowercase sentence:” The user then uses her keyboard to input a line,</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_196.png"/></span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">which is put into the variable <span class="s30">message </span>. Now that we have a socket and a message, we will want to send the message through the socket to the destination host.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">clientSocket.sendto(message.encode(),(serverName,  serverPort))</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">In the above line, we first convert the message from string type to byte type, as we need to send bytes into a socket; this is done with the <span class="s30">encode() </span>method. The method <span class="s30">sendto() </span>attaches the destination address ( <span class="s30">serverName, serverPort </span>) to the message and sends the resulting packet into the</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 14pt;text-align: left;">process’s socket, <span class="s30">clientSocket </span>. (As mentioned earlier, the source address is also attached to the</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_197.png"/></span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">packet, although this is done automatically rather than explicitly by the code.) Sending a client-to-server message via a UDP socket is that simple! After sending the packet, the client waits to receive data from the server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">modifiedMessage, serverAddress = clientSocket.recvfrom(2048)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">With the above line, when a packet arrives from the Internet at the client’s socket, the packet’s data is put into the variable <span class="s30">modifiedMessage </span>and the packet’s source address is put into the variable <span class="s30">serverAddress </span>. The variable  <span class="s30">serverAddress </span>contains both the server’s IP address and the</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">server’s port number. The program UDPClient doesn’t actually need this server address information,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">since it already knows the server address from the outset; but this line of Python provides the server</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_198.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">address nevertheless. The method <span class="s30">recvfrom </span>also takes the buffer size 2048 as input. (This buffer size works for most purposes.)</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">print(modifiedMessage.decode())</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_199.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark233">This line prints out modifiedMessage on the user’s display, after converting the message from bytes to string. It should be the original line that the user typed, but now capitalized.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">clientSocket.close()</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">This line closes the socket. The process then terminates.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">UDPServer.py</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="302" alt="image" src="计算机网络自顶向下7th-en/Image_200.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Let’s now take a look at the server side of the application:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 1pt;line-height: 148%;text-align: left;">from socket import * serverPort = 12000</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">serverSocket = socket(AF_INET, SOCK_DGRAM) serverSocket.bind((’’, serverPort)) print(”The server is ready to receive”) while True:</p><p class="s30" style="padding-left: 61pt;text-indent: 0pt;line-height: 148%;text-align: left;">message, clientAddress = serverSocket.recvfrom(2048) modifiedMessage = message.decode().upper() serverSocket.sendto(modifiedMessage.encode(),  clientAddress)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 24pt;text-align: left;">Note that the beginning of UDPServer is similar to UDPClient. It also imports the socket module, also sets the integer variable <span class="s30">serverPort </span>to 12000, and also creates a socket of type <span class="s30">SOCK_DGRAM </span>(a</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_201.png"/></span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">UDP socket). The first line of code that is significantly different from UDPClient is:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">serverSocket.bind((’’, serverPort))</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_202.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The above line binds (that is, assigns) the port number 12000 to the server’s socket. Thus in UDPServer, the code (written by the application developer) is explicitly assigning a port number to the socket. In this manner, when anyone sends a packet to port 12000 at the IP address of the server, that packet will be directed to this socket. UDPServer then enters a while loop; the while loop will allow UDPServer to receive and process packets from clients indefinitely. In the while loop, UDPServer waits for a packet to arrive.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">message, clientAddress = serverSocket.recvfrom(2048)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">This line of code is similar to what we saw in UDPClient. When a packet arrives at the server’s socket, the packet’s data is put into the variable <span class="s30">message </span>and the packet’s source address is put into the variable  <span class="s30">clientAddress </span>. The variable clientAddress contains both the client’s IP address and the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">client’s port number. Here, UDPServer <i>will </i>make use of this address information, as it provides a return</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_203.png"/></span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark234">address, similar to the return address with ordinary postal mail. With this source address information, the server now knows to where it should direct its reply.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">modifiedMessage = message.decode().upper()</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_204.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;">This line is the heart of our simple application. It takes the line sent by the client and, after converting the message to a string, uses the method <span class="s30">upper() </span>to capitalize it.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">serverSocket.sendto(modifiedMessage.encode(),  clientAddress)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">This last line attaches the client’s address (IP address and port number) to the capitalized message (after converting the string to bytes), and sends the resulting packet into the server’s socket. (As mentioned earlier, the server address is also attached to the packet, although this is done automatically rather than explicitly by the code.) The Internet will then deliver the packet to this client address. After the server sends the packet, it remains in the while loop, waiting for another UDP packet to arrive (from any client running on any host).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To test the pair of programs, you run UDPClient.py on one host and UDPServer.py on another host. Be sure to include the proper hostname or IP address of the server in UDPClient.py. Next, you execute UDPServer.py, the compiled server program, in the server host. This creates a process in the server that idles until it is contacted by some client. Then you execute UDPClient.py, the compiled client program, in the client. This creates a process in the client. Finally, to use the application at the client, you type a sentence followed by a carriage return.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">To develop your own UDP client-server application, you can begin by slightly modifying the client or server programs. For example, instead of converting all the letters to uppercase, the server could count the number of times the letter <i>s </i>appears and return this number. Or you can modify the client so that</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">after receiving a capitalized sentence, the user can continue to send more sentences to the server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Socket Programming with TCP</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Unlike UDP, TCP is a connection-oriented protocol. This means that before the client and server can start to send data to each other, they first need to handshake and establish a TCP connection. One end of the TCP connection is attached to the client socket and the other end is attached to a server socket. When creating the TCP connection, we associate with it the client socket address (IP address and port</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">number) and the server socket address (IP address and port number). With the TCP connection established, when one side wants to send data to the other side, it just drops the data into the TCP connection via its socket. This is different from UDP, for which the server must attach a destination address to the packet before dropping it into the socket.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now let’s take a closer look at the interaction of client and server programs in TCP. The client has the job of initiating contact with the server. In order for the server to be able to react to the client’s initial contact, the server has to be ready. This implies two things. First, as in the case of UDP, the TCP server must be running as a process before the client attempts to initiate contact. Second, the server program must have a special door—more precisely, a special socket—that welcomes some initial contact from a client process running on an arbitrary host. Using our house/door analogy for a process/socket, we will sometimes refer to the client’s initial contact as “knocking on the welcoming door.”</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">With the server process running, the client process can initiate a TCP connection to the server. This is done in the client program by creating a TCP socket. When the client creates its TCP socket, it specifies the address of the welcoming socket in the server, namely, the IP address of the server host and the port number of the socket. After creating its socket, the client initiates a three-way handshake and establishes a TCP connection with the server. The three-way handshake, which takes place within the transport layer, is completely invisible to the client and server programs.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">During the three-way handshake, the client process knocks on the welcoming door of the server process. When the server “hears” the knocking, it creates a new door—more precisely, a <i>new </i>socket</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">that is dedicated to that particular client. In our example below, the welcoming door is a TCP socket object that we call <span class="s30">­serverSocket </span>; the newly created socket dedicated to the client making the connection is called  <span class="s30">connectionSocket </span>. Students who are encountering TCP sockets for the first</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">time sometimes confuse the welcoming socket (which is the initial point of contact for all clients wanting</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">to communicate with the server), and each newly created server-side connection socket that is subsequently created for communicating with each client.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark236" class="s124">From the application’s perspective, the client’s socket and the server’s connection socket are directly connected by a pipe. As shown in </a><a href="#bookmark236" class="a">Figure 2.2</a>8<span class="p">, the client process can send arbitrary bytes into its</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">socket, and TCP guarantees that the server process will receive (through the connection socket) each byte in the order sent. TCP thus provides a reliable service between the client and server processes. Furthermore, just as people can go in and out the same door, the client process not only sends bytes into but also receives bytes from its socket; similarly, the server process not only receives bytes from but also sends bytes into its connection socket.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark238" class="s124">We use the same simple client-server application to demonstrate socket programming with TCP: The client sends one line of data to the server, the server capitalizes the line and sends it back to the client. </a><a href="#bookmark238" class="a">Figure 2.29</a> <span class="p">highlights the main socket-related activity of the client and server that communicate over</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark235">the TCP transport service.</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="477" height="432" alt="image" src="计算机网络自顶向下7th-en/Image_205.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s44" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark236">Figure</a><span class="h2"> 2.28 </span><span class="s45">The TCPServer </span>process<span class="h2"> has two sockets</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">TCPClient.py</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="330" alt="image" src="计算机网络自顶向下7th-en/Image_206.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Here is the code for the client side of the application:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 1pt;line-height: 148%;text-align: left;">from socket import * serverName = ’servername’ serverPort = 12000</p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;line-height: 148%;text-align: left;">clientSocket = socket(AF_INET, SOCK_STREAM) clientSocket.connect((serverName, serverPort)) sentence = raw_input(’Input lowercase sentence:’) clientSocket.send(sentence.encode()) modifiedSentence = clientSocket.recv(1024) print(’From Server: ’, modifiedSentence.decode()) clientSocket.close()</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now take a look at the various lines in the code that differ significantly from the UDP implementation. The first such line is the creation of the client socket.</p><p class="s30" style="padding-top: 4pt;padding-left: 32pt;text-indent: 0pt;text-align: left;">clientSocket = socket(AF_INET, SOCK_STREAM)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_207.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark237">This line creates the client’s socket, called </a><span class="s30">clientSocket </span>. The first parameter again indicates that the underlying network is using IPv4. The second parameter</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="669" height="696" alt="image" src="计算机网络自顶向下7th-en/Image_208.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark238">Figure 2.29 The client-server application using TCP</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">indicates that the socket is of type <span class="s30">SOCK_STREAM </span>, which means it is a TCP socket (rather than a UDP socket). Note that we are again not specifying the port number of the client socket when we create it; we are instead letting the operating system do this for us. Now the next line of code is very different from</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">what we saw in UDPClient:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="782" height="4" alt="image" src="计算机网络自顶向下7th-en/Image_209.png"/></span></p><p class="s30" style="padding-top: 4pt;padding-left: 32pt;text-indent: 0pt;text-align: left;">clientSocket.connect((serverName, serverPort))</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="76" alt="image" src="计算机网络自顶向下7th-en/Image_210.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Recall that before the client can send data to the server (or vice versa) using a TCP socket, a TCP connection must first be established between the client and server. The above line initiates the TCP connection between the client and server. The parameter of the <span class="s30">connect() </span>method is the address of</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the server side of the connection. After this line of code is executed, the three-way handshake is</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_211.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">performed and a TCP connection is established between the client and server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">sentence = raw_input(’Input lowercase sentence:’)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_212.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">As with UDPClient, the above obtains a sentence from the user. The string <span class="s30">sentence </span>continues to gather characters until the user ends the line by typing a carriage return. The next line of code is also very different from UDPClient:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">clientSocket.send(sentence.encode())</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_213.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">The above line sends the <span class="s30">sentence </span>through the client’s socket and into the TCP connection. Note that the program does <i>not </i>explicitly create a packet and attach the destination address to the packet, as was the case with UDP sockets. Instead the client program simply drops the bytes in the string <span class="s30">sentence </span>into the TCP connection. The client then waits to receive bytes from the server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">modifiedSentence = clientSocket.recv(2048)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_214.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">When characters arrive from the server, they get placed into the string  <span class="s30">modifiedSentence </span>. Characters continue to accumulate in  <span class="s30">modifiedSentence </span>until the line ends with a carriage return character. After printing the capitalized sentence, we close the client’s socket:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">clientSocket.close()</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark329" class="s124">This last line closes the socket and, hence, closes the TCP connection between the client and the server. It causes TCP in the client to send a TCP message to TCP in the server (see </a><a href="#bookmark329" class="a">Section 3.</a>5<span class="p">).</span></p><p class="s24" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">TCPServer.py</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="386" alt="image" src="计算机网络自顶向下7th-en/Image_215.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Now let’s take a look at the server program.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 1pt;line-height: 148%;text-align: left;">from socket import * serverPort = 12000</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">serverSocket = socket(AF_INET, SOCK_STREAM) serverSocket.bind((’’, serverPort)) serverSocket.listen(1)</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">print(’The server is ready to receive’) while True:</p><p class="s30" style="padding-left: 61pt;text-indent: 0pt;line-height: 148%;text-align: left;">connectionSocket, addr = serverSocket.accept() sentence = connectionSocket.recv(1024).decode() capitalizedSentence = sentence.upper() connectionSocket.send(capitalizedSentence.encode()) connectionSocket.close()</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_216.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now take a look at the lines that differ significantly from UDPServer and TCPClient. As with TCPClient, the server creates a TCP socket with:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">serverSocket=socket(AF_INET, SOCK_STREAM)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_217.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Similar to UDPServer, we associate the server port number, <span class="s30">serverPort </span>, with this socket:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">serverSocket.bind((’’, serverPort))</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_218.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">But with TCP, <span class="s30">serverSocket </span>will be our welcoming socket. After establishing this welcoming door, we will wait and listen for some client to knock on the door:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">serverSocket.listen(1)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">This line has the server listen for TCP connection requests from the client. The parameter specifies the maximum number of queued connections (at least 1).</p><p class="s30" style="padding-top: 3pt;padding-left: 32pt;text-indent: 0pt;text-align: left;"><a name="bookmark239">connectionSocket, addr = serverSocket.accept()</a><a name="bookmark240">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_219.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">When a client knocks on this door, the program invokes the <span class="s30">accept() </span>method for serverSocket, which creates a new socket in the server, called <span class="s30">­connectionSocket </span>, dedicated to this particular client.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">The client and server then complete the handshaking, creating a TCP connection between the client’s</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_220.png"/></span></p><p class="s30" style="padding-left: 5pt;text-indent: 2pt;line-height: 138%;text-align: left;">clientSocket <span class="p">and the server’s  </span>connectionSocket <span class="p">. With the TCP connection established, the client and server can now send bytes to each other over the connection. With TCP, all bytes sent from one side not are not only guaranteed to arrive at the other side but also guaranteed arrive in order.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">connectionSocket.close()</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 24pt;text-align: left;">In this program, after sending the modified sentence to the client, we close the connection socket. But since <span class="s30">serverSocket </span>remains open, another client can now knock on the door and send the server a</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">sentence to modify.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">This completes our discussion of socket programming in TCP. You are encouraged to run the two programs in two separate hosts, and also to modify them to achieve slightly different goals. You should compare the UDP program pair with the TCP program pair and see how they differ. You should also do</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark138" class="s124">many of the socket programming assignments described at the ends of </a><a href="#bookmark138" class="a">Chapter </a>2<a href="#bookmark368" class="s124">, </a>4<a href="#bookmark775" class="s124">, and </a>9<span class="p">. Finally, we hope someday, after mastering these and more advanced socket programs, you will write your own popular network application, become very rich and famous, and remember the authors of this textbook!</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li></ol></li><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark241">Summary</a><a name="bookmark242">&zwnj;</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this chapter, we’ve studied the conceptual and the implementation aspects of network applications. We’ve learned about the ubiquitous client-server architecture adopted by many Internet applications and seen its use in the HTTP, SMTP, POP3, and DNS protocols. We’ve studied these important application- level protocols, and their corresponding associated applications (the Web, file transfer, e-mail, and DNS) in some detail. We’ve learned about the P2P architecture and how it is used in many applications.  We’ve also learned about streaming video, and how modern video distribution systems leverage CDNs. We’ve examined how the socket API can be used to build network applications. We’ve walked through the use of sockets for connection-oriented (TCP) and connectionless (UDP) end-to-end transport services. The first step in our journey down the layered network architecture is now complete!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark15" class="s124">At the very beginning of this book, in </a><a href="#bookmark15" class="a">Section 1.</a>1<span class="p">, we gave a rather vague, bare-bones definition of a protocol: “the format and the order of messages exchanged between two or more communicating entities, as well as the actions taken on the transmission and/or receipt of a message or other event.”</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The material in this chapter, and in particular our detailed study of the HTTP, SMTP, POP3, and DNS protocols, has now added considerable substance to this definition. Protocols are a key concept in networking; our study of application protocols has now given us the opportunity to develop a more intuitive feel for what protocols are all about.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark157" class="s124">In </a><a href="#bookmark157" class="a">Section 2.</a>1<span class="p">, we described the service models that TCP and UDP offer to applications that invoke them. We took an even closer look at these service models when we developed simple applications that</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark239" class="s124">run over TCP and UDP in </a><a href="#bookmark239" class="a">Section 2.</a>7<span class="p">. However, we have said little about how TCP and UDP provide these service models. For example, we know that TCP provides a reliable data service, but we haven’t</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">said yet how it does so. In the next chapter we’ll take a careful look at not only the <i>what</i>, but also the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">how <span class="p">and </span>why <span class="p">of transport protocols.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark254" class="s124">Equipped with knowledge about Internet application structure and application-level protocols, we’re now ready to head further down the protocol stack and examine the transport layer in </a><a href="#bookmark254" class="a">Chapter </a>3<span class="p">.</span></p><p class="s18" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark243">Homework Problems and Questions</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Chapter 2 Review Questions</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 2.1</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R1. List five nonproprietary Internet applications and the application-layer protocols that they use.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R2. What is the difference between network architecture and application architecture?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R3. For a communication session between a pair of processes, which process is the client and which is the server?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R4. For a P2P file-sharing application, do you agree with the statement, “There is no notion of client and server sides of a communication session”? Why or why not?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R5. What information is used by a process running on one host to identify a process running on another host?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R6. Suppose you wanted to do a transaction from a remote client to a server as fast as possible. Would you use UDP or TCP? Why?</p><p class="s20" style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark150" class="s124">R7. Referring to </a><a href="#bookmark150" class="a">Figure 2.4</a> <a href="#bookmark150" class="s124">, we see that none of the applications listed in </a><a href="#bookmark150" class="a">Figure 2.4</a> <span class="p">requires both no data loss and timing. Can you conceive of an application that requires no data loss and that is also highly time-sensitive?</span></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R8. List the four broad classes of services that a transport protocol can provide. For each of the service classes, indicate if either UDP or TCP (or both) provides such a service.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R9. Recall that TCP can be enhanced with SSL to provide process-to-process security services, including encryption. Does SSL operate at the transport layer or the application layer? If the application developer wants TCP to be enhanced with SSL, what does the developer have to</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">do?</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 2.2–2.5</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R10. What is meant by a handshaking protocol?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">R11. Why do HTTP, SMTP, and POP3 run on top of TCP rather than on UDP?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R12. Consider an e-commerce site that wants to keep a purchase record for each of its customers. Describe how this can be done with cookies.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R13. Describe how Web caching can reduce the delay in receiving a requested object. Will Web caching reduce the delay for all objects requested by a user or for only some of the objects?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">Why?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 145%;text-align: left;">R14. Telnet into a Web server and send a multiline request message. Include in the request message the <span class="s30">If-modified-since: </span>header line to force a response message with the <span class="s30">304 Not Modified </span>status code.</p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">R15. List several popular messaging apps. Do they use the same protocols as SMS?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a name="bookmark244">R16. Suppose Alice, with a Web-based e-mail account (such as Hotmail or Gmail), sends a message to Bob, who accesses his mail from his mail server using POP3. Discuss how the message gets from Alice’s host to Bob’s host. Be sure to list the series of application-layer</a></p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">protocols that are used to move the message between the two hosts.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">R17. Print out the header of an e-mail message you have recently received. How many</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 49pt;text-indent: 0pt;text-align: left;">Received: <span class="p">header lines are there? Analyze each of the header lines in the message.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R18. From a user’s perspective, what is the difference between the download-and-delete mode and the download-and-keep mode in POP3?</p><p class="s37" style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 134%;text-align: left;"><span class="p">R19. Is it possible for an organization’s Web server and mail server to have exactly the same </span>alias<a href="http://foo.com/" class="s124" target="_blank"> for a hostname (for example, </a><a href="http://foo.com/" class="s36" target="_blank">foo.com</a><span class="s42"> </span>)?<span class="p"> What would be the type for the RR that contains the hostname of the mail server?</span></p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R20. Look over your received e-mails, and examine the header of a message sent from a user with a .edu e-mail address. Is it possible to determine from the header the IP address of the host from which the message was sent? Do the same for a message sent from a Gmail account.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 2.5</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;">R21. In BitTorrent, suppose Alice provides chunks to Bob throughout a 30-second interval. Will Bob necessarily return the favor and provide chunks to Alice in this same interval? Why or why not?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;">R22. Consider a new peer Alice that joins BitTorrent without possessing any chunks. Without any chunks, she cannot become a top-four uploader for any of the other peers, since she has nothing to upload. How then will Alice get her first chunk?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: justify;">R23. What is an overlay network? Does it include routers? What are the edges in the overlay network?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 2.6</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R24. CDNs typically adopt one of two different server placement philosophies. Name and briefly describe them.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R25. Besides network-related considerations such as delay, loss, and bandwidth performance, there are other important factors that go into designing a CDN server selection strategy. What are they?</p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 2.7</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R26. In Section 2.7, the UDP server described needed only one socket, whereas the TCP server needed two sockets. Why? If the TCP server were to support <i>n </i>simultaneous connections, each from a different client host, how many sockets would the TCP server need?</p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark239" class="s124">R27. For the client-server application over TCP described in </a><a href="#bookmark239" class="a">Section 2.7</a> <span class="p">, why must the server program be executed before the client program? For the client-server application over UDP, why may the client program be executed before the server program?</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Problems</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">P1. True or false?</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l129"><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">A user requests a Web page that consists of some text and three images. For this page, the client will send one request message and receive four response messages.</p></li><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p class="s37" style="display: inline;">Two<a href="http://www.mit.edu/research.html" class="s124" target="_blank"> distinct Web pages (for example,  </a><a href="http://www.mit.edu/research.html" class="s36" target="_blank">www.mit.edu/research.html</a><span class="s42"> </span>and</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s38" style="padding-left: 92pt;text-indent: 0pt;text-align: left;"><a href="http://www.mit.edu/students.html" class="s34" target="_blank">www.mit.edu/students.html</a> <span class="p">) can be sent over the same persistent connection.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">With nonpersistent connections between browser and origin server, it is possible for a single TCP segment to carry two distinct HTTP request messages.</p></li><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;line-height: 128%;text-align: left;"><p style="display: inline;">The <span class="s30">Date: </span>header in the HTTP response message indicates when the object in the response was last modified.</p></li><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">HTTP response messages never have an empty message body.</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">P2. SMS, iMessage, and WhatsApp are all smartphone real-time messaging systems. After doing some research on the Internet, for each of these systems write one paragraph about the protocols they use. Then write a paragraph explaining how they differ.</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">P3. Consider an HTTP client that wants to retrieve a Web document at a given URL. The IP address of the HTTP server is initially unknown. What transport and application-layer protocols besides HTTP are needed in this scenario?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">P4. Consider the following string of ASCII characters that were captured by Wireshark when the browser sent an HTTP GET message (i.e., this is the actual content of an HTTP GET message).</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">The characters <i>&lt;cr&gt;&lt;lf&gt; </i>are carriage return and line-feed characters (that is, the italized character string <i>&lt;cr&gt; </i>in the text below represents the single carriage-return character that was contained at that point in the HTTP header). Answer the following questions, indicating where in</p><p style="text-indent: 0pt;text-align: left;"><span><img width="728" height="149" alt="image" src="计算机网络自顶向下7th-en/Image_221.png"/></span></p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">the HTTP GET message below you find the answer.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 72pt;text-indent: 1pt;line-height: 148%;text-align: justify;">GET /cs453/index.html HTTP/1.1&lt;cr&gt;&lt;lf&gt;Host: gai a.cs.umass.edu&lt;cr&gt;&lt;lf&gt;User-Agent: Mozilla/5.0 ( Windows;U; Windows NT 5.1; en-US; rv:1.7.2) Gec ko/20040804 Netscape/7.2 (ax) &lt;cr&gt;&lt;lf&gt;Accept:ex</p><p style="text-indent: 0pt;text-align: left;"><span><img width="728" height="187" alt="image" src="计算机网络自顶向下7th-en/Image_222.png"/></span></p><p class="s30" style="padding-top: 4pt;padding-left: 30pt;text-indent: 0pt;text-align: left;">t/xml, application/xml, application/xhtml+xml, text</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">/html;q=0.9, text/plain;q=0.8, image/png,*/*;q=0.5</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;"><a name="bookmark245">&lt;cr&gt;&lt;lf&gt;Accept-Language: en-us, en;q=0.5&lt;cr&gt;&lt;lf&gt;Accept- Encoding: zip, deflate&lt;cr&gt;&lt;lf&gt;Accept-Charset: ISO</a></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">-8859-1, utf-8;q=0.7,*;q=0.7&lt;cr&gt;&lt;lf&gt;Keep-Alive: 300&lt;cr&gt;</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">&lt;lf&gt;Connection:keep-alive&lt;cr&gt;&lt;lf&gt;&lt;cr&gt;&lt;lf&gt;</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l130"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the URL of the document requested by the browser?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What version of HTTP is the browser running?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Does the browser request a non-persistent or a persistent connection?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the IP address of the host on which the browser is running?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">What type of browser initiates this message? Why is the browser type needed in an HTTP request message?</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="728" height="470" alt="image" src="计算机网络自顶向下7th-en/Image_223.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P5. The text below shows the reply sent from the server in response to the HTTP GET message in the question above. Answer the following questions, indicating where in the message below you find the answer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 1pt;line-height: 148%;text-align: left;">HTTP/1.1 200 OK&lt;cr&gt;&lt;lf&gt;Date: Tue, 07 Mar 2008 12:39:45GMT&lt;cr&gt;&lt;lf&gt;Server: Apache/2.0.52 (Fedora)</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">&lt;cr&gt;&lt;lf&gt;Last-Modified: Sat, 10 Dec2005 18:27:46 GMT&lt;cr&gt;&lt;lf&gt;ETag:  ”526c3-f22-a88a4c80”&lt;cr&gt;&lt;lf&gt;Accept- Ranges: bytes&lt;cr&gt;&lt;lf&gt;Content-Length: 3874&lt;cr&gt;&lt;lf&gt; Keep-Alive: timeout=max=100&lt;cr&gt;&lt;lf&gt;Connection:</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">Keep-Alive&lt;cr&gt;&lt;lf&gt;Content-Type: text/html; charset= ISO-8859-1&lt;cr&gt;&lt;lf&gt;&lt;cr&gt;&lt;lf&gt;&lt;!doctype html public ”-</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">//w3c//dtd html 4.0 transitional//en”&gt;&lt;lf&gt;&lt;html&gt;&lt;lf&gt;</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">&lt;head&gt;&lt;lf&gt; &lt;meta http-equiv=”Content-Type” content=”text/html; charset=iso-8859-1”&gt;&lt;lf&gt; &lt;meta name=”GENERATOR” content=”Mozilla/4.79 [en] (Windows NT 5.0; U) Netscape]”&gt;&lt;lf&gt; &lt;title&gt;CMPSCI 453 / 591 /</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">NTU-ST550ASpring 2005 homepage&lt;/title&gt;&lt;lf&gt;&lt;/head&gt;&lt;lf&gt;</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">&lt;much more document text following here (not shown)&gt;</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l131"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Was the server able to successfully find the document or not? What time was the document reply provided?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">When was the document last modified?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">How many bytes are there in the document being returned?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What are the first 5 bytes of the document being returned? Did the server agree to a</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">persistent connection?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P6. Obtain the HTTP/1.1 specification (RFC 2616). Answer the following questions:</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l132"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Explain the mechanism used for signaling between the client and server to indicate that a persistent connection is being closed. Can the client, the server, or both signal the close</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">of a connection?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What encryption services are provided by HTTP?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Can a client open three or more simultaneous connections with a given server?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Either a server or a client may close a transport connection between them if either one detects the connection has been idle for some time. Is it possible that one side starts</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">closing a connection while the other side is transmitting data via this connection? Explain.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P7. Suppose within your Web browser you click on a link to obtain a Web page. The IP address for the associated URL is not cached in your local host, so a DNS lookup is necessary to obtain</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">the IP address. Suppose that <i>n </i>DNS servers are visited before your host receives the IP address from DNS; the successive visits incur an RTT of RTT1,. . .,RTTn. Further suppose that the Web page associated with the link contains exactly one object, consisting of a small amount of HTML</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 143%;text-align: left;">text. Let RTT<span class="s22">0 </span>denote the RTT between the local host and the server containing the object. Assuming zero transmission time of the object, how much time elapses from when the client clicks on the link until the client receives the object?</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P8. Referring to Problem P7, suppose the HTML file references eight very small objects on the same server. Neglecting transmission times, how much time elapses with</p><ol id="l133"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Non-persistent HTTP with no parallel TCP connections?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Non-persistent HTTP with the browser configured for 5 parallel connections?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Persistent HTTP?</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark173" class="s124">P9. Consider </a><a href="#bookmark173" class="a">Figure 2.12</a> <span class="p">, for which there is an institutional network connected to the Internet. Suppose that the average object size is 850,000 bits and that the average request rate from the institution’s browsers to the origin servers is 16 requests per second. Also suppose that the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">amount of time it takes from when the router on the Internet side of the access link forwards an</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark177" class="s124">HTTP request until it receives the response is three seconds on average (see Section </a><a href="#bookmark177" class="a">2.2.</a>5<span class="p">). Model the total average response time as the sum of the average access delay (that is, the delay from Internet router to institution router) and the average Internet delay. For the average access</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">delay, use Δ/(1−Δβ), where Δ is the average time required to send an object over the access link and b is the arrival rate of objects to the access link.</p><ol id="l134"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Find the total average response time.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Now suppose a cache is installed in the institutional LAN. Suppose the miss rate is 0.4.</p></li></ol><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">Find the total response time.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P10. Consider a short, 10-meter link, over which a sender can transmit at a rate of 150 bits/sec in both directions. Suppose that packets containing data are 100,000 bits long, and packets</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">containing only control (e.g., ACK or handshaking) are 200 bits long. Assume that <i>N </i>parallel connections each get 1/<i>N </i>of the link bandwidth. Now consider the HTTP protocol, and suppose that each downloaded object is 100 Kbits long, and that the initial downloaded object contains 10</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">referenced objects from the same sender. Would parallel downloads via parallel instances of non-persistent HTTP make sense in this case? Now consider persistent HTTP. Do you expect significant gains over the non-persistent case? Justify and explain your answer.</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P11. Consider the scenario introduced in the previous problem. Now suppose that the link is shared by Bob with four other users. Bob uses parallel instances of non-persistent HTTP, and the other four users use non-persistent HTTP without parallel downloads.</p><ol id="l135"><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Do Bob’s parallel connections help him get Web pages more quickly? Why or why not?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If all five users open five parallel instances of non-persistent HTTP, then would Bob’s parallel connections still be beneficial? Why or why not?</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P12. Write a simple TCP program for a server that accepts lines of input from a client and prints the lines onto the server’s standard output. (You can do this by modifying the TCPServer.py program in the text.) Compile and execute your program. On any other machine that contains a</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Web browser, set the proxy server in the browser to the host that is running your server program; also configure the port number appropriately. Your browser should now send its GET request messages to your server, and your server should display the messages on its standard output. Use this platform to determine whether your browser generates conditional GET messages for objects that are locally cached.</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P13. What is the difference between <span class="s30">MAIL FROM </span>: in SMTP and <span class="s30">From </span>: in the mail message itself?</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P14. How does SMTP mark the end of a message body? How about HTTP? Can HTTP use the same method as SMTP to mark the end of a message body? Explain.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P15. Read RFC 5321 for SMTP. What does MTA stand for? Consider the following received spam e-mail (modified from a real spam e-mail). Assuming only the originator of this spam e-mail is malicious and all other hosts are honest, identify the malacious host that has generated this</p><p style="text-indent: 0pt;text-align: left;"><span><img width="728" height="268" alt="image" src="计算机网络自顶向下7th-en/Image_224.png"/></span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">spam e-mail.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">From - Fri Nov 07 13:41:30 2008</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 30pt;text-indent: 0pt;text-align: left;"><a href="mailto:tennis5@pp33head.com" class="s35" target="_blank">Return-Path: &lt;tennis5@pp33head.com&gt;</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;">Received: from barmail.cs.umass.edu (barmail.cs.umass.edu [128.119.240.3]) by cs.umass.edu (8.13.1/8.12.6) for</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;"><a href="mailto:hg@cs.umass.edu" class="s35" target="_blank">&lt;hg@cs.umass.edu&gt;;</a> Fri, 7 Nov 2008 13:27:10 -0500 Received: from asusus-4b96 (localhost [127.0.0.1]) by</p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;"><a href="mailto:hg@cs.umass.edu" class="s35" target="_blank">barmail.cs.umass.edu (Spam Firewall) for &lt;hg@cs.umass.edu&gt;;</a> Fri, 7</p><p style="text-indent: 0pt;text-align: left;"><span><img width="728" height="271" alt="image" src="计算机网络自顶向下7th-en/Image_225.png"/></span></p><p class="s30" style="padding-top: 4pt;padding-left: 30pt;text-indent: 0pt;text-align: left;">Nov 2008 13:27:07 -0500 (EST)</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;"><a href="mailto:hg@cs.umass.edu" class="s35" target="_blank">Received: from asusus-4b96 ([58.88.21.177]) by barmail.cs.umass.edu for &lt;hg@cs.umass.edu&gt;;</a> Fri, 07 Nov 2008 13:27:07 -0500 (EST) Received: from [58.88.21.177] by inbnd55.exchangeddd.com; Sat, 8 Nov 2008 01:27:07 +0700</p><p style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;"><a href="mailto:tennis5@pp33head.com" class="s35" target="_blank">From: ”Jonny” </a><a href="mailto:hg@cs.umass.edu" class="s35" target="_blank">&lt;tennis5@pp33head.com&gt; To: &lt;hg@cs.umass.edu&gt;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">Subject: How to secure your savings</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">P16. Read the POP3 RFC, RFC 1939. What is the purpose of the UIDL POP3 command? P17. Consider accessing your e-mail with POP3.</p><ol id="l136"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 15pt;text-align: left;"><p style="display: inline;">Suppose you have configured your POP mail client to operate in the download-and-</p><p style="text-indent: 0pt;text-align: left;"><span><img width="671" height="366" alt="image" src="计算机网络自顶向下7th-en/Image_226.png"/></span></p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">delete mode. Complete the following transaction:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 73pt;text-indent: 0pt;text-align: left;">C:<span class="s45"> </span><span class="s30">list</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 73pt;text-indent: 0pt;text-align: left;">S:<span class="s45"> </span><span class="s30">1 498</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 73pt;text-indent: 0pt;text-align: left;">S:<span class="s45"> </span><span class="s30">2 912</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s45" style="padding-left: 73pt;text-indent: 0pt;text-align: left;">S: <span class="s47">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 73pt;text-indent: 0pt;text-align: left;">C:<span class="s45"> </span><span class="s30">retr 1</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s45" style="padding-left: 73pt;text-indent: 0pt;line-height: 135%;text-align: left;"><span class="s46">S:</span> <span class="s30">blah blah ... </span><span class="s46">S:</span> <span class="s30">..........blah </span>S: <span class="s47">.</span></p><p class="s30" style="padding-top: 1pt;padding-left: 73pt;text-indent: 0pt;text-align: left;">?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 73pt;text-indent: 0pt;text-align: left;">?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="671" height="281" alt="image" src="计算机网络自顶向下7th-en/Image_227.png"/></span></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose you have configured your POP mail client to operate in the download-and-keep mode. Complete the following transaction:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 74pt;text-indent: 0pt;text-align: left;">C:<span class="s45"> </span><span class="s30">list</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 73pt;text-indent: 0pt;text-align: left;">S:<span class="s45"> </span><span class="s30">1 498</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 73pt;text-indent: 0pt;text-align: left;">S:<span class="s45"> </span><span class="s30">2 912</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s45" style="padding-left: 73pt;text-indent: 0pt;text-align: left;">S: <span class="s47">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s46" style="padding-left: 73pt;text-indent: 0pt;text-align: left;">C:<span class="s45"> </span><span class="s30">retr 1</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s45" style="padding-left: 73pt;text-indent: 0pt;line-height: 135%;text-align: left;"><span class="s46">S:</span> <span class="s30">blah blah ... </span><span class="s46">S:</span> <span class="s30">..........blah </span>S: <span class="s47">.</span></p><p class="s30" style="padding-top: 1pt;padding-left: 73pt;text-indent: 0pt;text-align: left;">?</p><p class="s30" style="padding-top: 4pt;padding-left: 73pt;text-indent: 0pt;text-align: left;">?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="671" height="59" alt="image" src="计算机网络自顶向下7th-en/Image_228.png"/></span></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose you have configured your POP mail client to operate in the download-and-keep mode. Using your transcript in part (b), suppose you retrieve messages 1 and 2, exit</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">POP, and then five minutes later you again access POP to retrieve new e-mail. Suppose that in the five-minute interval no new messages have been sent to you. Provide a transcript of this second POP session.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P18.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l137"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is a <i>whois </i>database?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Use various whois databases on the Internet to obtain the names of two DNS servers.</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">Indicate which whois databases you used.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Use nslookup on your local host to send DNS queries to three DNS servers: your local DNS server and the two DNS servers you found in part (b). Try querying for Type A, NS,</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">and MX reports. Summarize your findings.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Use nslookup to find a Web server that has multiple IP addresses. Does the Web server of your institution (school or company) have multiple IP addresses?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Use the ARIN whois database to determine the IP address range used by your university.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -15pt;line-height: 125%;text-align: left;"><p style="display: inline;">Describe how an attacker can use whois databases and the nslookup tool to perform reconnaissance on an institution before launching an attack.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Discuss why whois databases should be publicly available.</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P19. In this problem, we use the useful <i>dig </i><a href="#bookmark201" class="s124">tool available on Unix and Linux hosts to explore the hierarchy of DNS servers. Recall that in </a><a href="#bookmark201" class="a">Figure 2.19</a><span class="s20"> </span>, a DNS server in the DNS hierarchy delegates a DNS query to a DNS server lower in the hierarchy, by sending back to the DNS</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">client the name of that lower-level DNS server. First read the man page for <i>dig</i>, and then answer the following questions.</p><ol id="l138"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Starting with a root DNS server (from one of the root servers [a-m].root-servers.net), initiate a sequence of queries for the IP address for your department’s Web server by</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 130%;text-align: left;">using <i>dig. </i>Show the list of the names of DNS servers in the delegation chain in answering your query.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p class="s20" style="display: inline;"><a href="http://google.com/" class="s124" target="_blank">Repeat part (a) for several popular Web sites, such as </a><a href="http://google.com/" class="a" target="_blank">google.co</a>m<a href="http://yahoo.com/" class="s124" target="_blank">, </a>yahoo.com<span class="p">, or</span></p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 48pt;text-indent: 0pt;text-align: left;"><a href="http://amazon.com/" class="a" target="_blank">amazon.co</a>m<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P20. Suppose you can access the caches in the local DNS servers of your department. Can you propose a way to roughly determine the Web servers (outside your department) that are most popular among the users in your department? Explain.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">P21. Suppose that your department has a local DNS server for all computers in the department.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">You are an ordinary user (i.e., not a network/system administrator). Can you determine if an external Web site was likely accessed from a computer in your department a couple of seconds ago? Explain.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 127%;text-align: justify;">P22. Consider distributing a file of <span class="s27">F=</span>15 Gbits to <i>N </i>peers. The server has an upload rate of <span class="s27">u</span>s=30 Mbps, and each peer has a download rate of <span class="s27">d</span>i=2 Mbps and an upload rate of <i>u</i>. For N=10, 100, and 1,000 and u=300 Kbps, 700 Kbps, and 2 Mbps, prepare a chart giving the</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">minimum distribution time for each of the combinations of <i>N </i>and <i>u </i>for both client-server distribution and P2P distribution.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P23. Consider distributing a file of <i>F </i>bits to <i>N </i>peers using a client-server architecture. Assume a fluid model where the server can simultaneously transmit to multiple peers, transmitting to each</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">peer at different rates, as long as the combined rate does not exceed <i>u</i><span class="s31">s</span>.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><ol id="l139"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Suppose that <span class="s27">u</span>s/N≤dmin. Specify a distribution scheme that has a distribution time of</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 48pt;text-indent: 0pt;text-align: left;">NF<span class="p">/</span>u<span class="s31">s</span><span class="p">.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Suppose that <span class="s27">u</span>s/N≥dmin. Specify a distribution scheme that has a distribution time of</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 48pt;text-indent: 0pt;text-align: left;">F<span class="p">/</span>d<span class="s22">min</span><span class="p">.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Conclude that the minimum distribution time is in general given by <span class="s27">ma</span>x{NF/us, F/dmin}.</p></li></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P24. Consider distributing a file of <i>F </i>bits to <i>N </i>peers using a P2P architecture. Assume a fluid model. For simplicity assume that dmin is very large, so that peer download bandwidth is never a bottleneck.</p><ol id="l140"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 136%;text-align: left;"><p style="display: inline;">Suppose that <span class="s27">u</span>s≤(us+u1+…+uN)/N. Specify a distribution scheme that has a distribution time of <i>F</i>/<i>u</i><span class="s31">s</span>.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 124%;text-align: left;"><p style="display: inline;">Suppose that <span class="s27">u</span>s≥(us+u1+…+uN)/N. Specify a distribution scheme that has a distribution time of NF/(us+u1+…+uN).</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -17pt;line-height: 125%;text-align: left;"><p style="display: inline;">Conclude that the minimum distribution time is in general given by max{F/us, NF/(us+u1+…+uN)}.</p></li></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P25. Consider an overlay network with <i>N </i>active peers, with each pair of peers having an active TCP connection. Additionally, suppose that the TCP connections pass through a total of <i>M </i>routers. How many nodes and edges are there in the corresponding overlay network?</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P26. Suppose Bob joins a BitTorrent torrent, but he does not want to upload any data to any other peers (so called free-riding).</p><ol id="l141"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Bob claims that he can receive a complete copy of the file that is shared by the swarm. Is Bob’s claim possible? Why or why not?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Bob further claims that he can further make his “free-riding” more efficient by using a collection of multiple computers (with distinct IP addresses) in the computer lab in his</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">department. How can he do that?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">P27. Consider a DASH system for which there are <i>N </i>video versions (at <i>N </i>different rates and qualities) and <i>N </i>audio versions (at <i>N </i>different rates and qualities). Suppose we want to allow the</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">player to choose at any time any of the <i>N </i>video versions and any of the <i>N </i>audio versions.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l142"><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If we create files so that the audio is mixed in with the video, so server sends only one media stream at given time, how many files will the server need to store (each a different</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: center;">URL)?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If the server instead sends the audio and video streams separately and has the client synchronize the streams, how many files will the server need to store?</p></li></ol></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">P28. Install and compile the Python programs TCPClient and UDPClient on one host and TCPServer and UDPServer on another host.</p><ol id="l143"><li style="padding-top: 3pt;padding-left: 47pt;text-indent: 24pt;text-align: left;"><p style="display: inline;">Suppose you run TCPClient before you run TCPServer. What happens? Why?</p></li><li style="padding-top: 4pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Suppose you run UDPClient before you run UDPServer. What happens? Why?</p><p style="text-indent: 0pt;text-align: left;"><span><img width="728" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_229.png"/></span></p></li><li style="padding-top: 4pt;padding-left: 47pt;text-indent: 24pt;line-height: 269%;text-align: left;"><p style="display: inline;">What happens if you use different port numbers for the client and server sides? P29. Suppose that in UDPClient.py, after we create the socket, we add the line:</p></li></ol><p class="s30" style="padding-top: 3pt;padding-left: 74pt;text-indent: 0pt;text-align: left;">clientSocket.bind((’’, 5432))</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">Will it become necessary to change UDPServer.py? What are the port numbers for the sockets in UDPClient and UDPServer? What were they before making this change?</p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">P30. Can you configure your browser to open multiple simultaneous connections to a Web site? What are the advantages and disadvantages of having a large number of simultaneous TCP connections?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">P31. We have seen that Internet TCP sockets treat the data being sent as a byte stream but UDP sockets recognize message boundaries. What are one advantage and one disadvantage of byte-oriented API versus having the API explicitly recognize and preserve application-defined</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">message boundaries?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">P32. What is the Apache Web server? How much does it cost? What functionality does it currently have? You may want to look at Wikipedia to answer this question.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark246">Socket Programming Assignments</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark368" class="s124">The Companion Website includes six socket programming assignments. The first four assignments are summarized below. The fifth assignment makes use of the ICMP protocol and is summarized at the end of </a><a href="#bookmark368" class="a">Chapter </a>5<span class="p">. The sixth assignment employs multimedia protocols and is summarized at the end of</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark775" class="a">Chapter </a>9<span class="p">. It is highly recommended that students complete several, if not all, of these assignments.</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources" class="s124" target="_blank">Students can find full details of these assignments, as well as important snippets of the Python code, at the Web site </a><a href="http://www.pearsonhighered.com/cs-resources" class="a" target="_blank">www.pearsonhighered.com/</a>cs-resources<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Assignment 1: Web Server</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this assignment, you will develop a simple Web server in Python that is capable of processing only one request. Specifically, your Web server will (i) create a connection socket when contacted by a client (browser); (ii) receive the HTTP request from this connection; (iii) parse the request to determine the specific file being requested; (iv) get the requested file from the server’s file system; (v) create an HTTP response message consisting of the requested file preceded by header lines; and (vi) send the response over the TCP connection to the requesting browser. If a browser requests a file that is not present in your server, your server should return a “404 Not Found” error message.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the Companion Website, we provide the skeleton code for your server. Your job is to complete the code, run your server, and then test your server by sending requests from browsers running on different hosts. If you run your server on a host that already has a Web server running on it, then you should use a different port than port 80 for your Web server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Assignment 2: UDP Pinger</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this programming assignment, you will write a client ping program in Python. Your client will send a simple ping message to a server, receive a corresponding pong message back from the server, and determine the delay between when the client sent the ping message and received the pong message. This delay is called the Round Trip Time (RTT). The functionality provided by the client and server is similar to the functionality provided by standard ping program available in modern operating systems. However, standard ping programs use the Internet Control Message Protocol (ICMP) (which we will</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark368" class="s124">study in </a><a href="#bookmark368" class="a">Chapter </a>5<span class="p">). Here we will create a nonstandard (but simple!) UDP-based ping program.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Your ping program is to send 10 ping messages to the target server over UDP. For each message, your client is to determine and print the RTT when the corresponding pong message is returned. Because UDP is an unreliable protocol, a packet sent by the client or server may be lost. For this reason, the client cannot wait indefinitely for a reply to a ping message. You should have the client wait up to one second for a reply from the server; if no reply is received, the client should assume that the packet was lost and print a message accordingly.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this assignment, you will be given the complete code for the server (available in the Companion Website). Your job is to write the client code, which will be very similar to the server code. It is recommended that you first study carefully the server code. You can then write your client code, liberally cutting and pasting lines from the server code.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Assignment 3: Mail Client</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The goal of this programming assignment is to create a simple mail client that sends e-mail to any recipient. Your client will need to establish a TCP connection with a mail server (e.g., a Google mail server), dialogue with the mail server using the SMTP protocol, send an e-mail message to a recipient</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">(e.g., your friend) via the mail server, and finally close the TCP connection with the mail server.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">For this assignment, the Companion Website provides the skeleton code for your client. Your job is to complete the code and test your client by sending e-mail to different user accounts. You may also try sending through different servers (for example, through a Google mail server and through your university mail server).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Assignment 4: Multi-Threaded Web Proxy</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this assignment, you will develop a Web proxy. When your proxy receives an HTTP request for an object from a browser, it generates a new HTTP request for the same object and sends it to the origin server. When the proxy receives the corresponding HTTP response with the object from the origin server, it creates a new HTTP response, including the object, and sends it to the client. This proxy will be multi-threaded, so that it will be able to handle multiple requests at the same time.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">For this assignment, the Companion Website provides the skeleton code for the proxy server. Your job is to complete the code, and then test it by having different browsers request Web objects via your proxy.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark247">Wireshark Lab: HTTP</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having gotten our feet wet with the Wireshark packet sniffer in Lab 1, we’re now ready to use Wireshark to investigate protocols in operation. In this lab, we’ll explore several aspects of the HTTP protocol: the basic GET/reply interaction, HTTP message formats, retrieving large HTML files, retrieving HTML files with embedded URLs, persistent and non-persistent connections, and HTTP authentication and security.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">As is the case with all Wireshark labs, the full description of this lab is available at this book’s Web site,</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources" class="a" target="_blank">www.pearsonhighered.com/</a>cs-resources<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark248">Wireshark Lab: DNS</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark216" class="s124">In this lab, we take a closer look at the client side of the DNS, the protocol that translates Internet hostnames to IP addresses. Recall from </a><a href="#bookmark216" class="a">Section 2.5</a> <span class="p">that the client’s role in the DNS is relatively simple</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">—a client sends a query to its local DNS server and receives a response back. Much can go on under the covers, invisible to the DNS clients, as the hierarchical DNS servers communicate with each other to either recursively or iteratively resolve the client’s DNS query. From the DNS client’s standpoint, however, the protocol is quite simple—a query is formulated to the local DNS server and a response is received from that server. We observe DNS in action in this lab.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">As is the case with all Wireshark labs, the full description of this lab is available at this book’s Web site,</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources" class="a" target="_blank">www.pearsonhighered.com/</a>cs-resources<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1052" alt="image" src="计算机网络自顶向下7th-en/Image_230.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><a name="bookmark249">An Interview With…</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Marc Andreessen</p><p style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Marc Andreessen is the co-creator of Mosaic, the Web browser that popularized the World Wide Web in 1993. Mosaic had a clean, easily understood interface and was the first browser to display images in-line with text. In 1994, Marc Andreessen and Jim Clark founded Netscape, whose browser was by far the most popular browser through the mid-1990s. Netscape also developed the Secure Sockets Layer (SSL) protocol and many Internet server products, including mail servers and SSL-based Web servers. He is now a co-founder and general partner of venture capital firm Andreessen Horowitz, overseeing portfolio development with holdings that include Facebook, Foursquare, Groupon, Jawbone, Twitter, and Zynga. He serves on numerous boards, including Bump, eBay, Glam Media, Facebook, and Hewlett-Packard. He holds a BS in Computer Science from the University of Illinois at Urbana-Champaign.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><span><img width="192" height="288" alt="image" src="计算机网络自顶向下7th-en/Image_231.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;line-height: 43pt;text-align: left;">How did you become interested in computing? Did you always know that you wanted to work in information technology?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">The video game and personal computing revolutions hit right when I was growing up—personal computing was the new technology frontier in the late 70’s and early 80’s. And it wasn’t just Apple and the IBM PC, but hundreds of new companies like Commodore and Atari as well. I taught myself to program out of a book called “Instant Freeze-Dried BASIC” at age 10, and got my first computer (a TRS-80 Color Computer—look it up!) at age 12.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Please describe one or two of the most exciting projects you have worked on during your career.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1091" alt="image" src="计算机网络自顶向下7th-en/Image_232.png"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><a name="bookmark250">What were the biggest challenges?</a><a name="bookmark251">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Undoubtedly the most exciting project was the original Mosaic web browser in ’92–’93—and the biggest challenge was getting anyone to take it seriously back then. At the time, everyone thought the interactive future would be delivered as “interactive television” by huge companies, not as the Internet by startups.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><a name="bookmark252">What excites you about the future of networking and the Internet? What are your biggest</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">concerns?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">The most exciting thing is the huge unexplored frontier of applications and services that programmers and entrepreneurs are able to explore—the Internet has unleashed creativity at a level that I don’t think we’ve ever seen before. My biggest concern is the principle of unintended consequences—we don’t always know the implications of what we do, such as the Internet being used by governments to run a new level of surveillance on citizens.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Is there anything in particular students should be aware of as Web technology advances?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: justify;">The rate of change—the most important thing to learn is how to learn—how to flexibly adapt to changes in the specific technologies, and how to keep an open mind on the new opportunities and possibilities as you move through your career.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What people inspired you professionally?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Vannevar Bush, Ted Nelson, Doug Engelbart, Nolan Bushnell, Bill Hewlett and Dave Packard, Ken Olsen, Steve Jobs, Steve Wozniak, Andy Grove, Grace Hopper, Hedy Lamarr, Alan Turing, Richard Stallman.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What are your recommendations for students who want to pursue careers in computing and</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">information technology?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Go as deep as you possibly can on understanding how technology is created, and then complement with learning how business works.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Can technology solve the world’s problems?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">No, but we advance the standard of living of people through economic growth, and most economic growth throughout history has come from technology—so that’s as good as it gets.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="783" height="2" alt="image" src="计算机网络自顶向下7th-en/Image_233.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s16" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark253">Chapter </a><span class="h1">3 </span>Transport Layer<a name="bookmark254">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="1" alt="image" src="计算机网络自顶向下7th-en/Image_234.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Residing between the application and network layers, the transport layer is a central piece of the layered network architecture. It has the critical role of providing communication services directly to the application processes running on different hosts. The pedagogic approach we take in this chapter is to alternate between discussions of transport-layer principles and discussions of how these principles are implemented in existing protocols; as usual, particular emphasis will be given to Internet protocols, in particular the TCP and UDP transport-layer protocols.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We’ll begin by discussing the relationship between the transport and network layers. This sets the stage for examining the first critical function of the transport layer—extending the network layer’s delivery service between two end systems to a delivery service between two application-layer processes running on the end systems. We’ll illustrate this function in our coverage of the Internet’s connectionless transport protocol, UDP.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We’ll then return to principles and confront one of the most fundamental problems in computer networking—how two entities can communicate reliably over a medium that may lose and corrupt data. Through a series of increasingly complicated (and realistic!) scenarios, we’ll build up an array of techniques that transport protocols use to solve this problem. We’ll then show how these principles are embodied in TCP, the Internet’s connection-oriented transport protocol.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We’ll next move on to a second fundamentally important problem in networking—controlling the transmission rate of transport-layer entities in order to avoid, or recover from, congestion within the network. We’ll consider the causes and consequences of congestion, as well as commonly used congestion-control techniques. After obtaining a solid understanding of the issues behind congestion control, we’ll study TCP’s approach to congestion control.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l144"><ol id="l145"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark255">Introduction and Transport-Layer Services</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the previous two chapters we touched on the role of the transport layer and the services that it provides. Let’s quickly review what we have already learned about the transport layer.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">A transport-layer protocol provides for <span class="s20">logical communication </span>between application processes running on different hosts. By <i>logical communication</i>, we mean that from an application’s perspective, it is as if</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the hosts running the processes were directly connected; in reality, the hosts may be on opposite sides of the planet, connected via numerous routers and a wide range of link types. Application processes use the logical communication provided by the transport layer to send messages to each other, free from the</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark256" class="s124">worry of the details of the physical infrastructure used to carry these messages. </a><a href="#bookmark256" class="a">Figure 3.1</a> <span class="p">illustrates the notion of logical communication.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark256" class="s124">As shown in </a><a href="#bookmark256" class="a">Figure 3.</a>1<span class="p">, transport-layer protocols are implemented in the end systems but not in network routers. On the sending side, the transport layer converts the application-layer messages it receives from a sending application process into transport-layer packets, known as transport-layer</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">segments <span class="p">in Internet terminology. This is done by (possibly) breaking the application messages into smaller chunks and adding a transport-layer header to each chunk to create the transport-layer segment. The transport layer then passes the segment to the network layer at the sending end system, where the segment is encapsulated within a network-layer packet (a datagram) and sent to the destination. It’s important to note that network routers act only on the network-layer fields of the datagram; that is, they do not examine the fields of the transport-layer segment encapsulated with the datagram. On the receiving side, the network layer extracts the transport-layer segment from the datagram and passes the segment up to the transport layer. The transport layer then processes the received segment, making the data in the segment available to the receiving application.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">More than one transport-layer protocol may be available to network applications. For example, the Internet has two protocols—TCP and UDP. Each of these protocols provides a different set of transport- layer services to the invoking application.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l146"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Relationship Between Transport and Network Layers</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Recall that the transport layer lies just above the network layer in the protocol stack. Whereas a transport-layer protocol provides logical communication between</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="784" height="835" alt="image" src="计算机网络自顶向下7th-en/Image_235.png"/></span></p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark256">Figure 3.1 The transport layer provides logical rather than physical communication between application processes</a></h2><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">processes <span class="p">running on different hosts, a network-layer protocol provides logical-communication between </span>hosts<span class="p">. This distinction is subtle but important. Let’s examine this distinction with the aid of a household analogy.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Consider two houses, one on the East Coast and the other on the West Coast, with each house being home to a dozen kids. The kids in the East Coast household are cousins of the kids in the West Coast</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">household. The kids in the two households love to write to each other—each kid writes each cousin every week, with each letter delivered by the traditional postal service in a separate envelope. Thus, each household sends 144 letters to the other household every week. (These kids would save a lot of money if they had e-mail!) In each of the households there is one kid—Ann in the West Coast house and Bill in the East Coast house—responsible for mail collection and mail distribution. Each week Ann visits all her brothers and sisters, collects the mail, and gives the mail to a postal-service mail carrier, who makes daily visits to the house. When letters arrive at the West Coast house, Ann also has the job of distributing the mail to her brothers and sisters. Bill has a similar job on the East Coast.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this example, the postal service provides logical communication between the two houses—the postal service moves mail from house to house, not from person to person. On the other hand, Ann and Bill provide logical communication among the cousins—Ann and Bill pick up mail from, and deliver mail to,</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">their brothers and sisters. Note that from the cousins’ perspective, Ann and Bill <i>are </i>the mail service, even though Ann and Bill are only a part (the end-system part) of the end-to-end delivery process. This household example serves as a nice analogy for explaining how the transport layer relates to the</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">network layer:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 219%;text-align: left;">application messages = letters in envelopes processes = cousins</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 219%;text-align: left;">hosts (also called end systems) = houses transport-layer protocol = Ann and Bill</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">network-layer protocol = postal service (including mail carriers)</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Continuing with this analogy, note that Ann and Bill do all their work within their respective homes; they are not involved, for example, in sorting mail in any intermediate mail center or in moving mail from one mail center to another. Similarly, transport-layer protocols live in the end systems. Within an end system, a transport protocol moves messages from application processes to the network edge (that is, the network layer) and vice versa, but it doesn’t have any say about how the messages are moved within</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark256" class="s124">the network core. In fact, as illustrated in </a><a href="#bookmark256" class="a">Figure 3.</a>1<span class="p">, intermediate routers neither act on, nor recognize, any information that the transport layer may have added to the application messages.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Continuing with our family saga, suppose now that when Ann and Bill go on vacation, another cousin pair—say, Susan and Harvey—substitute for them and provide the household-internal collection and delivery of mail. Unfortunately for the two families, Susan and Harvey do not do the collection and delivery in exactly the same way as Ann and Bill. Being younger kids, Susan and Harvey pick up and drop off the mail less frequently and occasionally lose letters (which are sometimes chewed up by the family dog). Thus, the cousin-pair Susan and Harvey do not provide the same set of services (that is, the same service model) as Ann and Bill. In an analogous manner, a computer network may make</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark257">available multiple transport protocols, with each protocol offering a different service model to applications.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The possible services that Ann and Bill can provide are clearly constrained by the possible services that the postal service provides. For example, if the postal service doesn’t provide a maximum bound on how long it can take to deliver mail between the two houses (for example, three days), then there is no way that Ann and Bill can guarantee a maximum delay for mail delivery between any of the cousin pairs. In a similar manner, the services that a transport protocol can provide are often constrained by the service model of the underlying network-layer protocol. If the network-layer protocol cannot provide delay or bandwidth guarantees for transport-layer segments sent between hosts, then the transport-layer  protocol cannot provide delay or bandwidth guarantees for application messages sent between processes.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Nevertheless, certain services <i>can </i>be offered by a transport protocol even when the underlying network protocol doesn’t offer the corresponding service at the network layer. For example, as we’ll see in this chapter, a transport protocol can offer reliable data transfer service to an application even when the</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">underlying network protocol is unreliable, that is, even when the network protocol loses, garbles, or</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark671" class="s124">duplicates packets. As another example (which we’ll explore in </a><a href="#bookmark671" class="a">Chapter 8</a> <span class="p">when we discuss network security), a transport protocol can use encryption to guarantee that application messages are not read by intruders, even when the network layer cannot guarantee the confidentiality of transport-layer</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">segments.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Overview of the Transport Layer in the Internet</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Recall that the Internet makes two distinct transport-layer protocols available to the application layer. One of these protocols is <span class="s20">UDP </span>(User Datagram Protocol), which provides an unreliable, connectionless service to the invoking application. The second of these protocols is <span class="s20">TCP </span>(Transmission Control Protocol), which provides a reliable, connection-oriented service to the invoking application. When designing a network application, the application developer must specify one of these two transport</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark239" class="s124">protocols. As we saw in </a><a href="#bookmark239" class="a">Section 2.</a>7<span class="p">, the application developer selects between UDP and TCP when creating sockets.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">To simplify terminology, we refer to the transport-layer packet as a <i>segment</i>. We mention, however, that the Internet literature (for example, the RFCs) also refers to the transport-layer packet for TCP as a segment but often refers to the packet for UDP as a datagram. But this same Internet literature also</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">uses the term <i>datagram </i>for the network-layer packet! For an introductory book on computer networking such as this, we believe that it is less confusing to refer to both TCP and UDP packets as segments,</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">and reserve the term <i>datagram </i>for the network-layer packet.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Before proceeding with our brief introduction of UDP and TCP, it will be useful to say a few words about</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark368" class="s124">the Internet’s network layer. (We’ll learn about the network layer in detail in </a><a href="#bookmark368" class="a">Chapters 4</a> <a href="#bookmark444" class="s124">and </a>5<span class="p">.) The Internet’s network-layer protocol has a name—IP, for Internet Protocol. IP provides logical communication between hosts. The IP service model is a </span>best-effort delivery service<span class="p">. This means that</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">IP makes its “best effort” to deliver segments between communicating hosts, <i>but it makes no guarantees. </i>In particular, it does not guarantee segment delivery, it does not guarantee orderly delivery of segments, and it does not guarantee the integrity of the data in the segments. For these reasons, IP</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">is said to be an <span class="s20">unreliable service</span><a href="#bookmark368" class="s124">. We also mention here that every host has at least one network- layer address, a so-called IP address. We’ll examine IP addressing in detail in </a><a href="#bookmark368" class="a">Chapter </a><span class="s20">4</span>; for this chapter we need only keep in mind that <i>each host has an IP address</i>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having taken a glimpse at the IP service model, let’s now summarize the service models provided by UDP and TCP. The most fundamental responsibility of UDP and TCP is to extend IP’s delivery service between two end systems to a delivery service between two processes running on the end systems. Extending host-to-host delivery to process-to-process delivery is called <span class="s20">transport-layer multiplexing </span>and <span class="s20">demultiplexing</span>. We’ll discuss transport-layer multiplexing and demultiplexing in the next section. UDP and TCP also provide integrity checking by including error-detection fields in their segments’ headers. These two minimal transport-layer services—process-to-process data delivery and error checking—are the only two services that UDP provides! In particular, like IP, UDP is an unreliable service—it does not guarantee that data sent by one process will arrive intact (or at all!) to the</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark271" class="s124">destination process. UDP is discussed in detail in </a><a href="#bookmark271" class="a">Section 3.</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">TCP, on the other hand, offers several additional services to applications. First and foremost, it provides <span class="s20">reliable data transfer</span>. Using flow control, sequence numbers, acknowledgments, and timers (techniques we’ll explore in detail in this chapter), TCP ensures that data is delivered from sending process to receiving process, correctly and in order. TCP thus converts IP’s unreliable service between end systems into a reliable data transport service between processes. TCP also provides <span class="s20">congestion control</span>. Congestion control is not so much a service provided to the invoking application as it is a service for the Internet as a whole, a service for the general good. Loosely speaking, TCP congestion control prevents any one TCP connection from swamping the links and routers between communicating hosts with an excessive amount of traffic. TCP strives to give each connection traversing a congested link an equal share of the link bandwidth. This is done by regulating the rate at which the sending sides of TCP connections can send traffic into the network. UDP traffic, on the other hand, is unregulated. An application using UDP transport can send at any rate it pleases, for as long as it pleases.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark298" class="s124">A protocol that provides reliable data transfer and congestion control is necessarily complex. We’ll need several sections to cover the principles of reliable data transfer and congestion control, and additional sections to cover the TCP protocol itself. These topics are investigated in </a><a href="#bookmark298" class="a">Sections 3.4</a> <a href="#bookmark358" class="s124">through </a><a href="#bookmark358" class="a">3.</a>8<span class="p">. The</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">approach taken in this chapter is to alternate between basic principles and the TCP protocol. For</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">example, we’ll first discuss reliable data transfer in a general setting and then discuss how TCP</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark258">specifically provides reliable data transfer. Similarly, we’ll first discuss congestion control in a general setting and then discuss how TCP performs congestion control. But before getting into all this good stuff, let’s first look at transport-layer multiplexing and demultiplexing.</a><a name="bookmark259">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li></ol></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark260">Multiplexing and Demultiplexing</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section, we discuss transport-layer multiplexing and demultiplexing, that is, extending the host-to- host delivery service provided by the network layer to a process-to-process delivery service for applications running on the hosts. In order to keep the discussion concrete, we’ll discuss this basic transport-layer service in the context of the Internet. We emphasize, however, that a multiplexing/demultiplexing service is needed for all computer networks.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">At the destination host, the transport layer receives segments from the network layer just below. The transport layer has the responsibility of delivering the data in these segments to the appropriate application process running in the host. Let’s take a look at an example. Suppose you are sitting in front of your computer, and you are downloading Web pages while running one FTP session and two Telnet sessions. You therefore have four network application processes running—two Telnet processes, one FTP process, and one HTTP process. When the transport layer in your computer receives data from the network layer below, it needs to direct the received data to one of these four processes. Let’s now examine how this is done.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark239" class="s124">First recall from </a><a href="#bookmark239" class="a">Section 2.7</a> <span class="p">that a process (as part of a network application) can have one or more</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">sockets<span class="p">, doors through which data passes from the network to the process and through which data</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark261" class="s124">passes from the process to the network. Thus, as shown in </a><a href="#bookmark261" class="a">Figure 3.</a>2<span class="p">, the transport layer in the receiving host does not actually deliver data directly to a process, but instead to an intermediary socket. Because at any given time there can be more than one socket in the receiving host, each socket has a</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">unique identifier. The format of the identifier depends on whether the socket is a UDP or a TCP socket, as we’ll discuss shortly.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now let’s consider how a receiving host directs an incoming transport-layer segment to the appropriate socket. Each transport-layer segment has a set of fields in the segment for this purpose. At the receiving end, the transport layer examines these fields to identify the receiving socket and then directs the segment to that socket. This job of delivering the data in a transport-layer segment to the correct socket is called <span class="s20">demultiplexing</span>. The job of gathering data chunks at the source host from different sockets, encapsulating each data chunk with header information (that will later be used in demultiplexing) to create segments, and passing the segments to the network layer is called <span class="s20">multiplexing</span>. Note that the transport layer in the middle host</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="789" height="361" alt="image" src="计算机网络自顶向下7th-en/Image_236.png"/></span></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark261">Figure 3.2 Transport-layer multiplexing and demultiplexing</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;"><a href="#bookmark261" class="s124">in </a><a href="#bookmark261" class="a">Figure 3.2</a><span class="s20"> </span>must demultiplex segments arriving from the network layer below to either process P<span class="s22">1 </span>or P<span class="s22">2 </span>above; this is done by directing the arriving segment’s data to the corresponding process’s socket. The transport layer in the middle host must also gather outgoing data from these sockets, form transport- layer segments, and pass these segments down to the network layer. Although we have introduced multiplexing and demultiplexing in the context of the Internet transport protocols, it’s important to realize that they are concerns whenever a single protocol at one layer (at the transport layer or elsewhere) is used by multiple protocols at the next higher layer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To illustrate the demultiplexing job, recall the household analogy in the previous section. Each of the kids is identified by his or her name. When Bill receives a batch of mail from the mail carrier, he performs a demultiplexing operation by observing to whom the letters are addressed and then hand delivering the mail to his brothers and sisters. Ann performs a multiplexing operation when she collects letters from her brothers and sisters and gives the collected mail to the mail person.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now that we understand the roles of transport-layer multiplexing and demultiplexing, let us examine how it is actually done in a host. From the discussion above, we know that transport-layer multiplexing requires (1) that sockets have unique identifiers, and (2) that each segment have special fields that</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 129%;text-align: left;"><a href="#bookmark263" class="s124">indicate the socket to which the segment is to be delivered. These special fields, illustrated in </a><a href="#bookmark263" class="a">Figure </a><a href="#bookmark263" class="s48">3.</a>3<span class="p">, are the </span>source port number field <span class="s49">and</span><span class="p"> the </span>destination port number field<span class="s49">.</span><span class="p"> (The UDP and TCP segments have other fields as well, as discussed in the subsequent sections of this chapter.) Each port</span></p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark262">number is a 16-bit number, ranging from 0 to 65535. The port numbers ranging from 0 to 1023 are called </a><span class="s20">well-known port numbers </span>and are restricted, which means that they are reserved for use by well-known</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="273" height="237" alt="image" src="计算机网络自顶向下7th-en/Image_237.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark263">Figure 3.3 Source and destination port-number fields in a transport-layer segment</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="http://www.iana.org/" class="s124" target="_blank">application protocols such as HTTP (which uses port number 80) and FTP (which uses port number 21). The list of well-known port numbers is given in RFC 1700 and is updated at </a><a href="http://www.iana.org/" class="a" target="_blank">http://www.iana.org</a><a href="#bookmark848" class="a"> [RFC </a>3232]<a href="#bookmark239" class="s124">. When we develop a new application (such as the simple application developed in </a><a href="#bookmark239" class="a">Section 2.</a>7<span class="p">),</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">we must assign the application a port number.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">It should now be clear how the transport layer <i>could </i>implement the demultiplexing service: Each socket in the host could be assigned a port number, and when a segment arrives at the host, the transport layer examines the destination port number in the segment and directs the segment to the corresponding</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">socket. The segment’s data then passes through the socket into the attached process. As we’ll see, this is basically how UDP does it. However, we’ll also see that multiplexing/demultiplexing in TCP is yet more subtle.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Connectionless Multiplexing and Demultiplexing</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_238.png"/></span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark234" class="s124">Recall from </a><a href="#bookmark234" class="a">Section 2.7.1</a> <span class="p">that the Python program running in a host can create a UDP socket with the line</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 31pt;text-indent: 0pt;text-align: left;">clientSocket = socket(AF_INET, SOCK_DGRAM)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">When a UDP socket is created in this manner, the transport layer automatically assigns a port number to the socket. In particular, the transport layer assigns a port number in the range 1024 to 65535 that is currently not being used by any other UDP port in the host. Alternatively, we can add a line into our Python program after we create the socket to associate a specific port number (say, 19157) to this UDP</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">socket via the socket <b>bind() </b>method:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="49" alt="image" src="计算机网络自顶向下7th-en/Image_239.png"/></span></p><p class="s30" style="padding-left: 31pt;text-indent: 0pt;text-align: left;">clientSocket.bind((’’, 19157))</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="32" alt="image" src="计算机网络自顶向下7th-en/Image_240.png"/></span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">If the application developer writing the code were implementing the server side of a “well-known protocol,” then the developer would have to assign the corresponding well-known port number. Typically, the client side of the application lets the transport layer automatically (and transparently) assign the port number, whereas the server side of the application assigns a specific port number.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">With port numbers assigned to UDP sockets, we can now precisely describe UDP multiplexing/demultiplexing. Suppose a process in Host A, with UDP port 19157, wants to send a chunk of application data to a process with UDP port 46428 in Host B. The transport layer in Host A creates a transport-layer segment that includes the application data, the source port number (19157), the destination port number (46428), and two other values (which will be discussed later, but are unimportant for the current discussion). The transport layer then passes the resulting segment to the network layer. The network layer encapsulates the segment in an IP datagram and makes a best-effort attempt to deliver the segment to the receiving host. If the segment arrives at the receiving Host B, the transport layer at the receiving host examines the destination port number in the segment (46428) and delivers the segment to its socket identified by port 46428. Note that Host B could be running multiple processes, each with its own UDP socket and associated port number. As UDP segments arrive from the network, Host B directs (demultiplexes) each segment to the appropriate socket by examining the segment’s destination port number.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">It is important to note that a UDP socket is fully identified by a two-tuple consisting of a destination IP address and a destination port number. As a consequence, if two UDP segments have different source IP addresses and/or source port numbers, but have the same <i>destination </i>IP address and <i>destination</i></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">port number, then the two segments will be directed to the same destination process via the same</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">destination socket.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark264" class="s124">You may be wondering now, what is the purpose of the source port number? As shown in </a><a href="#bookmark264" class="a">Figure 3.</a>4<span class="p">, in the A-to-B segment the source port number serves as part of a “return address”—when B wants to send a segment back to A, the destination port in the B-to-A segment will take its value from the source port</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark239" class="s124">value of the A-to-B segment. (The complete return address is A’s IP address and the source port number.) As an example, recall the UDP server program studied in </a><a href="#bookmark239" class="a">Section 2.</a><span class="s20">7</span>. In <span class="s30">UDPServer.py </span>, the server uses the <span class="s30">recvfrom() </span>method to extract the client-side (source) port number from the</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">segment it receives from the client; it then sends a new segment to the client, with the extracted source</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">port number serving as the destination port number in this new segment.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Connection-Oriented Multiplexing and Demultiplexing</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In order to understand TCP demultiplexing, we have to take a close look at TCP sockets and TCP connection establishment. One subtle difference between a TCP socket and a UDP socket is that a TCP</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">socket is identified by a four-tuple: (source IP address, source port number, destination IP address, destination port number). Thus, when a TCP segment arrives from the network to a host, the host uses all four values to direct (demultiplex) the segment to the appropriate socket.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="673" height="383" alt="image" src="计算机网络自顶向下7th-en/Image_241.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark264">Figure 3.4 The inversion of source and destination port numbers</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In particular, and in contrast with UDP, two arriving TCP segments with different source IP addresses or source port numbers will (with the exception of a TCP segment carrying the original connection- establishment request) be directed to two different sockets. To gain further insight, let’s reconsider the</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark240" class="s124">TCP client-server programming example in </a><a href="#bookmark240" class="a">Section 2.7.</a>2<span class="p">:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_242.png"/></span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark238" class="s124">The TCP server application has a “welcoming socket,” that waits for connection-establishment requests from TCP clients (see </a><a href="#bookmark238" class="a">Figure 2.2</a>9<span class="p">) on port number 12000.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="757" height="134" alt="image" src="计算机网络自顶向下7th-en/Image_243.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_244.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">The TCP client creates a socket and sends a connection establishment request segment with the lines:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 50pt;text-indent: 0pt;text-align: left;">clientSocket = socket(AF_INET, SOCK_STREAM)</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 165pt;text-indent: 0pt;text-align: left;">clientSocket.connect((serverName,12000))</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_245.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">A connection-establishment request is nothing more than a TCP segment with destination port number 12000 and a special connection-establishment bit set in the TCP header (discussed in</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_246.png"/></span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark329" class="a">Section 3.</a>5<span class="p">). The segment also includes a source port number that was chosen by the client. When the host operating system of the computer running the server process receives the incoming</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="757" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_247.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">connection-request segment with destination port 12000, it locates the server process that is waiting to accept a connection on port number 12000. The server process then creates a new socket:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 53pt;text-indent: 0pt;text-align: left;">connectionSocket, addr = serverSocket.accept()</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_248.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">Also, the transport layer at the server notes the following four values in the connection-request segment: (1) the source port number in the segment, (2) the IP address of the source host, (3) the destination port number in the segment, and (4) its own IP address. The newly created connection</p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">socket is identified by these four values; all subsequently arriving segments whose source port, source IP address, destination port, and destination IP address match these four values will be demultiplexed to this socket. With the TCP connection now in place, the client and server can now send data to each other.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The server host may support many simultaneous TCP connection sockets, with each socket attached to a process, and with each socket identified by its own four-tuple. When a TCP segment arrives at the host, all four fields (source IP address, source port, destination IP address, destination port) are used to direct (demultiplex) the segment to the appropriate socket.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="614" alt="image" src="计算机网络自顶向下7th-en/Image_249.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">FOCUS ON SECURITY</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Port Scanning</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">We’ve seen that a server process waits patiently on an open port for contact by a remote client. Some ports are reserved for well-known applications (e.g., Web, FTP, DNS, and SMTP servers); other ports are used by convention by popular applications (e.g., the Microsoft 2000 SQL server listens for requests on UDP port 1434). Thus, if we determine that a port is open on a host, we may be able to map that port to a specific application running on the host. This is very useful for system administrators, who are often interested in knowing which network applications are running on the hosts in their networks. But attackers, in order to “case the joint,” also want to know which ports are open on target hosts. If a host is found to be running an application with a known security flaw (e.g., a SQL server listening on port 1434 was subject to a buffer overflow, allowing a remote user to execute arbitrary code on the vulnerable host, a flaw exploited by the</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">Slammer worm </a><a href="#bookmark848" class="a">[CERT </a>2003–04]<span class="p">), then that host is ripe for attack.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="http://nmap.org/" class="s124" target="_blank">Determining which applications are listening on which ports is a relatively easy task. Indeed there are a number of public domain programs, called port scanners, that do just that. Perhaps the most widely used of these is nmap, freely available at </a><a href="http://nmap.org/" class="a" target="_blank">http://nmap.org</a> <span class="p">and included in most</span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Linux distributions. For TCP, nmap sequentially scans ports, looking for ports that are accepting</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: justify;">TCP connections. For UDP, nmap again sequentially scans ports, looking for UDP ports that respond to transmitted UDP segments. In both cases, nmap returns a list of open, closed, or unreachable ports. A host running nmap can attempt to scan any target host <i>anywhere </i>in the</p><p class="s20" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: left;"><a href="#bookmark330" class="s124">Internet. We’ll revisit nmap in </a><a href="#bookmark330" class="a">Section 3.5.</a>6<span class="p">, when we discuss TCP connection management.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="551" alt="image" src="计算机网络自顶向下7th-en/Image_250.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark265">Figure 3.5 Two clients, using the same destination port number (80) to communicate with the same Web server application</a></h2><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark265" class="s124">The situation is illustrated in </a><a href="#bookmark265" class="a">Figure 3.</a>5<span class="p">, in which Host C initiates two HTTP sessions to server B, and Host A initiates one HTTP session to B. Hosts A and C and server B each have their own unique IP address—A, C, and B, respectively. Host C assigns two different source port numbers (26145 and 7532)</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">to its two HTTP connections. Because Host A is choosing source port numbers independently of C, it might also assign a source port of 26145 to its HTTP connection. But this is not a problem—server B will still be able to correctly demultiplex the two connections having the same source port number, since the two connections have different source IP addresses.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Web Servers and TCP</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before closing this discussion, it’s instructive to say a few additional words about Web servers and how they use port numbers. Consider a host running a Web server, such as an Apache Web server, on port</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">80. When clients (for example, browsers) send segments to the server, <i>all </i>segments will have destination port 80. In particular, both the initial connection-establishment segments and the segments carrying HTTP request messages will have destination port 80. As we have just described, the server</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">distinguishes the segments from the different clients using source IP addresses and source port</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark266">numbers.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark265" class="a">Figure 3.5</a> <a href="#bookmark265" class="s124">shows a Web server that spawns a new process for each connection. As shown in </a><a href="#bookmark265" class="a">Figure 3.</a>5<span class="p">, each of these processes has its own connection socket through which HTTP requests arrive and HTTP responses are sent. We mention, however, that there is not always a one-to-one correspondence</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">between connection sockets and processes. In fact, today’s high-performing Web servers often use only one process, and create a new thread with a new connection socket for each new client connection. (A thread can be viewed as a lightweight subprocess.) If you did the first programming assignment in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark138" class="a">Chapter </a>2<span class="p">, you built a Web server that does just this. For such a server, at any given time there may be many connection sockets (with different identifiers) attached to the same process.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">If the client and server are using persistent HTTP, then throughout the duration of the persistent connection the client and server exchange HTTP messages via the same server socket. However, if the client and server use non-persistent HTTP, then a new TCP connection is created and closed for every request/response, and hence a new socket is created and later closed for every request/response. This frequent creating and closing of sockets can severely impact the performance of a busy Web server (although a number of operating system tricks can be used to mitigate the problem). Readers interested in the operating system issues surrounding persistent and non-persistent HTTP are encouraged to see</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="a">[Nielsen </a>1997<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Nahum 2002</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now that we’ve discussed transport-layer multiplexing and demultiplexing, let’s move on and discuss one of the Internet’s transport protocols, UDP. In the next section we’ll see that UDP adds little more to the network-layer protocol than a multiplexing/demultiplexing service.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark267">Connectionless Transport: UDP</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark157" class="s124">In this section, we’ll take a close look at UDP, how it works, and what it does. We encourage you to refer back to </a><a href="#bookmark157" class="a">Section 2.</a>1<a href="#bookmark234" class="s124">, which includes an overview of the UDP service model, and to </a><a href="#bookmark234" class="a">Section 2.7.</a>1<span class="p">, which</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">discusses socket programming using UDP.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To motivate our discussion about UDP, suppose you were interested in designing a no-frills, bare-bones transport protocol. How might you go about doing this? You might first consider using a vacuous transport protocol. In particular, on the sending side, you might consider taking the messages from the application process and passing them directly to the network layer; and on the receiving side, you might consider taking the messages arriving from the network layer and passing them directly to the application process. But as we learned in the previous section, we have to do a little more than nothing! At the very least, the transport layer has to provide a multiplexing/demultiplexing service in order to pass data between the network layer and the correct application-level process.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">UDP, defined in </a><a href="#bookmark848" class="a">[RFC 768</a>]<span class="p">, does just about as little as a transport protocol can do. Aside from the multiplexing/demultiplexing function and some light error checking, it adds nothing to IP. In fact, if the application developer chooses UDP instead of TCP, then the application is almost directly talking with</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">IP. UDP takes messages from the application process, attaches source and destination port number fields for the multiplexing/demultiplexing service, adds two other small fields, and passes the resulting segment to the network layer. The network layer encapsulates the transport-layer segment into an IP datagram and then makes a best-effort attempt to deliver the segment to the receiving host. If the segment arrives at the receiving host, UDP uses the destination port number to deliver the segment’s data to the correct application process. Note that with UDP there is no handshaking between sending and receiving transport-layer entities before sending a segment. For this reason, UDP is said to be</p><p class="s17" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">connectionless.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">DNS is an example of an application-layer protocol that typically uses UDP. When the DNS application in a host wants to make a query, it constructs a DNS query message and passes the message to UDP. Without performing any handshaking with the UDP entity running on the destination end system, the host-side UDP adds header fields to the message and passes the resulting segment to the network layer. The network layer encapsulates the UDP segment into a datagram and sends the datagram to a name server. The DNS application at the querying host then waits for a reply to its query. If it doesn’t receive a reply (possibly because the underlying network lost the query or the reply), it might try resending the query, try sending the query to another name server, or inform the invoking application that it can’t get a reply.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now you might be wondering why an application developer would ever choose to build an application over UDP rather than over TCP. Isn’t TCP always preferable, since TCP provides a reliable data transfer service, while UDP does not? The answer is no, as some applications are better suited for UDP for the following reasons:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_251.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Finer application-level control over what data is sent, and when. <span class="p">Under UDP, as soon as an application process passes data to UDP, UDP will package the data inside a UDP segment and immediately pass the segment to the network layer. TCP, on the other hand, has a congestion-</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">control mechanism that throttles the transport-layer TCP sender when one or more links between the source and destination hosts become excessively congested. TCP will also continue to resend a segment until the receipt of the segment has been acknowledged by the destination, regardless of how long reliable delivery takes. Since real-time applications often require a minimum sending rate, do not want to overly delay segment transmission, and can tolerate some data loss, TCP’s service model is not particularly well matched to these applications’ needs. As discussed below, these applications can use UDP and implement, as part of the application, any additional functionality that is needed beyond UDP’s no-frills segment-delivery service.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_252.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;">No connection establishment. <span class="p">As we’ll discuss later, TCP uses a three-way handshake before it starts to transfer data. UDP just blasts away without any formal preliminaries. Thus UDP does not introduce any delay to establish a connection. This is probably the principal reason why DNS runs</span></p><p class="s20" style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark176" class="s124">over UDP rather than TCP—DNS would be much slower if it ran over TCP. HTTP uses TCP rather than UDP, since reliability is critical for Web pages with text. But, as we briefly discussed in </a><a href="#bookmark176" class="a">Section 2.</a>2<span class="p">, the TCP connection-establishment delay in HTTP is an important contributor to the delays</span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 11pt;text-align: left;">associated with downloading Web documents. Indeed, the QUIC protocol (Quick UDP Internet</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">Connection, </a><a href="#bookmark848" class="a">[Iyengar </a>2015]<span class="p">), used in Google’s Chrome browser, uses UDP as its underlying transport protocol and implements reliability in an application-layer protocol on top of UDP.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_253.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">No connection state. <span class="p">TCP maintains connection state in the end systems. This connection state includes receive and send buffers, congestion-control parameters, and sequence and</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark329" class="s124">acknowledgment number parameters. We will see in </a><a href="#bookmark329" class="a">Section 3.5</a> <span class="p">that this state information is needed to implement TCP’s reliable data transfer service and to provide congestion control. UDP, on the other hand, does not maintain connection state and does not track any of these parameters. For</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">this reason, a server devoted to a particular application can typically support many more active clients when the application runs over UDP rather than TCP.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_254.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Small packet header overhead. <span class="p">The TCP segment has 20 bytes of header overhead in every segment, whereas UDP has only 8 bytes of overhead.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark268" class="a">Figure 3.6</a> <span class="p">lists popular Internet applications and the transport protocols that they use. As we expect, e- mail, remote terminal access, the Web, and file transfer run over TCP—all these applications need the reliable data transfer service of TCP. Nevertheless, many important applications run over UDP rather</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark502" class="s124">than TCP. For example, UDP is used to carry network management (SNMP; see </a><a href="#bookmark502" class="a">Section 5.</a>7<span class="p">) data. UDP is preferred to TCP in this case, since network management applications must often run when the</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">network is in a stressed state—precisely when reliable, congestion-controlled data transfer is difficult to achieve. Also, as we mentioned earlier, DNS runs over UDP, thereby avoiding TCP’s connection- establishment delays.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark268" class="s124">As shown in </a><a href="#bookmark268" class="a">Figure 3.</a>6<span class="p">, both UDP and TCP are somtimes used today with multimedia applications, such as Internet phone, real-time video conferencing, and streaming of stored audio and video. We’ll</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark775" class="s124">take a close look at these applications in </a><a href="#bookmark775" class="a">Chapter </a>9<span class="p">. We just mention now that all of these applications can tolerate a small amount of packet loss, so that reliable data transfer is not absolutely critical for the application’s success. Furthermore, real-time applications, like Internet phone and video conferencing,</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark671" class="s124">react very poorly to TCP’s congestion control. For these reasons, developers of multimedia applications may choose to run their applications over UDP instead of TCP. When packet loss rates are low, and with some organizations blocking UDP traffic for security reasons (see </a><a href="#bookmark671" class="a">Chapter </a>8<span class="p">), TCP becomes an</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">increasingly attractive protocol for streaming media transport.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="376" alt="image" src="计算机网络自顶向下7th-en/Image_255.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark268">Figure 3.6 Popular Internet applications and their underlying transport protocols</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although commonly done today, running multimedia applications over UDP is controversial. As we mentioned above, UDP has no congestion control. But congestion control is needed to prevent the network from entering a congested state in which very little useful work is done. If everyone were to start streaming high-bit-rate video without using any congestion control, there would be so much packet overflow at routers that very few UDP packets would successfully traverse the source-to-destination path. Moreover, the high loss rates induced by the uncontrolled UDP senders would cause the TCP</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">senders (which, as we’ll see, <i>do </i>decrease their sending rates in the face of congestion) to dramatically decrease their rates. Thus, the lack of congestion control in UDP can result in high loss rates between a</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">UDP sender and receiver, and the crowding out of TCP sessions—a potentially serious problem </a><a href="#bookmark848" class="a">[Floyd</a></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">1999]<a href="#bookmark848" class="s124">. Many researchers have proposed new mechanisms to force all sources, including UDP sources, to perform adaptive congestion control </a><a href="#bookmark848" class="a">[Mahdavi 199</a>7<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Floyd 200</a>0<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Kohler 200</a>6<a href="#bookmark848" class="s124">: </a><a href="#bookmark848" class="a">RFC 4340</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Before discussing the UDP segment structure, we mention that it <i>is </i>possible for an application to have reliable data transfer when using UDP. This can be done if reliability is built into the application itself (for example, by adding acknowledgment and retransmission mechanisms, such as those we’ll study in the</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">next section). We mentioned earlier that the QUIC protocol </a><a href="#bookmark848" class="a">[Iyengar 2015]</a> <span class="p">used in Google’s Chrome browser implements reliability in an application-layer protocol on top of UDP. But this is a nontrivial task that would keep an application developer busy debugging for a long time. Nevertheless, building</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">reliability directly into the application allows the application to “have its cake and eat it too. That is, application processes can communicate reliably without being subjected to the transmission-rate constraints imposed by TCP’s congestion-control mechanism.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l147"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark269">UDP Segment Structure</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark270" class="s124">The UDP segment structure, shown in </a><a href="#bookmark270" class="a">Figure 3.</a>7<span class="p">, is defined in RFC 768. The application data occupies the data field of the UDP segment. For example, for DNS, the data field contains either a query message or a response message. For a streaming audio application, audio samples fill the data field.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The UDP header has only four fields, each consisting of two bytes. As discussed in the previous section, the port numbers allow the destination host to pass the application data to the correct process running on the destination end system (that is, to perform the demultiplexing function). The length field specifies the number of bytes in the UDP segment (header plus data). An explicit length value is needed since the size of the data field may differ from one UDP segment to the next. The checksum is used by the receiving host to check whether errors have been introduced into the segment. In truth, the checksum is also calculated over a few of the fields in the IP header in addition to the UDP segment. But we ignore this detail in order to see the forest through the trees. We’ll discuss the checksum calculation below.</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark527" class="s124">Basic principles of error detection are described in </a><a href="#bookmark527" class="a">Section 6.</a>2<span class="p">. The length field specifies the length of the UDP segment, including the header, in bytes.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">UDP Checksum</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">The UDP checksum provides for error detection. That is, the checksum is used to determine whether bits within the UDP segment have been altered (for example, by noise in the links or while stored in a router) as it moved from source to destination.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="273" height="237" alt="image" src="计算机网络自顶向下7th-en/Image_256.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark270">Figure 3.7 UDP segment structure</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">UDP at the sender side performs the 1s complement of the sum of all the 16-bit words in the segment, with any overflow encountered during the sum being wrapped around. This result is put in the checksum field of the UDP segment. Here we give a simple example of the checksum calculation. You can find details about efficient implementation of the calculation in RFC 1071 and performance over real data in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="a">[Stone 199</a>8<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Stone 2000</a>]<span class="p">. As an example, suppose that we have the following three 16-bit words:</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0110011001100000</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0101010101010101</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">1000111100001100</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 42pt;text-align: left;">The sum of first two of these 16-bit words is 0110011001100000</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s50" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">0101010101010101</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">1011101110110101</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 42pt;text-align: left;">Adding the third word to the above sum gives 1011101110110101</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s50" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">1000111100001100</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">0100101011000010</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Note that this last addition had overflow, which was wrapped around. The 1s complement is obtained by converting all the 0s to 1s and converting all the 1s to 0s. Thus the 1s complement of the sum 0100101011000010 is 1011010100111101, which becomes the checksum. At the receiver, all four 16-</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark271">bit words are added, including the checksum. If no errors are introduced into the packet, then clearly the sum at the receiver will be 1111111111111111. If one of the bits is a 0, then we know that errors have been introduced into the packet.</a><a name="bookmark272">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">You may wonder why UDP provides a checksum in the first place, as many link-layer protocols (including the popular Ethernet protocol) also provide error checking. The reason is that there is no guarantee that all the links between source and destination provide error checking; that is, one of the links may use a link-layer protocol that does not provide error checking. Furthermore, even if segments are correctly transferred across a link, it’s possible that bit errors could be introduced when a segment is stored in a router’s memory. Given that neither link-by-link reliability nor in-memory error detection is</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;"><span class="p">guaranteed, UDP must provide error detection at the transport layer, </span><span class="s17">on an end-end basis</span><span class="p">, if the end- end data transfer service is to provide error detection. This is an example of the celebrated </span>end-end <span class="s23">principle</span> <a href="#bookmark848" class="s124">in system design </a><a href="#bookmark848" class="a">[Saltzer </a>1984]<span class="p">, which states that since certain functionality (error detection,</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">in this case) must be implemented on an end-end basis: “functions placed at the lower levels may be</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">redundant or of little value when compared to the cost of providing them at the higher level.”</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Because IP is supposed to run over just about any layer-2 protocol, it is useful for the transport layer to provide error checking as a safety measure. Although UDP provides error checking, it does not do anything to recover from an error. Some implementations of UDP simply discard the damaged segment; others pass the damaged segment to the application with a warning.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">That wraps up our discussion of UDP. We will soon see that TCP offers reliable data transfer to its applications as well as other services that UDP doesn’t offer. Naturally, TCP is also more complex than UDP. Before discussing TCP, however, it will be useful to step back and first discuss the underlying principles of reliable data transfer.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s18" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark273">3.4 Principles of Reliable Data Transfer</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section, we consider the problem of reliable data transfer in a general context. This is appropriate since the problem of implementing reliable data transfer occurs not only at the transport layer, but also at the link layer and the application layer as well. The general problem is thus of central importance to networking. Indeed, if one had to identify a “top-ten” list of fundamentally important problems in all of networking, this would be a candidate to lead the list. In the next section we’ll examine TCP and show, in particular, that TCP exploits many of the principles that we are about to describe.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark274" class="a">Figure 3.8</a> <span class="p">illustrates the framework for our study of reliable data transfer. The service abstraction provided to the upper-layer entities is that of a reliable channel through which data can be transferred. With a reliable channel, no transferred data bits are corrupted (flipped from 0 to 1, or vice versa) or lost,</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">and all are delivered in the order in which they were sent. This is precisely the service model offered by TCP to the Internet applications that invoke it.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">It is the responsibility of a <span class="s20">reliable data transfer protocol </span>to implement this service abstraction. This task is made difficult by the fact that the layer <i>below </i>the reliable data transfer protocol may be</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">unreliable. For example, TCP is a reliable data transfer protocol that is implemented on top of an unreliable (IP) end-to-end network layer. More generally, the layer beneath the two reliably communicating end points might consist of a single physical link (as in the case of a link-level data transfer protocol) or a global internetwork (as in the case of a transport-level protocol). For our purposes, however, we can view this lower layer simply as an unreliable point-to-point channel.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section, we will incrementally develop the sender and receiver sides of a reliable data transfer protocol, considering increasingly complex models of the underlying channel. For example, we’ll consider what protocol mechanisms are</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="330" height="521" alt="image" src="计算机网络自顶向下7th-en/Image_257.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark274">Figure 3.8 Reliable data transfer: Service model and service implementation</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="361" height="464" alt="image" src="计算机网络自顶向下7th-en/Image_258.jpg"/></span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark274" class="s124">needed when the underlying channel can corrupt bits or lose entire packets. One assumption we’ll adopt throughout our discussion here is that packets will be delivered in the order in which they were sent, with some packets possibly being lost; that is, the underlying channel will not reorder packets. </a><a href="#bookmark274" class="a">Figure 3.8(b)</a></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">illustrates the interfaces for our data transfer protocol. The sending side of the data transfer protocol will</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">be invoked from above by a call to <span class="s30">rdt_send() </span>. It will pass the data to be delivered to the upper layer at the receiving side. (Here <span class="s30">rdt </span>stands for <i>reliable data transfer </i>protocol and <span class="s30">_send </span>indicates that the sending side of <span class="s30">rdt </span>is being called. The first step in developing any protocol is to choose a good name!) On the receiving side, <span class="s30">rdt_rcv() </span>will be called when a packet arrives from the receiving side of the channel. When the <span class="s30">rdt </span>protocol wants to deliver data to the upper layer, it will do so by calling <span class="s30">deliver_data() </span>. In the following we use the terminology “packet” rather than transport-layer</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">“segment.” Because the theory developed in this section applies to computer networks in general and</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">not just to the Internet transport layer, the generic term “packet” is perhaps more appropriate here.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section we consider only the case of <span class="s20">unidirectional data transfer</span>, that is, data transfer from the sending to the receiving side. The case of reliable <span class="s20">bidirectional </span>(that is, full-duplex) <span class="s20">data transfer </span>is conceptually no more difficult but considerably more tedious to explain. Although we consider only unidirectional data transfer, it is important to note that the sending and receiving sides of our protocol</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">will nonetheless need to transmit packets in <i>both </i><a href="#bookmark274" class="s124">directions, as indicated in </a><a href="#bookmark274" class="a">Figure 3.</a><span class="s20">8</span>. We will see shortly that, in addition to exchanging packets containing the data to be transferred, the sending and</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: justify;">receiving sides of <span class="s30">rdt </span>will also need to exchange control packets back and forth. Both the send and receive sides of <span class="s30">rdt </span>send packets to the other side by a call to <span class="s30">udt_send() </span>(where udt stands for <i>unreliable data transfer</i>).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">3.4.1 Building a Reliable Data Transfer Protocol</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We now step through a series of protocols, each one becoming more complex, arriving at a flawless, reliable data transfer protocol.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Reliable Data Transfer over a Perfectly Reliable Channel:  <span class="s51">rdt1.0</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;"><span class="p">We first consider the simplest case, in which the underlying channel is completely reliable. The protocol itself, which we’ll call </span><span class="s30">rdt1.0 </span><span class="p">, is trivial. The </span><span class="s23">finite-state</span> machine (FSM) <span class="p">definitions for the </span><span class="s30">rdt1.0 </span><a href="#bookmark275" class="s124">sender and receiver are shown in </a><a href="#bookmark275" class="a">Figure 3.</a>9<a href="#bookmark275" class="s124">. The FSM in </a><a href="#bookmark275" class="a">Figure 3.9(a)</a> <a href="#bookmark275" class="s124">defines the operation of the sender, while the FSM in </a><a href="#bookmark275" class="a">Figure 3.9(b)</a> <span class="p">defines the operation of the receiver. It is important to note that there are </span><span class="s17">separate </span><a href="#bookmark275" class="s124">FSMs for the sender and for the receiver. The sender and receiver FSMs in </a><a href="#bookmark275" class="a">Figure</a></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark275" class="a">3.9</a> <a href="#bookmark275" class="s124">each have just one state. The arrows in the FSM description indicate the transition of the protocol from one state to another. (Since each FSM in </a><a href="#bookmark275" class="a">Figure 3.9</a> <span class="p">has just one state, a transition is necessarily from the one state back to itself; we’ll see more complicated state diagrams shortly.) The event causing</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">the transition is shown above the horizontal line labeling the transition, and the actions taken when the event occurs are shown below the horizontal line. When no action is taken on an event, or no event occurs and an action is taken, we’ll use the symbol Λ below or above the horizontal, respectively, to explicitly denote the lack of an action or event. The initial state of the FSM is indicated by the dashed</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark275" class="s124">arrow. Although the FSMs in </a><a href="#bookmark275" class="a">Figure 3.9</a> <span class="p">have but one state, the FSMs we will see shortly have multiple states, so it will be important to identify the initial state of each FSM.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;">The sending side of <span class="s30">rdt </span>simply accepts data from the upper layer via the <span class="s30">rdt_send(data) </span>event, creates a packet containing the data (via the action <span class="s30">make_pkt(data) </span>) and sends the packet into the channel. In practice, the <span class="s30">rdt_send(data) </span>event would result from a procedure call (for example, to <span class="s30">rdt_send() </span>) by the upper-layer application.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="391" height="418" alt="image" src="计算机网络自顶向下7th-en/Image_259.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s44" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark275">Figure</a><span class="h2"> 3.9 </span><span class="s45">rdt1.0 </span>–<span class="h2"> A protocol for a completely reliable channel</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;">On the receiving side, rdt receives a packet from the underlying channel via the <span class="s30">rdt_rcv(packet) </span>event, removes the data from the packet (via the action <span class="s30">extract (packet, data) </span>) and passes the data up to the upper layer (via the action <span class="s30">deliver_data(data) </span>). In practice, the <span class="s30">rdt_rcv(packet) </span>event would result from a procedure call (for example, to <span class="s30">rdt_rcv() </span>) from the</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">lower-layer protocol.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this simple protocol, there is no difference between a unit of data and a packet. Also, all packet flow is from the sender to receiver; with a perfectly reliable channel there is no need for the receiver side to provide any feedback to the sender since nothing can go wrong! Note that we have also assumed that</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the receiver is able to receive data as fast as the sender happens to send data. Thus, there is no need for the receiver to ask the sender to slow down!</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Reliable Data Transfer over a Channel with Bit Errors:  <span class="s52">rdt2.0</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A more realistic model of the underlying channel is one in which bits in a packet may be corrupted. Such bit errors typically occur in the physical components of a network as a packet is transmitted, propagates, or is buffered. We’ll continue to assume for the moment that all transmitted packets are received (although their bits may be corrupted) in the order in which they were sent.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before developing a protocol for reliably communicating over such a channel, first consider how people might deal with such a situation. Consider how you yourself might dictate a long message over the phone. In a typical scenario, the message taker might say “OK” after each sentence has been heard, understood, and recorded. If the message taker hears a garbled sentence, you’re asked to repeat the garbled sentence. This message-dictation protocol uses both <span class="s20">positive acknowledgments </span>(“OK”) and <span class="s20">negative acknowledgments </span>(“Please repeat that.”). These control messages allow the receiver to let the sender know what has been received correctly, and what has been received in error and thus requires repeating. In a computer network setting, reliable data transfer protocols based on such retransmission are known as <span class="s20">ARQ (Automatic Repeat reQuest) protocols</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Fundamentally, three additional protocol capabilities are required in ARQ protocols to handle the presence of bit errors:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_260.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Error detection. <span class="p">First, a mechanism is needed to allow the receiver to detect when bit errors have occurred. Recall from the previous section that UDP uses the Internet checksum field for exactly this</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark513" class="s124">purpose. In </a><a href="#bookmark513" class="a">Chapter 6</a> <span class="p">we’ll examine error-detection and -correction techniques in greater detail; these techniques allow the receiver to detect and possibly correct packet bit errors. For now, we need only know that these techniques require that extra bits (beyond the bits of original data to be</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 161%;text-align: left;">transferred) be sent from the sender to the receiver; these bits will be gathered into the packet checksum field of the <span class="s30">rdt2.0 </span>data packet.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_261.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Receiver feedback. <span class="p">Since the sender and receiver are typically executing on different end systems,</span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">possibly separated by thousands of miles, the only way for the sender to learn of the receiver’s view of the world (in this case, whether or not a packet was received correctly) is for the receiver to provide explicit feedback to the sender. The positive (ACK) and negative (NAK) acknowledgment</p><p style="padding-top: 2pt;padding-left: 25pt;text-indent: 0pt;line-height: 138%;text-align: left;">replies in the message-dictation scenario are examples of such feedback. Our <span class="s30">rdt2.0 </span>protocol will similarly send ACK and NAK packets back from the receiver to the sender. In principle, these packets need only be one bit long; for example, a 0 value could indicate a NAK and a value of 1</p><p style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;text-align: left;">could indicate an ACK.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_262.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Retransmission. <span class="p">A packet that is received in error at the receiver will be retransmitted by the sender.</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark276" class="a">Figure 3.10</a><span class="s20"> </span>shows the FSM representation of <span class="s30">rdt2.0 </span>, a data transfer protocol employing error detection, positive acknowledgments, and negative acknowledgments.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">The send side of <span class="s30">rdt2.0 </span>has two states. In the leftmost state, the send-side protocol is waiting for data to be passed down from the upper layer. When the <span class="s30">rdt_send(data) </span>event occurs, the sender will create a packet ( <span class="s30">sndpkt </span><a href="#bookmark272" class="s124">) containing the data to be sent, along with a packet checksum (for example, as discussed in </a><a href="#bookmark272" class="a">Section 3.3.2</a><span class="s20"> </span>for the case of a UDP segment), and then send the packet via the <span class="s30">udt_send(sndpkt) </span>operation. In the rightmost state, the sender protocol is waiting for an ACK or a</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">NAK packet from the receiver. If an ACK packet is received</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="618" height="281" alt="image" src="计算机网络自顶向下7th-en/Image_263.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s44" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark276">Figure</a><span class="h2"> 3.10 </span><span class="s45">rdt2.0 </span>–<span class="h2"> A protocol for a channel with bit errors</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="395" height="276" alt="image" src="计算机网络自顶向下7th-en/Image_264.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;">(the notation <span class="s30">rdt_rcv(rcvpkt) &amp;&amp; isACK (rcvpkt) </span><a href="#bookmark276" class="s124">in </a><a href="#bookmark276" class="a">Figure 3.10</a><span class="s20"> </span>corresponds to this event), the sender knows that the most recently transmitted packet has been received correctly and thus the protocol returns to the state of waiting for data from the upper layer. If a NAK is received, the protocol</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">retransmits the last packet and waits for an ACK or NAK to be returned by the receiver in response to</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">the retransmitted data packet. It is important to note that when the sender is in the wait-for-ACK-or-NAK</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">state, it <i>cannot </i>get more data from the upper layer; that is, the <span class="s30">rdt_send() </span>event can not occur; that will happen only after the sender receives an ACK and leaves this state. Thus, the sender will not send a new piece of data until it is sure that the receiver has correctly received the current packet. Because of</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">this behavior, protocols such as <span class="s30">rdt2.0 </span>are known as <span class="s23">stop-and-wait</span><span class="s20"> </span>protocols.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">The receiver-side FSM for <span class="s30">rdt2.0 </span><a href="#bookmark276" class="s124">still has a single state. On packet arrival, the receiver replies with either an ACK or a NAK, depending on whether or not the received packet is corrupted. In </a><a href="#bookmark276" class="a">Figure 3.1</a><span class="s20">0</span>, the notation <span class="s30">rdt_rcv(rcvpkt) &amp;&amp; corrupt(rcvpkt) </span>corresponds to the event in which a packet is received and is found to be in error.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Protocol <span class="s30">rdt2.0 </span>may look as if it works but, unfortunately, it has a fatal flaw. In particular, we haven’t accounted for the possibility that the ACK or NAK packet could be corrupted! (Before proceeding on, you should think about how this problem may be fixed.) Unfortunately, our slight oversight is not as</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">innocuous as it may seem. Minimally, we will need to add checksum bits to ACK/NAK packets in order to detect such errors. The more difficult question is how the protocol should recover from errors in ACK or NAK packets. The difficulty here is that if an ACK or NAK is corrupted, the sender has no way of knowing whether or not the receiver has correctly received the last piece of transmitted data.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Consider three possibilities for handling corrupted ACKs or NAKs:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_265.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">For the first possibility, consider what a human might do in the message-dictation scenario. If the speaker didn’t understand the “OK” or “Please repeat that” reply from the receiver, the speaker would probably ask, “What did you say?” (thus introducing a new type of sender-to-receiver packet</p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 153%;text-align: left;">to our protocol). The receiver would then repeat the reply. But what if the speaker’s “What did you say?” is corrupted? The receiver, having no idea whether the garbled sentence was part of the dictation or a request to repeat the last reply, would probably then respond with “What did <i>you </i>say?”</p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 11pt;text-align: left;">And then, of course, that response might be garbled. Clearly, we’re heading down a difficult path.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_266.png"/></span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: justify;">A second alternative is to add enough checksum bits to allow the sender not only to detect, but also to recover from, bit errors. This solves the immediate problem for a channel that can corrupt packets but not lose them.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_267.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">A third approach is for the sender simply to resend the current data packet when it receives a garbled ACK or NAK packet. This approach, however, introduces <span class="s20">duplicate packets </span>into the sender-to-receiver channel. The fundamental difficulty with duplicate packets is that the receiver</p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 161%;text-align: left;">doesn’t know whether the ACK or NAK it last sent was received correctly at the sender. Thus, it cannot know <i>a priori </i>whether an arriving packet contains new data or is a retransmission!</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">A simple solution to this new problem (and one adopted in almost all existing data transfer protocols, including TCP) is to add a new field to the data packet and have the sender number its data packets by putting a <span class="s20">sequence number </span>into this field. The receiver then need only check this sequence number to</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">determine whether or not the received packet is a retransmission. For this simple case of a stop-and- wait protocol, a 1-bit sequence number will suffice, since it will allow the receiver to know whether the sender is resending the previously transmitted packet (the sequence number of the received packet has the same sequence number as the most recently received packet) or a new packet (the sequence number changes, moving “forward” in modulo-2 arithmetic). Since we are currently assuming a channel that does not lose packets, ACK and NAK packets do not themselves need to indicate the sequence number of the packet they are acknowledging. The sender knows that a received ACK or NAK packet (whether garbled or not) was generated in response to its most recently transmitted data packet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;"><a href="#bookmark277" class="a">Figures 3.11</a><span class="s20"> </span><a href="#bookmark278" class="s124">and </a><a href="#bookmark278" class="a">3.12</a><span class="s20"> </span>show the FSM description for <span class="s30">rdt2.1 </span>, our fixed version of <span class="s30">rdt2.0 </span>. The <span class="s30">rdt2.1 </span>sender and receiver FSMs each now have twice as many states as before. This is because the protocol state must now reflect whether the packet currently being sent (by the sender) or expected (at the receiver) should have a sequence number of 0 or 1. Note that the actions in those states where a 0-</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">numbered packet is being sent or expected are mirror images of those where a 1-numbered packet is being sent or expected; the only differences have to do with the handling of the sequence number.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Protocol <span class="s30">rdt2.1 </span>uses both positive and negative acknowledgments from the receiver to the sender. When an out-of-order packet is received, the receiver sends a positive acknowledgment for the packet it has received. When a corrupted packet</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="712" height="514" alt="image" src="计算机网络自顶向下7th-en/Image_268.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s44" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Figure<span class="h2"> 3.11 </span><span class="s45">rdt2.1 </span>sender</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="785" height="411" alt="image" src="计算机网络自顶向下7th-en/Image_269.png"/></span></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s44" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark277">Figure</a><span class="h2"> 3.12 </span><span class="s45">rdt2.1 </span>receiver<a name="bookmark278">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">is received, the receiver sends a negative acknowledgment. We can accomplish the same effect as a NAK if, instead of sending a NAK, we send an ACK for the last correctly received packet. A sender that receives two ACKs for the same packet (that is, receives <span class="s20">duplicate ACKs</span>) knows that the receiver did not correctly receive the packet following the packet that is being ACKed twice. Our NAK-free reliable</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">data transfer protocol for a channel with bit errors is <span class="s30">rdt2.2 </span><a href="#bookmark279" class="s124">, shown in </a><a href="#bookmark279" class="a">Figures 3.13</a><span class="s20"> </span><a href="#bookmark280" class="s124">and </a><a href="#bookmark280" class="a">3.1</a><span class="s20">4</span>. One subtle change between <span class="s30">rtdt2.1 </span>and <span class="s30">rdt2.2 </span>is that the receiver must now include the sequence number of the packet being acknowledged by an ACK message (this is done by including the <span class="s30">ACK </span>, <span class="s30">0 </span>or <span class="s30">ACK </span>, <span class="s30">1 </span>argument in <span class="s30">make_pkt() </span>in the receiver FSM), and the sender must now check the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">sequence number of the packet being acknowledged by a received ACK message (this is done by</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">including the <span class="s30">0 </span>or <span class="s30">1 </span>argument in <span class="s30">isACK() </span>in the sender FSM).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Reliable Data Transfer over a Lossy Channel with Bit Errors:  <span class="s51">rdt3.0</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Suppose now that in addition to corrupting bits, the underlying channel can <i>lose </i>packets as well, a not- uncommon event in today’s computer networks (including the Internet). Two additional concerns must now be addressed by the protocol: how to detect packet loss and what to do when packet loss occurs.</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">The use of checksumming, sequence numbers, ACK packets, and retransmissions—the techniques</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="714" height="514" alt="image" src="计算机网络自顶向下7th-en/Image_270.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s44" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark279">Figure</a><span class="h2"> 3.13 </span><span class="s45">rdt2.2 </span>sender</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">already developed in <span class="s30">rdt2.2 </span>—will allow us to answer the latter concern. Handling the first concern will require adding a new protocol mechanism.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">There are many possible approaches toward dealing with packet loss (several more of which are explored in the exercises at the end of the chapter). Here, we’ll put the burden of detecting and recovering from lost packets on the sender. Suppose that the sender transmits a data packet and either that packet, or the receiver’s ACK of that packet, gets lost. In either case, no reply is forthcoming at the</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">sender from the receiver. If the sender is willing to wait long enough so that it is <i>certain </i>that a packet has been lost, it can simply retransmit the data packet. You should convince yourself that this protocol does indeed work.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">But how long must the sender wait to be certain that something has been lost? The sender must clearly wait at least as long as a round-trip delay between the sender and receiver (which may include buffering at intermediate routers) plus whatever amount of time is needed to process a packet at the receiver. In many networks, this worst-case maximum delay is very difficult even to estimate, much less know with certainty. Moreover, the protocol should ideally recover from packet loss as soon as possible; waiting for a worst-case delay could mean a long wait until error recovery</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="791" height="386" alt="image" src="计算机网络自顶向下7th-en/Image_271.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s44" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark280">Figure</a><span class="h2"> 3.14 </span><span class="s45">rdt2.2 </span>receiver</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">is initiated. The approach thus adopted in practice is for the sender to judiciously choose a time value such that packet loss is likely, although not guaranteed, to have happened. If an ACK is not received within this time, the packet is retransmitted. Note that if a packet experiences a particularly large delay, the sender may retransmit the packet even though neither the data packet nor its ACK have been lost. This introduces the possibility of <span class="s20">duplicate data packets </span>in the sender-to-receiver channel. Happily,</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">protocol <span class="s30">rdt2.2 </span>already has enough functionality (that is, sequence numbers) to handle the case of duplicate packets.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">From the sender’s viewpoint, retransmission is a panacea. The sender does not know whether a data packet was lost, an ACK was lost, or if the packet or ACK was simply overly delayed. In all cases, the action is the same: retransmit. Implementing a time-based retransmission mechanism requires a <span class="s20">countdown timer </span>that can interrupt the sender after a given amount of time has expired. The sender will thus need to be able to (1) start the timer each time a packet (either a first-time packet or a retransmission) is sent, (2) respond to a timer interrupt (taking appropriate actions), and (3) stop the timer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark282" class="a">Figure 3.15</a><span class="s20"> </span>shows the sender FSM for <span class="s30">rdt3.0 </span>, a protocol that reliably transfers data over a channel that can corrupt or lose packets; in the homework problems, you’ll be asked to provide the receiver FSM</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 137%;text-align: justify;"><span class="p">for </span><span class="s30">rdt3.0 </span><a href="#bookmark283" class="s124">. </a><a href="#bookmark283" class="a">Figure 3.16</a> <a href="#bookmark283" class="s124">shows how the protocol operates with no lost or delayed packets and how it handles lost data packets. In </a><a href="#bookmark283" class="a">Figure 3.1</a>6<span class="p">, time moves forward from the top of the diagram toward the bottom of the</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="723" height="550" alt="image" src="计算机网络自顶向下7th-en/Image_272.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s44" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark281">Figure</a><span class="h2"> 3.15 </span><span class="s45">rdt3.0 </span>sender<a name="bookmark282">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark283" class="s124">diagram; note that a receive time for a packet is necessarily later than the send time for a packet as a result of transmission and propagation delays. In </a><a href="#bookmark283" class="a">Figures 3.16(b</a>)<a href="#bookmark283" class="s124">–</a>(d)<span class="p">, the send-side brackets indicate</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 147%;text-align: left;">the times at which a timer is set and later times out. Several of the more subtle aspects of this protocol are explored in the exercises at the end of this chapter. Because packet sequence numbers alternate between 0 and 1, protocol <span class="s30">rdt3.0 </span>is sometimes known as the <span class="s23">alternating-bit</span><span class="s20"> protocol</span>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="787" height="199" alt="image" src="计算机网络自顶向下7th-en/Image_273.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We have now assembled the key elements of a data transfer protocol. Checksums, sequence numbers, timers, and positive and negative acknowledgment packets each play a crucial and necessary role in the operation of the protocol. We now have a working reliable data transfer protocol!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">Developing a protocol and FSM representation for a simple application-layer protocol</p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">3.4.2 Pipelined Reliable Data Transfer Protocols</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Protocol <span class="s30">rdt3.0 </span>is a functionally correct protocol, but it is unlikely that anyone would be happy with its performance, particularly in today’s high-speed networks. At the heart of  <span class="s30">rdt3.0 </span>’s performance problem is the fact that it is a stop-and-wait protocol.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="301" height="353" alt="image" src="计算机网络自顶向下7th-en/Image_274.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s44" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark283">Figure</a><span class="h2"> 3.16 Operation of </span><span class="s45">rdt3.0 </span>,<span class="h2"> the alternating-bit protocol</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="305" height="376" alt="image" src="计算机网络自顶向下7th-en/Image_275.jpg"/></span></p><p class="s53" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">p<span class="s54"> </span><span class="s55">〉飞〈</span></p><p class="s56" style="padding-top: 3pt;padding-left: 37pt;text-indent: 0pt;text-align: left;">Sender                                   Reω<span style=" color: #694134;">I</span>ver</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s58" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">唱<span class="s59">且</span></p><p class="s60" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">nU  VA</p><p class="s61" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">t<span class="s62"> c</span></p><p class="s63" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">K A</p><p class="s63" style="padding-left: 3pt;text-indent: 0pt;line-height: 120%;text-align: left;">P</p><p class="s62" style="padding-left: 1pt;text-indent: 12pt;line-height: 120%;text-align: left;">d v n</p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">c e</p><p class="s64" style="padding-left: 2pt;text-indent: 0pt;line-height: 120%;text-align: left;">咱<span class="s65">A</span><span class="s60"> VA</span></p><p class="s61" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">t<span class="s62">c</span></p><p class="s63" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">K A</p><p class="s63" style="padding-left: 3pt;text-indent: 0pt;line-height: 120%;text-align: left;">P</p><p class="s62" style="padding-left: 13pt;text-indent: 0pt;line-height: 120%;text-align: left;">d</p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">v n</p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">c e</p><p class="s61" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">t<span class="s62"> t ac</span></p><p class="s63" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">K C CA</p><p class="s63" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">p e <span style=" color: #A8A8A8;">i</span></p><p class="s61" style="padding-left: 13pt;text-indent: 0pt;line-height: 120%;text-align: left;">t<span class="s62"> l d</span></p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">v e p<span class="s67">-</span>n</p><p class="s61" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">c<span class="s62"> d u e</span></p><p class="s68" style="padding-left: 2pt;text-indent: 0pt;line-height: 120%;text-align: left;">E { d s</p><p class="s69" style="padding-left: 4pt;text-indent: 0pt;line-height: 120%;text-align: left;">「 <span class="s70">|</span></p><p class="s71" style="padding-left: 2pt;text-indent: 0pt;line-height: 120%;text-align: left;">A<span class="s72">U </span><span class="s58">噜</span><span class="s59">且</span></p><p class="s62" style="padding-left: 2pt;text-indent: 0pt;line-height: 120%;text-align: left;">k t</p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">c k</p><p class="s62" style="padding-left: 2pt;text-indent: 0pt;line-height: 120%;text-align: left;">A P</p><p class="s73" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">L</p><p class="s73" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">l</p><p class="s74" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">-<span class="s72">L </span><span class="s58">唱</span><span class="s59">且</span></p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">u t</p><p class="s75" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">。<span class="s62">K</span></p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">e p</p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">m</p><p class="s61" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">L<span class="s62"> d</span></p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">v d</p><p style="padding-left: 25pt;text-indent: 0pt;text-align: left;"><span><img width="198" height="22" alt="image" src="计算机网络自顶向下7th-en/Image_276.jpg"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s72" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">-<span class="s74">L</span> UR<span class="s74">U</span></p><p class="s72" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">AU</p><p class="s72" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">VA</p><p class="s61" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">t<span class="s62"> C</span></p><p class="s63" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">K A</p><p class="s63" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">p</p><p class="s62" style="padding-left: 1pt;text-indent: 12pt;line-height: 120%;text-align: left;">d v n</p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">c e</p><p class="s76" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">v</p><p class="s77" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">/</p><p class="s78" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">V</p><p class="s79" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">I O</p><p class="s60" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">UR<span class="s65">U</span> -<span style=" color: #CD8E82;">-</span><span class="s81">、</span></p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">c k</p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">A P</p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">v d</p><p class="s62" style="padding-left: 1pt;text-indent: 0pt;line-height: 120%;text-align: left;">c n</p><ol id="l148"><li style="padding-left: 19pt;text-indent: -11pt;text-align: left;"><p class="s82" style="display: inline;">L<span style=" color: #423B4D;">ost ACK</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s56" style="padding-left: 40pt;text-indent: 0pt;text-align: left;">Sender                                        Recelver</p><p style="text-indent: 0pt;text-align: left;"><span><img width="100" height="70" alt="image" src="计算机网络自顶向下7th-en/Image_277.jpg"/></span></p><p class="s83" style="padding-top: 3pt;padding-left: 170pt;text-indent: 0pt;line-height: 20pt;text-align: left;">•<span class="s84">.</span></p><p class="s83" style="text-indent: 0pt;line-height: 13pt;text-align: left;">•</p><p class="s85" style="padding-left: 30pt;text-indent: 0pt;line-height: 11pt;text-align: left;">send pktO</p><ol id="l149"><li style="padding-top: 3pt;padding-left: 99pt;text-indent: -15pt;line-height: 25pt;text-align: left;"><p class="s86" style="display: inline;">v  <span style=" color: #827789;">pktO</span></p><p class="s83" style="padding-left: 83pt;text-indent: 0pt;line-height: 20pt;text-align: left;">•<span class="s87">.</span><span class="s85">send ACKO</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="126" height="42" alt="image" src="计算机网络自顶向下7th-en/Image_278.jpg"/></span></p><p class="s85" style="padding-left: 29pt;text-indent: 0pt;line-height: 11pt;text-align: left;">rcv ACKO    <span class="s88">二                       :</span></p><p class="s85" style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">end pkt <span style=" color: #A8A8A8;">l</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s85" style="text-indent: 0pt;text-align: center;">rese:;m;::<span style=" color: #A8A8A8;">;</span><span style=" color: #232123;">L</span><span style=" color: #C1C1C4;">j </span><span style=" color: #388CAE;">4</span><span class="s92">」</span><span style=" color: #487B97;">4</span><span class="s94">户</span></p><ul id="l150"><li style="padding-left: 20pt;text-indent: -20pt;line-height: 8pt;text-align: left;"><p class="s95" style="display: inline;">二</p></li></ul><ul id="l151"><li style="padding-left: 126pt;text-indent: -35pt;line-height: 9pt;text-align: left;"><p class="s95" style="display: inline;">二</p><p class="s85" style="padding-left: 16pt;text-indent: 0pt;line-height: 16pt;text-align: center;">rcv ACK <span style=" color: #A8A8A8;">l </span><span class="s96">:</span><span class="s97">AI&quot;&quot;&quot;&quot;    </span><span class="s98">..c.</span><span class="s99">川</span></p><p class="s85" style="padding-left: 30pt;text-indent: 0pt;line-height: 12pt;text-align: left;">send pktO <span class="s100">:</span><span class="s101">..e.!:I</span><span class="s102">o</span></p></li><li style="padding-left: 113pt;text-indent: -22pt;line-height: 7pt;text-align: left;"><p class="s95" style="display: inline;">二</p><p class="s85" style="padding-left: 36pt;text-indent: 0pt;line-height: 10pt;text-align: left;">rcv ACK <span style=" color: #A8A8A8;">l </span><span style=" color: #C1C1C4;">:     </span><span class="s103">---......咱</span></p><p class="s104" style="padding-left: 2pt;text-indent: 0pt;line-height: 15pt;text-align: center;">也 <span class="s85">nothing </span><span class="s105">:  </span><span class="s106">峰</span></p><p class="s107" style="text-indent: 0pt;line-height: 25pt;text-align: left;">.</p><p class="s108" style="padding-top: 3pt;padding-left: 15pt;text-indent: 0pt;line-height: 34pt;text-align: center;">.<span class="s109">-</span></p><p class="s83" style="text-indent: 0pt;line-height: 8pt;text-align: center;">•</p><p class="s83" style="padding-left: 10pt;text-indent: 0pt;line-height: 22pt;text-align: center;">•<span class="s110">.</span></p><p class="s111" style="padding-left: 88pt;text-indent: 0pt;line-height: 7pt;text-align: left;">&#39;f&#39;                   &#39;f&#39;</p></li></ul></li></ol></li><li style="padding-top: 4pt;padding-left: 18pt;text-indent: -11pt;text-align: left;"><p class="s56" style="display: inline;">Premature tlmeout</p></li></ol><p class="s86" style="text-indent: 0pt;line-height: 11pt;text-align: left;">rcv  <span style=" color: #827789;">pktl</span></p><p class="s85" style="text-indent: 0pt;text-align: left;">send ACK <span style=" color: #A8A8A8;">l</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s86" style="text-indent: 0pt;text-align: left;">rcv <span style=" color: #827789;">pkt </span><span style=" color: #A8A8A8;">1</span></p><p class="s85" style="text-indent: 1pt;line-height: 12pt;text-align: left;">(detect   dup<span style=" color: #A8A8A8;">l</span><span style=" color: #8C8A97;">icatel </span>send ACK <span style=" color: #A8A8A8;">l</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s86" style="text-indent: 0pt;text-align: left;">rcv  <span style=" color: #827789;">pktO send ACKO</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s112" style="padding-left: 65pt;text-indent: 0pt;text-align: left;"><span style=" color: #423B4D;">Data </span>pac<span class="s113">l&lt;</span>e<span style=" color: #3F284F;">t</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="237" height="1" alt="image" src="计算机网络自顶向下7th-en/Image_279.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="238" height="1" alt="image" src="计算机网络自顶向下7th-en/Image_280.png"/></span></p><p class="s115" style="padding-left: 5pt;text-indent: 0pt;line-height: 74pt;text-align: left;">己<span class="s116">   </span><span class="s117">-</span><span class="s118">翩翩+           </span><span class="s119">u</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s56" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">a <span style=" color: #694134;">. </span>A stop-and-wa <span style=" color: #2A5675;">l</span>t protocolln  operat<span style=" color: #2A5675;">l</span>on</p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark284">Figure 3.17 Stop-and-wait versus pipelined protocol</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="316" height="217" alt="image" src="计算机网络自顶向下7th-en/Image_281.jpg"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark284" class="s124">To appreciate the performance impact of this stop-and-wait behavior, consider an idealized case of two hosts, one located on the West Coast of the United States and the other located on the East Coast, as shown in </a><a href="#bookmark284" class="a">Figure 3.1</a>7<span class="p">. The speed-of-light round-trip propagation delay between these two end systems,</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">RTT, is approximately 30 milliseconds. Suppose that they are connected by a channel with a</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 141%;text-align: left;">transmission rate, <i>R</i>, of 1 Gbps (10<span class="s21">9</span><span class="s22"> </span>bits per second). With a packet size, <i>L, </i>of 1,000 bytes (8,000 bits) per packet, including both header fields and data, the time needed to actually transmit the packet into the 1 Gbps link is</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">dtrans=LR=8000 bits/packet109 bits/sec=8 microseconds</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark285" class="a">Figure 3.18(a)</a> <span class="p">shows that with our stop-and-wait protocol, if the sender begins sending the packet at t=0, then at t=L/R=8 microseconds, the last bit enters the channel at the sender side. The packet then makes its 15-msec cross-country journey, with the last bit of the packet emerging at the receiver at</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">t=RTT/2+L/R= 15.008 msec. Assuming for simplicity that ACK packets are extremely small (so that we can ignore their transmission time) and that the receiver can send an ACK as soon as the last bit of a data packet is received, the ACK emerges back at the sender at t=RTT+L/R=30.008 msec. At this point, the sender can now transmit the next message. Thus, in 30.008 msec, the sender was sending for only</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">0.008 msec. If we define the <span class="s20">utilization </span><a href="#bookmark285" class="s124">of the sender (or the channel) as the fraction of time the sender is actually busy sending bits into the channel, the analysis in </a><a href="#bookmark285" class="a">Figure 3.18(a)</a><span class="s20"> </span>shows that the stop-and- wait protocol has a rather dismal sender utilization, <i>U</i><span class="s22">sender</span>, of</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Usender=L/RRTT+L/R  =.00830.008=0.00027</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="709" height="381" alt="image" src="计算机网络自顶向下7th-en/Image_282.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark285">Figure 3.18 Stop-and-wait and pipelined sending</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="709" height="407" alt="image" src="计算机网络自顶向下7th-en/Image_283.jpg"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">That is, the sender was busy only 2.7 hundredths of one percent of the time! Viewed another way, the sender was able to send only 1,000 bytes in 30.008 milliseconds, an effective throughput of only 267 kbps—even though a 1 Gbps link was available! Imagine the unhappy network manager who just paid a fortune for a gigabit capacity link but manages to get a throughput of only 267 kilobits per second! This is a graphic example of how network protocols can limit the capabilities provided by the underlying network hardware. Also, we have neglected lower-layer protocol-processing times at the sender and receiver, as well as the processing and queuing delays that would occur at any intermediate routers</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark286">between the sender and receiver. Including these effects would serve only to further increase the delay and further accentuate the poor performance.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark284" class="s124">The solution to this particular performance problem is simple: Rather than operate in a stop-and-wait manner, the sender is allowed to send multiple packets without waiting for acknowledgments, as illustrated in </a><a href="#bookmark284" class="a">Figure 3.17(b</a>)<a href="#bookmark285" class="s124">. </a><a href="#bookmark285" class="a">Figure 3.18(b)</a> <span class="p">shows that if the sender is allowed to transmit three packets</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">before having to wait for acknowledgments, the utilization of the sender is essentially tripled. Since the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">many in-transit sender-to-receiver packets can be visualized as filling a pipeline, this technique is known as <span class="s20">pipelining</span>. Pipelining has the following consequences for reliable data transfer protocols:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_284.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">The range of sequence numbers must be increased, since each in-transit packet (not counting retransmissions) must have a unique sequence number and there may be multiple, in-transit, unacknowledged packets.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_285.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">The sender and receiver sides of the protocols may have to buffer more than one packet. Minimally, the sender will have to buffer packets that have been transmitted but not yet acknowledged. Buffering of correctly received packets may also be needed at the receiver, as discussed below.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_286.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;">The range of sequence numbers needed and the buffering requirements will depend on the manner in which a data transfer protocol responds to lost, corrupted, and overly delayed packets. Two basic approaches toward pipelined error recovery can be identified: <span class="s20">Go-Back-N </span>and <span class="s20">selective repeat</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">3.4.3 Go-Back-N (GBN)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">In a <span class="s20">Go-Back-N (GBN) protocol</span>, the sender is allowed to transmit multiple packets (when available) without waiting for an acknowledgment, but is constrained to have no more than some maximum allowable number, <i>N, </i>of unacknowledged packets in the pipeline. We describe the GBN protocol in</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">some detail in this section. But before reading on, you are encouraged to play with the GBN applet (an</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">awesome applet!) at the companion Web site.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark287" class="a">Figure 3.19</a> <span class="p">shows the sender’s view of the range of sequence numbers in a GBN protocol. If we define</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">base <span class="p">to be the sequence number of the oldest unacknowledged</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="771" height="153" alt="image" src="计算机网络自顶向下7th-en/Image_287.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Figure 3.19 Sender’s view of sequence numbers in Go-Back-N</h2><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark287">packet and </a><span class="s30">nextseqnum </span>to be the smallest unused sequence number (that is, the sequence number of the next packet to be sent), then four intervals in the range of sequence numbers can be identified.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">Sequence numbers in the interval [ <span class="s30">0, base-1 </span>] correspond to packets that have already been transmitted and acknowledged. The interval  <span class="s30">[base, nextseqnum-1] </span>corresponds to packets that have been sent but not yet acknowledged. Sequence numbers in the interval  <span class="s30">[nextseqnum, base+N-1] </span>can be used for packets that can be sent immediately, should data arrive from the upper layer. Finally, sequence numbers greater than or equal to <span class="s30">base+N </span>cannot be used until an unacknowledged packet currently in the pipeline (specifically, the packet with sequence number  <span class="s30">base </span>)</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">has been acknowledged.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark287" class="s124">As suggested by </a><a href="#bookmark287" class="a">Figure 3.1</a><span class="s20">9</span>, the range of permissible sequence numbers for transmitted but not yet acknowledged packets can be viewed as a window of size <i>N </i>over the range of sequence numbers. As the protocol operates, this window slides forward over the sequence number space. For this reason, <i>N</i></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">is often referred to as the <span class="s20">window size </span>and the GBN protocol itself as a <span class="s20">sliding-window protocol</span>. You</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;">might be wondering why we would even limit the number of outstanding, unacknowledged packets to a value of <i>N </i><a href="#bookmark329" class="s124">in the first place. Why not allow an unlimited number of such packets? We’ll see in </a><a href="#bookmark329" class="a">Section</a></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;"><a href="#bookmark329" class="a">3.5</a> <span class="p">that flow control is one reason to impose a limit on the sender. We’ll examine another reason to do</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark355" class="s124">so in </a><a href="#bookmark355" class="a">Section 3.</a>7<span class="p">, when we study TCP congestion control.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">In practice, a packet’s sequence number is carried in a fixed-length field in the packet header. If <i>k </i>is the number of bits in the packet sequence number field, the range of sequence numbers is thus [0,2k−1]. With a finite range of sequence numbers, all arithmetic involving sequence numbers must then be done</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 136%;text-align: left;">using modulo 2<span class="s121">k</span><span class="s31"> </span>arithmetic. (That is, the sequence number space can be thought of as a ring of size 2<span class="s121">k</span>, where sequence number <span class="s27">2</span>k−1 is immediately followed by sequence number 0.) Recall that  <span class="s30">rdt3.0 </span>had a 1-bit sequence number and a range of sequence numbers of [0,1]. Several of the problems at the end of this chapter explore the consequences of a finite range of sequence numbers. We will see in</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark329" class="a">Section 3.5</a> <span class="p">that TCP has a 32-bit sequence number field, where TCP sequence numbers count bytes in the byte stream rather than packets.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark288" class="a">Figures 3.20</a> <a href="#bookmark289" class="s124">and </a><a href="#bookmark289" class="a">3.21</a> <span class="p">give an extended FSM description of the sender and receiver sides of an ACK- based, NAK-free, GBN protocol. We refer to this FSM</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="758" height="492" alt="image" src="计算机网络自顶向下7th-en/Image_288.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark288">Figure 3.20 Extended FSM description of the GBN sender</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="500" height="316" alt="image" src="计算机网络自顶向下7th-en/Image_289.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark289">Figure 3.21 Extended FSM description of the GBN receiver</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">description as an <i>extended FSM </i>because we have added variables (similar to programming-language variables) for <span class="s30">base </span>and <span class="s30">nextseqnum </span>, and added operations on these variables and conditional actions involving these variables. Note that the extended FSM specification is now beginning to look</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">somewhat like a programming-language specification. </a><a href="#bookmark848" class="a">[Bochman 1984]</a> <span class="p">provides an excellent survey of</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">additional extensions to FSM techniques as well as other programming-language-based techniques for specifying protocols.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The GBN sender must respond to three types of events:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_290.png"/></span></p><p style="padding-top: 3pt;padding-left: 25pt;text-indent: 0pt;line-height: 137%;text-align: left;"><b>Invocation from above. </b>When <span class="s30">rdt_send() </span>is called from above, the sender first checks to see if the window is full, that is, whether there are <i>N </i>outstanding, unacknowledged packets. If the window is not full, a packet is created and sent, and variables are appropriately updated. If the window is full,</p><p style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">the sender simply returns the data back to the upper layer, an implicit indication that the window is full. The upper layer would presumably then have to try again later. In a real implementation, the sender would more likely have either buffered (but not immediately sent) this data, or would have a synchronization mechanism (for example, a semaphore or a flag) that would allow the upper layer to</p><p style="padding-top: 2pt;padding-left: 25pt;text-indent: 0pt;text-align: left;">call <span class="s30">rdt_send() </span>only when the window is not full.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_291.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;text-align: left;">Receipt of an ACK. <span class="p">In our GBN protocol, an acknowledgment for a packet with sequence number </span><i>n</i></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">will be taken to be a <span class="s20">cumulative acknowledgment</span>, indicating that all packets with a sequence</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">number up to and including <i>n </i>have been correctly received at the receiver. We’ll come back to this issue shortly when we examine the receiver side of GBN.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_292.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">A timeout event. <span class="p">The protocol’s name, “Go-Back-N,” is derived from the sender’s behavior in the presence of lost or overly delayed packets. As in the stop-and-wait protocol, a timer will again be used to recover from lost data or acknowledgment packets. If a timeout occurs, the sender resends</span></p><p class="s17" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">all <a href="#bookmark288" class="s124">packets that have been previously sent but that have not yet been acknowledged. Our sender in </a><a href="#bookmark288" class="a">Figure 3.20</a><span class="s20"> </span><span class="p">uses only a single timer, which can be thought of as a timer for the oldest transmitted but not yet acknowledged packet. If an ACK is received but there are still additional transmitted but</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">not yet acknowledged packets, the timer is restarted. If there are no outstanding, unacknowledged packets, the timer is stopped.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 137%;text-align: left;">The receiver’s actions in GBN are also simple. If a packet with sequence number <i>n </i>is received correctly and is in order (that is, the data last delivered to the upper layer came from a packet with sequence number <span class="s27">n</span>−1), the receiver sends an ACK for packet <i>n </i>and delivers the data portion of the packet to the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">upper layer. In all other cases, the receiver discards the packet and resends an ACK for the most</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">recently received in-order packet. Note that since packets are delivered one at a time to the upper layer,</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">if packet <i>k </i>has been received and delivered, then all packets with a sequence number lower than <i>k </i>have also been delivered. Thus, the use of cumulative acknowledgments is a natural choice for GBN.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">In our GBN protocol, the receiver discards out-of-order packets. Although it may seem silly and wasteful to discard a correctly received (but out-of-order) packet, there is some justification for doing so. Recall that the receiver must deliver data in order to the upper layer. Suppose now that packet <i>n </i>is expected,</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">but packet <span class="s27">n</span>+1 arrives. Because data must be delivered in order, the receiver <i>could </i>buffer (save) packet</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 124%;text-align: left;"><span class="s27">n</span>+1 and then deliver this packet to the upper layer after it had later received and delivered packet <i>n</i>. However, if packet <i>n </i>is lost, both it and packet <span class="s27">n</span>+1 will eventually be retransmitted as a result of the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">GBN retransmission rule at the sender. Thus, the receiver can simply discard packet n+1. The</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">advantage of this approach is the simplicity of receiver buffering—the receiver need not buffer <i>any </i>out- of-order packets. Thus, while the sender must maintain the upper and lower bounds of its window and</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">the position of <span class="s30">nextseqnum </span>within this window, the only piece of information the receiver need maintain is the sequence number of the next in-order packet. This value is held in the variable</p><p class="s30" style="padding-top: 4pt;padding-left: 5pt;text-indent: 2pt;line-height: 138%;text-align: left;">expectedseqnum <a href="#bookmark289" class="s124">, shown in the receiver FSM in </a><a href="#bookmark289" class="a">Figure 3.2</a><span class="s20">1</span><span class="p">. Of course, the disadvantage of throwing away a correctly received packet is that the subsequent retransmission of that packet might be lost or garbled and thus even more retransmissions would be required.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark291" class="a">Figure 3.22</a> <span class="p">shows the operation of the GBN protocol for the case of a window size of four packets. Because of this window size limitation, the sender sends packets 0 through 3 but then must wait for one or more of these packets to be acknowledged before proceeding. As each successive ACK (for</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">example, <span class="s30">ACK0 </span>and <span class="s30">ACK1 </span>) is received, the window slides forward and the sender can transmit one new packet (pkt4 and pkt5, respectively). On the receiver side, packet 2 is lost and thus packets 3, 4, and 5 are found to be out of order and are discarded.</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark288" class="s124">Before closing our discussion of GBN, it is worth noting that an implementation of this protocol in a protocol stack would likely have a structure similar to that of the extended FSM in </a><a href="#bookmark288" class="a">Figure 3.2</a>0<span class="p">. The</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">implementation would also likely be in the form of various procedures that implement the actions to be taken in response to the various events that can occur. In such <span class="s20">event-based programming</span>, the various procedures are called (invoked) either by other procedures in the protocol stack, or as the result of an interrupt. In the sender, these events would be (1) a call from the upper-layer entity to invoke</p><p class="s30" style="padding-top: 2pt;padding-left: 5pt;text-indent: 2pt;line-height: 138%;text-align: left;">rdt_send() <span class="p">, (2) a timer interrupt, and (3) a call from the lower layer to invoke </span>rdt_rcv() <span class="p">when a packet arrives. The programming exercises at the end of this chapter will give you a chance to actually implement these routines in a simulated, but realistic, network setting.</span></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark329" class="s124">We note here that the GBN protocol incorporates almost all of the techniques that we will encounter when we study the reliable data transfer components of TCP in </a><a href="#bookmark329" class="a">Section 3.</a>5<span class="p">. These techniques include</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the use of sequence numbers, cumulative acknowledgments, checksums, and a timeout/retransmit operation.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="548" height="719" alt="image" src="计算机网络自顶向下7th-en/Image_293.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark290">Figure 3.22 Go-Back-N in operation</a><a name="bookmark291">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">3.4.4 Selective Repeat (SR)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark284" class="s124">The GBN protocol allows the sender to potentially “fill the pipeline” in </a><a href="#bookmark284" class="a">Figure 3.17</a> <span class="p">with packets, thus avoiding the channel utilization problems we noted with stop-and-wait protocols. There are, however, scenarios in which GBN itself suffers from performance problems. In particular, when the window size</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">and bandwidth-delay product are both large, many packets can be in the pipeline. A single packet error can thus cause GBN to retransmit a large number of packets, many unnecessarily. As the probability of channel errors increases, the pipeline can become filled with these unnecessary retransmissions. Imagine, in our message-dictation scenario, that if every time a word was garbled, the surrounding 1,000 words (for example, a window size of 1,000 words) had to be repeated. The dictation would be</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">slowed by all of the reiterated words.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">As the name suggests, selective-repeat protocols avoid unnecessary retransmissions by having the sender retransmit only those packets that it suspects were received in error (that is, were lost or corrupted) at the receiver. This individual, as-needed, retransmission will require that the receiver</p><p class="s17" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">individually <span class="p">acknowledge correctly received packets. A window size of </span>N <span class="p">will again be used to limit the number of outstanding, unacknowledged packets in the pipeline. However, unlike GBN, the sender will</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark292" class="s124">have already received ACKs for some of the packets in the window. </a><a href="#bookmark292" class="a">Figure 3.23</a> <a href="#bookmark293" class="s124">shows the SR sender’s view of the sequence number space. </a><a href="#bookmark293" class="a">Figure 3.24</a> <span class="p">details the various actions taken by the SR sender.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark294" class="s124">The SR receiver will acknowledge a correctly received packet whether or not it is in order. Out-of-order packets are buffered until any missing packets (that is, packets with lower sequence numbers) are received, at which point a batch of packets can be delivered in order to the upper layer. </a><a href="#bookmark294" class="a">Figure 3.25</a></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark295" class="s124">itemizes the various actions taken by the SR receiver. </a><a href="#bookmark295" class="a">Figure 3.26</a> <span class="p">shows an example of SR operation</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark295" class="s124">in the presence of lost packets. Note that in </a><a href="#bookmark295" class="a">Figure 3.2</a>6<span class="p">, the receiver initially buffers packets 3, 4, and 5, and delivers them together with packet 2 to the upper layer when packet 2 is finally received.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="791" height="467" alt="image" src="计算机网络自顶向下7th-en/Image_294.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark292">Figure 3.23 Selective-repeat (SR) sender and receiver views of sequence-number space</a></h2><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="372" alt="image" src="计算机网络自顶向下7th-en/Image_295.gif"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark293">Figure 3.24 SR sender events and actions</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="372" alt="image" src="计算机网络自顶向下7th-en/Image_296.gif"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;"><a name="bookmark294">Figure 3.25 SR receiver events and actions</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark294" class="s124">It is important to note that in Step 2 in </a><a href="#bookmark294" class="a">Figure 3.2</a><span class="s20">5</span>, the receiver reacknowledges (rather than ignores) already received packets with certain sequence numbers <i>below </i>the current window base. You should convince yourself that this reacknowledgment is indeed needed. Given the sender and receiver</p><p class="s37" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">sequence<a href="#bookmark292" class="s124"> number spaces in </a><a href="#bookmark292" class="a">Figure 3.2</a><span class="s20">3</span><span class="p">, for example, if there is no ACK for packet </span><span class="s45">send_base</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">propagating from the</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="785" height="744" alt="image" src="计算机网络自顶向下7th-en/Image_297.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark295">Figure 3.26 SR operation</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s37" style="padding-left: 5pt;text-indent: 0pt;line-height: 124%;text-align: left;">receiver<span class="p"> to the sender, the sender will eventually retransmit packet </span><span class="s45">send_base </span>,<span class="p"> even though it is clear (to us, not the sender!) that the receiver has already received that packet. If the receiver were not to</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">acknowledge this packet, the sender’s window would never move forward! This example illustrates an important aspect of SR protocols (and many other protocols as well). The sender and receiver will not always have an identical view of what has been received correctly and what has not. For SR protocols, this means that the sender and receiver windows will not always coincide.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The lack of synchronization between sender and receiver windows has important consequences when we are faced with the reality of a finite range of sequence numbers. Consider what could happen, for example, with a finite range of four packet sequence numbers, 0, 1, 2, 3, and a window size of three.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark296" class="s124">Suppose packets 0 through 2 are transmitted and correctly received and acknowledged at the receiver. At this point, the receiver’s window is over the fourth, fifth, and sixth packets, which have sequence numbers 3, 0, and 1, respectively. Now consider two scenarios. In the first scenario, shown in </a><a href="#bookmark296" class="a">Figure</a></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark296" class="a">3.27(a</a>)<span class="p">, the ACKs for the first three packets are lost and the sender retransmits these packets. The</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">receiver thus next receives a packet with sequence number 0—a copy of the first packet sent.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark296" class="s124">In the second scenario, shown in </a><a href="#bookmark296" class="a">Figure 3.27(b</a>)<span class="p">, the ACKs for the first three packets are all delivered correctly. The sender thus moves its window forward and sends the fourth, fifth, and sixth packets, with sequence numbers 3, 0, and 1, respectively. The packet with sequence number 3 is lost, but the packet</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">with sequence number 0 arrives—a packet containing <i>new </i>data.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark296" class="s124">Now consider the receiver’s viewpoint in </a><a href="#bookmark296" class="a">Figure 3.2</a>7<span class="p">, which has a figurative curtain between the sender and the receiver, since the receiver cannot “see” the actions taken by the sender. All the receiver observes is the sequence of messages it receives from the channel and sends into the channel. As far</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark296" class="s124">as it is concerned, the two scenarios in </a><a href="#bookmark296" class="a">Figure 3.27</a><span class="s20"> </span>are <i>identical. </i>There is no way of distinguishing the retransmission of the first packet from an original transmission of the fifth packet. Clearly, a window size that is 1 less than the size of the sequence number space won’t work. But how small must the window</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">size be? A problem at the end of the chapter asks you to show that the window size must be less than or equal to half the size of the sequence number space for SR protocols.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">At the companion Web site, you will find an applet that animates the operation of the SR protocol. Try performing the same experiments that you did with the GBN applet. Do the results agree with what you expect?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">This completes our discussion of reliable data transfer protocols. We’ve covered a <i>lot </i><a href="#bookmark300" class="s124">of ground and introduced numerous mechanisms that together provide for reliable data transfer. </a><a href="#bookmark300" class="a">Table 3.1</a><span class="s20"> </span>summarizes these mechanisms. Now that we have seen all of these mechanisms in operation and can see the “big</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">picture,” we encourage you to review this section again to see how these mechanisms were incrementally added to cover increasingly complex (and realistic) models of the channel connecting the sender and receiver, or to improve the performance of the protocols.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s conclude our discussion of reliable data transfer protocols by considering one remaining assumption in our underlying channel model. Recall that we have assumed that packets cannot be reordered within the channel between the sender and receiver. This is generally a reasonable assumption when the sender and receiver are connected by a single physical wire. However, when the “channel” connecting the two is a network, packet reordering can occur. One manifestation of packet reordering is that old copies of a packet with a sequence or acknowledgment</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="515" height="353" alt="image" src="计算机网络自顶向下7th-en/Image_298.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark296">Figure 3.27 SR receiver dilemma with too-large windows: A new packet or a retransmission?</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="516" height="359" alt="image" src="计算机网络自顶向下7th-en/Image_299.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark297">Table 3.1 Summary of reliable data transfer mechanisms and their use</a></h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Mechanism</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Use, Comments</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Checksum</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Used to detect bit errors in a transmitted packet.</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Timer</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 21pt;text-indent: 0pt;line-height: 146%;text-align: left;">Used to timeout/retransmit a packet, possibly because the packet (or its ACK) was lost within the channel. Because timeouts can occur when a packet is delayed but not lost (premature timeout), or when a packet has been received by the receiver but the receiver-to-sender ACK has been lost, duplicate copies</p></td></tr></table><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p class="s122" style="padding-left: 8pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a name="bookmark298">of a packet may be received by a receiver.</a><a name="bookmark299">&zwnj;</a><a name="bookmark300">&zwnj;</a></p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 49pt;text-indent: 0pt;line-height: 146%;text-align: left;">Sequence number</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 16pt;text-indent: 0pt;line-height: 146%;text-align: left;">Used for sequential numbering of packets of data flowing from sender to receiver. Gaps in the sequence numbers of received packets allow the receiver to detect a lost packet. Packets with duplicate sequence numbers allow the receiver to detect duplicate copies of a packet.</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Acknowledgment</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 17pt;text-indent: 0pt;line-height: 146%;text-align: left;">Used by the receiver to tell the sender that a packet or set of packets has been received correctly. Acknowledgments will typically carry the sequence number of the packet or packets being acknowledged. Acknowledgments may be individual or cumulative, depending on the protocol.</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 10pt;text-indent: 0pt;line-height: 146%;text-align: left;">Negative acknowledgment</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 21pt;text-indent: 0pt;line-height: 146%;text-align: left;">Used by the receiver to tell the sender that a packet has not been received correctly. Negative acknowledgments will typically carry the sequence number of the packet that was not received correctly.</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 52pt;text-indent: 0pt;line-height: 146%;text-align: left;">Window, pipelining</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 16pt;text-indent: 0pt;line-height: 146%;text-align: left;">The sender may be restricted to sending only packets with sequence numbers that fall within a given range. By allowing multiple packets to be transmitted but not yet acknowledged, sender utilization can be increased over a stop-and-wait mode of operation. We’ll see shortly that the window size may be set on the basis of the receiver’s ability to receive and buffer messages, or the level of congestion in the network, or both.</p></td></tr></table><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">number of <i>x </i>can appear, even though neither the sender’s nor the receiver’s window contains <i>x</i>. With packet reordering, the channel can be thought of as essentially buffering packets and spontaneously</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">emitting these packets at <i>any </i>point in the future. Because sequence numbers may be reused, some care must be taken to guard against such duplicate packets. The approach taken in practice is to ensure that a sequence number is not reused until the sender is “sure” that any previously sent packets with</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">sequence number <i>x </i>are no longer in the network. This is done by assuming that a packet cannot “live” in the network for longer than some fixed maximum amount of time. A maximum packet lifetime of</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">approximately three minutes is assumed in the TCP extensions for high-speed networks </a><a href="#bookmark848" class="a">[RFC </a>1323]<a href="#bookmark848" class="s124">. </a><a href="#bookmark848" class="a">[Sunshine 1978]</a> <span class="p">describes a method for using sequence numbers such that reordering problems can be completely avoided.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l152"><ol id="l153"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark301">Connection-Oriented Transport: TCP</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now that we have covered the underlying principles of reliable data transfer, let’s turn to TCP—the Internet’s transport-layer, connection-oriented, reliable transport protocol. In this section, we’ll see that in order to provide reliable data transfer, TCP relies on many of the underlying principles discussed in the previous section, including error detection, retransmissions, cumulative acknowledgments, timers, and header fields for sequence and acknowledgment numbers. TCP is defined in RFC 793, RFC 1122, RFC 1323, RFC 2018, and RFC 2581.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l154"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The TCP Connection</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">TCP is said to be <span class="s20">connection-oriented </span>because before one application process can begin to send data to another, the two processes must first “handshake” with each other—that is, they must send some preliminary segments to each other to establish the parameters of the ensuing data transfer. As part of TCP connection establishment, both sides of the connection will initialize many TCP state variables</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark355" class="s124">(many of which will be discussed in this section and in </a><a href="#bookmark355" class="a">Section 3.</a>7<span class="p">) associated with the TCP connection.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The TCP “connection” is not an end-to-end TDM or FDM circuit as in a circuit-switched network. Instead, the “connection” is a logical one, with common state residing only in the TCPs in the two communicating end systems. Recall that because the TCP protocol runs only in the end systems and not in the intermediate network elements (routers and link-layer switches), the intermediate network elements do not maintain TCP connection state. In fact, the intermediate routers are completely oblivious to TCP connections; they see datagrams, not connections.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A TCP connection provides a <span class="s20">full-duplex service</span>: If there is a TCP connection between Process A on one host and Process B on another host, then application-layer data can flow from Process A to Process B at the same time as application-layer data flows from Process B to Process A. A TCP connection is also always <span class="s20">point-to-point</span>, that is, between a single sender and a single receiver. So- called “multicasting” (see the online supplementary materials for this text)—the transfer of data from one sender to many receivers in a single send operation—is not possible with TCP. With TCP, two hosts are company and three are a crowd!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now take a look at how a TCP connection is established. Suppose a process running in one host wants to initiate a connection with another process in another host. Recall that the process that is</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">initiating the connection is called the <i>client process</i>, while the other process is called the <i>server process</i>. The client application process first informs the client transport layer that it wants to establish a connection</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="669" alt="image" src="计算机网络自顶向下7th-en/Image_300.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">CASE HISTORY</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Vinton Cerf, Robert Kahn, and TCP/IP</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the early 1970s, packet-switched networks began to proliferate, with the ARPAnet—the precursor of the Internet—being just one of many networks. Each of these networks had its own protocol. Two researchers, Vinton Cerf and Robert Kahn, recognized the importance of interconnecting these networks and invented a cross-network protocol called TCP/IP, which stands for Transmission Control Protocol/Internet Protocol. Although Cerf and Kahn began by seeing the protocol as a single entity, it was later split into its two parts, TCP and IP, which</p><p style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">operated separately. Cerf and Kahn published a paper on TCP/IP in May 1974 in <a href="#bookmark848" style=" color: #333; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt;">IEEE Transactions on Communications Technology </a><a href="#bookmark848" class="a">[Cerf </a><span class="s20">1974]</span>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">The TCP/IP protocol, which is the bread and butter of today’s Internet, was devised before PCs, workstations, smartphones, and tablets, before the proliferation of Ethernet, cable, and DSL, WiFi, and other access network technologies, and before the Web, social media, and streaming video. Cerf and Kahn saw the need for a networking protocol that, on the one hand, provides broad support for yet-to-be-defined applications and, on the other hand, allows arbitrary hosts and link-layer protocols to interoperate.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">In 2004, Cerf and Kahn received the ACM’s Turing Award, considered the “Nobel Prize of Computing” for “pioneering work on internetworking, including the design and implementation of the Internet’s basic communications protocols, TCP/IP, and for inspired leadership in networking.”</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_301.png"/></span></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark240" class="s124">to a process in the server. Recall from </a><a href="#bookmark240" class="a">Section 2.7.</a>2<span class="p">, a Python client program does this by issuing the command</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 32pt;text-indent: 0pt;text-align: left;">clientSocket.connect((serverName, serverPort))</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">where <span class="s30">serverName </span>is the name of the server and <span class="s30">serverPort </span>identifies the process on the server. TCP in the client then proceeds to establish a TCP connection with TCP in the server. At the end of this section we discuss in some detail the connection-establishment procedure. For now it suffices to know</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">that the client first sends a special TCP segment; the server responds with a second special TCP segment; and finally the client responds again with a third special segment. The first two segments carry no payload, that is, no application-layer data; the third of these segments may carry a payload. Because</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">three segments are sent between the two hosts, this connection-establishment procedure is often referred to as a <span class="s20">three-way handshake</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark239" class="s124">Once a TCP connection is established, the two application processes can send data to each other. Let’s consider the sending of data from the client process to the server process. The client process passes a stream of data through the socket (the door of the process), as described in </a><a href="#bookmark239" class="a">Section 2.</a>7<span class="p">. Once the data</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark302" class="s124">passes through the door, the data is in the hands of TCP running in the client. As shown in </a><a href="#bookmark302" class="a">Figure 3.2</a>8<span class="p">,</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">TCP directs this data to the connection’s </span>send buffer<a href="#bookmark848" class="s124">, which is one of the buffers that is set aside during the initial three-way handshake. From time to time, TCP will grab chunks of data from the send buffer and pass the data to the network layer. Interestingly, the TCP specification </a><a href="#bookmark848" class="a">[RFC 793]</a> <span class="p">is very laid back</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">about specifying when TCP should actually send buffered data, stating that TCP should “send that data</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">in segments at its own convenience.” The maximum amount of data that can be grabbed and placed in a segment is limited by the <span class="s20">maximum segment size (MSS)</span>. The MSS is typically set by first determining the length of the largest link-layer frame that can be sent by the local sending host (the so- called <span class="s20">maximum transmission unit, MTU</span>), and then setting the MSS to ensure that a TCP segment (when encapsulated in an IP datagram) plus the TCP/IP header length (typically 40 bytes) will fit into a single link-layer frame. Both Ethernet and PPP link-layer protocols have an MTU of 1,500 bytes. Thus a typical value of MSS is 1460 bytes. Approaches have also been proposed for discovering the path MTU</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">—the largest link-layer frame that can be sent on all links from source to destination </a><a href="#bookmark848" class="a">[RFC </a>1191]<span class="p">—and setting the MSS based on the path MTU value. Note that the MSS is the maximum amount of application-layer data in the segment, not the maximum size of the TCP segment including headers.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">(This terminology is confusing, but we have to live with it, as it is well entrenched.)</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">TCP pairs each chunk of client data with a TCP header, thereby forming <span class="s20">TCP segments</span>. The segments are passed down to the network layer, where they are separately encapsulated within network-layer IP datagrams. The IP datagrams are then sent into the network. When TCP receives a segment at the</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark302" class="s124">other end, the segment’s data is placed in the TCP connection’s receive buffer, as shown in </a><a href="#bookmark302" class="a">Figure</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark302" class="a">3.2</a>8<span class="p">. The application reads the stream of data from this buffer. Each side of the connection has</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="622" height="250" alt="image" src="计算机网络自顶向下7th-en/Image_302.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark302">Figure 3.28 TCP send and receive buffers</a></h2><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark303">its own send buffer and its own receive buffer. (You can see the online flow-control applet at</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="http://www.awl.com/kurose-ross" class="s123" target="_blank">http://www.awl.com/kurose-ross</a><a href="http://www.awl.com/kurose-ross" class="s124" target="_blank">,</a> which provides an animation of the send and receive buffers.)</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We see from this discussion that a TCP connection consists of buffers, variables, and a socket connection to a process in one host, and another set of buffers, variables, and a socket connection to a process in another host. As mentioned earlier, no buffers or variables are allocated to the connection in the network elements (routers, switches, and repeaters) between the hosts.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">TCP Segment Structure</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having taken a brief look at the TCP connection, let’s examine the TCP segment structure. The TCP segment consists of header fields and a data field. The data field contains a chunk of application data. As mentioned above, the MSS limits the maximum size of a segment’s data field. When TCP sends a large file, such as an image as part of a Web page, it typically breaks the file into chunks of size MSS (except for the last chunk, which will often be less than the MSS). Interactive applications, however, often transmit data chunks that are smaller than the MSS; for example, with remote login applications like Telnet, the data field in the TCP segment is often only one byte. Because the TCP header is typically 20 bytes (12 bytes more than the UDP header), segments sent by Telnet may be only 21 bytes in length.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 136%;text-align: left;"><a href="#bookmark305" class="a">Figure 3.29</a> <span class="p">shows the structure of the TCP segment. As with UDP, the header includes </span><span class="s23">source</span> and destination port numbers<span class="p">, which are used for multiplexing/demultiplexing data from/to upper-layer applications. Also, as with UDP, the header includes a </span>checksum field<span class="p">. A TCP segment header also</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">contains the following fields:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_303.png"/></span></p><p class="s49" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 128%;text-align: left;">The<span class="p"> 32-bit </span><span class="s20">sequence number field </span>and<span class="p"> the 32-bit </span><span class="s20">acknowledgment number field </span>are<span class="p"> used by the TCP sender and receiver in implementing a reliable data transfer service, as discussed below.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_304.png"/></span></p><p style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 126%;text-align: left;">The 16-bit <span class="s23">receive</span><span class="s20"> window </span>field is used for flow control. We will see shortly that it is used to indicate the number of bytes that a receiver is willing to accept.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_305.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 136%;text-align: left;">The 4-bit <span class="s23">header</span><span class="s20"> length field </span>specifies the length of the TCP header in 32-bit words. The TCP header can be of variable length due to the TCP options field. (Typically, the options field is empty, so that the length of the typical TCP header is 20 bytes.)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_306.png"/></span></p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 136%;text-align: left;">The optional and variable-length <span class="s23">options</span><span class="s20"> field </span>is used when a sender and receiver negotiate the maximum segment size (MSS) or as a window scaling factor for use in high-speed networks. A time- stamping option is also defined. See RFC 854 and RFC 1323 for additional details.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_307.png"/></span></p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 136%;text-align: left;"><a name="bookmark304">The </a><span class="s23">flag</span><span class="s20"> field </span>contains 6 bits. The <span class="s23">ACK</span><span class="s20"> bit </span>is used to indicate that the value carried in the acknowledgment field is valid; that is, the segment contains an acknowledgment for a segment that has been successfully received. The <span class="s20">RST</span>,</p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="583" height="469" alt="image" src="计算机网络自顶向下7th-en/Image_308.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark305">Figure 3.29 TCP segment structure</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 161%;text-align: left;">SYN<span class="p">, and </span>FIN <a href="#bookmark356" class="s124">bits are used for connection setup and teardown, as we will discuss at the end of this section. The CWR and ECE bits are used in explicit congestion notification, as discussed in </a><a href="#bookmark356" class="a">Section</a></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 12pt;text-align: left;"><a href="#bookmark356" class="a">3.7.</a>2<span class="p">. Setting the </span><span class="s23">PSH</span> <span class="p">bit indicates that the receiver should pass the data to the upper layer</span></p><p style="padding-top: 4pt;padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">immediately. Finally, the <span class="s20">URG </span>bit is used to indicate that there is data in this segment that the sending-side upper-layer entity has marked as “urgent.” The location of the last byte of this urgent data is indicated by the 16-bit <span class="s20">urgent data pointer field</span>. TCP must inform the receiving-side upper- layer entity when urgent data exists and pass it a pointer to the end of the urgent data. (In practice, the PSH, URG, and the urgent data pointer are not used. However, we mention these fields for completeness.)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">Our experience as teachers is that our students sometimes find discussion of packet formats rather dry and perhaps a bit boring. For a fun and fanciful look at TCP header fields, particularly if you love Legos™ as we do, see </a><a href="#bookmark848" class="a">[Pomeranz </a>2010]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Sequence Numbers and Acknowledgment Numbers</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Two of the most important fields in the TCP segment header are the sequence number field and the acknowledgment number field. These fields are a critical part of TCP’s reliable data transfer service. But before discussing how these fields are used to provide reliable data transfer, let us first explain what exactly TCP puts in these fields.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="674" height="177" alt="image" src="计算机网络自顶向下7th-en/Image_309.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark306">Figure 3.30 Dividing file data into TCP segments</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">TCP views data as an unstructured, but ordered, stream of bytes. TCP’s use of sequence numbers reflects this view in that sequence numbers are over the stream of transmitted bytes and <i>not </i>over the</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">series of transmitted segments. The <span class="s20">sequence number for a segment </span>is therefore the byte-stream number of the first byte in the segment. Let’s look at an example. Suppose that a process in Host A wants to send a stream of data to a process in Host B over a TCP connection. The TCP in Host A will implicitly number each byte in the data stream. Suppose that the data stream consists of a file consisting of 500,000 bytes, that the MSS is 1,000 bytes, and that the first byte of the data stream is numbered 0.</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark306" class="s124">As shown in </a><a href="#bookmark306" class="a">Figure 3.3</a>0<span class="p">, TCP constructs 500 segments out of the data stream. The first segment gets assigned sequence number 0, the second segment gets assigned sequence number 1,000, the third segment gets assigned sequence number 2,000, and so on. Each sequence number is inserted in the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">sequence number field in the header of the appropriate TCP segment.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now let’s consider acknowledgment numbers. These are a little trickier than sequence numbers. Recall that TCP is full-duplex, so that Host A may be receiving data from Host B while it sends data to Host B (as part of the same TCP connection). Each of the segments that arrive from Host B has a sequence</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">number for the data flowing from B to A. <i>The acknowledgment number that Host A puts in its segment is the sequence number of the next byte Host A is expecting from Host B. </i>It is good to look at a few examples to understand what is going on here. Suppose that Host A has received all bytes numbered 0</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">through 535 from B and suppose that it is about to send a segment to Host B. Host A is waiting for byte 536 and all the subsequent bytes in Host B’s data stream. So Host A puts 536 in the acknowledgment number field of the segment it sends to B.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">As another example, suppose that Host A has received one segment from Host B containing bytes 0 through 535 and another segment containing bytes 900 through 1,000. For some reason Host A has not yet received bytes 536 through 899. In this example, Host A is still waiting for byte 536 (and beyond) in order to re-create B’s data stream. Thus, A’s next segment to B will contain 536 in the acknowledgment number field. Because TCP only acknowledges bytes up to the first missing byte in the stream, TCP is said to provide <span class="s20">cumulative acknowledgments</span>.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark307">This last example also brings up an important but subtle issue. Host A received the third segment (bytes 900 through 1,000) before receiving the second segment (bytes 536 through 899). Thus, the third segment arrived out of order. The subtle issue is: What does a host do when it receives out-of-order segments in a TCP connection? Interestingly, the TCP RFCs do not impose any rules here and leave the decision up to the programmers implementing a TCP implementation. There are basically two choices: either (1) the receiver immediately discards out-of-order segments (which, as we discussed earlier, can simplify receiver design), or (2) the receiver keeps the out-of-order bytes and waits for the missing bytes to fill in the gaps. Clearly, the latter choice is more efficient in terms of network bandwidth, and is the approach taken in practice.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark306" class="s124">In </a><a href="#bookmark306" class="a">Figure 3.3</a>0<span class="p">, we assumed that the initial sequence number was zero. In truth, both sides of a TCP connection randomly choose an initial sequence number. This is done to minimize the possibility that a segment that is still present in the network from an earlier, already-terminated connection between two</span></p><p class="s20" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">hosts is mistaken for a valid segment in a later connection between these same two hosts (which also happen to be using the same port numbers as the old connection) </a><a href="#bookmark848" class="a">[Sunshine 1978</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Telnet: A Case Study for Sequence and Acknowledgment Numbers</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark138" class="s124">Telnet, defined in RFC 854, is a popular application-layer protocol used for remote login. It runs over TCP and is designed to work between any pair of hosts. Unlike the bulk data transfer applications discussed in </a><a href="#bookmark138" class="a">Chapter </a>2<span class="p">, Telnet is an interactive application. We discuss a Telnet example here, as it</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">nicely illustrates TCP sequence and acknowledgment numbers. We note that many users now prefer to</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark744" class="s124">use the SSH protocol rather than Telnet, since data sent in a Telnet connection (including passwords!) are not encrypted, making Telnet vulnerable to eavesdropping attacks (as discussed in </a><a href="#bookmark744" class="a">Section 8.</a>7<span class="p">).</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Suppose Host A initiates a Telnet session with Host B. Because Host A initiates the session, it is labeled the client, and Host B is labeled the server. Each character typed by the user (at the client) will be sent to the remote host; the remote host will send back a copy of each character, which will be displayed on the Telnet user’s screen. This “echo back” is used to ensure that characters seen by the Telnet user have already been received and processed at the remote site. Each character thus traverses the network twice between the time the user hits the key and the time the character is displayed on the user’s monitor.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark308" class="s124">Now suppose the user types a single letter, ‘C,’ and then grabs a coffee. Let’s examine the TCP segments that are sent between the client and server. As shown in </a><a href="#bookmark308" class="a">Figure 3.3</a>1<span class="p">, we suppose the starting</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">sequence numbers are 42 and 79 for the client and server, respectively. Recall that the sequence number of a segment is the sequence number of the first byte in the data field. Thus, the first segment sent from the client will have sequence number 42; the first segment sent from the server will have sequence number 79. Recall that the acknowledgment number is the sequence</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="544" height="514" alt="image" src="计算机网络自顶向下7th-en/Image_310.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark308">Figure 3.31 Sequence and acknowledgment numbers for a simple Telnet application over TCP</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">number of the next byte of data that the host is waiting for. After the TCP connection is established but before any data is sent, the client is waiting for byte 79 and the server is waiting for byte 42.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark308" class="s124">As shown in </a><a href="#bookmark308" class="a">Figure 3.3</a>1<span class="p">, three segments are sent. The first segment is sent from the client to the server, containing the 1-byte ASCII representation of the letter ‘C’ in its data field. This first segment also has 42 in its sequence number field, as we just described. Also, because the client has not yet received</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">any data from the server, this first segment will have 79 in its acknowledgment number field.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The second segment is sent from the server to the client. It serves a dual purpose. First it provides an acknowledgment of the data the server has received. By putting 43 in the acknowledgment field, the server is telling the client that it has successfully received everything up through byte 42 and is now waiting for bytes 43 onward. The second purpose of this segment is to echo back the letter ‘C.’ Thus, the second segment has the ASCII representation of ‘C’ in its data field. This second segment has the sequence number 79, the initial sequence number of the server-to-client data flow of this TCP connection, as this is the very first byte of data that the server is sending. Note that the acknowledgment for client-to-server data is carried in a segment carrying server-to-client data; this acknowledgment is said to be <span class="s20">piggybacked </span>on the server-to-client data segment.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark309">The third segment is sent from the client to the server. Its sole purpose is to acknowledge the data it has received from the server. (Recall that the second segment contained data—the letter ‘C’—from the server to the client.) This segment has an empty data field (that is, the acknowledgment is not being piggybacked with any client-to-server data). The segment has 80 in the acknowledgment number field because the client has received the stream of bytes up through byte sequence number 79 and it is now waiting for bytes 80 onward. You might think it odd that this segment also has a sequence number since the segment contains no data. But because TCP has a sequence number field, the segment needs to have some sequence number.</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Round-Trip Time Estimation and Timeout</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s37" style="padding-left: 6pt;text-indent: 0pt;line-height: 124%;text-align: left;">TCP,<span class="p"> like our </span><span class="s45">rdt </span>protocol<a href="#bookmark298" class="s124"> in </a><a href="#bookmark298" class="a">Section 3.</a><span class="s20">4</span><span class="p">, uses a timeout/retransmit mechanism to recover from lost segments. Although this is conceptually simple, many subtle issues arise when we implement a</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">timeout/retransmit mechanism in an actual protocol such as TCP. Perhaps the most obvious question is the length of the timeout intervals. Clearly, the timeout should be larger than the connection’s round-trip time (RTT), that is, the time from when a segment is sent until it is acknowledged. Otherwise, unnecessary retransmissions would be sent. But how much larger? How should the RTT be estimated in the first place? Should a timer be associated with each and every unacknowledged segment? So many</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">questions! Our discussion in this section is based on the TCP work in </a><a href="#bookmark848" class="a">[Jacobson 1988]</a> <a href="#bookmark848" class="s124">and the current IETF recommendations for managing TCP timers </a><a href="#bookmark848" class="a">[RFC </a>6298]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Estimating the Round-Trip Time</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 24pt;text-align: left;">Let’s begin our study of TCP timer management by considering how TCP estimates the round-trip time between sender and receiver. This is accomplished as follows. The sample RTT, denoted  <span class="s30">SampleRTT </span>,</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">for a segment is the amount of time between when the segment is sent (that is, passed to IP) and when an acknowledgment for the segment is received. Instead of measuring a <span class="s30">SampleRTT </span>for every transmitted segment, most TCP implementations take only one  <span class="s30">SampleRTT </span>measurement at a time.</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 14pt;text-align: left;">That is, at any point in time, the <span class="s30">SampleRTT </span>is being estimated for only one of the transmitted but</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">currently unacknowledged segments, leading to a new value of  <span class="s30">SampleRTT </span>approximately once every RTT. Also, TCP never computes a <span class="s30">SampleRTT </span>for a segment that has been retransmitted; it only measures <span class="s30">SampleRTT </span><a href="#bookmark848" class="s124">for segments that have been transmitted once </a><a href="#bookmark848" class="a">[Karn </a><span class="s20">1987]</span>. (A problem at the end of the chapter asks you to consider why.)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Obviously, the <span class="s30">SampleRTT </span>values will fluctuate from segment to segment due to congestion in the routers and to the varying load on the end systems. Because of this fluctuation, any given <span class="s30">SampleRTT </span>value may be atypical. In order to estimate a typical RTT, it is therefore natural to take some sort of</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">average of the <span class="s30">SampleRTT </span>values. TCP maintains an average, called <span class="s30">EstimatedRTT </span>, of the</p><p class="s30" style="padding-top: 3pt;padding-left: 5pt;text-indent: 2pt;line-height: 130%;text-align: left;">SampleRTT <span class="p">values. Upon obtaining a new  </span>SampleRTT <span class="p">, TCP updates </span>EstimatedRTT <span class="p">according to the following formula:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-top: 2pt;padding-left: 31pt;text-indent: 0pt;text-align: left;">EstimatedRTT=(1−α)<span class="s125">⋅</span>EstimatedRTT+α<span class="s125">⋅</span>SampleRTT</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_311.png"/></span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">The formula above is written in the form of a programming-language statement—the new value of <b>EstimatedRTT </b>is a weighted combination of the previous value of <b>EstimatedRTT </b>and the new value for <b>SampleRTT</b><a href="#bookmark848" class="s124">. The recommended value of α is α = 0.125 (that is, 1/8) </a><a href="#bookmark848" class="a">[RFC </a><span class="s20">6298]</span>, in which case the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">formula above becomes:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-top: 2pt;padding-left: 31pt;text-indent: 0pt;text-align: left;">EstimatedRTT=0.875<span class="s125">⋅</span>EstimatedRTT+0.125<span class="s125">⋅</span>SampleRTT</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_312.png"/></span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Note that <b>EstimatedRTT </b>is a weighted average of the <b>SampleRTT </b>values. As discussed in a homework problem at the end of this chapter, this weighted average puts more weight on recent samples than on old samples. This is natural, as the more recent samples better reflect the current congestion in the</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">network. In statistics, such an average is called an <span class="s20">exponential weighted moving average (EWMA)</span>.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">The word “exponential” appears in EWMA because the weight of a given <span class="s30">SampleRTT </span>decays exponentially fast as the updates proceed. In the homework problems you will be asked to derive the</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">exponential term in  <span class="s30">EstimatedRTT </span>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;"><a href="#bookmark311" class="a">Figure 3.32</a><span class="s20"> </span>shows the <span class="s30">SampleRTT </span>values and <span class="s30">EstimatedRTT </span>for a value of α = 1/8 for a TCP connection between  <span class="s30">gaia.cs.umass.edu </span>(in Amherst, Massachusetts) to  <span class="s30">fantasia.eurecom.fr </span>(in the south of France). Clearly, the variations in the <span class="s30">SampleRTT </span>are smoothed out in the computation of the <span class="s30">EstimatedRTT </span>.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_313.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">In addition to having an estimate of the RTT, it is also valuable to have a measure of the variability of the RTT. </a><a href="#bookmark848" class="a">[RFC 6298]</a><span class="s20"> </span>defines the RTT variation, <span class="s30">DevRTT </span>, as an estimate of how much <span class="s30">SampleRTT </span>typically deviates from  <span class="s30">EstimatedRTT </span>:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-top: 2pt;padding-left: 31pt;text-indent: 0pt;text-align: left;">DevRTT=(1−β)<span class="s125">⋅</span>DevRTT+β<span class="s125">⋅</span>|SampleRTT−EstimatedRTT|</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">Note that <span class="s30">DevRTT </span>is an EWMA of the difference between <span class="s30">SampleRTT </span>and <span class="s30">EstimatedRTT </span>. If the <span class="s30">SampleRTT </span>values have little fluctuation, then <span class="s30">DevRTT </span>will be small; on the other hand, if there is a lot of fluctuation, <span class="s30">DevRTT </span>will be large. The recommended value of β is 0.25.</p><p class="s24" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Setting and Managing the Retransmission Timeout Interval</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">Given values of <span class="s30">EstimatedRTT </span>and <span class="s30">DevRTT </span>, what value should be used for TCP’s timeout interval? Clearly, the interval should be greater than or equal to</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="586" alt="image" src="计算机网络自顶向下7th-en/Image_314.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">PRINCIPLES IN PRACTICE</p><p style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">TCP provides reliable data transfer by using positive acknowledgments and timers in much the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark298" class="s124">same way that we studied in </a><a href="#bookmark298" class="a">Section 3.</a>4<span class="p">. TCP acknowledges data that has been received correctly, and it then retransmits segments when segments or their corresponding acknowledgments are thought to be lost or corrupted. Certain versions of TCP also have an</span></p><p style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">implicit NAK mechanism—with TCP’s fast retransmit mechanism, the receipt of three duplicate ACKs for a given segment serves as an implicit NAK for the following segment, triggering retransmission of that segment before timeout. TCP uses sequences of numbers to allow the receiver to identify lost or duplicate segments. Just as in the case of our reliable data transfer</p><p class="s37" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 124%;text-align: left;">protocol,<span class="p"> </span><span class="s45">rdt3.0 </span>,<span class="p"> TCP cannot itself tell for certain if a segment, or its ACK, is lost, corrupted, or overly delayed. At the sender, TCP’s response will be the same: retransmit the segment in</span></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">question.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">TCP also uses pipelining, allowing the sender to have multiple transmitted but yet-to-be- acknowledged segments outstanding at any given time. We saw earlier that pipelining can greatly improve a session’s throughput when the ratio of the segment size to round-trip delay is small. The specific number of outstanding, unacknowledged segments that a sender can have is determined by TCP’s flow-control and congestion-control mechanisms. TCP flow control is</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark355" class="s124">discussed at the end of this section; TCP congestion control is discussed in </a><a href="#bookmark355" class="a">Section 3.</a>7<span class="p">. For the time being, we must simply be aware that the TCP sender uses pipelining.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 6pt;text-indent: 2pt;line-height: 138%;text-align: left;">EstimatedRTT <span class="p">, or unnecessary retransmissions would be sent. But the timeout interval should not be too much larger than </span>EstimatedRTT <span class="p">; otherwise, when a segment is lost, TCP would not quickly retransmit the segment, leading to large data transfer delays. It is therefore desirable to set the timeout</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_315.png"/></span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 140%;text-align: left;">equal to the <span class="s30">EstimatedRTT </span>plus some margin. The margin should be large when there is a lot of fluctuation in the <span class="s30">SampleRTT </span>values; it should be small when there is little fluctuation. The value of <span class="s30">DevRTT </span>should thus come into play here. All of these considerations are taken into account in TCP’s method for determining the retransmission timeout interval:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-top: 2pt;padding-left: 32pt;text-indent: 0pt;text-align: left;">TimeoutInterval=EstimatedRTT+4<span class="s125">⋅</span>DevRTT</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;">An initial <span class="s30">TimeoutInterval </span><a href="#bookmark848" class="s124">value of 1 second is recommended </a><a href="#bookmark848" class="a">[RFC </a><span class="s20">6298]</span>. Also, when a timeout occurs, the value of <span class="s30">TimeoutInterval </span>is doubled to avoid a premature timeout occurring for a</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark310">subsequent segment that will soon be acknowledged. However, as soon as a segment is received and</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">EstimatedRTT <span class="p">is updated, the  </span>TimeoutInterval <span class="p">is again computed using the formula above.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="787" height="466" alt="image" src="计算机网络自顶向下7th-en/Image_316.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark311">Figure 3.32 RTT samples and RTT estimates</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Reliable Data Transfer</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Recall that the Internet’s network-layer service (IP service) is unreliable. IP does not guarantee datagram delivery, does not guarantee in-order delivery of datagrams, and does not guarantee the integrity of the data in the datagrams. With IP service, datagrams can overflow router buffers and never reach their destination, datagrams can arrive out of order, and bits in the datagram can get corrupted (flipped from 0 to 1 and vice versa). Because transport-layer segments are carried across the network by IP datagrams, transport-layer segments can suffer from these problems as well.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">TCP creates a <span class="s20">reliable data transfer service </span>on top of IP’s unreliable best-effort service. TCP’s reliable data transfer service ensures that the data stream that a process reads out of its TCP receive buffer is uncorrupted, without gaps, without duplication, and in sequence; that is, the byte stream is exactly the same byte stream that was sent by the end system on the other side of the connection. How TCP</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark298" class="s124">provides a reliable data transfer involves many of the principles that we studied in </a><a href="#bookmark298" class="a">Section 3.</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">In our earlier development of reliable data transfer techniques, it was conceptually easiest to assume</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">that an individual timer is associated with each transmitted but not yet acknowledged segment. While this is great in theory, timer management can require considerable overhead. Thus, the recommended TCP timer management procedures </a><a href="#bookmark848" class="a">[RFC 6298]</a><span class="s20"> </span>use only a <i>single </i>retransmission timer, even if there</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">are multiple transmitted but not yet acknowledged segments. The TCP protocol described in this section</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">follows this single-timer recommendation.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We will discuss how TCP provides reliable data transfer in two incremental steps. We first present a highly simplified description of a TCP sender that uses only timeouts to recover from lost segments; we then present a more complete description that uses duplicate acknowledgments in addition to timeouts. In the ensuing discussion, we suppose that data is being sent in only one direction, from Host A to Host B, and that Host A is sending a large file.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark312" class="a">Figure 3.33</a> <span class="p">presents a highly simplified description of a TCP sender. We see that there are three major events related to data transmission and retransmission in the TCP sender: data received from application above; timer timeout; and ACK</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="784" height="610" alt="image" src="计算机网络自顶向下7th-en/Image_317.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark312">Figure 3.33 Simplified TCP sender</a></h2><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">receipt. Upon the occurrence of the first major event, TCP receives data from the application, encapsulates the data in a segment, and passes the segment to IP. Note that each segment includes a sequence number that is the byte-stream number of the first data byte in the segment, as described in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark309" class="a">Section 3.5.</a>2<span class="p">. Also note that if the timer is already not running for some other segment, TCP starts the timer when the segment is passed to IP. (It is helpful to think of the timer as being associated with the</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">oldest unacknowledged segment.) The expiration interval for this timer is the  <span class="s30">TimeoutInterval </span>, which is calculated from <span class="s30">EstimatedRTT </span>and <span class="s30">DevRTT </span><a href="#bookmark310" class="s124">, as described in </a><a href="#bookmark310" class="a">Section 3.5.</a><span class="s20">3</span>.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The second major event is the timeout. TCP responds to the timeout event by retransmitting the segment that caused the timeout. TCP then restarts the timer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">The third major event that must be handled by the TCP sender is the arrival of an acknowledgment segment (ACK) from the receiver (more specifically, a segment containing a valid ACK field value). On <span class="s37">the</span> occurrence of this event, TCP compares the ACK value <span class="s45">y </span><span class="s37">with</span> its variable <span class="s30">SendBase </span>. The TCP</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">state variable <span class="s30">SendBase </span>is the sequence number of the oldest unacknowledged byte. (Thus</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 2pt;line-height: 137%;text-align: left;"><span class="s30">SendBase–1 </span>is the sequence number of the last byte that is known to have been received correctly <span class="s37">and</span> in order at the receiver.) As indicated earlier, TCP uses cumulative acknowledgments, so that <span class="s45">y </span>acknowledges the receipt of all bytes before byte number <span class="s30">y </span>. If <span class="s30">y &gt; SendBase </span>, then the ACK is acknowledging one or more previously unacknowledged segments. Thus the sender updates its</p><p class="s30" style="padding-top: 3pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">SendBase <span class="p">variable; it also restarts the timer if there currently are any not-yet-acknowledged segments.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">A Few Interesting Scenarios</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark313" class="s124">We have just described a highly simplified version of how TCP provides reliable data transfer. But even this highly simplified version has many subtleties. To get a good feeling for how this protocol works, let’s now walk through a few simple scenarios. </a><a href="#bookmark313" class="a">Figure 3.34</a> <span class="p">depicts the first scenario, in which Host A sends</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">one segment to Host B. Suppose that this segment has sequence number 92 and contains 8 bytes of</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">data. After sending this segment, Host A waits for a segment from B with acknowledgment number 100. Although the segment from A is received at B, the acknowledgment from B to A gets lost. In this case, the timeout event occurs, and Host A retransmits the same segment. Of course, when Host B receives the retransmission, it observes from the sequence number that the segment contains data that has already been received. Thus, TCP in Host B will discard the bytes in the retransmitted segment.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark315" class="s124">In a second scenario, shown in </a><a href="#bookmark315" class="a">Figure 3.3</a>5<span class="p">, Host A sends two segments back to back. The first segment has sequence number 92 and 8 bytes of data, and the second segment has sequence number 100 and 20 bytes of data. Suppose that both segments arrive intact at B, and B sends two separate</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">acknowledgments for each of these segments. The first of these acknowledgments has acknowledgment number 100; the second has acknowledgment number 120. Suppose now that neither of the acknowledgments arrives at Host A before the timeout. When the timeout event occurs, Host</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="450" height="514" alt="image" src="计算机网络自顶向下7th-en/Image_318.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark313">Figure 3.34 Retransmission due to a lost acknowledgment</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A resends the first segment with sequence number 92 and restarts the timer. As long as the ACK for the second segment arrives before the new timeout, the second segment will not be retransmitted.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In a third and final scenario, suppose Host A sends the two segments, exactly as in the second example. The acknowledgment of the first segment is lost in the network, but just before the timeout event, Host A receives an acknowledgment with acknowledgment number 120. Host A therefore knows</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">that Host B has received <i>everything </i><a href="#bookmark317" class="s124">up through byte 119; so Host A does not resend either of the two segments. This scenario is illustrated in </a><a href="#bookmark317" class="a">Figure 3.3</a><span class="s20">6</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Doubling the Timeout Interval</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark314">We now discuss a few modifications that most TCP implementations employ. The first concerns the length of the timeout interval after a timer expiration. In this modification, whenever the timeout event occurs, TCP retransmits the not-yet-acknowledged segment with the smallest sequence number, as described above. But each time TCP retransmits, it sets the next timeout interval to twice the previous value,</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="609" height="550" alt="image" src="计算机网络自顶向下7th-en/Image_319.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark315">Figure 3.35 Segment 100 not retransmitted</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">rather than deriving it from the last <span class="s30">EstimatedRTT </span>and <span class="s30">DevRTT </span><a href="#bookmark310" class="s124">(as described in </a><a href="#bookmark310" class="a">Section 3.5.</a><span class="s20">3</span>). For example, suppose  <span class="s30">TimeoutInterval </span>associated with the oldest not yet acknowledged segment is</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">.75 sec when the timer first expires. TCP will then retransmit this segment and set the new expiration</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">time to 1.5 sec. If the timer expires again 1.5 sec later, TCP will again retransmit this segment, now setting the expiration time to 3.0 sec. Thus the intervals grow exponentially after each retransmission. However, whenever the timer is started after either of the two other events (that is, data received from</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">application above, and ACK received), the  <span class="s30">TimeoutInterval </span>is derived from the most recent values of <span class="s30">EstimatedRTT </span>and <span class="s30">DevRTT </span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark355" class="s124">This modification provides a limited form of congestion control. (More comprehensive forms of TCP congestion control will be studied in </a><a href="#bookmark355" class="a">Section 3.</a>7<span class="p">.) The timer expiration is most likely caused by</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark316">congestion in the network, that is, too many packets arriving at one (or more) router queues in the path between the source and destination, causing packets to be dropped and/or long queuing delays. In times of congestion, if the sources continue to retransmit packets persistently, the congestion</a></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="611" height="550" alt="image" src="计算机网络自顶向下7th-en/Image_320.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark317">Figure 3.36 A cumulative acknowledgment avoids retransmission of the first segment</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark513" class="s124">may get worse. Instead, TCP acts more politely, with each sender retransmitting after longer and longer intervals. We will see that a similar idea is used by Ethernet when we study CSMA/CD in </a><a href="#bookmark513" class="a">Chapter </a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Fast Retransmit</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">One of the problems with timeout-triggered retransmissions is that the timeout period can be relatively long. When a segment is lost, this long timeout period forces the sender to delay resending the lost packet, thereby increasing the end-to-end delay. Fortunately, the sender can often detect packet loss well before the timeout event occurs by noting so-called duplicate ACKs. A <span class="s20">duplicate ACK </span>is an ACK that reacknowledges a segment for which the sender has already received an earlier acknowledgment. To understand the sender’s response to a duplicate ACK, we must look at why the receiver sends a</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark318" class="s124">duplicate ACK in the first place. </a><a href="#bookmark318" class="a">Table 3.2</a> <a href="#bookmark848" class="s124">summarizes the TCP receiver’s ACK generation policy </a><a href="#bookmark848" class="a">[RFC </a>5681]<span class="p">. When a TCP receiver receives</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="787" height="61" alt="image" src="计算机网络自顶向下7th-en/Image_321.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" style=" color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt;">Table 3.2 TCP ACK Generation Recommendation </a><a href="#bookmark848" class="a">[RFC 5681]</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s126" style="padding-left: 15pt;text-indent: 0pt;text-align: left;">Event                                                                      TCP Receiver Action</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark318">Arrival of in-order segment with expected sequence number. All data up to expected sequence number already acknowledged.</a></p></td><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 18pt;text-indent: 0pt;line-height: 146%;text-align: left;">Delayed ACK. Wait up to 500 msec for arrival of another in-order segment. If next in-order segment does not arrive in this interval, send an ACK.</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 32pt;text-indent: 0pt;line-height: 146%;text-align: left;">Arrival of in-order segment with expected sequence number. One other in-order segment waiting for ACK transmission.</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 7pt;text-indent: 0pt;line-height: 146%;text-align: left;">One Immediately send single cumulative ACK, ACKing both in-order segments.</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 22pt;text-indent: 0pt;line-height: 146%;text-align: left;">Arrival of out-of-order segment with higher- than-expected sequence number. Gap detected.</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 7pt;text-indent: 0pt;line-height: 146%;text-align: left;">Immediately send duplicate ACK, indicating sequence number of next expected byte (which is the lower end of the gap).</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 10pt;text-indent: 0pt;line-height: 146%;text-align: left;">Arrival of segment that partially or completely fills in gap in received data.</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 40pt;text-indent: 0pt;line-height: 146%;text-align: left;">Immediately send ACK, provided that segment starts at the lower end of gap.</p></td></tr></table><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">a segment with a sequence number that is larger than the next, expected, in-order sequence number, it detects a gap in the data stream—that is, a missing segment. This gap could be the result of lost or reordered segments within the network. Since TCP does not use negative acknowledgments, the receiver cannot send an explicit negative acknowledgment back to the sender. Instead, it simply reacknowledges (that is, generates a duplicate ACK for) the last in-order byte of data it has received.</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark318" class="s124">(Note that </a><a href="#bookmark318" class="a">Table 3.2</a> <span class="p">allows for the case that the receiver does not discard out-of-order segments.)</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">Because a sender often sends a large number of segments back to back, if one segment is lost, there will likely be many back-to-back duplicate ACKs. If the TCP sender receives three duplicate ACKs for the same data, it takes this as an indication that the segment following the segment that has been ACKed three times has been lost. (In the homework problems, we consider the question of why the sender waits for three duplicate ACKs, rather than just a single duplicate ACK.) In the case that three duplicate ACKs are received, the TCP sender performs a <span class="s23">fast</span><a href="#bookmark848" class="a"> retransmit [RFC 5681</a><span class="s20">]</span>, retransmitting the missing segment <i>before </i><a href="#bookmark319" class="s124">that segment’s timer expires. This is shown in </a><a href="#bookmark319" class="a">Figure 3.3</a><span class="s20">7</span>, where the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">second segment is lost, then retransmitted before its timer expires. For TCP with fast retransmit, the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="197" alt="image" src="计算机网络自顶向下7th-en/Image_322.png"/></span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark312" class="s124">following code snippet replaces the ACK received event in </a><a href="#bookmark312" class="a">Figure 3.3</a>3<span class="p">:</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 122pt;text-indent: -90pt;line-height: 148%;text-align: left;">event: ACK received, with ACK field value of y if (y &gt; SendBase) {</p><p class="s30" style="padding-left: 122pt;text-indent: 0pt;text-align: left;">SendBase=y</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 122pt;text-indent: 0pt;text-align: left;">if (there are currently any not yet</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 145pt;text-indent: 61pt;line-height: 148%;text-align: left;">acknowledged segments) start timer</p><p class="s30" style="padding-top: 4pt;padding-left: 144pt;text-indent: 0pt;text-align: left;">}</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="478" height="587" alt="image" src="计算机网络自顶向下7th-en/Image_323.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="51" alt="image" src="计算机网络自顶向下7th-en/Image_324.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="346" alt="image" src="计算机网络自顶向下7th-en/Image_325.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark319">Figure 3.37 Fast retransmit: retransmitting the missing segment before the segment’s timer expires</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 175pt;text-indent: -53pt;line-height: 148%;text-align: left;">else {/* a duplicate ACK for already ACKed segment */</p><p class="s30" style="padding-left: 175pt;text-indent: -30pt;line-height: 148%;text-align: left;">increment number of duplicate ACKs received for y</p><p class="s30" style="padding-left: 175pt;text-indent: -30pt;line-height: 148%;text-align: left;">if (number of duplicate ACKS received for y==3)</p><p class="s30" style="padding-left: 175pt;text-indent: 0pt;text-align: left;">/* TCP fast retransmit */</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 175pt;text-indent: 0pt;text-align: left;">resend segment with sequence number y</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 144pt;text-indent: 0pt;text-align: left;">}</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 113pt;text-indent: 0pt;text-align: left;">break;</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="778" height="14" alt="image" src="计算机网络自顶向下7th-en/Image_326.png"/></span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;"><a name="bookmark320">We noted earlier that many subtle issues arise when a timeout/retransmit mechanism is implemented in an actual protocol such as TCP. The procedures above, which have evolved as a result of more than 20 years of experience with TCP timers, should convince you that this is indeed the case!</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark321">Go-Back-N or Selective Repeat?</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark312" class="s124">Let us close our study of TCP’s error-recovery mechanism by considering the following question: Is TCP a GBN or an SR protocol? Recall that TCP acknowledgments are cumulative and correctly received but out-of-order segments are not individually ACKed by the receiver. Consequently, as shown in </a><a href="#bookmark312" class="a">Figure</a></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark312" class="a">3.33</a> <a href="#bookmark287" class="s124">(see also </a><a href="#bookmark287" class="a">Figure 3.1</a>9<span class="p">), the TCP sender need only maintain the smallest sequence number of a</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">transmitted but unacknowledged byte ( <span class="s30">SendBase </span>) and the sequence number of the next byte to be sent ( <span class="s30">NextSeqNum </span>). In this sense, TCP looks a lot like a GBN-style protocol. But there are some striking differences between TCP and Go-Back-N. Many TCP implementations will buffer correctly</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">received but out-of-order segments </a><a href="#bookmark848" class="a">[Stevens </a><span class="s20">1994]</span>. Consider also what happens when the sender sends a sequence of segments 1, 2, . . ., <i>N</i>, and all of the segments arrive in order without error at the receiver. Further suppose that the acknowledgment for packet n&lt;N gets lost, but the remaining N−1</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 137%;text-align: left;">acknowledgments arrive at the sender before their respective timeouts. In this example, GBN would retransmit not only packet <i>n, </i>but also all of the subsequent packets <span class="s27">n</span>+1,n+2,…,N. TCP, on the other hand, would retransmit at most one segment, namely, segment <i>n</i>. Moreover, TCP would not even retransmit segment <i>n </i>if the acknowledgment for segment <span class="s27">n</span>+1 arrived before the timeout for segment <i>n</i>.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 136%;text-align: justify;">A proposed modification to TCP, the so-called <span class="s23">selective</span><a href="#bookmark848" class="a"> acknowledgment [RFC 2018</a><span class="s20">]</span>, allows a TCP receiver to acknowledge out-of-order segments selectively rather than just cumulatively acknowledging the last correctly received, in-order segment. When combined with selective retransmission—skipping</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the retransmission of segments that have already been selectively acknowledged by the receiver—TCP looks a lot like our generic SR protocol. Thus, TCP’s error-recovery mechanism is probably best categorized as a hybrid of GBN and SR protocols.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l155"><ol id="l156"><ol id="l157"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Flow Control</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Recall that the hosts on each side of a TCP connection set aside a receive buffer for the connection. When the TCP connection receives bytes that are correct and in sequence, it places the data in the receive buffer. The associated application process will read data from this buffer, but not necessarily at the instant the data arrives. Indeed, the receiving application may be busy with some other task and may not even attempt to read the data until long after it has arrived. If the application is relatively slow at reading the data, the sender can very easily overflow the connection’s receive buffer by sending too much data too quickly.</p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">TCP provides a </span>flow-control service <span class="p">to its applications to eliminate the possibility of the sender overflowing the receiver’s buffer. Flow control is thus a speed-matching service—matching the rate at which the sender is sending against the rate at which the receiving application is reading. As noted earlier, a TCP sender can also be throttled due to congestion within the IP network; this form of sender control is referred to as </span><span class="s23">congestion</span> control<a href="#bookmark341" class="s124">, a topic we will explore in detail in </a><a href="#bookmark341" class="a">Sections 3.6</a> <a href="#bookmark355" class="s124">and </a><a href="#bookmark355" class="a">3.</a>7<span class="p">.</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Even though the actions taken by flow and congestion control are similar (the throttling of the sender),</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">they are obviously taken for very different reasons. Unfortunately, many authors use the terms interchangeably, and the savvy reader would be wise to distinguish between them. Let’s now discuss how TCP provides its flow-control service. In order to see the forest for the trees, we suppose throughout this section that the TCP implementation is such that the TCP receiver discards out-of-order segments.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 136%;text-align: left;">TCP provides flow control by having the <i>sender </i>maintain a variable called the <span class="s23">receive</span><span class="s20"> window</span>. Informally, the receive window is used to give the sender an idea of how much free buffer space is available at the receiver. Because TCP is full-duplex, the sender at each side of the connection</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;">maintains a distinct receive window. Let’s investigate the receive window in the context of a file transfer. Suppose that Host A is sending a large file to Host B over a TCP connection. Host B allocates a receive buffer to this connection; denote its size by <span class="s30">RcvBuffer </span>. From time to time, the application process in</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Host B reads from the buffer. Define the following variables:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_327.png"/></span></p><p class="s30" style="padding-top: 3pt;padding-left: 27pt;text-indent: 2pt;line-height: 130%;text-align: left;">LastByteRead <span class="p">: the number of the last byte in the data stream read from the buffer by the application process in B</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_328.png"/></span></p><p class="s30" style="padding-top: 4pt;padding-left: 27pt;text-indent: 2pt;line-height: 130%;text-align: left;">LastByteRcvd <span class="p">: the number of the last byte in the data stream that has arrived from the network and has been placed in the receive buffer at B</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Because TCP is not permitted to overflow the allocated buffer, we must have</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-top: 3pt;padding-left: 32pt;text-indent: 0pt;text-align: left;">LastByteRcvd−LastByteRead≤RcvBuffer</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_329.png"/></span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">The receive window, denoted <span class="s30">rwnd </span>is set to the amount of spare room in the buffer:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-top: 3pt;padding-left: 32pt;text-indent: 0pt;text-align: left;">rwnd=RcvBuffer−[LastByteRcvd−LastByteRead]</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_330.png"/></span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Because the spare room changes with time, <span class="s30">rwnd </span>is dynamic. The variable <span class="s30">rwnd </span>is illustrated in</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark322" class="a">Figure 3.3</a>8<span class="p">.</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">How does the connection use the variable <span class="s30">rwnd </span>to provide the flow-control service? Host B tells Host A how much spare room it has in the connection buffer by placing its current value of <span class="s30">rwnd </span>in the receive window field of every segment it sends to A. Initially, Host B sets <span class="s30">rwnd = RcvBuffer </span>. Note that to pull this off, Host B must keep track of several connection-specific variables.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">Host A in turn keeps track of two variables, <span class="s30">LastByteSent </span>and <span class="s30">LastByteAcked </span>, which have obvious meanings. Note that the difference between these two variables,  <span class="s30">LastByteSent – LastByteAcked </span>, is the amount of unacknowledged data that A has sent into the connection. By keeping the amount of unacknowledged data less than the value of <span class="s30">rwnd </span>, Host A is assured that it is</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">not</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="527" height="268" alt="image" src="计算机网络自顶向下7th-en/Image_331.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s44" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark322">Figure</a><span class="h2"> 3.38 The receive window </span><span class="s45">(rwnd) </span>and<span class="h2"> the receive buffer </span><span class="s45">(RcvBuffer)</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">overflowing the receive buffer at Host B. Thus, Host A makes sure throughout the connection’s life that</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-top: 3pt;padding-left: 31pt;text-indent: 0pt;text-align: left;">LastByteSent−LastByteAcked≤rwnd</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_332.png"/></span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">There is one minor technical problem with this scheme. To see this, suppose Host B’s receive buffer</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">becomes full so that <span class="s30">rwnd </span>= 0. After advertising <span class="s30">rwnd </span>= 0 to Host A, also suppose that B has <i>nothing</i></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">to send to A. Now consider what happens. As the application process at B empties the buffer, TCP does</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">not send new segments with new <span class="s30">rwnd </span>values to Host A; indeed, TCP sends a segment to Host A only if it has data to send or if it has an acknowledgment to send. Therefore, Host A is never informed that some space has opened up in Host B’s receive buffer—Host A is blocked and can transmit no more</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">data! To solve this problem, the TCP specification requires Host A to continue to send segments with one data byte when B’s receive window is zero. These segments will be acknowledged by the receiver. Eventually the buffer will begin to empty and the acknowledgments will contain a nonzero <span class="s30">rwnd </span>value.</p><p class="s43" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="http://www.awl.com/kurose-ross" class="s124" target="_blank" name="bookmark323">The online site at </a><a href="http://www.awl.com/kurose-ross" class="s123" target="_blank">http://www.awl.com/kurose-ross</a> <span style=" color: #333;">for this book provides an interactive Java applet that illustrates the operation of the TCP receive window.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having described TCP’s flow-control service, we briefly mention here that UDP does not provide flow control and consequently, segments may be lost at the receiver due to buffer overflow. For example, consider sending a series of UDP segments from a process on Host A to a process on Host B. For a typical UDP implementation, UDP will append the segments in a finite-sized buffer that “precedes” the corresponding socket (that is, the door to the process). The process reads one entire segment at a time from the buffer. If the process does not read the segments fast enough from the buffer, the buffer will overflow and segments will get dropped.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">TCP Connection Management</p></li></ol></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this subsection we take a closer look at how a TCP connection is established and torn down. Although this topic may not seem particularly thrilling, it is important because TCP connection establishment can significantly add to perceived delays (for example, when surfing the Web). Furthermore, many of the most common network attacks—including the incredibly popular SYN flood attack—exploit vulnerabilities in TCP connection management. Let’s first take a look at how a TCP connection is established. Suppose a process running in one host (client) wants to initiate a connection with another process in another host (server). The client application process first informs the client TCP that it wants to establish a connection to a process in the server. The TCP in the client then proceeds to establish a TCP connection with the TCP in the server in the following manner:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_333.png"/></span></p><p class="s17" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Step 1. <span class="p">The client-side TCP first sends a special TCP segment to the server-side TCP. This special segment contains no application-layer data. But one of the flag bits in the segment’s header (see</span></p><p style="padding-top: 4pt;padding-left: 25pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark305" class="a">Figure 3.2</a><span class="s20">9</span>), the SYN bit, is set to 1. For this reason, this special segment is referred to as a SYN segment. In addition, the client randomly chooses an initial sequence number ( <span class="s30">client_isn </span>) and puts this number in the sequence number field of the initial TCP SYN segment. This segment is</p><p style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;line-height: 153%;text-align: left;">encapsulated within an IP datagram and sent to the server. There has been considerable interest in properly randomizing the choice of the <span class="s30">client_isn </span><a href="#bookmark848" class="s124">in order to avoid certain security attacks </a><a href="#bookmark848" class="a">[CERT </a><span class="s20">2001–09]</span>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_334.png"/></span></p><p class="s17" style="padding-left: 26pt;text-indent: 0pt;line-height: 14pt;text-align: left;">Step 2. <span class="p">Once the IP datagram containing the TCP SYN segment arrives at the server host</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark671" class="s124">(assuming it does arrive!), the server extracts the TCP SYN segment from the datagram, allocates the TCP buffers and variables to the connection, and sends a connection-granted segment to the client TCP. (We’ll see in </a><a href="#bookmark671" class="a">Chapter 8</a> <span class="p">that the allocation of these buffers and variables before</span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 11pt;text-align: left;">completing the third step of the three-way handshake makes TCP vulnerable to a denial-of-service</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">attack known as SYN flooding.) This connection-granted segment also contains no application-layer data. However, it does contain three important pieces of information in the segment header. First, the SYN bit is set to 1. Second, the acknowledgment field of the TCP segment header is set to</p><p class="s30" style="padding-top: 3pt;padding-left: 26pt;text-indent: 2pt;line-height: 138%;text-align: justify;">client_isn+1 <span class="p">. Finally, the server chooses its own initial sequence number ( </span>server_isn <span class="p">) and puts this value in the sequence number field of the TCP segment header. This connection-granted segment is saying, in effect, “I received your SYN packet to start a connection with your initial</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_335.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 137%;text-align: left;">sequence number,  <span class="s30">client_isn </span>. I agree to establish this connection. My own initial sequence number is  <span class="s30">server_isn </span>.” The connection-granted segment is referred to as a <span class="s23">SYNACK</span><span class="s20"> segment</span>. <i>Step 3. </i>Upon receiving the SYNACK segment, the client also allocates buffers and variables to the connection. The client host then sends the server yet another segment; this last segment acknowledges the server’s connection-granted segment (the client does so by putting the value</p><p class="s30" style="padding-top: 3pt;padding-left: 26pt;text-indent: 2pt;line-height: 138%;text-align: justify;">server_isn+1 <span class="p">in the acknowledgment field of the TCP segment header). The SYN bit is set to zero, since the connection is established. This third stage of the three-way handshake may carry client-to-server data in the segment payload.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark324" class="s124">Once these three steps have been completed, the client and server hosts can send segments containing data to each other. In each of these future segments, the SYN bit will be set to zero. Note that in order to establish the connection, three packets are sent between the two hosts, as illustrated in </a><a href="#bookmark324" class="a">Figure 3.3</a>9<span class="p">. For this reason, this connection-establishment procedure is often referred to as a </span><span class="s23">three-</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">way handshake<span class="p">. Several aspects of the TCP three-way handshake are explored in the homework</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">problems (Why are initial sequence numbers needed? Why is a three-way handshake, as opposed to a two-way handshake, needed?). It’s interesting to note that a rock climber and a belayer (who is stationed below the rock climber and whose job it is to handle the climber’s safety rope) use a three- way-handshake communication protocol that is identical to TCP’s to ensure that both sides are ready before the climber begins ascent.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">All good things must come to an end, and the same is true with a TCP connection. Either of the two processes participating in a TCP connection can end the connection. When a connection ends, the “resources” (that is, the buffers and variables)</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="546" height="489" alt="image" src="计算机网络自顶向下7th-en/Image_336.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark324">Figure 3.39 TCP three-way handshake: segment exchange</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="484" height="537" alt="image" src="计算机网络自顶向下7th-en/Image_337.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark325">Figure 3.40 Closing a TCP connection</a><a name="bookmark326">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark325" class="s124">in the hosts are deallocated. As an example, suppose the client decides to close the connection, as shown in </a><a href="#bookmark325" class="a">Figure 3.4</a>0<span class="p">. The client application process issues a close command. This causes the client</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">TCP to send a special TCP segment to the server process. This special segment has a flag bit in the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark305" class="s124">segment’s header, the FIN bit (see </a><a href="#bookmark305" class="a">Figure 3.2</a>9<span class="p">), set to 1. When the server receives this segment, it sends the client an acknowledgment segment in return. The server then sends its own shutdown segment, which has the FIN bit set to 1. Finally, the client acknowledges the server’s shutdown</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">segment. At this point, all the resources in the two hosts are now deallocated.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;">During the life of a TCP connection, the TCP protocol running in each host makes transitions through various <span class="s23">TCP</span><span class="s20"> states</span><a href="#bookmark327" class="s124">. </a><a href="#bookmark327" class="a">Figure 3.41</a><span class="s20"> </span>illustrates a typical sequence of TCP states that are visited by the <i>client </i>TCP. The client TCP begins in the CLOSED state. The application on the client side initiates a new TCP connection (by creating a Socket object in our Java examples as in the Python examples from</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark138" class="a">Chapter </a>2<span class="p">). This causes TCP in the client to send a SYN segment to TCP in the server. After having sent the SYN segment, the client TCP enters the SYN_SENT state. While in the SYN_SENT state, the client TCP waits for a segment from the server TCP that includes an acknowledgment for the client’s</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">previous segment and</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="602" height="448" alt="image" src="计算机网络自顶向下7th-en/Image_338.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark327">Figure 3.41 A typical sequence of TCP states visited by a client TCP</a></h2><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">has the SYN bit set to 1. Having received such a segment, the client TCP enters the ESTABLISHED state. While in the ESTABLISHED state, the TCP client can send and receive TCP segments containing payload (that is, application-generated) data.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Suppose that the client application decides it wants to close the connection. (Note that the server could also choose to close the connection.) This causes the client TCP to send a TCP segment with the FIN bit set to 1 and to enter the FIN_WAIT_1 state. While in the FIN_WAIT_1 state, the client TCP waits for a TCP segment from the server with an acknowledgment. When it receives this segment, the client TCP enters the FIN_WAIT_2 state. While in the FIN_WAIT_2 state, the client waits for another segment from the server with the FIN bit set to 1; after receiving this segment, the client TCP acknowledges the server’s segment and enters the TIME_WAIT state. The TIME_WAIT state lets the TCP client resend the final acknowledgment in case the ACK is lost. The time spent in the TIME_WAIT state is implementation-dependent, but typical values are 30 seconds, 1 minute, and 2 minutes. After the wait, the connection formally closes and all resources on the client side (including port numbers) are released.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark328" class="a">Figure 3.42</a> <span class="p">illustrates the series of states typically visited by the server-side TCP, assuming the client begins connection teardown. The transitions are self-explanatory. In these two state-transition diagrams, we have only shown how a TCP connection is normally established and shut down. We have not</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">described what happens in certain pathological scenarios, for example, when both sides of a connection want to initiate or shut down at the same time. If you are interested in learning about</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="543" height="423" alt="image" src="计算机网络自顶向下7th-en/Image_339.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark328">Figure 3.42 A typical sequence of TCP states visited by a server-side TCP</a></h2><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">this and other advanced issues concerning TCP, you are encouraged to see Stevens’ comprehensive book </a><a href="#bookmark848" class="a">[Stevens </a>1994]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Our discussion above has assumed that both the client and server are prepared to communicate, i.e., that the server is listening on the port to which the client sends its SYN segment. Let’s consider what happens when a host receives a TCP segment whose port numbers or source IP address do not match with any of the ongoing sockets in the host. For example, suppose a host receives a TCP SYN packet with destination port 80, but the host is not accepting connections on port 80 (that is, it is not running a Web server on port 80). Then the host will send a special reset segment to the source. This TCP</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark309" class="s124">segment has the RST flag bit (see </a><a href="#bookmark309" class="a">Section 3.5.</a>2<span class="p">) set to 1. Thus, when a host sends a reset segment, it is telling the source “I don’t have a socket for that segment. Please do not resend the segment.” When a host receives a UDP packet whose destination port number doesn’t match with an ongoing UDP socket,</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark444" class="s124">the host sends a special ICMP datagram, as discussed in </a><a href="#bookmark444" class="a">Chapter </a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now that we have a good understanding of TCP connection management, let’s revisit the nmap port- scanning tool and examine more closely how it works. To explore a specific TCP port, say port 6789, on a target host, nmap will send a TCP SYN segment with destination port 6789 to that host. There are three possible outcomes:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="543" alt="image" src="计算机网络自顶向下7th-en/Image_340.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_341.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">The source host receives a TCP SYNACK segment from the target host. <span class="p">Since this means that an application is running with TCP port 6789 on the target post, nmap returns “open.”</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;">FOCUS ON SECURITY</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 48pt;text-indent: 0pt;text-align: left;">The Syn Flood Attack</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">We’ve seen in our discussion of TCP’s three-way handshake that a server allocates and initializes connection variables and buffers in response to a received SYN. The server then sends a SYNACK in response, and awaits an ACK segment from the client. If the client does not send an ACK to complete the third step of this 3-way handshake, eventually (often after a minute or more) the server will terminate the half-open connection and reclaim the allocated resources.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">This TCP connection management protocol sets the stage for a classic Denial of Service (DoS) attack known as the <span class="s20">SYN flood attack</span>. In this attack, the attacker(s) send a large number of TCP SYN segments, without completing the third handshake step. With this deluge of SYN segments, the server’s connection resources become exhausted as they are allocated (but never used!) for half-open connections; legitimate clients are then denied</p><p class="s20" style="padding-top: 2pt;padding-left: 48pt;text-indent: 0pt;line-height: 129%;text-align: left;"><a href="#bookmark848" class="s124">service. Such SYN flooding attacks were among the first documented DoS attacks </a><a href="#bookmark848" class="a">[CERT SYN </a>1996]<span class="p">. Fortunately, an effective defense known as </span><span class="s23">SYN</span><a href="#bookmark848" class="a"> cookies [RFC 4987]</a> <span class="p">are now deployed in most major operating systems. SYN cookies work as follows:</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_342.png"/></span></p><p style="padding-top: 4pt;padding-left: 69pt;text-indent: 0pt;text-align: left;">When the server receives a SYN segment, it does not know if the segment is coming</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="644" alt="image" src="计算机网络自顶向下7th-en/Image_343.png"/></span></p><p style="padding-left: 69pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark329">from a legitimate user or is part of a SYN flood attack. So, instead of creating a half-open TCP connection for this SYN, the server creates an initial TCP sequence number that is a complicated function (hash function) of source and destination IP addresses and port numbers of the SYN segment, as well as a secret number only known to the server. This carefully crafted initial sequence number is the so-called “cookie.” The server then sends</a><a name="bookmark330">&zwnj;</a></p><p style="padding-top: 2pt;padding-left: 69pt;text-indent: 0pt;line-height: 146%;text-align: left;">the client a SYNACK packet with this special initial sequence number. <i>Importantly, the server does not remember the cookie or any other state information corresponding to the SYN</i>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_344.png"/></span></p><p style="padding-left: 69pt;text-indent: 0pt;line-height: 138%;text-align: left;">A legitimate client will return an ACK segment. When the server receives this ACK, it must verify that the ACK corresponds to some SYN sent earlier. But how is this done if the server maintains no memory about SYN segments? As you may have guessed, it is</p><p class="s20" style="padding-top: 1pt;padding-left: 69pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark324" class="s124">done with the cookie. Recall that for a legitimate ACK, the value in the acknowledgment field is equal to the initial sequence number in the SYNACK (the cookie value in this case) plus one (see </a><a href="#bookmark324" class="a">Figure 3.3</a>9<span class="p">). The server can then run the same hash function using</span></p><p style="padding-left: 69pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the source and destination IP address and port numbers in the SYNACK (which are the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 69pt;text-indent: 0pt;line-height: 146%;text-align: left;">same as in the original SYN) and the secret number. If the result of the function plus one is the same as the acknowledgment (cookie) value in the client’s SYNACK, the server concludes that the ACK corresponds to an earlier SYN segment and is hence valid. The server then creates a fully open connection along with a socket.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_345.png"/></span></p><p style="padding-top: 2pt;padding-left: 69pt;text-indent: 0pt;line-height: 138%;text-align: justify;">On the other hand, if the client does not return an ACK segment, then the original SYN has done no harm at the server, since the server hasn’t yet allocated any resources in response to the original bogus SYN.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_346.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">The source host receives a TCP RST segment from the target host. <span class="p">This means that the SYN segment reached the target host, but the target host is not running an application with TCP port 6789. But the attacker at least knows that the segments destined to the host at port 6789 are not</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">blocked by any firewall on the path between source and target hosts. (Firewalls are discussed in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark671" class="a">Chapter </a>8<span class="p">.)</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_347.png"/></span></p><p class="s28" style="padding-left: 25pt;text-indent: 0pt;line-height: 130%;text-align: left;">The source receives nothing. <span class="p">This likely means that the SYN segment was blocked by an intervening firewall and never reached the target host.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">Nmap is a powerful tool that can “case the joint” not only for open TCP ports, but also for open UDP ports, for firewalls and their configurations, and even for the versions of applications and operating systems. Most of this is done by manipulating TCP connection-management segments </a><a href="#bookmark848" class="a">[Skoudis 2006</a>]<span class="p">.</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="http://www.nmap.org/" class="s124" target="_blank">You can download nmap from </a>www.nmap.org<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark355" class="s124">This completes our introduction to error control and flow control in TCP. In </a><a href="#bookmark355" class="a">Section 3.7</a> <span class="p">we’ll return to TCP and look at TCP congestion control in some depth. Before doing so, however, we first step back and examine congestion-control issues in a broader context.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l158"><ol id="l159"><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark331">Principles of Congestion Control</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the previous sections, we examined both the general principles and specific TCP mechanisms used to provide for a reliable data transfer service in the face of packet loss. We mentioned earlier that, in practice, such loss typically results from the overflowing of router buffers as the network becomes congested. Packet retransmission thus treats a symptom of network congestion (the loss of a specific transport-layer segment) but does not treat the cause of network congestion—too many sources attempting to send data at too high a rate. To treat the cause of network congestion, mechanisms are needed to throttle senders in the face of network congestion.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section, we consider the problem of congestion control in a general context, seeking to understand why congestion is a bad thing, how network congestion is manifested in the performance received by upper-layer applications, and various approaches that can be taken to avoid, or react to, network congestion. This more general study of congestion control is appropriate since, as with reliable data transfer, it is high on our “top-ten” list of fundamentally important problems in networking. The following section contains a detailed study of TCP’s congestion-control algorithm.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l160"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The Causes and the Costs of Congestion</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s begin our general study of congestion control by examining three increasingly complex scenarios in which congestion occurs. In each case, we’ll look at why congestion occurs in the first place and at the cost of congestion (in terms of resources not fully utilized and poor performance received by the end systems). We’ll not (yet) focus on how to react to, or avoid, congestion but rather focus on the simpler issue of understanding what happens as hosts increase their transmission rate and the network becomes congested.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Scenario 1: Two Senders, a Router with Infinite Buffers</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark332" class="s124">We begin by considering perhaps the simplest congestion scenario possible: Two hosts (A and B) each have a connection that shares a single hop between source and destination, as shown in </a><a href="#bookmark332" class="a">Figure 3.4</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">Let’s assume that the application in Host A is sending data into the connection (for example, passing data to the transport-level protocol via a socket) at an average rate of λ<span class="s22">in </span>bytes/sec. These data are</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">original in the sense that each unit of data is sent into the socket only once. The underlying transport-</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">level protocol is a simple one. Data is encapsulated and sent; no error recovery (for example,</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 155%;text-align: left;">retransmission), flow control, or congestion control is performed. Ignoring the additional overhead due to adding transport- and lower-layer header information, the rate at which Host A offers traffic to the router in this first scenario is thus λ<span class="s22">in </span>bytes/sec. Host B operates in a similar manner, and we assume for simplicity that it too is sending at a rate of λ<span class="s22">in </span>bytes/sec. Packets from Hosts A and B pass through a router and over a shared outgoing link of capacity <i>R</i>. The router has buffers that allow it to store</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">incoming packets when the packet-arrival rate exceeds the outgoing link’s capacity. In this first scenario,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">we assume that the router has an infinite amount of buffer space.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark333" class="a">Figure 3.44</a> <span class="p">plots the performance of Host A’s connection under this first scenario. The left graph plots the </span>per-connection throughput <span class="p">(number of bytes per</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="310" alt="image" src="计算机网络自顶向下7th-en/Image_348.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark332">Figure 3.43 Congestion scenario 1: Two connections sharing a single hop with infinite buffers</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="266" height="250" alt="image" src="计算机网络自顶向下7th-en/Image_349.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark333">Figure 3.44 Congestion scenario 1: Throughput and delay as a function of host sending rate</a><a name="bookmark334">&zwnj;</a></h2><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="242" height="252" alt="image" src="计算机网络自顶向下7th-en/Image_350.jpg"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">second at the receiver) as a function of the connection-sending rate. For a sending rate between 0 and <i>R</i>/2, the throughput at the receiver equals the sender’s sending rate—everything sent by the sender is received at the receiver with a finite delay. When the sending rate is above <i>R</i>/2, however, the throughput</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">is only <i>R</i>/2. This upper limit on throughput is a consequence of the sharing of link capacity between two</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">connections. The link simply cannot deliver packets to a receiver at a steady-state rate that exceeds <i>R</i>/2. No matter how high Hosts A and B set their sending rates, they will each never see a throughput higher than <i>R</i>/2.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Achieving a per-connection throughput of <i>R</i><a href="#bookmark333" class="s124">/2 might actually appear to be a good thing, because the link is fully utilized in delivering packets to their destinations. The right-hand graph in </a><a href="#bookmark333" class="a">Figure 3.4</a><span class="s20">4</span>, however, shows the consequence of operating near link capacity. As the sending rate approaches <i>R</i>/2 (from the left), the average delay becomes larger and larger. When the sending rate exceeds <i>R</i>/2, the average</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">number of queued packets in the router is unbounded, and the average delay between source and</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">destination becomes infinite (assuming that the connections operate at these sending rates for an infinite period of time and there is an infinite amount of buffering available). Thus, while operating at an aggregate throughput of near <i>R </i>may be ideal from a throughput standpoint, it is far from ideal from a</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">delay standpoint. <i>Even in this (extremely) idealized scenario, we’ve already found one cost of a</i></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">congested network—large queuing delays are experienced as the packet-arrival rate nears the link capacity.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Scenario 2: Two Senders and a Router with Finite Buffers</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark336" class="s124">Let’s now slightly modify scenario 1 in the following two ways (see </a><a href="#bookmark336" class="a">Figure 3.4</a>5<span class="p">). First, the amount of router buffering is assumed to be finite. A consequence of this real-world assumption is that packets will be dropped when arriving to an already-full buffer. Second, we assume that each connection is reliable.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark335">If a packet containing</a></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="363" alt="image" src="计算机网络自顶向下7th-en/Image_351.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark336">Figure 3.45 Scenario 2: Two hosts (with retransmissions) and a router with finite buffers</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">a transport-level segment is dropped at the router, the sender will eventually retransmit it. Because packets can be retransmitted, we must now be more careful with our use of the term <i>sending rate</i>.</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Specifically, let us again denote the rate at which the application sends original data into the socket by</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 143%;text-align: left;">λ<span class="s22">in </span>bytes/sec. The rate at which the transport layer sends segments (containing original data <i>and </i>retransmitted data) into the network will be denoted λ′in bytes/sec. λ′in is sometimes referred to as the <span class="s20">offered load </span>to the network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 148%;text-align: left;">The performance realized under scenario 2 will now depend strongly on how retransmission is performed. First, consider the unrealistic case that Host A is able to somehow (magically!) determine whether or not a buffer is free in the router and thus sends a packet only when a buffer is free. In this case, no loss would occur, λ<span class="s22">in </span>would be equal to <span class="s27">λ</span>′in, and the throughput of the connection would be equal to λ<span class="s22">in</span><a href="#bookmark337" class="s124">. This case is shown in </a><a href="#bookmark337" class="a">Figure 3.46(</a><span class="s20">a</span>). From a throughput standpoint, performance is ideal— everything that is sent is received. Note that the average host sending rate cannot exceed <i>R</i>/2 under</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">this scenario, since packet loss is assumed never to occur.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 144%;text-align: left;"><a href="#bookmark337" class="s124">Consider next the slightly more realistic case that the sender retransmits only when a packet is known for certain to be lost. (Again, this assumption is a bit of a stretch. However, it is possible that the sending host might set its timeout large enough to be virtually assured that a packet that has not been acknowledged has been lost.) In this case, the performance might look something like that shown in </a><a href="#bookmark337" class="a">Figure 3.46(b</a><span class="s20">)</span>. To appreciate what is happening here, consider the case that the offered load, <span class="s27">λ</span>′in (the rate of original data transmission plus retransmissions), equals <i>R/2</i><a href="#bookmark337" class="s124">. According to </a><a href="#bookmark337" class="a">Figure 3.46(b</a><span class="s20">)</span>, at this</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">value of the offered load, the rate at which data</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="793" height="251" alt="image" src="计算机网络自顶向下7th-en/Image_352.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark337">Figure 3.46 Scenario 2 performance with finite buffers</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">are delivered to the receiver application is <i>R</i>/3. Thus, out of the 0.5<i>R </i>units of data transmitted, 0.333<i>R </i>bytes/sec (on average) are original data and 0.166<i>R </i>bytes/sec (on average) are retransmitted data. <i>We see here another cost of a congested network—the sender must perform retransmissions in order to compensate for dropped (lost) packets due to buffer overflow.</i></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Finally, let us consider the case that the sender may time out prematurely and retransmit a packet that has been delayed in the queue but not yet lost. In this case, both the original data packet and the retransmission may reach the receiver. Of course, the receiver needs but one copy of this packet and will discard the retransmission. In this case, the work done by the router in forwarding the retransmitted copy of the original packet was wasted, as the receiver will have already received the original copy of this packet. The router would have better used the link transmission capacity to send a different packet</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">instead. <a href="#bookmark337" style=" color: #333; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt;">Here then is yet another cost of a congested network—unneeded retransmissions by the sender in the face of large delays may cause a router to use its link bandwidth to forward unneeded copies of a packet. </a><a href="#bookmark337" class="a">Figure 3.46 (c)</a><span class="s20"> </span>shows the throughput versus offered load when each packet is</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">assumed to be forwarded (on average) twice by the router. Since each packet is forwarded twice, the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">throughput will have an asymptotic value of <i>R</i>/4 as the offered load approaches <i>R/</i>2.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Scenario 3: Four Senders, Routers with Finite Buffers, and Multihop Paths</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 154%;text-align: justify;"><a href="#bookmark338" class="s124">In our final congestion scenario, four hosts transmit packets, each over overlapping two-hop paths, as shown in </a><a href="#bookmark338" class="a">Figure 3.4</a><span class="s20">7</span>. We again assume that each host uses a timeout/retransmission mechanism to implement a reliable data transfer service, that all hosts have the same value of λ<span class="s22">in</span>, and that all router links have capacity <i>R </i>bytes/sec.</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="723" height="594" alt="image" src="计算机网络自顶向下7th-en/Image_353.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark338">Figure 3.47 Four senders, routers with finite buffers, and multihop paths</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 154%;text-align: left;">Let’s consider the connection from Host A to Host C, passing through routers R1 and R2. The A–C connection shares router R1 with the D–B connection and shares router R2 with the B–D connection. For extremely small values of λ<span class="s22">in</span>, buffer overflows are rare (as in congestion scenarios 1 and 2), and the throughput approximately equals the offered load. For slightly larger values of λ<span class="s22">in</span>, the corresponding</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">throughput is also larger, since more original data is being transmitted into the network and delivered to</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 156%;text-align: left;">the destination, and overflows are still rare. Thus, for small values of λ<span class="s22">in</span>, an increase in λ<span class="s22">in </span>results in an increase in λ<span class="s22">out</span>.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 134%;text-align: left;">Having considered the case of extremely low traffic, let’s next examine the case that λ<span class="s22">in </span>(and hence <span class="s27">λ</span>′in) is extremely large. Consider router R2. The A–C traffic arriving to router R2 (which arrives at R2 after</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 128%;text-align: left;">being forwarded from R1) can have an arrival rate at R2 that is at most <i>R, </i>the capacity of the link from R1 to R2, regardless of the value of λ<span class="s22">in</span>. If <span class="s27">λ</span>′in is extremely large for all connections (including the</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="374" height="265" alt="image" src="计算机网络自顶向下7th-en/Image_354.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark339">Figure 3.48 Scenario 3 performance with finite buffers and multihop paths</a><a name="bookmark340">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">B–D connection), then the arrival rate of B–D traffic at R2 can be much larger than that of the A–C traffic. Because the A–C and B–D traffic must compete at router R2 for the limited amount of buffer space, the amount of A–C traffic that successfully gets through R2 (that is, is not lost due to buffer overflow) becomes smaller and smaller as the offered load from B–D gets larger and larger. In the limit, as the offered load approaches infinity, an empty buffer at R2 is immediately filled by a B–D packet, and</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the throughput of the A–C connection at R2 goes to zero. This, in turn, <i>implies that the A–C end-to-end throughput goes to zero </i><a href="#bookmark340" class="s124">in the limit of heavy traffic. These considerations give rise to the offered load versus throughput tradeoff shown in </a><a href="#bookmark340" class="a">Figure 3.4</a><span class="s20">8</span>.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The reason for the eventual decrease in throughput with increasing offered load is evident when one considers the amount of wasted work done by the network. In the high-traffic scenario outlined above, whenever a packet is dropped at a second-hop router, the work done by the first-hop router in forwarding a packet to the second-hop router ends up being “wasted.” The network would have been equally well off (more accurately, equally bad off) if the first router had simply discarded that packet and remained idle. More to the point, the transmission capacity used at the first router to forward the packet to the second router could have been much more profitably used to transmit a different packet. (For example, when selecting a packet for transmission, it might be better for a router to give priority to</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">packets that have already traversed some number of upstream routers.) <i>So here we see yet another cost of dropping a packet due to congestion—when a packet is dropped along a path, the transmission capacity that was used at each of the upstream links to forward that packet to the point at which it is dropped ends up having been wasted.</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Approaches to Congestion Control</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark355" class="s124">In </a><a href="#bookmark355" class="a">Section 3.</a>7<span class="p">, we’ll examine TCP’s specific approach to congestion control in great detail. Here, we identify the two broad approaches to congestion control that are taken in practice and discuss specific</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">network architectures and congestion-control protocols embodying these approaches.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">At the highest level, we can distinguish among congestion-control approaches by whether the network layer provides explicit assistance to the transport layer for congestion-control purposes:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_355.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">End-to-end congestion control. <span class="p">In an end-to-end approach to congestion control, the network layer provides no explicit support to the transport layer for congestion-control purposes. Even the presence of network congestion must be inferred by the end systems based only on observed</span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark353" class="s124">network behavior (for example, packet loss and delay). We’ll see shortly in </a><a href="#bookmark353" class="a">Section 3.7.1</a> <span class="p">that TCP takes this end-to-end approach toward congestion control, since the IP layer is not required to provide feedback to hosts regarding network congestion. TCP segment loss (as indicated by a</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">timeout or the receipt of three duplicate acknowledgments) is taken as an indication of network congestion, and TCP decreases its window size accordingly. We’ll also see a more recent proposal for TCP congestion control that uses increasing round-trip segment delay as an indicator of increased network congestion</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_356.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Network-assisted congestion control. <span class="p">With network-assisted congestion control, routers provide explicit feedback to the sender and/or receiver regarding the congestion state of the network. This feedback may be as simple as a single bit indicating congestion at a link – an approach taken in the</span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">early IBM SNA </a><a href="#bookmark848" class="a">[Schwartz 1982</a>]<a href="#bookmark848" class="s124">, DEC DECnet </a><a href="#bookmark848" class="a">[Jain 198</a>9<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Ramakrishnan 1990]</a> <a href="#bookmark848" class="s124">architectures, and ATM </a><a href="#bookmark848" class="a">[Black 1995]</a> <span class="p">network architectures. More sophisticated feedback is also possible. For example, in </span>ATM Available Bite Rate (ABR) <span class="p">congestion control, a router informs the sender of the</span></p><p class="s20" style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark356" class="s124">maximum host sending rate it (the router) can support on an outgoing link. As noted above, the Internet-default versions of IP and TCP adopt an end-to-end approach towards congestion control. We’ll see, however, in </a><a href="#bookmark356" class="a">Section 3.7.2</a> <span class="p">that, more recently, IP and TCP may also optionally implement</span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 11pt;text-align: left;">network-assisted congestion control.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">For network-assisted congestion control, congestion information is typically fed back from the network to</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark343" class="s124">the sender in one of two ways, as shown in </a><a href="#bookmark343" class="a">Figure 3.4</a>9<span class="p">. Direct feedback may be sent from a network router to the sender. This form of notification typically takes the form of a choke packet (essentially saying, “I’m congested!”). The second and more common form of notification occurs when a router</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">marks/updates a field in a packet flowing from sender to receiver to indicate congestion. Upon receipt of a marked packet, the receiver then notifies the sender of the congestion indication. This latter form of notification takes a full round-trip time.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="649" height="348" alt="image" src="计算机网络自顶向下7th-en/Image_357.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark341">Figure 3.49 Two feedback pathways for network-indicated congestion information</a><a name="bookmark342">&zwnj;</a><a name="bookmark343">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l161"><ol id="l162"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark344">TCP Congestion Control</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark329" class="s124">In this section we return to our study of TCP. As we learned in </a><a href="#bookmark329" class="a">Section 3.</a>5<span class="p">, TCP provides a reliable transport service between two processes running on different hosts. Another key component of TCP is its congestion-control mechanism. As indicated in the previous section, TCP must use end-to-end</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">congestion control rather than network-assisted congestion control, since the IP layer provides no explicit feedback to the end systems regarding network congestion.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The approach taken by TCP is to have each sender limit the rate at which it sends traffic into its connection as a function of perceived network congestion. If a TCP sender perceives that there is little congestion on the path between itself and the destination, then the TCP sender increases its send rate; if the sender perceives that there is congestion along the path, then the sender reduces its send rate. But this approach raises three questions. First, how does a TCP sender limit the rate at which it sends traffic into its connection? Second, how does a TCP sender perceive that there is congestion on the path between itself and the destination? And third, what algorithm should the sender use to change its send rate as a function of perceived end-to-end congestion?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark329" class="s124">Let’s first examine how a TCP sender limits the rate at which it sends traffic into its connection. In </a><a href="#bookmark329" class="a">Section 3.5</a><span class="s20"> </span>we saw that each side of a TCP connection consists of a receive buffer, a send buffer, and several variables ( <span class="s30">LastByteRead </span>,  <span class="s30">rwnd </span>, and so on). The TCP congestion-control mechanism</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;"><a name="bookmark345">operating at the sender keeps track of an additional variable, the </a><span class="s20">congestion window</span>. The congestion</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">window, denoted <span class="s30">cwnd </span>, imposes a constraint on the rate at which a TCP sender can send traffic into the network. Specifically, the amount of unacknowledged data at a sender may not exceed the minimum</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">of <span class="s30">cwnd </span>and <span class="s30">rwnd </span>, that is:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-top: 3pt;padding-left: 31pt;text-indent: 0pt;text-align: left;">LastByteSent−LastByteAcked≤min{cwnd, rwnd}</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="78" alt="image" src="计算机网络自顶向下7th-en/Image_358.png"/></span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">In order to focus on congestion control (as opposed to flow control), let us henceforth assume that the TCP receive buffer is so large that the receive-window constraint can be ignored; thus, the amount of unacknowledged data at the sender is solely limited by <span class="s30">cwnd </span>. We will also assume that the sender</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">always has data to send, i.e., that all segments in the congestion window are sent.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The constraint above limits the amount of unacknowledged data at the sender and therefore indirectly limits the sender’s send rate. To see this, consider a connection for which loss and packet transmission delays are negligible. Then, roughly, at the beginning of every RTT, the constraint permits the sender to</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">send <span class="s30">cwnd </span>bytes of data into the connection; at the end of the RTT the sender receives acknowledgments for the data. <i>Thus the sender’s send rate is roughly cwnd/RTT bytes/sec. By adjusting the value of </i><span class="s30">cwnd </span><i>, the sender can therefore adjust the rate at which it sends data into its connection.</i></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark320" class="s124">Let’s next consider how a TCP sender perceives that there is congestion on the path between itself and the destination. Let us define a “loss event” at a TCP sender as the occurrence of either a timeout or the receipt of three duplicate ACKs from the receiver. (Recall our discussion in </a><a href="#bookmark320" class="a">Section 3.5.4</a> <span class="p">of the timeout</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark312" class="s124">event in </a><a href="#bookmark312" class="a">Figure 3.33</a> <span class="p">and the subsequent modification to include fast retransmit on receipt of three</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">duplicate ACKs.) When there is excessive congestion, then one (or more) router buffers along the path overflows, causing a datagram (containing a TCP segment) to be dropped. The dropped datagram, in turn, results in a loss event at the sender—either a timeout or the receipt of three duplicate ACKs— which is taken by the sender to be an indication of congestion on the sender-to-receiver path.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having considered how congestion is detected, let’s next consider the more optimistic case when the network is congestion-free, that is, when a loss event doesn’t occur. In this case, acknowledgments for previously unacknowledged segments will be received at the TCP sender. As we’ll see, TCP will take the arrival of these acknowledgments as an indication that all is well—that segments being transmitted into the network are being successfully delivered to the destination—and will use acknowledgments to increase its congestion window size (and hence its transmission rate). Note that if acknowledgments arrive at a relatively slow rate (e.g., if the end-end path has high delay or contains a low-bandwidth link), then the congestion window will be increased at a relatively slow rate. On the other hand, if acknowledgments arrive at a high rate, then the congestion window will be increased more quickly. Because TCP uses acknowledgments to trigger (or clock) its increase in congestion window size, TCP is said to be <span class="s20">self-clocking</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 134%;text-align: left;"><span class="s37">Given</span> the <i>mechanism </i>of adjusting the value of <span class="s45">cwnd </span><span class="s37">to</span> control the sending rate, the critical question remains: <i>How </i>should a TCP sender determine the rate at which it should send? If TCP senders collectively send too fast, they can congest the network, leading to the type of congestion collapse that</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark340" class="s124">we saw in </a><a href="#bookmark340" class="a">Figure 3.4</a>8<a href="#bookmark848" class="s124">. Indeed, the version of TCP that we’ll study shortly was developed in response to observed Internet congestion collapse </a><a href="#bookmark848" class="a">[Jacobson 1988]</a> <span class="p">under earlier versions of TCP. However, if TCP senders are too cautious and send too slowly, they could under utilize the bandwidth in the network; that</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">is, the TCP senders could send at a higher rate without congesting the network. How then do the TCP senders determine their sending rates such that they don’t congest the network but at the same time make use of all the available bandwidth? Are TCP senders explicitly coordinated, or is there a distributed approach in which the TCP senders can set their sending rates based only on local information? TCP answers these questions using the following guiding principles:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_359.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">A lost segment implies congestion, and hence, the TCP sender’s rate should be decreased when a segment is lost. <a href="#bookmark320" class="s124">Recall from our discussion in </a><a href="#bookmark320" class="a">Section 3.5.</a><span style=" color: #1E79B8;">4</span><span class="p">, that a timeout event or the</span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">receipt of four acknowledgments for a given segment (one original ACK and then three duplicate ACKs) is interpreted as an implicit “loss event” indication of the segment following the quadruply ACKed segment, triggering a retransmission of the lost segment. From a congestion-control standpoint, the question is how the TCP sender should decrease its congestion window size, and hence its sending rate, in response to this inferred loss event.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_360.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">An acknowledged segment indicates that the network is delivering the sender’s segments to the receiver, and hence, the sender’s rate can be increased when an ACK arrives for a previously unacknowledged segment. <span class="p">The arrival of acknowledgments is taken as an implicit</span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 12pt;text-align: left;">indication that all is well—segments are being successfully delivered from sender to receiver, and</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">the network is thus not congested. The congestion window size can thus be increased.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_361.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Bandwidth probing. <span class="p">Given ACKs indicating a congestion-free source-to-destination path and loss events indicating a congested path, TCP’s strategy for adjusting its transmission rate is to increase its rate in response to arriving ACKs until a loss event occurs, at which point, the transmission rate is</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">decreased. The TCP sender thus increases its transmission rate to probe for the rate that at which congestion onset begins, backs off from that rate, and then to begins probing again to see if the congestion onset rate has changed. The TCP sender’s behavior is perhaps analogous to the child who requests (and gets) more and more goodies until finally he/she is finally told “No!”, backs off a bit, but then begins making requests again shortly afterwards. Note that there is no explicit signaling of congestion state by the network—ACKs and loss events serve as implicit signals—and that each TCP sender acts on local information asynchronously from other TCP senders.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;"><span class="p">Given this overview of TCP congestion control, we’re now in a position to consider the details of the celebrated </span><span class="s23">TCP</span> congestion-control algorithm<a href="#bookmark848" class="s124">, which was first described in </a><a href="#bookmark848" class="a">[Jacobson 1988]</a> <a href="#bookmark848" class="s124">and is standardized in </a><a href="#bookmark848" class="a">[RFC </a>5681]<span class="p">. The algorithm has three major components: (1) slow start, (2) congestion avoidance, and (3) fast recovery. Slow start and congestion avoidance are mandatory components of</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">TCP, differing in how they increase the size of <span class="s30">cwnd </span>in response to received ACKs. We’ll see shortly that slow start increases the size of <span class="s30">cwnd </span>more rapidly (despite its name!) than congestion avoidance. Fast recovery is recommended, but not required, for TCP senders.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Slow Start</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 137%;text-align: left;">When a TCP connection begins, the value of <span class="s30">cwnd </span><a href="#bookmark848" class="s124">is typically initialized to a small value of 1 MSS </a><a href="#bookmark848" class="a">[RFC </a><span class="s20">3390]</span>, resulting in an initial sending rate of roughly MSS/RTT. For example, if MSS = 500 bytes and RTT = 200 msec, the resulting initial sending rate is only about 20 kbps. Since the available</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 147%;text-align: left;">bandwidth to the TCP sender may be much larger than MSS/RTT, the TCP sender would like to find the amount of available bandwidth quickly. Thus, in the <span class="s23">slow-start</span><span class="s20"> </span>state, the value of <span class="s30">cwnd </span>begins at 1</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">MSS and increases by 1 MSS every time a transmitted segment is first acknowledged. In the example of</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark346" class="a">Figure 3.5</a>0<span class="p">, TCP sends the first segment into the network</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="397" height="543" alt="image" src="计算机网络自顶向下7th-en/Image_362.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark346">Figure 3.50 TCP slow start</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">and waits for an acknowledgment. When this acknowledgment arrives, the TCP sender increases the congestion window by one MSS and sends out two maximum-sized segments. These segments are then acknowledged, with the sender increasing the congestion window by 1 MSS for each of the acknowledged segments, giving a congestion window of 4 MSS, and so on. This process results in a doubling of the sending rate every RTT. Thus, the TCP send rate starts slow but grows exponentially during the slow start phase.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">But when should this exponential growth end? Slow start provides several answers to this question. First, if there is a loss event (i.e., congestion) indicated by a timeout, the TCP sender sets the value of <span class="s30">cwnd </span>to 1 and begins the slow start process anew. It also sets the value of a second state variable,</p><p class="s30" style="padding-left: 8pt;text-indent: 0pt;line-height: 14pt;text-align: left;">ssthresh <span class="p">(shorthand for “slow start threshold”) to </span>cwnd/2 <span class="p">—half of the value of the congestion</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">window value when congestion was detected. The second way in which slow start may end is directly tied to the value of <span class="s30">ssthresh </span>. Since <span class="s30">ssthresh </span>is half the value of <span class="s30">cwnd </span>when congestion was last detected, it might be a bit reckless to keep doubling <span class="s30">cwnd </span>when it reaches or surpasses the value of</p><p class="s30" style="padding-left: 8pt;text-indent: 0pt;line-height: 14pt;text-align: left;">ssthresh <span class="p">. Thus, when the value of </span>cwnd <span class="p">equals </span>ssthresh <span class="p">, slow start ends and TCP transitions</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">into congestion avoidance mode. As we’ll see, TCP increases <span class="s30">cwnd </span>more cautiously when in congestion-avoidance mode. The final way in which slow start can end is if three duplicate ACKs are</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark320" class="s124">detected, in which case TCP performs a fast retransmit (see </a><a href="#bookmark320" class="a">Section 3.5.</a>4<span class="p">) and enters the fast recovery state, as discussed below. TCP’s behavior in slow start is summarized in the FSM description of TCP</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark347" class="s124">congestion control in </a><a href="#bookmark347" class="a">Figure 3.5</a>1<a href="#bookmark848" class="s124">. The slow-start algorithm traces it roots to </a><a href="#bookmark848" class="a">[Jacobson 1988</a>]<a href="#bookmark848" class="s124">; an approach similar to slow start was also proposed independently in </a><a href="#bookmark848" class="a">[Jain 1986</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Congestion Avoidance</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">On entry to the congestion-avoidance state, the value of <span class="s30">cwnd </span>is approximately half its value when congestion was last encountered—congestion could be just around the corner! Thus, rather than</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">doubling the value of <span class="s30">cwnd </span>every RTT, TCP adopts a more conservative approach and increases the value of <span class="s30">cwnd </span><a href="#bookmark848" class="s124">by just a single MSS every RTT </a><a href="#bookmark848" class="a">[RFC </a><span class="s20">5681]</span>. This can be accomplished in several ways. A common approach is for the TCP sender to increase <span class="s30">cwnd </span>by MSS bytes (MSS/ <span class="s30">cwnd </span>) whenever a new acknowledgment arrives. For example, if MSS is 1,460 bytes and <span class="s30">cwnd </span>is 14,600 bytes, then 10</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">segments are being sent within an RTT. Each arriving ACK (assuming one ACK per segment) increases</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the congestion window size by 1/10 MSS, and thus, the value of the congestion window will have increased by one MSS after ACKs when all 10 segments have been received.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;">But when should congestion avoidance’s linear increase (of 1 MSS per RTT) end? TCP’s congestion- avoidance algorithm behaves the same when a timeout occurs. As in the case of slow start: The value of <span class="s30">cwnd </span>is set to 1 MSS, and the value of <span class="s30">ssthresh </span>is updated to half the value of <span class="s30">cwnd </span>when the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">loss event occurred. Recall, however, that a loss event also can be triggered by a triple duplicate ACK</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">event.</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="786" height="603" alt="image" src="计算机网络自顶向下7th-en/Image_363.png"/></span></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark347">Figure 3.51 FSM description of TCP congestion control</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">In this case, the network is continuing to deliver segments from sender to receiver (as indicated by the receipt of duplicate ACKs). So TCP’s behavior to this type of loss event should be less drastic than with a timeout-indicated loss: TCP halves the value of <span class="s30">cwnd </span>(adding in 3 MSS for good measure to account</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 14pt;text-align: left;">for the triple duplicate ACKs received) and records the value of <span class="s30">ssthresh </span>to be half the value of <span class="s30">cwnd</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">when the triple duplicate ACKs were received. The fast-recovery state is then entered.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Fast Recovery</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">In fast recovery, the value of <span class="s30">cwnd </span>is increased by 1 MSS for every duplicate ACK received for the missing segment that caused TCP to enter the fast-recovery state. Eventually, when an ACK arrives for the missing segment, TCP enters the</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="775" height="87" alt="image" src="计算机网络自顶向下7th-en/Image_364.png"/></span></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Examining the behavior of TCP</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="787" height="113" alt="image" src="计算机网络自顶向下7th-en/Image_365.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="985" alt="image" src="计算机网络自顶向下7th-en/Image_366.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">PRINCIPLES IN PRACTICE</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">TCP SPLITTING: OPTIMIZING THE PERFORMANCE OF CLOUD SERVICES</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">For cloud services such as search, e-mail, and social networks, it is desirable to provide a high- level of responsiveness, ideally giving users the illusion that the services are running within their own end systems (including their smartphones). This can be a major challenge, as users are often located far away from the data centers responsible for serving the dynamic content associated with the cloud services. Indeed, if the end system is far from a data center, then the RTT will be large, potentially leading to poor response time performance due to TCP slow start.</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">As a case study, consider the delay in receiving a response for a search query. Typically, the server requires three TCP windows during slow start to deliver the response </a><a href="#bookmark848" class="a">[Pathak </a>2010]<span class="p">.</span></p><p style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;line-height: 141%;text-align: left;">Thus the time from when an end system initiates a TCP connection until the time when it receives the last packet of the response is roughly 4<span class="s29">⋅</span>RTT (one RTT to set up the TCP connection plus three RTTs for the three windows of data) plus the processing time in the data center. These RTT delays can lead to a noticeable delay in returning search results for a significant fraction of queries. Moreover, there can be significant packet loss in access networks, leading to TCP retransmissions and even larger delays.</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">One way to mitigate this problem and improve user-perceived performance is to (1) deploy front- end servers closer to the users, and (2) utilize <span class="s20">TCP splitting </span>by breaking the TCP connection at the front-end server. With TCP splitting, the client establishes a TCP connection to the nearby front-end, and the front-end maintains a persistent TCP connection to the data center with a very</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 119%;text-align: left;"><a href="#bookmark848" class="s124">large TCP congestion window </a><a href="#bookmark848" class="a">[Tariq 200</a>8<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Pathak </a>2010<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Chen 2011</a>]<span class="p">. With this approach, the response time roughly becomes </span><span class="s27">4</span><span class="s29">⋅</span><span class="p">RTTFE+RTTBE+ processing time, where RTT</span><span class="s22">FE  </span><span class="p">is the round-</span></p><p style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;line-height: 140%;text-align: left;">trip time between client and front-end server, and RTT<span class="s22">BE </span>is the round-trip time between the front- end server and the data center (back-end server). If the front-end server is close to client, then</p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;line-height: 156%;text-align: left;">this response time approximately becomes RTT plus processing time, since RTT<span class="s22">FE  </span>is negligibly small and RTT<span class="s22">BE  </span>is approximately RTT. In summary, TCP splitting can reduce the networking</p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 13pt;text-align: left;">delay roughly from 4<span class="s29">⋅</span>RTT to RTT, significantly improving user-perceived performance,</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark228" class="s124">particularly for users who are far from the nearest data center. TCP splitting also helps reduce TCP retransmission delays caused by losses in access networks. Google and Akamai have made extensive use of their CDN servers in access networks (recall our discussion in </a><a href="#bookmark228" class="a">Section</a></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark228" class="a">2.</a>6<a href="#bookmark848" class="s124">) to perform TCP splitting for the cloud services they support </a><a href="#bookmark848" class="a">[Chen 2011</a>]<span class="p">.</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">congestion-avoidance state after deflating <span class="s30">cwnd </span>. If a timeout event occurs, fast recovery transitions to the slow-start state after performing the same actions as in slow start and congestion avoidance: The</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">value of <span class="s30">cwnd </span>is set to 1 MSS, and the value of <span class="s30">ssthresh </span>is set to half the value of <span class="s30">cwnd </span>when the loss event occurred.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">Fast recovery is a recommended, but not required, component of TCP </a><a href="#bookmark848" class="a">[RFC </a>5681]<span class="p">. It is interesting that an early version of TCP, known as </span>TCP Tahoe<span class="p">, unconditionally cut its congestion window to 1 MSS and entered the slow-start phase after either a timeout-indicated or triple-duplicate-ACK-indicated loss event.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">The newer version of TCP, <span class="s20">TCP Reno</span>, incorporated fast recovery.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark348" class="a">Figure 3.52</a> <span class="p">illustrates the evolution of TCP’s congestion window for both Reno and Tahoe. In this figure, the threshold is initially equal to 8 MSS. For the first eight transmission rounds, Tahoe and Reno take identical actions. The congestion window climbs exponentially fast during slow start and hits the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">threshold at the fourth round of transmission. The congestion window then climbs linearly until a triple duplicate- ACK event occurs, just after transmission round 8. Note that the congestion window is</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 18pt;text-align: left;"><span class="s27">1</span>2<span class="s29">⋅</span>MSS when this loss event occurs. The value of <span class="s30">ssthresh </span>is then set to <span class="s27">0.</span>5<span class="s29">⋅</span></p><p class="s30" style="padding-top: 3pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">cwnd</p><p style="padding-left: 3pt;text-indent: 0pt;line-height: 17pt;text-align: left;">=6<span class="s29">⋅</span>MSS. <span class="s49">Under</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">TCP Reno, the congestion window is set to <span class="s30">cwnd</span></p><p style="padding-top: 2pt;padding-left: 3pt;text-indent: 0pt;text-align: left;"><span class="s27">=</span> 9<span class="s29">⋅</span>MSS and then grows linearly. Under TCP Tahoe,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">the congestion window is set to 1 MSS and grows exponentially until it reaches the value of <span class="s30">ssthresh </span>, at which point it grows linearly.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark347" class="a">Figure 3.51</a> <span class="p">presents the complete FSM description of TCP’s congestion-control algorithms—slow start, congestion avoidance, and fast recovery. The figure also indicates where transmission of new segments or retransmitted segments can occur. Although it is important to distinguish between TCP error</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">control/retransmission and TCP congestion control, it’s also important to appreciate how these two aspects of TCP are inextricably linked.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">TCP Congestion Control: Retrospective</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having delved into the details of slow start, congestion avoidance, and fast recovery, it’s worthwhile to now step back and view the forest from the trees. Ignoring the</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="486" height="314" alt="image" src="计算机网络自顶向下7th-en/Image_367.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark348">Figure 3.52 Evolution of TCP’s congestion window (Tahoe and Reno)</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="523" height="301" alt="image" src="计算机网络自顶向下7th-en/Image_368.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark349">Figure 3.53 Additive-increase, multiplicative-decrease congestion control</a><a name="bookmark350">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">initial slow-start period when a connection begins and assuming that losses are indicated by triple duplicate ACKs rather than timeouts, TCP’s congestion control consists of linear (additive) increase in <span class="s30">cwnd </span>of 1 MSS per RTT and then a halving (multiplicative decrease) of <span class="s30">cwnd </span>on a triple duplicate-ACK</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">event. For this reason, TCP congestion control is often referred to as an <span class="s20">additive-increase,</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">multiplicative-decrease (AIMD) <span class="p">form of congestion control. AIMD congestion control gives rise to the</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark349" class="s124">“saw tooth” behavior shown in </a><a href="#bookmark349" class="a">Figure 3.5</a>3<span class="p">, which also nicely illustrates our earlier intuition of TCP “probing” for bandwidth—TCP linearly increases its congestion window size (and hence its transmission rate) until a triple duplicate-ACK event occurs. It then decreases its congestion window size by a factor</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">of two but then again begins increasing it linearly, probing to see if there is additional available bandwidth.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">As noted previously, many TCP implementations use the Reno algorithm </a><a href="#bookmark848" class="a">[Padhye </a>2001]<a href="#bookmark848" class="s124">. Many variations of the Reno algorithm have been proposed </a><a href="#bookmark848" class="a">[RFC </a>3782<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 2018</a>]<a href="#bookmark848" class="s124">. The TCP Vegas  algorithm </a><a href="#bookmark848" class="a">[Brakmo </a>1995<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Ahn 1995]</a> <span class="p">attempts to avoid congestion while maintaining good throughput. The basic idea of Vegas is to (1) detect congestion in the routers between source and destination </span><span class="s17">before</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">packet loss occurs, and (2) lower the rate linearly when this imminent packet loss is detected. Imminent</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">packet loss is predicted by observing the RTT. The longer the RTT of the packets, the greater the congestion in the routers. As of late 2015, the Ubuntu Linux implementation of TCP provided slowstart, congestion avoidance, fast recovery, fast retransmit, and SACK, by default; alternative congestion</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">control algorithms, such as TCP Vegas and BIC </a><a href="#bookmark848" class="a">[Xu 2004</a>]<a href="#bookmark848" class="s124">, are also provided. For a survey of the many flavors of TCP, see </a><a href="#bookmark848" class="a">[Afanasyev </a>2010]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">TCP’s AIMD algorithm was developed based on a tremendous amount of engineering insight and experimentation with congestion control in operational networks. Ten years after TCP’s development, theoretical analyses showed that TCP’s congestion-control algorithm serves as a distributed asynchronous-optimization algorithm that results in several important aspects of user and network</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">performance being simultaneously optimized </a><a href="#bookmark848" class="a">[Kelly </a>1998]<a href="#bookmark848" class="s124">. A rich theory of congestion control has since been developed </a><a href="#bookmark848" class="a">[Srikant </a>2004]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Macroscopic Description of TCP Throughput</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">Given the saw-toothed behavior of TCP, it’s natural to consider what the average throughput (that is, the average rate) of a long-lived TCP connection might be. In this analysis we’ll ignore the slow-start phases that occur after timeout events. (These phases are typically very short, since the sender grows out of the phase exponentially fast.) During a particular round-trip interval, the rate at which TCP sends data is a</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">function of the congestion window and the current <i>RTT</i>. When the window size is <i>w </i>bytes and the current round-trip time is <i>RTT </i>second<i>s</i>, then TCP’s transmission rate is roughly <i>w/RTT. </i>TCP then probes for additional bandwidth by increasing <i>w </i>by 1 MSS each <i>RTT </i>until a loss event occurs. Denote by <i>W </i>the value of <i>w </i>when a loss event occurs. Assuming that <i>RTT </i>and <i>W </i>are approximately constant over the duration of the connection, the TCP transmission rate ranges from <i>W</i>/(2 · <i>RTT</i>) to <i>W/RTT</i>.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;">These assumptions lead to a highly simplified macroscopic model for the steady-state behavior of TCP. The network drops a packet from the connection when the rate increases to <i>W/RTT; </i>the rate is then cut in half and then increases by MSS/<i>RTT </i>every <i>RTT </i>until it again reaches <i>W/RTT</i>. This process repeats</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">itself over and over again. Because TCP’s throughput (that is, rate) increases linearly between the two</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">extreme values, we have</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">average throughput of a connection=0.75<span class="s29">⋅</span>WRTT</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">Using this highly idealized model for the steady-state dynamics of TCP, we can also derive an interesting expression that relates a connection’s loss rate to its available bandwidth </a><a href="#bookmark848" class="a">[Mahdavi 1997</a>]<span class="p">.</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">This derivation is outlined in the homework problems. A more sophisticated model that has been found empirically to agree with measured data is </a><a href="#bookmark848" class="a">[Padhye </a>2000]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">TCP Over High-Bandwidth Paths</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark848" class="s124">It is important to realize that TCP congestion control has evolved over the years and indeed continues to evolve. For a summary of current TCP variants and discussion of TCP evolution, see </a><a href="#bookmark848" class="a">[Floyd 200</a>1<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">RFC </a>5681<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Afanasyev </a>2010]<span class="p">. What was good for the Internet when the bulk of the TCP connections carried</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">SMTP, FTP, and Telnet traffic is not necessarily good for today’s HTTP-dominated Internet or for a</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">future Internet with services that are still undreamed of.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">The need for continued evolution of TCP can be illustrated by considering the high-speed TCP connections that are needed for grid- and cloud-computing applications. For example, consider a TCP connection with 1,500-byte segments and a 100 ms <i>RTT</i>, and suppose we want to send data through</p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark848" class="s124">this connection at 10 Gbps. Following </a><a href="#bookmark848" class="a">[RFC </a>3649]<span class="p">, we note that using the TCP throughput formula</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">above, in order to achieve a 10 Gbps throughput, the average congestion window size would need to be</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">83,333 segments. That’s a <i>lot </i>of segments, leading us to be rather concerned that one of these 83,333 in-flight segments might be lost. What would happen in the case of a loss? Or, put another way, what fraction of the transmitted segments could be lost that would allow the TCP congestion-control algorithm</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark347" class="s124">specified in </a><a href="#bookmark347" class="a">Figure 3.51</a> <span class="p">still to achieve the desired 10 Gbps rate? In the homework questions for this chapter, you are led through the derivation of a formula relating the throughput of a TCP connection as a</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">function of the loss rate (<i>L</i>), the round-trip time (<i>RTT</i>), and the maximum segment size (MSS):</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">average throughput of a connection=1.22<span class="s29">⋅</span>MSSRTTL</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">Using this formula, we can see that in order to achieve a throughput of 10 Gbps, today’s TCP congestion-control algorithm can only tolerate a segment loss probability of 2 · 10<span class="s21">–10</span><span class="s22">  </span>(or equivalently, one loss event for every 5,000,000,000 segments)—a very low rate. This observation has led a number of researchers to investigate new versions of TCP that are specifically designed for such high-speed</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">environments; see </a><a href="#bookmark848" class="a">[Jin 200</a>4<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Kelly </a>2003<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Ha 200</a>8<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 7323]</a> <span class="p">for discussions of these efforts.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><ol id="l163"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Fairness</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Consider <i>K </i>TCP connections, each with a different end-to-end path, but all passing through a bottleneck link with transmission rate <i>R </i>bps. (By <i>bottleneck link</i>, we mean that for each connection, all the other links along the connection’s path are not congested and have abundant transmission capacity as</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">compared with the transmission capacity of the bottleneck link.) Suppose each connection is transferring a large file and there is no UDP traffic passing through the bottleneck link. A congestion-control mechanism is said to be <i>fair </i>if the average transmission rate of each connection is approximately <i>R/K;</i></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">that is, each connection gets an equal share of the link bandwidth.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">Is TCP’s AIMD algorithm fair, particularly given that different TCP connections may start at different times and thus may have different window sizes at a given point in time? </a><a href="#bookmark848" class="a">[Chiu 1989]</a> <span class="p">provides an</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">elegant and intuitive explanation of why TCP congestion control converges to provide an equal share of a bottleneck link’s bandwidth among competing TCP connections.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s consider the simple case of two TCP connections sharing a single link with transmission rate <i>R</i><a href="#bookmark351" class="s124">, as shown in </a><a href="#bookmark351" class="a">Figure 3.5</a><span class="s20">4</span>. Assume that the two connections</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="520" height="226" alt="image" src="计算机网络自顶向下7th-en/Image_369.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark351">Figure 3.54 Two TCP connections sharing a single bottleneck link</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">have the same MSS and RTT (so that if they have the same congestion window size, then they have the same throughput), that they have a large amount of data to send, and that no other TCP connections or UDP datagrams traverse this shared link. Also, ignore the slow-start phase of TCP and assume the TCP connections are operating in CA mode (AIMD) at all times.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark352" class="a">Figure 3.55</a> <span class="p">plots the throughput realized by the two TCP connections. If TCP is to share the link bandwidth equally between the two connections, then the realized throughput should fall along the 45- degree arrow (equal bandwidth share) emanating from the origin. Ideally, the sum of the two</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">throughputs should equal <i>R</i>. (Certainly, each connection receiving an equal, but zero, share of the link capacity is not a desirable situation!) So the goal should be to have the achieved throughputs fall somewhere near the intersection of the equal bandwidth share line and the full bandwidth utilization line</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark352" class="s124">in </a><a href="#bookmark352" class="a">Figure 3.5</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Suppose that the TCP window sizes are such that at a given point in time, connections 1 and 2 realize throughputs indicated by point <i>A </i><a href="#bookmark352" class="s124">in </a><a href="#bookmark352" class="a">Figure 3.5</a><span class="s20">5</span>. Because the amount of link bandwidth jointly consumed by the two connections is less than <i>R</i>, no loss will occur, and both connections will increase their</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">window by 1 MSS per RTT as a result of TCP’s congestion-avoidance algorithm. Thus, the joint</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">throughput of the two connections proceeds along a 45-degree line (equal increase for both</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">connections) starting from point <i>A</i>. Eventually, the link bandwidth jointly consumed by the two connections will be greater than <i>R, </i>and eventually packet loss will occur. Suppose that connections 1 and 2 experience packet loss when they realize throughputs indicated by point <i>B</i>. Connections 1 and 2 then decrease their windows by a factor of two. The resulting throughputs realized are thus at point <i>C, </i>halfway along a vector starting at <i>B </i>and ending at the origin. Because the joint bandwidth use is less than <i>R </i>at point <i>C, </i>the two connections again increase their throughputs along a 45-degree line starting from <i>C</i>. Eventually, loss will again occur, for example, at point <i>D, </i>and the two connections again</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">decrease their window sizes by a factor of two, and so on. You should convince yourself that the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">bandwidth realized by the two connections eventually fluctuates along the equal bandwidth share line. You should also convince</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="429" height="424" alt="image" src="计算机网络自顶向下7th-en/Image_370.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark352">Figure 3.55 Throughput realized by TCP connections 1 and 2</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">yourself that the two connections will converge to this behavior regardless of where they are in the two- dimensional space! Although a number of idealized assumptions lie behind this scenario, it still provides an intuitive feel for why TCP results in an equal sharing of bandwidth among connections.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In our idealized scenario, we assumed that only TCP connections traverse the bottleneck link, that the connections have the same RTT value, and that only a single TCP connection is associated with a host- destination pair. In practice, these conditions are typically not met, and client-server applications can thus obtain very unequal portions of link bandwidth. In particular, it has been shown that when multiple connections share a common bottleneck, those sessions with a smaller RTT are able to grab the available bandwidth at that link more quickly as it becomes free (that is, open their congestion windows</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">faster) and thus will enjoy higher throughput than those connections with larger RTTs </a><a href="#bookmark848" class="a">[Lakshman</a></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark353">1997]</a><span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Fairness and UDP</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We have just seen how TCP congestion control regulates an application’s transmission rate via the congestion window mechanism. Many multimedia applications, such as Internet phone and video conferencing, often do not run over TCP for this very reason—they do not want their transmission rate throttled, even if the network is very congested. Instead, these applications prefer to run over UDP, which does not have built-in congestion control. When running over UDP, applications can pump their audio and video into the network at a constant rate and occasionally lose packets, rather than reduce their rates to “fair” levels at times of congestion and not lose any packets. From the perspective of TCP, the multimedia applications running over UDP are not being fair—they do not cooperate with the other connections nor adjust their transmission rates appropriately. Because TCP congestion control will decrease its transmission rate in the face of increasing congestion (loss), while UDP sources need not, it is possible for UDP sources to crowd out TCP traffic. An area of research today is thus the development of congestion-control mechanisms for the Internet that prevent UDP traffic from bringing</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">the Internet’s throughput to a grinding halt </a><a href="#bookmark848" class="a">[Floyd 199</a>9<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Floyd 200</a>0<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Kohler 200</a>6<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 4340</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Fairness and Parallel TCP Connections</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">But even if we could force UDP traffic to behave fairly, the fairness problem would still not be completely solved. This is because there is nothing to stop a TCP-based application from using multiple parallel connections. For example, Web browsers often use multiple parallel TCP connections to transfer the multiple objects within a Web page. (The exact number of multiple connections is configurable in most browsers.) When an application uses multiple parallel connections, it gets a larger fraction of the</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">bandwidth in a congested link. As an example, consider a link of rate <i>R </i>supporting nine ongoing client- server applications, with each of the applications using one TCP connection. If a new application comes along and also uses one TCP connection, then each application gets approximately the same</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">transmission rate of <i>R</i>/10. But if this new application instead uses 11 parallel TCP connections, then the new application gets an unfair allocation of more than <i>R</i>/2. Because Web traffic is so pervasive in the Internet, multiple parallel connections are not uncommon.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Explicit Congestion Notification (ECN): Network-assisted Congestion Control</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark848" class="s124">Since the initial standardization of slow start and congestion avoidance in the late 1980’s </a><a href="#bookmark848" class="a">[RFC </a>1122]<a href="#bookmark353" class="s124">, TCP has implemented the form of end-end congestion control that we studied in </a><a href="#bookmark353" class="a">Section 3.7.</a>1<span class="p">: a TCP sender receives no explicit congestion indications from the network layer, and instead infers congestion</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">through observed packet loss. More recently, extensions to both IP and TCP </a><a href="#bookmark848" class="a">[RFC 3168]</a> <span class="p">have been proposed, implemented, and deployed that allow the network to explicitly signal congestion to a TCP</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 147%;text-align: left;"><span class="p">sender and receiver. This form of network-assisted congestion control is known as </span>Explicit Congestion <span class="s23">Notification</span><a href="#bookmark354" class="s124">. As shown in </a><a href="#bookmark354" class="a">Figure 3.5</a>6<span class="p">, the TCP and IP protocols are involved.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark423" class="s124">At the network layer, two bits (with four possible values, overall) in the Type of Service field of the IP datagram header (which we’ll discuss in </a><a href="#bookmark423" class="a">Section 4.</a>3<span class="p">) are used for ECN. One setting of the ECN bits is</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">used by a router to indicate that it (the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="681" height="374" alt="image" src="计算机网络自顶向下7th-en/Image_371.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark354">Figure 3.56 Explicit Congestion Notification: network-assisted congestion control</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark354" class="s124">router) is experiencing congestion. This congestion indication is then carried in the marked IP datagram to the destination host, which then informs the sending host, as shown in </a><a href="#bookmark354" class="a">Figure 3.5</a>6<span class="p">. RFC 3168 does</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">not provide a definition of when a router is congested; that decision is a configuration choice made possible by the router vendor, and decided by the network operator. However, RFC 3168 does recommend that an ECN congestion indication be set only in the face of persistent congestion. A  second setting of the ECN bits is used by the sending host to inform routers that the sender and receiver are ECN-capable, and thus capable of taking action in response to ECN-indicated network congestion.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark354" class="s124">As shown in </a><a href="#bookmark354" class="a">Figure 3.5</a>6<span class="p">, when the TCP in the receiving host receives an ECN congestion indication via a received datagram, the TCP in the receiving host informs the TCP in the sending host of the</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark296" class="s124">congestion indication by setting the ECE (Explicit Congestion Notification Echo) bit (see </a><a href="#bookmark296" class="a">Figure 3.2</a>9<span class="p">) in a receiver-to-sender TCP ACK segment. The TCP sender, in turn, reacts to an ACK with an ECE congestion indication by halving the congestion window, as it would react to a lost segment using fast</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">retransmit, and sets the CWR (Congestion Window Reduced) bit in the header of the next transmitted TCP sender-to-receiver segment.</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark355">Other transport-layer protocols besides TCP may also make use of network-layer-signaled ECN. The Datagram Congestion Control Protocol (DCCP) </a><a href="#bookmark848" class="a">[RFC 4340]</a> <a href="#bookmark848" class="s124">provides a low-overhead, congestion- controlled UDP-like unreliable service that utilizes ECN. DCTCP (Data Center TCP) </a><a href="#bookmark848" class="a">[Alizadeh 2010</a>]<span class="p">, a</span><a name="bookmark356">&zwnj;</a></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">version of TCP designed specifically for data center networks, also makes use of ECN.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l164"><ol id="l165"><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark357">Summary</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We began this chapter by studying the services that a transport-layer protocol can provide to network applications. At one extreme, the transport-layer protocol can be very simple and offer a no-frills service to applications, providing only a multiplexing/demultiplexing function for communicating processes. The Internet’s UDP protocol is an example of such a no-frills transport-layer protocol. At the other extreme, a transport-layer protocol can provide a variety of guarantees to applications, such as reliable delivery of data, delay guarantees, and bandwidth guarantees. Nevertheless, the services that a transport protocol can provide are often constrained by the service model of the underlying network-layer protocol. If the network-layer protocol cannot provide delay or bandwidth guarantees to transport-layer segments, then the transport-layer protocol cannot provide delay or bandwidth guarantees for the messages sent between processes.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark298" class="s124">We learned in </a><a href="#bookmark298" class="a">Section 3.4</a> <span class="p">that a transport-layer protocol can provide reliable data transfer even if the underlying network layer is unreliable. We saw that providing reliable data transfer has many subtle points, but that the task can be accomplished by carefully combining acknowledgments, timers,</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">retransmissions, and sequence numbers.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although we covered reliable data transfer in this chapter, we should keep in mind that reliable data transfer can be provided by link-, network-, transport-, or application-layer protocols. Any of the upper four layers of the protocol stack can implement acknowledgments, timers, retransmissions, and sequence numbers and provide reliable data transfer to the layer above. In fact, over the years, engineers and computer scientists have independently designed and implemented link-, network-, transport-, and application-layer protocols that provide reliable data transfer (although many of these protocols have quietly disappeared).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark329" class="s124">In </a><a href="#bookmark329" class="a">Section 3.</a>5<span class="p">, we took a close look at TCP, the Internet’s connection-oriented and reliable transport- layer protocol. We learned that TCP is complex, involving connection management, flow control, and round-trip time estimation, as well as reliable data transfer. In fact, TCP is actually more complex than</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">our description—we intentionally did not discuss a variety of TCP patches, fixes, and improvements that are widely implemented in various versions of TCP. All of this complexity, however, is hidden from the network application. If a client on one host wants to send data reliably to a server on another host, it simply opens a TCP socket to the server and pumps data into that socket. The client-server application is blissfully unaware of TCP’s complexity.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark341" class="s124">In </a><a href="#bookmark341" class="a">Section 3.</a>6<a href="#bookmark355" class="s124">, we examined congestion control from a broad perspective, and in </a><a href="#bookmark355" class="a">Section 3.</a>7<span class="p">, we showed how TCP implements congestion control. We learned that congestion control is imperative for</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">the well-being of the network. Without congestion control, a network can easily become gridlocked, with</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark355" class="s124">little or no data being transported end-to-end. In </a><a href="#bookmark355" class="a">Section 3.7</a> <span class="p">we learned that TCP implements an end- to-end congestion-control mechanism that additively increases its transmission rate when the TCP connection’s path is judged to be congestion-free, and multiplicatively decreases its transmission rate</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">when loss occurs. This mechanism also strives to give each TCP connection passing through a congested link an equal share of the link bandwidth. We also examined in some depth the impact of TCP connection establishment and slow start on latency. We observed that in many important scenarios, connection establishment and slow start significantly contribute to end-to-end delay. We emphasize once more that while TCP congestion control has evolved over the years, it remains an area of intensive research and will likely continue to evolve in the upcoming years.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Our discussion of specific Internet transport protocols in this chapter has focused on UDP and TCP—the two “work horses” of the Internet transport layer. However, two decades of experience with these two protocols has identified circumstances in which neither is ideally suited. Researchers have thus been busy developing additional transport-layer protocols, several of which are now IETF proposed  standards.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">The Datagram Congestion Control Protocol (DCCP) </a><a href="#bookmark848" class="a">[RFC 4340]</a> <span class="p">provides a low-overhead, message- oriented, UDP-like unreliable service, but with an application-selected form of congestion control that is compatible with TCP. If reliable or semi-reliable data transfer is needed by an application, then this</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">would be performed within the application itself, perhaps using the mechanisms we have studied in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark298" class="a">Section 3.</a>4<a href="#bookmark775" class="s124">. DCCP is envisioned for use in applications such as streaming media (see </a><a href="#bookmark775" class="a">Chapter </a>9<span class="p">) that can exploit the tradeoff between timeliness and reliability of data delivery, but that want to be responsive to network congestion.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Google’s QUIC (Quick UDP Internet Connections) protocol [Iyengar 2016], implemented in Google’s Chromium browser, provides reliability via retransmission as well as error correction, fast-connection setup, and a rate-based congestion control algorithm that aims to be TCP friendly—all implemented as an application-level protocol on top of UDP. In early 2015, Google reported that roughly half of all requests from Chrome to Google servers are served over QUIC.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">DCTCP (Data Center TCP) </a><a href="#bookmark848" class="a">[Alizadeh 2010]</a> <span class="p">is a version of TCP designed specifically for data center networks, and uses ECN to better support the mix of short- and long-lived flows that characterize data center workloads.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">The Stream Control Transmission Protocol (SCTP) </a><a href="#bookmark848" class="a">[RFC </a>4960<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">RFC 3286]</a> <span class="p">is a reliable, message- oriented protocol that allows several different application-level “streams” to be multiplexed through a single SCTP connection (an approach known as “multi-streaming”). From a reliability standpoint, the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">different streams within the connection are handled separately, so that packet loss in one stream does not affect the delivery of data in other streams. QUIC provides similar multi-stream semantics. SCTP</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark358">also allows data to be transferred over two outgoing paths when a host is connected to two or more networks, optional delivery of out-of-order data, and a number of other features. SCTP’s flow- and congestion-control algorithms are essentially the same as in TCP.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark848" class="s124">The TCP-Friendly Rate Control (TFRC) protocol </a><a href="#bookmark848" class="a">[RFC 5348]</a> <span class="p">is a congestion-control protocol rather than a full-fledged transport-layer protocol. It specifies a congestion-control mechanism that could be used in another transport protocol such as DCCP (indeed one of the two application-selectable protocols</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark349" class="s124">available in DCCP is TFRC). The goal of TFRC is to smooth out the “saw tooth” behavior (see </a><a href="#bookmark349" class="a">Figure 3.5</a>3<span class="p">) in TCP congestion control, while maintaining a long-term sending rate that is “reasonably” close to that of TCP. With a smoother sending rate than TCP, TFRC is well-suited for multimedia applications</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">such as IP telephony or streaming media where such a smooth rate is important. TFRC is an “equation-</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">based” protocol that uses the measured packet loss rate as input to an equation </a><a href="#bookmark848" class="a">[Padhye 2000]</a> <span class="p">that estimates what TCP’s throughput would be if a TCP session experiences that loss rate. This rate is then taken as TFRC’s target sending rate.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Only the future will tell whether DCCP, SCTP, QUIC, or TFRC will see widespread deployment. While these protocols clearly provide enhanced capabilities over TCP and UDP, TCP and UDP have proven themselves “good enough” over the years. Whether “better” wins out over “good enough” will depend on a complex mix of technical, social, and business considerations.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark5" class="s124">In </a><a href="#bookmark5" class="a">Chapter </a>1<span class="p">, we said that a computer network can be partitioned into the “network edge” and the “network core.” The network edge covers everything that happens in the end systems. Having now covered the application layer and the transport layer, our discussion of the network edge is complete. It</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark513" class="s124">is time to explore the network core! This journey begins in the next two chapters, where we’ll study the network layer, and continues into </a><a href="#bookmark513" class="a">Chapter </a>6<span class="p">, where we’ll study the link layer.</span></p><p class="s18" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark359">Homework Problems and Questions</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Chapter 3 Review Questions</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTIONS 3.1–3.3</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;">R1. Suppose the network layer provides the following service. The network layer in the source host accepts a segment of maximum size 1,200 bytes and a destination host address from the transport layer. The network layer then guarantees to deliver the segment to the transport layer</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">at the destination host. Suppose many network application processes can be running at the destination host.</p><ol id="l166"><li style="padding-top: 1pt;padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Design the simplest possible transport-layer protocol that will get application data to the desired process at the destination host. Assume the operating system in the destination</p><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;text-align: left;">host has assigned a 4-byte port number to each running application process.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Modify this protocol so that it provides a “return address” to the destination process.</p></li><li style="padding-top: 4pt;padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">In your protocols, does the transport layer “have to do anything” in the core of the computer network?</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R2. Consider a planet where everyone belongs to a family of six, every family lives in its own house, each house has a unique address, and each person in a given house has a unique name. Suppose this planet has a mail service that delivers letters from source house to</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">destination house. The mail service requires that (1) the letter be in an envelope, and that (2) the address of the destination house (and nothing more) be clearly written on the envelope. Suppose each family has a delegate family member who collects and distributes letters for the other family members. The letters do not necessarily provide any indication of the recipients of the letters.</p><ol id="l167"><li style="padding-top: 1pt;padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Using the solution to Problem R1 above as inspiration, describe a protocol that the delegates can use to deliver letters from a sending family member to a receiving family</p><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;text-align: left;">member.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">In your protocol, does the mail service ever have to open the envelope and examine the letter in order to provide its service?</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R3. Consider a TCP connection between Host A and Host B. Suppose that the TCP segments traveling from Host A to Host B have source port number <i>x </i>and destination port number <i>y</i>. What are the source and destination port numbers for the segments traveling from Host B to Host A?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R4. Describe why an application developer might choose to run an application over UDP rather than TCP.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R5. Why is it that voice and video traffic is often sent over TCP rather than UDP in today’s Internet? (<i>Hint</i>: The answer we are looking for has nothing to do with TCP’s congestion-control mechanism.)</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R6. Is it possible for an application to enjoy reliable data transfer even when the application runs over UDP? If so, how?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;">R7. Suppose a process in Host C has a UDP socket with port number 6789. Suppose both Host A and Host B each send a UDP segment to Host C with destination port number 6789. Will both of these segments be directed to the same socket at Host C? If so, how will the process at Host</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">C know that these two segments originated from two different hosts?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R8. Suppose that a Web server runs in Host C on port 80. Suppose this Web server uses persistent connections, and is currently receiving requests from two different Hosts, A and B. Are all of the requests being sent through the same socket at Host C? If they are being passed</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">through different sockets, do both of the sockets have port 80? Discuss and explain.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 3.4</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 145%;text-align: left;">R9. In our <span class="s30">rdt </span>protocols, why did we need to introduce sequence numbers? R10. In our <span class="s30">rdt </span>protocols, why did we need to introduce timers?</p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;">R11. Suppose that the roundtrip delay between sender and receiver is constant and known to the sender. Would a timer still be necessary in protocol <span class="s30">rdt 3.0 </span>, assuming that packets can be lost? Explain.</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: justify;">R12. Visit the Go-Back-N Java applet at the companion Web site.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l168"><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Have the source send five packets, and then pause the animation before any of the five packets reach the destination. Then kill the first packet and resume the animation.</p><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;text-align: left;">Describe what happens.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Repeat the experiment, but now let the first packet reach the destination and kill the first acknowledgment. Describe again what happens.</p></li><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Finally, try sending six packets. What happens?</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R13. Repeat R12, but now with the Selective Repeat Java applet. How are Selective Repeat and Go-Back-N different?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 3.5</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R14. True or false?</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l169"><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Host A is sending Host B a large file over a TCP connection. Assume Host B has no data to send Host A. Host B will not send acknowledgments to Host A because Host B cannot</p><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;text-align: left;">piggyback the acknowledgments on data.</p></li><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The size of the TCP <span class="s30">rwnd </span>never changes throughout the duration of the connection.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose Host A is sending Host B a large file over a TCP connection. The number of unacknowledged bytes that A sends cannot exceed the size of the receive buffer.</p></li><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;line-height: 134%;text-align: left;"><p style="display: inline;">Suppose Host A is sending a large file to Host B over a TCP connection. If the sequence number for a segment of this connection is <i>m</i>, then the sequence number for the subsequent segment will necessarily be m+1.</p></li><li style="padding-top: 2pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The TCP segment has a field in its header for <span class="s30">rwnd </span>.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 90pt;text-indent: -15pt;line-height: 129%;text-align: left;"><p style="display: inline;">Suppose that the last <span class="s30">SampleRTT </span>in a TCP connection is equal to 1 sec. The current value of <span class="s30">TimeoutInterval </span>for the connection will necessarily be <span class="s27">≥</span>1 sec.</p></li><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose Host A sends one segment with sequence number 38 and 4 bytes of data over a TCP connection to Host B. In this same segment the acknowledgment number is</p></li></ol><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;text-align: left;">necessarily 42.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R15. Suppose Host A sends two TCP segments back to back to Host B over a TCP connection. The first segment has sequence number 90; the second has sequence number 110.</p><ol id="l170"><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">How much data is in the first segment?</p></li><li style="padding-top: 4pt;padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose that the first segment is lost but the second segment arrives at B. In the acknowledgment that Host B sends to Host A, what will be the acknowledgment number?</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark329" class="s124">R16. Consider the Telnet example discussed in </a><a href="#bookmark329" class="a">Section 3.5</a> <span class="p">. A few seconds after the user types the letter ‘C,’ the user types the letter ‘R.’ After typing the letter ‘R,’ how many segments are sent, and what is put in the sequence number and acknowledgment fields of the segments?</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 3.7</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R17. Suppose two TCP connections are present over some bottleneck link of rate <i>R </i>bps. Both connections have a huge file to send (in the same direction over the bottleneck link). The transmissions of the files start at the same time. What transmission rate would TCP like to give</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">to each of the connections?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">R18. True or false? Consider congestion control in TCP. When the timer expires at the sender, the value of <span class="s30">ssthresh </span>is set to one half of its previous value.</p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 127%;text-align: left;"><a href="#bookmark355" class="s124">R19. In the discussion of TCP splitting in the sidebar in </a><a href="#bookmark355" class="a">Section 3.7</a><span class="s20"> </span>, it was claimed that the response time with TCP splitting is approximately 4<span class="s29">⋅</span>RTTFE+RTTBE+processing time. Justify this claim.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Problems</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">P1. Suppose Client A initiates a Telnet session with Server S. At about the same time, Client B</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">also initiates a Telnet session with Server S. Provide possible source and destination port numbers for</p><ol id="l171"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The segments sent from A to S.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The segments sent from B to S.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The segments sent from S to A.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The segments sent from S to B.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If A and B are different hosts, is it possible that the source port number in the segments from A to S is the same as that from B to S?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -15pt;text-align: left;"><p style="display: inline;">How about if they are the same host?</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark265" class="s124">P2. Consider </a><a href="#bookmark265" class="a">Figure 3.5</a> <span class="p">. What are the source and destination port values in the segments flowing from the server back to the clients’ processes? What are the IP addresses in the network-layer datagrams carrying the transport-layer segments?</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">P3. UDP and TCP use 1s complement for their checksums. Suppose you have the following three 8-bit bytes: 01010011, 01100110, 01110100. What is the 1s complement of the sum of these 8-bit bytes? (Note that although UDP and TCP use 16-bit words in computing the</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">checksum, for this problem you are being asked to consider 8-bit sums.) Show all work. Why is it that UDP takes the 1s complement of the sum; that is, why not just use the sum? With the 1s complement scheme, how does the receiver detect errors? Is it possible that a 1-bit error will go undetected? How about a 2-bit error?</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">P4.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l172"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose you have the following 2 bytes: 01011100 and 01100101. What is the 1s complement of the sum of these 2 bytes?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose you have the following 2 bytes: 11011010 and 01100101. What is the 1s complement of the sum of these 2 bytes?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">For the bytes in part (a), give an example where one bit is flipped in each of the 2 bytes and yet the 1s complement doesn’t change.</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P5. Suppose that the UDP receiver computes the Internet checksum for the received UDP segment and finds that it matches the value carried in the checksum field. Can the receiver be absolutely certain that no bit errors have occurred? Explain.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 137%;text-align: justify;"><span class="p">P6. Consider our motivation for correcting protocol </span><span class="s30">rdt2.1 </span><a href="#bookmark360" class="s124">. Show that the receiver, shown in </a><a href="#bookmark360" class="a">Figure 3.57</a> <a href="#bookmark277" class="s124">, when operating with the sender shown in </a><a href="#bookmark277" class="a">Figure 3.11</a> <span class="p">, can lead the sender and receiver to enter into a deadlock state, where each is waiting for an event that will never occur.</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P7. In protocol <span class="s30">rdt3.0 </span>, the ACK packets flowing from the receiver to the sender do not have sequence numbers (although they do have an ACK field that contains the sequence number of the packet they are acknowledging). Why is it that our ACK packets do not require sequence</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">numbers?</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="722" height="406" alt="image" src="计算机网络自顶向下7th-en/Image_372.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s44" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark360">Figure</a><span class="h2"> 3.57 An incorrect receiver for protocol </span><span class="s45">rdt 2.1</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P8. Draw the FSM for the receiver side of protocol <span class="s30">rdt3.0 </span>.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">P9. Give a trace of the operation of protocol <span class="s30">rdt3.0 </span><a href="#bookmark283" class="s124">when data packets and acknowledgment packets are garbled. Your trace should be similar to that used in </a><a href="#bookmark283" class="a">Figure 3.16</a><span class="s20"> </span>.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">P10. Consider a channel that can lose packets but has a maximum delay that is known. Modify protocol <span class="s30">rdt2.1 </span>to include sender timeout and retransmit. Informally argue why your protocol can communicate correctly over this channel.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P11. Consider the <span class="s30">rdt2.2 </span><a href="#bookmark280" class="s124">receiver in </a><a href="#bookmark280" class="a">Figure 3.14</a><span class="s20"> </span>, and the creation of a new packet in the self-transition (i.e., the transition from the state back to itself) in the Wait-for-0-from-below and</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">the Wait-for-1-from-below states:  <span class="s30">sndpkt=make_pkt(ACK, 1, checksum) </span>and <span class="s30">sndpkt=make_pkt(ACK, 0, checksum) </span>. Would the protocol work correctly if this action were removed from the self-transition in the Wait-for-1-from-below state? Justify your answer.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">What if this event were removed from the self-transition in the Wait-for-0-from-below state? [<i>Hint</i>: In this latter case, consider what would happen if the first sender-to-receiver packet were corrupted.]</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">P12. The sender side of <span class="s30">rdt3.0 </span>simply ignores (that is, takes no action on) all received packets that are either in error or have the wrong value in the <span class="s30">acknum </span>field of an acknowledgment packet. Suppose that in such circumstances,  <span class="s30">rdt3.0 </span>were simply to retransmit the current data packet. Would the protocol still work? (<i>Hint</i>: Consider what would</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">happen if there were only bit errors; there are no packet losses but premature timeouts can</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">occur. Consider how many times the <i>n</i>th packet is sent, in the limit as <i>n </i>approaches infinity.)</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P13. Consider the <span class="s30">rdt 3.0 </span>protocol. Draw a diagram showing that if the network connection between the sender and receiver can reorder messages (that is, that two messages propagating in the medium between the sender and receiver can be reordered), then the alternating-bit</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">protocol will not work correctly (make sure you clearly identify the sense in which it will not work correctly). Your diagram should have the sender on the left and the receiver on the right, with the time axis running down the page, showing data (D) and acknowledgment (A) message exchange. Make sure you indicate the sequence number associated with any data or acknowledgment segment.</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P14. Consider a reliable data transfer protocol that uses only negative acknowledgments. Suppose the sender sends data only infrequently. Would a NAK-only protocol be preferable to a protocol that uses ACKs? Why? Now suppose the sender has a lot of data to send and the end-</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">to-end connection experiences few losses. In this second case, would a NAK-only protocol be preferable to a protocol that uses ACKs? Why?</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark284" class="s124">P15. Consider the cross-country example shown in </a><a href="#bookmark284" class="a">Figure 3.17</a> <span class="p">. How big would the window size have to be for the channel utilization to be greater than 98 percent? Suppose that the size of a packet is 1,500 bytes, including both header fields and data.</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P16. Suppose an application uses <span class="s30">rdt 3.0 </span>as its transport layer protocol. As the stop-and-wait protocol has very low channel utilization (shown in the cross-country example), the designers of this application let the receiver keep sending back a number (more than two) of alternating ACK</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">0 and ACK 1 even if the corresponding data have not arrived at the receiver. Would this application design increase the channel utilization? Why? Are there any potential problems with this approach? Explain.</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P17. Consider two network entities, A and B, which are connected by a perfect bi-directional channel (i.e., any message sent will be received correctly; the channel will not corrupt, lose, or re-order packets). A and B are to deliver data messages to each other in an alternating manner:</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">First, A must deliver a message to B, then B must deliver a message to A, then A must deliver a message to B and so on. If an entity is in a state where it should not attempt to deliver a message to the other side, and there is an event like <span class="s30">rdt_send(data) </span>call from above that</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">attempts to pass data down for transmission to the other side, this call from above can simply be</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">ignored with a call to <span class="s30">rdt_unable_to_send(data) </span>, which informs the higher layer that it is currently not able to send data. [Note: This simplifying assumption is made so you don’t have to worry about buffering data.]</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Draw a FSM specification for this protocol (one FSM for A, and one FSM for B!). Note that you  do not have to worry about a reliability mechanism here; the main point of this question is to create a FSM specification that reflects the synchronized behavior of the two entities. You should</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark275" class="s124">use the following events and actions that have the same meaning as protocol rdt1.0 in </a><a href="#bookmark275" class="a">Figure</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;"><a href="#bookmark275" class="a">3.9</a><span class="s20"> </span>:  <span class="s30">rdt_send(data), packet = make_pkt(data) </span>,  <span class="s30">udt_send(packet), rdt_rcv(packet) </span>,  <span class="s30">extract (packet, data), deliver_data(data) </span>. Make sure your protocol reflects the strict alternation of sending between A and B. Also, make sure to indicate the initial states for A and B in your FSM descriptions.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark299" class="s124">P18. In the generic SR protocol that we studied in </a><a href="#bookmark299" class="a">Section 3.4.4</a> <span class="p">, the sender transmits a message as soon as it is available (if it is in the window) without waiting for an acknowledgment. Suppose now that we want an SR protocol that sends messages two at a time. That is, the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">sender will send a pair of messages and will send the next pair of messages only when it knows that both messages in the first pair have been received correctly.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Suppose that the channel may lose messages but will not corrupt or reorder messages. Design an error-control protocol for the unidirectional reliable transfer of messages. Give an FSM description of the sender and receiver. Describe the format of the packets sent between sender</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark298" class="s124">and receiver, and vice versa. If you use any procedure calls other than those in </a><a href="#bookmark298" class="a">Section 3.4</a><span class="s20"> </span>(for example, <span class="s30">udt_send() </span>, <span class="s30">start_timer() </span>, <span class="s30">rdt_rcv() </span>, and so on), clearly state their actions. Give an example (a timeline trace of sender and receiver) showing how your protocol</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">recovers from a lost packet.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P19. Consider a scenario in which Host A wants to simultaneously send packets to Hosts B and</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">C. A is connected to B and C via a broadcast channel—a packet sent by A is carried by the channel to both B and C. Suppose that the broadcast channel connecting A, B, and C can independently lose and corrupt packets (and so, for example, a packet sent from A might be correctly received by B, but not by C). Design a stop-and-wait-like error-control protocol for reliably transferring packets from A to B and C, such that A will not get new data from the upper layer until it knows that both B and C have correctly received the current packet. Give FSM</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">descriptions of A and C. (<i>Hint: </i>The FSM for B should be essentially the same as for C.) Also, give a description of the packet format(s) used.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P20. Consider a scenario in which Host A and Host B want to send messages to Host C. Hosts A and C are connected by a channel that can lose and corrupt (but not reorder) messages. Hosts B and C are connected by another channel (independent of the channel connecting A and</p><ol id="l173"><li style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><p style="display: inline;">with the same properties. The transport layer at Host C should alternate in delivering messages from A and B to the layer above (that is, it should first deliver the data from a packet from A, then the data from a packet from B, and so on). Design a stop-and-wait-like error-control protocol for reliably transferring packets from A and B to C, with alternating delivery at C as</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">described above. Give FSM descriptions of A and C. (<i>Hint: </i>The FSM for B should be essentially the same as for A.) Also, give a description of the packet format(s) used.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">P21. Suppose we have two network entities, A and B. B has a supply of data messages that will be sent to A according to the following conventions. When A gets a request from the layer above to get the next data (D) message from B, A must send a request (R) message to B on the A-to-B</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">channel. Only when B receives an R message can it send a data (D) message back to A on the B-to-A channel. A should deliver exactly one copy of each D message to the layer above. R messages can be lost (but not corrupted) in the A-to-B channel; D messages, once sent, are always delivered correctly. The delay along both channels is unknown and variable.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Design (give an FSM description of) a protocol that incorporates the appropriate mechanisms to compensate for the loss-prone A-to-B channel and implements message passing to the layer above at entity A, as discussed above. Use only those mechanisms that are absolutely</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">necessary.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">P22. Consider the GBN protocol with a sender window size of 4 and a sequence number range of 1,024. Suppose that at time <i>t</i>, the next in-order packet that the receiver is expecting has a sequence number of <i>k</i>. Assume that the medium does not reorder messages. Answer the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">following questions:</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l174"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What are the possible sets of sequence numbers inside the sender’s window at time <i>t</i>?</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">Justify your answer.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 139%;text-align: left;"><p style="display: inline;">What are all possible values of the ACK field in all possible messages currently propagating back to the sender at time <i>t</i>? Justify your answer.</p></li></ol></li></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P23. Consider the GBN and SR protocols. Suppose the sequence number space is of size <i>k</i>. What is the largest allowable sender window that will avoid the occurrence of problems such as</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark296" class="s124">that in </a><a href="#bookmark296" class="a">Figure 3.27</a> <span class="p">for each of these protocols?</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P24. Answer true or false to the following questions and briefly justify your answer:</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l175"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">With the SR protocol, it is possible for the sender to receive an ACK for a packet that falls outside of its current window.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">With GBN, it is possible for the sender to receive an ACK for a packet that falls outside of its current window.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The alternating-bit protocol is the same as the SR protocol with a sender and receiver window size of 1.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The alternating-bit protocol is the same as the GBN protocol with a sender and receiver window size of 1.</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P25. We have said that an application may choose UDP for a transport protocol because UDP offers finer application control (than TCP) of what data is sent in a segment and when.</p><ol id="l176"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Why does an application have more control of what data is sent in a segment?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Why does an application have more control on when the segment is sent?</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P26. Consider transferring an enormous file of <i>L </i>bytes from Host A to Host B. Assume an MSS of 536 bytes.</p><ol id="l177"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the maximum value of <i>L </i>such that TCP sequence numbers are not exhausted?</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">Recall that the TCP sequence number field has 4 bytes.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">For the <i>L </i>you obtain in (a), find how long it takes to transmit the file. Assume that a total of 66 bytes of transport, network, and data-link header are added to each segment</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">before the resulting packet is sent out over a 155 Mbps link. Ignore flow control and congestion control so A can pump out the segments back to back and continuously.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">P27. Host A and B are communicating over a TCP connection, and Host B has already received from A all bytes up through byte 126. Suppose Host A then sends two segments to Host B back- to-back. The first and second segments contain 80 and 40 bytes of data, respectively. In the first</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">segment, the sequence number is 127, the source port number is 302, and the destination port number is 80. Host B sends an acknowledgment whenever it receives a segment from Host A.</p><ol id="l178"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">In the second segment sent from Host A to B, what are the sequence number, source port number, and destination port number?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If the first segment arrives before the second segment, in the acknowledgment of the first arriving segment, what is the acknowledgment number, the source port number, and the</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">destination port number?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If the second segment arrives before the first segment, in the acknowledgment of the first arriving segment, what is the acknowledgment number?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose the two segments sent by A arrive in order at B. The first acknowledgment is lost and the second acknowledgment arrives after the first timeout interval. Draw a timing</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">diagram, showing these segments and all other segments and acknowledgments sent. (Assume there is no additional packet loss.) For each segment in your figure, provide the sequence number and the number of bytes of data; for each acknowledgment that you add, provide the acknowledgment number.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P28. Host A and B are directly connected with a 100 Mbps link. There is one TCP connection between the two hosts, and Host A is sending to Host B an enormous file over this connection. Host A can send its application data into its TCP socket at a rate as high as 120 Mbps but Host</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">B can read out of its TCP receive buffer at a maximum rate of 50 Mbps. Describe the effect of TCP flow control.</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark330" class="s124">P29. SYN cookies were discussed in </a><a href="#bookmark330" class="a">Section 3.5.6</a> <span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l179"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Why is it necessary for the server to use a special initial sequence number in the SYNACK?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose an attacker knows that a target host uses SYN cookies. Can the attacker create half-open or fully open connections by simply sending an ACK packet to the target? Why</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">or why not?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose an attacker collects a large amount of initial sequence numbers sent by the server. Can the attacker cause the server to create many fully open connections by</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">sending ACKs with those initial sequence numbers? Why?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark339" class="s124">P30. Consider the network shown in Scenario 2 in </a><a href="#bookmark339" class="a">Section 3.6.1</a> <span class="p">. Suppose both sending hosts A and B have some fixed timeout values.</span></p><ol id="l180"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 139%;text-align: left;"><p style="display: inline;">Argue that increasing the size of the finite buffer of the router might possibly decrease the throughput (λ<span class="s31">out</span>).</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Now suppose both hosts dynamically adjust their timeout values (like what TCP does) based on the buffering delay at the router. Would increasing the buffer size help to</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">increase the throughput? Why?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P31. Suppose that the five measured <span class="s30">SampleRTT </span><a href="#bookmark310" class="s124">values (see </a><a href="#bookmark310" class="a">Section 3.5.3</a><span class="s20"> </span>) are 106 ms, 120</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 133%;text-align: left;">ms, 140 ms, 90 ms, and 115 ms. Compute the <span class="s30">EstimatedRTT </span>after each of these SampleRTT values is obtained, using a value of <span class="s27">α</span>=0.125 and assuming that the value of <span class="s30">EstimatedRTT </span>was 100 ms just before the first of these five samples were obtained. Compute also the <span class="s30">DevRTT </span>after each sample is obtained, assuming a value of <span class="s27">β</span>=0.25 and assuming the value of <span class="s30">DevRTT </span>was 5 ms just before the first of these five samples was obtained. Last, compute the TCP</p><p class="s30" style="padding-top: 4pt;padding-left: 7pt;text-indent: 0pt;text-align: left;">TimeoutInterval <span class="p">after each of these samples is obtained.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;">P32. Consider the TCP procedure for estimating RTT. Suppose that <span class="s27">α</span>=0.1. Let <span class="s30">SampleRTT </span><span class="h4">1 </span>be the most recent sample RTT, let <span class="s30">SampleRTT </span><span class="h4">2 </span>be the next most recent sample RTT, and so on.</p><ol id="l181"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 16pt;text-align: left;"><p style="display: inline;">For a given TCP connection, suppose four acknowledgments have been returned with</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;">corresponding sample RTTs:  <span class="s30">SampleRTT </span><span class="h4">4</span>,  <span class="s30">SampleRTT </span><span class="h4">3</span>,  <span class="s30">SampleRTT </span><span class="h4">2</span>, and</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 50pt;text-indent: 0pt;text-align: left;">SampleRTT <span class="h4">1</span><span class="p">. Express </span>EstimatedRTT <span class="p">in terms of the four sample RTTs.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Generalize your formula for <i>n </i>sample RTTs.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">For the formula in part (b) let <i>n </i>approach infinity. Comment on why this averaging procedure is called an exponential moving average.</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark310" class="s124">P33. In </a><a href="#bookmark310" class="a">Section 3.5.3</a><span class="s20"> </span>, we discussed TCP’s estimation of RTT. Why do you think TCP avoids measuring the  <span class="s30">SampleRTT </span>for retransmitted segments?</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P34. What is the relationship between the variable <span class="s30">SendBase </span><a href="#bookmark320" class="s124">in </a><a href="#bookmark320" class="a">Section 3.5.4</a><span class="s20"> </span>and the variable</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 7pt;text-indent: 0pt;text-align: left;">LastByteRcvd <a href="#bookmark323" class="s124">in </a><a href="#bookmark323" class="a">Section 3.5.5</a><span class="s20"> </span><span class="p">?</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;"><span class="p">P35. What is the relationship between the variable </span><span class="s30">LastByteRcvd </span><a href="#bookmark323" class="s124">in </a><a href="#bookmark323" class="a">Section 3.5.5</a> <a href="#bookmark320" class="s124">and the variable y in Section </a><a href="#bookmark320" class="a">3.5.</a>4<span class="p">?</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark320" class="s124">P36. In </a><a href="#bookmark320" class="a">Section 3.5.4</a> <span class="p">, we saw that TCP waits until it has received three duplicate ACKs before performing a fast retransmit. Why do you think the TCP designers chose not to perform a fast retransmit after the first duplicate ACK for a segment is received?</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P37. Compare GBN, SR, and TCP (no delayed ACK). Assume that the timeout values for all three protocols are sufficiently long such that 5 consecutive data segments and their corresponding ACKs can be received (if not lost in the channel) by the receiving host (Host B)</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">and the sending host (Host A) respectively. Suppose Host A sends 5 data segments to Host B, and the 2nd segment (sent from A) is lost. In the end, all 5 data segments have been correctly received by Host B.</p><ol id="l182"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">How many segments has Host A sent in total and how many ACKs has Host B sent in total? What are their sequence numbers? Answer this question for all three protocols.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If the timeout values for all three protocol are much longer than 5 RTT, then which protocol successfully delivers all five data segments in shortest time interval?</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark349" class="s124">P38. In our description of TCP in </a><a href="#bookmark349" class="a">Figure 3.53</a><span class="s20"> </span>, the value of the threshold, <span class="s30">ssthresh </span>, is set as <span class="s30">ssthresh=cwnd/2 </span>in several places and <span class="s30">ssthresh </span>value is referred to as being set to half the window size when a loss event occurred. Must the rate at which the sender is sending when</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the loss event occurred be approximately equal to <span class="s30">cwnd </span>segments per RTT? Explain your</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">answer. If your answer is no, can you suggest a different manner in which <span class="s30">ssthresh </span>should be set?</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark337" class="s124">P39. Consider </a><a href="#bookmark337" class="a">Figure 3.46(b)</a><span class="s20"> </span>. If <span class="s27">λ</span>′in increases beyond <i>R</i>/2, can λ<span class="s22">out </span>increase beyond <i>R</i><a href="#bookmark337" class="s124">/3? Explain. Now consider </a><a href="#bookmark337" class="a">Figure 3.46(c)</a><span class="s20"> </span>. If <span class="s27">λ</span>′in increases beyond <i>R</i>/2, can λ<span class="s22">out </span>increase beyond R/4 under the assumption that a packet will be forwarded twice on average from the router to the receiver? Explain.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark361" class="s124">P40. Consider </a><a href="#bookmark361" class="a">Figure 3.58</a> <span class="p">. Assuming TCP Reno is the protocol experiencing the behavior shown above, answer the following questions. In all cases, you should provide a short discussion justifying your answer.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Examining the behavior of TCP</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="730" height="199" alt="image" src="计算机网络自顶向下7th-en/Image_373.png"/></span></p><ol id="l183"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Identify the intervals of time when TCP slow start is operating.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Identify the intervals of time when TCP congestion avoidance is operating.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">After the 16th transmission round, is segment loss detected by a triple duplicate ACK or by a timeout?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">After the 22nd transmission round, is segment loss detected by a triple duplicate ACK or by a timeout?</p><p style="padding-top: 2pt;padding-left: 48pt;text-indent: 0pt;text-align: left;"><span><img width="467" height="362" alt="image" src="计算机网络自顶向下7th-en/Image_374.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-left: 48pt;text-indent: 0pt;text-align: left;"><a name="bookmark361">Figure 3.58 TCP window size as a function of time</a></h2></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the initial value of <span class="s30">ssthresh </span>at the first transmission round?</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -15pt;text-align: left;"><p style="display: inline;">What is the value of <span class="s30">ssthresh </span>at the 18th transmission round?</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the value of <span class="s30">ssthresh </span>at the 24th transmission round?</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">During what transmission round is the 70th segment sent?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -14pt;line-height: 125%;text-align: left;"><p style="display: inline;">Assuming a packet loss is detected after the 26th round by the receipt of a triple duplicate ACK, what will be the values of the congestion window size and of</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 50pt;text-indent: 0pt;text-align: left;">ssthresh <span class="p">?</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -14pt;line-height: 135%;text-align: left;"><p style="display: inline;">Suppose TCP Tahoe is used (instead of TCP Reno), and assume that triple duplicate ACKs are received at the 16th round. What are the <span class="s30">ssthresh </span>and the congestion window size at the 19th round?</p></li><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Again suppose TCP Tahoe is used, and there is a timeout event at 22nd round. How many packets have been sent out from 17th round till 22nd round, inclusive?</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark352" class="s124">P41. Refer to </a><a href="#bookmark352" class="a">Figure 3.55</a> <span class="p">, which illustrates the convergence of TCP’s AIMD algorithm. Suppose that instead of a multiplicative decrease, TCP decreased the window size by a constant amount. Would the resulting AIAD algorithm converge to an equal share algorithm? Justify your answer</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark352" class="s124">using a diagram similar to </a><a href="#bookmark352" class="a">Figure 3.55</a> <span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark320" class="s124">P42. In </a><a href="#bookmark320" class="a">Section 3.5.4</a> <span class="p">, we discussed the doubling of the timeout interval after a timeout event. This mechanism is a form of congestion control. Why does TCP need a window-based</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark355" class="s124">congestion-control mechanism (as studied in </a><a href="#bookmark355" class="a">Section 3.7</a> <span class="p">) in addition to this doubling-timeout- interval mechanism?</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P43. Host A is sending an enormous file to Host B over a TCP connection. Over this connection there is never any packet loss and the timers never expire. Denote the transmission rate of the</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 120%;text-align: left;">link connecting Host A to the Internet by <i>R </i>bps. Suppose that the process in Host A is capable of sending data into its TCP socket at a rate <i>S </i>bps, where <span class="s27">S=</span>10<span class="s29">⋅</span>R. Further suppose that the TCP receive buffer is large enough to hold the entire file, and the send buffer can hold only one</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">percent of the file. What would prevent the process in Host A from continuously passing data to</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">its TCP socket at rate <i>S </i>bps? TCP flow control? TCP congestion control? Or something else? Elaborate.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P44. Consider sending a large file from a host to another over a TCP connection that has no loss.</p><ol id="l184"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Suppose TCP uses AIMD for its congestion control without slow start. Assuming <span class="s30">cwnd</span></p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">increases by 1 MSS every time a batch of ACKs is received and assuming approximately</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 130%;text-align: left;">constant round-trip times, how long does it take for <span class="s30">cwnd </span>increase from 6 MSS to 12 MSS (assuming no loss events)?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">What is the average throughout (in terms of MSS and RTT) for this connection up through time=6 RTT?</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P45. Recall the macroscopic description of TCP throughput. In the period of time from when the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">connection’s rate varies from <i>W</i>/(2 · RTT) to <i>W/RTT</i>, only one packet is lost (at the very end of the period).</p><ol id="l185"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 139%;text-align: left;"><p style="display: inline;">Show that the loss rate (fraction of packets lost) is equal to L=loss rate=138W2+34W</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Use the result above to show that if a connection has loss rate <i>L</i>, then its average rate is approximately given by</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">≈1.22<span class="s29">⋅</span>MSSRTTL</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P46. Consider that only a single TCP (Reno) connection uses one 10Mbps link which does not buffer any data. Suppose that this link is the only congested link between the sending and receiving hosts. Assume that the TCP sender has a huge file to send to the receiver, and the</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">receiver’s receive buffer is much larger than the congestion window. We also make the following assumptions: each TCP segment size is 1,500 bytes; the two-way propagation delay of this connection is 150 msec; and this TCP connection is always in congestion avoidance phase, that is, ignore slow start.</p><ol id="l186"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the maximum window size (in segments) that this TCP connection can achieve?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">What is the average window size (in segments) and average throughput (in bps) of this TCP connection?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">How long would it take for this TCP connection to reach its maximum window again after recovering from a packet loss?</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P47. Consider the scenario described in the previous problem. Suppose that the 10Mbps link can buffer a finite number of segments. Argue that in order for the link to always be busy sending</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">data, we would like to choose a buffer size that is at least the product of the link speed <i>C </i>and the two-way propagation delay between the sender and the receiver.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P48. Repeat Problem 46, but replacing the 10 Mbps link with a 10 Gbps link. Note that in your answer to part c, you will realize that it takes a very long time for the congestion window size to reach its maximum window size after recovering from a packet loss. Sketch a solution to solve</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">this problem.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P49. Let <i>T </i>(measured by RTT) denote the time interval that a TCP connection takes to increase its congestion window size from <i>W/2 </i>to <i>W</i>, where <i>W </i>is the maximum congestion window size. Argue that T is a function of TCP’s average throughput.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P50. Consider a simplified TCP’s AIMD algorithm where the congestion window size is measured in number of segments, not in bytes. In additive increase, the congestion window size increases by one segment in each RTT. In multiplicative decrease, the congestion window size</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 158%;text-align: left;">decreases by half (if the result is not an integer, round down to the nearest integer). Suppose that two TCP connections, C<span class="s22">1 </span>and C<span class="s22">2</span>, share a single congested link of speed 30 segments per second. Assume that both C<span class="s22">1  </span>and C<span class="s22">2 </span>are in the congestion avoidance phase. Connection C<span class="s22">1</span>’s RTT is 50 msec and connection C<span class="s22">2</span>’s RTT is 100 msec. Assume that when the data rate in the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">link exceeds the link’s speed, all TCP connections experience data segment loss.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l187"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 134%;text-align: left;"><p style="display: inline;">If both C<span class="s22">1 </span>and C<span class="s22">2 </span>at time t<span class="s22">0 </span>have a congestion window of 10 segments, what are their congestion window sizes after 1000 msec?</p></li><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">In the long run, will these two connections get the same share of the bandwidth of the congested link? Explain.</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 143%;text-align: left;">P51. Consider the network described in the previous problem. Now suppose that the two TCP connections, C1 and C2, have the same RTT of 100 msec. Suppose that at time t<span class="s22">0</span>, C1’s congestion window size is 15 segments but C2’s congestion window size is 10 segments.</p><ol id="l188"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What are their congestion window sizes after 2200 msec?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">In the long run, will these two connections get about the same share of the bandwidth of the congested link?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">We say that two connections are synchronized, if both connections reach their maximum window sizes at the same time and reach their minimum window sizes at the same time.</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the long run, will these two connections get synchronized eventually? If so, what are their maximum window sizes?</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Will this synchronization help to improve the utilization of the shared link? Why? Sketch some idea to break this synchronization.</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P52. Consider a modification to TCP’s congestion control algorithm. Instead of additive increase, we can use multiplicative increase. A TCP sender increases its window size by a small positive constant a(0&lt;a&lt;1) whenever it receives a valid ACK. Find the functional relationship between</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">loss rate L and maximum congestion window W. Argue that for this modified TCP, regardless of TCP’s average throughput, a TCP connection always spends the same amount of time to increase its congestion window size from <i>W/2 </i>to <i>W</i>.</p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark355" class="s124">P53. In our discussion of TCP futures in </a><a href="#bookmark355" class="a">Section 3.7</a> <span class="p">, we noted that to achieve a throughput of</span></p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 126%;text-align: left;">10 Gbps, TCP could only tolerate a segment loss probability of 2<span class="s29">⋅</span>10−10 (or equivalently, one loss event for every 5,000,000,000 segments). Show the derivation for the values of 2<span class="s29">⋅</span>10−10 (1</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark355" class="s124">out of 5,000,000) for the RTT and MSS values given in </a><a href="#bookmark355" class="a">Section 3.7</a> <span class="p">. If TCP needed to support a 100 Gbps connection, what would the tolerable loss be?</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark355" class="s124">P54. In our discussion of TCP congestion control in </a><a href="#bookmark355" class="a">Section 3.7</a> <span class="p">, we implicitly assumed that the TCP sender always had data to send. Consider now the case that the TCP sender sends a large</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 152%;text-align: justify;">amount of data and then goes idle (since it has no more data to send) at <i>t</i><span class="s22">1</span>. TCP remains idle for a relatively long period of time and then wants to send more data at <i>t</i><span class="s22">2</span>. What are the advantages and disadvantages of having TCP use the <span class="s30">cwnd </span>and <span class="s30">ssthresh </span>values from <i>t</i><span class="s22">1 </span>when starting to send data at <i>t</i><span class="s22">2</span>? What alternative would you recommend? Why?</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P55. In this problem we investigate whether either UDP or TCP provides a degree of end-point authentication.</p><ol id="l189"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Consider a server that receives a request within a UDP packet and responds to that request within a UDP packet (for example, as done by a DNS server). If a client with IP</p><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;text-align: left;">address X spoofs its address with address Y, where will the server send its response?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose a server receives a SYN with IP source address Y, and after responding with a SYNACK, receives an ACK with IP source address Y with the correct acknowledgment</p></li></ol><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;line-height: 146%;text-align: left;">number. Assuming the server chooses a random initial sequence number and there is no “man-in-the-middle,” can the server be certain that the client is indeed at Y (and not at some other address X that is spoofing Y)?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">P56. In this problem, we consider the delay introduced by the TCP slow-start phase. Consider a client and a Web server directly connected by one link of rate <i>R</i>. Suppose the client wants to retrieve an object whose size is exactly equal to 15 <i>S</i>, where <i>S </i>is the maximum segment size</p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 12pt;text-align: left;">(MSS). Denote the round-trip time between client and server as RTT (assumed to be constant).</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">Ignoring protocol headers, determine the time to retrieve the object (including TCP connection establishment) when</p><ol id="l190"><li style="padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">4 S/R&gt;S/R+RTT&gt;2S/R</p></li><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">S/R+RTT&gt;4 S/R</p></li><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">S/R&gt;RTT<span class="s49">.</span></p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Programming Assignments</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Implementing a Reliable Transport Protocol</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this laboratory programming assignment, you will be writing the sending and receiving transport-level code for implementing a simple reliable data transfer protocol. There are two versions of this lab, the alternating-bit-protocol version and the GBN version. This lab should be fun—your implementation will differ very little from what would be required in a real-world situation.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Since you probably don’t have standalone machines (with an OS that you can modify), your code will have to execute in a simulated hardware/software environment. However, the programming interface provided to your routines—the code that would call your entities from above and from below—is very close to what is done in an actual UNIX environment. (Indeed, the software interfaces described in this programming assignment are much more realistic than the infinite loop senders and receivers that many texts describe.) Stopping and starting timers are also simulated, and timer interrupts will cause your timer handling routine to be activated.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources" class="s124" target="_blank">The full lab assignment, as well as code you will need to compile with your own code, are available at this book’s Web site: </a><a href="http://www.pearsonhighered.com/cs-resources" class="a" target="_blank">www.pearsonhighered.com/</a>cs-resources<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Wireshark Lab: Exploring TCP</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark362">In this lab, you’ll use your Web browser to access a file from a Web server. As in earlier Wireshark labs,</a><a name="bookmark363">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;">you’ll use Wireshark to capture the packets arriving at your computer. Unlike earlier labs, you’ll <i>also </i>be able to download a Wireshark-readable packet trace from the Web server from which you downloaded the file. In this server trace, you’ll find the packets that were generated by your own access of the Web</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">server. You’ll analyze the client- and server-side traces to explore aspects of TCP. In particular, you’ll evaluate the performance of the TCP connection between your computer and the Web server. You’ll trace TCP’s window behavior, and infer packet loss, retransmission, flow control and congestion control behavior, and estimated roundtrip time.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">As is the case with all Wireshark labs, the full description of this lab is available at this book’s Web site,</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources" class="a" target="_blank">www.pearsonhighered.com/</a>cs-resources<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Wireshark Lab: Exploring UDP</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark271" class="s124">In this short lab, you’ll do a packet capture and analysis of your favorite application that uses UDP (for example, DNS or a multimedia application such as Skype). As we learned in </a><a href="#bookmark271" class="a">Section 3.</a>3<span class="p">, UDP is a</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">simple, no-frills transport protocol. In this lab, you’ll investigate the header fields in the UDP segment as well as the checksum calculation.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">As is the case with all Wireshark labs, the full description of this lab is available at this book’s Web site,</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources" class="a" target="_blank">www.pearsonhighered.com/</a>cs-resources<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="511" alt="image" src="计算机网络自顶向下7th-en/Image_375.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">AN INTERVIEW WITH...</p><p class="s28" style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Van Jacobson</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Van Jacobson works at Google and was previously a Research Fellow at PARC. Prior to that, he was co-founder and Chief Scientist of Packet Design. Before that, he was Chief Scientist at Cisco. Before joining Cisco, he was head of the Network Research Group at Lawrence Berkeley National Laboratory and taught at UC Berkeley and Stanford. Van received the ACM SIGCOMM Award in 2001 for outstanding lifetime contribution to the field of communication networks and the IEEE Kobayashi Award in 2002 for “contributing to the understanding of network congestion and developing congestion control mechanisms that enabled the successful scaling of the Internet”. He was elected to the U.S. National Academy of Engineering in 2004.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_376.png"/></span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><span><img width="192" height="288" alt="image" src="计算机网络自顶向下7th-en/Image_377.gif"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s26" style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Please describe one or two of the most exciting projects you have worked on during your career.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What were the biggest challenges?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">School teaches us lots of ways to find answers. In every interesting problem I’ve worked on, the challenge has been finding the right question. When Mike Karels and I started looking at TCP congestion, we spent months staring at protocol and packet traces asking “Why is it failing?”. One day in Mike’s office, one of us said “The reason I can’t figure out why it fails is because I don’t understand how it ever worked to begin with.” That turned out to be the right question and it forced us to figure out the “ack clocking” that makes TCP work. After that, the rest was easy.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">More generally, where do you see the future of networking and the Internet?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark364">For most people, the Web is the Internet. Networking geeks smile politely since we know the Web is an application running over the Internet but what if they’re right? The Internet is about enabling conversations between pairs of hosts. The Web is about distributed information production and consumption. “Information propagation” is a very general view of communication of which “pairwise conversation” is a tiny subset. We need to move into the larger tent. Networking today deals with broadcast media (radios, PONs, etc.) by pretending it’s a point-to- point wire. That’s massively inefficient. Terabits-per-second of data are being exchanged all over the World via thumb drives or smart phones but we don’t know how to treat that as “networking”. ISPs are busily setting up caches and CDNs to scalably distribute video and audio. Caching is a necessary part of the solution but there’s no part of today’s networking—from Information, Queuing or Traffic Theory down to the Internet protocol specs—that tells us how to engineer and deploy it. I think and hope that over the next few years, networking will evolve to embrace the much larger vision of communication that underlies the Web.</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What people inspired you professionally?</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="509" alt="image" src="计算机网络自顶向下7th-en/Image_378.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark365">When I was in grad school, Richard Feynman visited and gave a colloquium. He talked about a piece of Quantum theory that I’d been struggling with all semester and his explanation was so simple and lucid that what had been incomprehensible gibberish to me became obvious and inevitable. That ability to see and convey the simplicity that underlies our complex world seems to me a rare and wonderful gift.</a><a name="bookmark366">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What are your recommendations for students who want careers in computer science and</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">networking?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">It’s a wonderful field—computers and networking have probably had more impact on society than any invention since the book. Networking is fundamentally about connecting stuff, and studying it helps you make intellectual connections: Ant foraging &amp; Bee dances demonstrate protocol design better than RFCs, traffic jams or people leaving a packed stadium are the essence of congestion, and students finding flights back to school in a post-Thanksgiving blizzard are the core of dynamic routing. If you’re interested in lots of stuff and want to have an impact, it’s hard to imagine a better field.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="783" height="2" alt="image" src="计算机网络自顶向下7th-en/Image_379.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s16" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark367">Chapter </a><span class="h1">4 </span>The Network Layer: Data Plane</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="1" alt="image" src="计算机网络自顶向下7th-en/Image_380.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We learned in the previous chapter that the transport layer provides various forms of process-to-process communication by relying on the network layer’s host-to-host communication service. We also learned that the transport layer does so without any knowledge about how the network layer actually implements this service. So perhaps you’re now wondering, what’s under the hood of the host-to-host communication service, what makes it tick?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">In this chapter and the next, we’ll learn exactly how the network layer can provide its host-to-host communication service. We’ll see that unlike the transport and application layers, <i>there is a piece of the network layer in each and every host and router in the network. </i>Because of this, network-layer protocols</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">are among the most challenging (and therefore among the most interesting!) in the protocol stack.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">Since the network layer is arguably the most complex layer in the protocol stack, we’ll have a lot of ground to cover here. Indeed, there is <i>so </i>much to cover that we cover the network layer in two chapters.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;">We’ll see that the network layer can be decomposed into two interacting parts, the <span class="s20">data plane </span>and the <span class="s23">control</span><span class="s20"> plane</span><a href="#bookmark368" class="s124">. In </a><a href="#bookmark368" class="a">Chapter </a><span class="s20">4</span>, we’ll first cover the data plane functions of the network layer—the <i>per- router </i>functions in the network layer that determine how a datagram (that is, a network-layer packet) arriving on one of a router’s input links is forwarded to one of that router’s output links. We’ll cover both</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">traditional IP forwarding (where forwarding is based on a datagram’s destination address) and generalized forwarding (where forwarding and other functions may be performed using values in several different fields in the datagram’s header). We’ll study the IPv4 and IPv6 protocols and addressing in</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark444" class="s124">detail. In </a><a href="#bookmark444" class="a">Chapter </a><span class="s20">5</span>, we’ll cover the control plane functions of the network layer—the <i>network-wide </i>logic that controls how a datagram is routed among routers along an end-to-end path from the source host to the destination host. We’ll cover routing algorithms, as well as routing protocols, such as OSPF and</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">BGP, that are in widespread use in today’s Internet. Traditionally, these control-plane routing protocols and data-plane forwarding functions have been implemented together, monolithically, within a router. Software-defined networking (SDN) explicitly separates the data plane and control plane by implementing these control plane functions as a separate service, typically in a remote “controller.” We’ll</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark444" class="s124">also cover SDN controllers in </a><a href="#bookmark444" class="a">Chapter </a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">This distinction between data-plane and control-plane functions in the network layer is an important concept to keep in mind as you learn about the network layer —it will help structure your thinking about</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark368">the network layer and reflects a modern view of the network layer’s role in computer networking.</a></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s18" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark369">4.1 Overview of Network Layer</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark370" class="a">Figure 4.1</a> <span class="p">shows a simple network with two hosts, H1 and H2, and several routers on the path between H1 and H2. Let’s suppose that H1 is sending information to H2, and consider the role of the network layer in these hosts and in the intervening routers. The network layer in H1 takes segments from the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">transport layer in H1, encapsulates each segment into a datagram, and then sends the datagrams to its nearby router, R1. At the receiving host, H2, the network layer receives the datagrams from its nearby router R2, extracts the transport-layer segments, and delivers the segments up to the transport layer at H2. The primary data-plane role of each router is to forward datagrams from its input links to its output links; the primary role of the network control plane is to coordinate these local, per-router forwarding actions so that datagrams are ultimately transferred end-to-end, along paths of routers between source</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark370" class="s124">and destination hosts. Note that the routers in </a><a href="#bookmark370" class="a">Figure 4.1</a> <span class="p">are shown with a truncated protocol stack, that is, with no upper layers above the network layer, because routers do not run application- and transport-</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark138" class="s124">layer protocols such as those we examined in </a><a href="#bookmark138" class="a">Chapters 2</a> <a href="#bookmark254" class="s124">and </a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">4.1.1 Forwarding and Routing: The Data and Control Planes</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The primary role of the network layer is deceptively simple—to move packets from a sending host to a receiving host. To do so, two important network-layer functions can be identified:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_381.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Forwarding. <a href="#bookmark370" class="s124">When a packet arrives at a router’s input link, the router must move the packet to the appropriate output link. For example, a packet arriving from Host H1 to Router R1 in </a><a href="#bookmark370" class="a">Figure 4.1</a> <span class="p">must be forwarded to the next router on a path to H2. As we will see, forwarding is but one function (albeit</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">the most</p><p style="padding-top: 4pt;padding-left: 19pt;text-indent: 0pt;text-align: left;"><span><img width="762" height="846" alt="image" src="计算机网络自顶向下7th-en/Image_382.png"/></span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 19pt;text-indent: 0pt;text-align: left;"><a name="bookmark370">Figure 4.1 The network layer</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 19pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark433" class="s124">common and important one!) implemented in the data plane. In the more general case, which we’ll cover in </a><a href="#bookmark433" class="a">Section 4.</a>4<span class="p">, a packet might also be blocked from exiting a router (e.g., if the packet</span></p><p style="padding-top: 4pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">originated at a known malicious sending host, or if the packet were destined to a forbidden destination host), or might be duplicated and sent over multiple outgoing links.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_383.png"/></span></p><p style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>Routing. </b>The network layer must determine the route or path taken by packets as they flow from a sender to a receiver. The algorithms that calculate these paths are referred to as <span class="s20">routing algorithms</span>. A routing algorithm would determine, for example, the path along which packets flow</p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark370" class="s124">from H1 to H2 in </a><a href="#bookmark370" class="a">Figure 4.</a>1<span class="p">. Routing is implemented in the control plane of the network layer.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">The terms <i>forwarding </i>and <i>routing </i>are often used interchangeably by authors discussing the network layer. We’ll use these terms much more precisely in this book. <span class="s20">Forwarding </span>refers to the router-local action of transferring a packet from an input link interface to the appropriate output link interface.</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Forwarding takes place at very short timescales (typically a few nanoseconds), and thus is typically implemented in hardware. <span class="s20">Routing </span>refers to the network-wide process that determines the end-to-end paths that packets take from source to destination. Routing takes place on much longer timescales (typically seconds), and as we will see is often implemented in software. Using our driving analogy,</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark49" class="s124">consider the trip from Pennsylvania to Florida undertaken by our traveler back in </a><a href="#bookmark49" class="a">Section 1.3.</a>1<span class="p">. During this trip, our driver passes through many interchanges en route to Florida. We can think of forwarding as the process of getting through a single interchange: A car enters the interchange from one road and</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">determines which road it should take to leave the interchange. We can think of routing as the process of planning the trip from Pennsylvania to Florida: Before embarking on the trip, the driver has consulted a map and chosen one of many paths possible, with each path consisting of a series of road segments connected at interchanges.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A key element in every network router is its <span class="s20">forwarding table</span>. A router forwards a packet by examining the value of one or more fields in the arriving packet’s header, and then using these header values to index into its forwarding table. The value stored in the forwarding table entry for those values indicates</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 134%;text-align: left;"><a href="#bookmark371" class="s124">the outgoing link interface at that router to which that packet is to be forwarded. For example, in </a><a href="#bookmark371" class="a">Figure </a><a href="#bookmark371" class="s127">4.</a><span class="s20">2</span>, a packet with header field value of <span class="s45">0110 </span><span class="s37">arrives</span> to a router. The router indexes into its forwarding table and determines that the output link interface for this packet is interface 2. The router then internally</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark394" class="s124">forwards the packet to interface 2. In </a><a href="#bookmark394" class="a">Section 4.</a>2<span class="p">, we’ll look inside a router and examine the forwarding function in much greater detail. Forwarding is the key function performed by the data-plane functionality of the network layer.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Control Plane: The Traditional Approach</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">But now you are undoubtedly wondering how a router’s forwarding tables are configured in the first place. This is a crucial issue, one that exposes the important interplay between forwarding (in data plane) and routing (in control plane). As shown</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="702" height="442" alt="image" src="计算机网络自顶向下7th-en/Image_384.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark371">Figure 4.2 Routing algorithms determine values in forward tables</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark371" class="s124">in </a><a href="#bookmark371" class="a">Figure 4.</a>2<span class="p">, the routing algorithm determines the contents of the routers’ forwarding tables. In this example, a routing algorithm runs in each and every router and both forwarding and routing functions</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark463" class="s124">are contained within a router. As we’ll see in </a><a href="#bookmark463" class="a">Sections 5.3</a> <a href="#bookmark480" class="s124">and </a><a href="#bookmark480" class="a">5.</a>4<span class="p">, the routing algorithm function in one router communicates with the routing algorithm function in other routers to compute the values for its forwarding table. How is this communication performed? By exchanging routing messages containing</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">routing information according to a routing protocol! We’ll cover routing algorithms and protocols in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark459" class="a">Sections 5.2</a> <a href="#bookmark480" class="s124">through </a><a href="#bookmark480" class="a">5.4.</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The distinct and different purposes of the forwarding and routing functions can be further illustrated by considering the hypothetical (and unrealistic, but technically feasible) case of a network in which all forwarding tables are configured directly by human network operators physically present at the routers.</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">In this case, <i>no </i>routing protocols would be required! Of course, the human operators would need to interact with each other to ensure that the forwarding tables were configured in such a way that packets reached their intended destinations. It’s also likely that human configuration would be more error-prone</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">and much slower to respond to changes in the network topology than a routing protocol. We’re thus fortunate that all networks have both a forwarding <i>and </i>a routing function!</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Control Plane: The SDN Approach</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark371" class="s124">The approach to implementing routing functionality shown in </a><a href="#bookmark371" class="a">Figure 4.</a>2<span class="p">—with each router having a routing component that communicates with the routing component of other routers—has been the</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">traditional approach adopted by routing vendors in their products, at least until recently. Our observation that humans could manually configure forwarding tables does suggest, however, that there may be other ways for control-plane functionality to determine the contents of the data-plane forwarding tables.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark372" class="a">Figure 4.3</a> <span class="p">shows an alternate approach in which a physically separate (from the routers), remote controller computes and distributes the forwarding tables to be used by each and every router. Note that</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark371" class="s124">the data plane components of </a><a href="#bookmark371" class="a">Figures 4.2</a> <a href="#bookmark372" class="s124">and </a><a href="#bookmark372" class="a">4.3</a> <a href="#bookmark372" class="s124">are identical. In </a><a href="#bookmark372" class="a">Figure 4.</a>3<span class="p">, however, control-plane routing functionality is separated</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="728" height="562" alt="image" src="计算机网络自顶向下7th-en/Image_385.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark372">Figure 4.3 A remote controller determines and distributes values in forwarding tables</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">from the physical router—the routing device performs forwarding only, while the remote controller computes and distributes forwarding tables. The remote controller might be implemented in a remote data center with high reliability and redundancy, and might be managed by the ISP or some third party. How might the routers and the remote controller communicate? By exchanging messages containing</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark372" class="s124">forwarding tables and other pieces of routing information. The control-plane approach shown in </a><a href="#bookmark372" class="a">Figure</a></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 136%;text-align: left;"><a href="#bookmark372" class="a">4.3</a> <span class="p">is at the heart of </span><span class="s23">software-defined</span> networking (SDN)<span class="p">, where the network is “software-defined” because the controller that computes forwarding tables and interacts with routers is implemented in software. Increasingly, these software implementations are also open, i.e., similar to Linux OS code, the</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark492" class="s124" name="bookmark373">code is publically available, allowing ISPs (and networking researchers and students!) to innovate and propose changes to the software that controls network-layer functionality. We will cover the SDN control plane in </a><a href="#bookmark492" class="a">Section 5.</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">4.1.2 Network Service Model</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before delving into the network layer’s data plane, let’s wrap up our introduction by taking the broader view and consider the different types of service that might be offered by the network layer. When the transport layer at a sending host transmits a packet into the network (that is, passes it down to the network layer at the sending host), can the transport layer rely on the network layer to deliver the packet to the destination? When multiple packets are sent, will they be delivered to the transport layer in the receiving host in the order in which they were sent? Will the amount of time between the sending of two sequential packet transmissions be the same as the amount of time between their reception? Will the network provide any feedback about congestion in the network? The answers to these questions and others are determined by the service model provided by the network layer. The <span class="s20">network service model </span>defines the characteristics of end-to-end delivery of packets between sending and receiving hosts.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now consider some possible services that the network layer could provide. These services could include:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_386.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Guaranteed delivery. <span class="p">This service guarantees that a packet sent by a source host will eventually arrive at the destination host.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_387.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Guaranteed delivery with bounded delay. <span class="p">This service not only guarantees delivery of the packet, but delivery within a specified host-to-host delay bound (for example, within 100 msec).</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_388.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">In-order packet delivery. <span class="p">This service guarantees that packets arrive at the destination in the order that they were sent.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_389.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Guaranteed minimal bandwidth. <span class="p">This network-layer service emulates the behavior of a transmission link of a specified bit rate (for example, 1 Mbps) between sending and receiving hosts. As long as the sending host transmits bits (as part of packets) at a rate below the specified bit rate,</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">then all packets are eventually delivered to the destination host.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_390.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Security. <span class="p">The network layer could encrypt all datagrams at the source and decrypt them at the destination, thereby providing confidentiality to all transport-layer segments.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">This is only a partial list of services that a network layer could provide—there are countless variations possible.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The Internet’s network layer provides a single service, known as <span class="s20">best-effort service</span>. With best-effort service, packets are neither guaranteed to be received in the order in which they were sent, nor is their eventual delivery even guaranteed. There is no guarantee on the end-to-end delay nor is there a</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a name="bookmark374">minimal bandwidth guarantee. It might appear that </a><i>best-effort service </i>is a euphemism for <i>no service at all</i>—a network that delivered <i>no </i>packets to the destination would satisfy the definition of best-effort delivery service! Other network architectures have defined and implemented service models that go<a name="bookmark375">&zwnj;</a></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">beyond the Internet’s best-effort service. For example, the ATM network architecture </a><a href="#bookmark848" class="a">[MFA Forum </a>2016<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Black 1995]</a> <span class="p">provides for guaranteed in-order delay, bounded delay, and guaranteed minimal bandwidth. There have also been proposed service model extensions to the Internet architecture; for</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">example, the Intserv architecture </a><a href="#bookmark848" class="a">[RFC 1633]</a> <span class="p">aims to provide end-end delay guarantees and</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">congestion-free communication. Interestingly, in spite of these well-developed alternatives, the Internet’s basic best-effort service model combined with adequate bandwidth provisioning have arguably proven to be more than “good enough” to enable an amazing range of applications, including streaming video services such as Netflix and voice-and-video-over-IP, real-time conferencing applications such as Skype and Facetime.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark368" style=" color: #575757; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt;">An Overview of </a><a href="#bookmark368" class="s128">Chapter 4</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark394" class="s124">Having now provided an overview of the network layer, we’ll cover the data-plane component of the network layer in the following sections in this chapter. In </a><a href="#bookmark394" class="a">Section 4.</a>2<span class="p">, we’ll dive down into the internal</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">hardware operations of a router, including input and output packet processing, the router’s internal</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark423" class="s124">switching mechanism, and packet queueing and scheduling. In Section </a><a href="#bookmark423" class="a">4.</a>3<span class="p">, we’ll take a look at traditional IP forwarding, in which packets are forwarded to output ports based on their destination IP</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark433" class="s124">addresses. We’ll encounter IP addressing, the celebrated IPv4 and IPv6 protocols and more. In </a><a href="#bookmark433" class="a">Section 4.</a>4<span class="p">, we’ll cover more generalized forwarding, where packets may be forwarded to output ports based on a large number of header values (i.e., not only based on destination IP address). Packets may be</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">blocked or duplicated at the router, or may have certain header field values rewritten—all under software control. This more generalized form of packet forwarding is a key component of a modern network data plane, including the data plane in software-defined networks (SDN).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">We mention here in passing that the terms <i>forwarding </i>and <i>switching </i>are often used interchangeably by computer-networking researchers and practitioners; we’ll use both terms interchangeably in this textbook as well. While we’re on the topic of terminology, it’s also worth mentioning two other terms that</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">are often used interchangeably, but that we will use more carefully. We’ll reserve the term <i>packet switch </i>to mean a general packet-switching device that transfers a packet from input link interface to output link interface, according to values in a packet’s header fields. Some packet switches, called <span class="s20">link-layer</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 136%;text-align: left;"><span class="s23">switches</span> <a href="#bookmark444" class="s124">(examined in </a><a href="#bookmark444" class="a">Chapter </a>6<span class="p">), base their forwarding decision on values in the fields of the link- layer frame; switches are thus referred to as link-layer (layer 2) devices. Other packet switches, called </span>routers<span class="p">, base their forwarding decision on header field values in the network-layer datagram. Routers</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark95" class="s124">are thus network-layer (layer 3) devices. (To fully appreciate this important distinction, you might want to review </a><a href="#bookmark95" class="a">Section 1.5.</a><span class="s20">2</span>, where we discuss network-layer datagrams and link-layer frames and their relationship.) Since our focus in this chapter is on the network layer, we’ll mostly use the term <i>router </i>in</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">place of <i>packet switch</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l191"><ol id="l192"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark376">What’s Inside a Router?</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now that we’ve overviewed the data and control planes within the network layer, the important distinction between forwarding and routing, and the services and functions of the network layer, let’s turn our attention to its forwarding function—the actual transfer of packets from a router’s incoming links to the appropriate outgoing links at that router.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark377" class="s124">A high-level view of a generic router architecture is shown in </a><a href="#bookmark377" class="a">Figure 4.</a>4<span class="p">. Four router components can be identified:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="766" height="366" alt="image" src="计算机网络自顶向下7th-en/Image_391.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark377">Figure 4.4 Router architecture</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_392.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 126%;text-align: left;"><a name="bookmark378"><b>Input ports. </b></a>An <span class="s23">input</span><span class="s20"> port </span>performs several key functions. It performs the physical layer function of terminating an incoming physical link at a router; this is shown in the leftmost box of an input port</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark377" class="s124">and the rightmost box of an output port in </a><a href="#bookmark377" class="a">Figure 4.</a>4<span class="p">. An input port also performs link-layer functions needed to interoperate with the link layer at the other side of the incoming link; this is represented by the middle boxes in the input and output ports. Perhaps most crucially, a lookup function is also</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">performed at the input port; this will occur in the rightmost box of the input port. It is here that the forwarding table is consulted to determine the router output port to which an arriving packet will be forwarded via the switching fabric. Control packets (for example, packets carrying routing protocol information) are forwarded from an input port to the routing processor. Note that the term “port” here</p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">—referring to the physical input and output router interfaces—is distinctly different from the software</p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark138" class="s124">ports associated with network applications and sockets discussed in </a><a href="#bookmark138" class="a">Chapters 2</a> <a href="#bookmark254" class="s124">and </a>3<span class="p">. In practice, the number of ports supported by a router can range from a relatively small number in enterprise routers, to hundreds of 10 Gbps ports in a router at an ISP’s edge, where the number of incoming</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_393.png"/></span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">lines tends to be the greatest. The Juniper MX2020, edge router, for example, supports up to 960 10 Gbps Ethernet ports, with an overall router system capacity of 80 Tbps </a><a href="#bookmark848" class="a">[Juniper MX 2020 2016</a><span class="s20">]</span>. <b>Switching fabric. </b>The switching fabric connects the router’s input ports to its output ports. This</p><p style="padding-left: 25pt;text-indent: 0pt;line-height: 11pt;text-align: left;">switching fabric is completely contained within the router—a network inside of a network router!</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_394.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 136%;text-align: left;"><b>Output ports. </b>An <span class="s23">output</span><span class="s20"> port </span>stores packets received from the switching fabric and transmits these packets on the outgoing link by performing the necessary link-layer and physical-layer functions. When a link is bidirectional (that is, carries traffic in both directions), an output port will typically be</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">paired with the input port for that link on the same line card.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_395.png"/></span></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><span style=" color: #333;">Routing processor. </span><a href="#bookmark463" class="s124">The routing processor performs control-plane functions. In traditional routers, it executes the routing protocols (which we’ll study in </a><a href="#bookmark463" class="a">Sections 5.3</a> <a href="#bookmark480" class="s124">and </a><a href="#bookmark480" class="a">5.</a>4<span class="p">), maintains routing tables and attached link state information, and computes the forwarding table for the router. In SDN</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">routers, the routing processor is responsible for communicating with the remote controller in order to (among other activities) receive forwarding table entries computed by the remote controller, and install these entries in the router’s input ports. The routing processor also performs the network</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark502" class="s124">management functions that we’ll study in </a><a href="#bookmark502" class="a">Section 5.</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">A router’s input ports, output ports, and switching fabric are almost always implemented in hardware, as</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark377" class="s124">shown in </a><a href="#bookmark377" class="a">Figure 4.</a>4<span class="p">. To appreciate why a hardware implementation is needed, consider that with a 10 Gbps input link and a 64-byte IP datagram, the input port has only 51.2 ns to process the datagram</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">before another datagram may arrive. If <i>N </i>ports are combined on a line card (as is often done in practice), the datagram-processing pipeline must operate <i>N </i>times faster—far too fast for software implementation. Forwarding hardware can be implemented either using a router vendor’s own hardware</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">designs, or constructed using purchased merchant-silicon chips (e.g., as sold by companies such as Intel and Broadcom).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">While the data plane operates at the nanosecond time scale, a router’s control functions—executing the routing protocols, responding to attached links that go up or down, communicating with the remote controller (in the SDN case) and performing management functions—operate at the millisecond or second timescale. These <span class="s20">control plane </span>functions are thus usually implemented in software and execute on the routing processor (typically a traditional CPU).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before delving into the details of router internals, let’s return to our analogy from the beginning of this chapter, where packet forwarding was compared to cars entering and leaving an interchange. Let’s suppose that the interchange is a roundabout, and that as a car enters the roundabout, a bit of processing is required. Let’s consider what information is required for this processing:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_396.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">Destination-based forwarding. <span class="p">Suppose the car stops at an entry station and indicates its final</span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">destination (not at the local roundabout, but the ultimate destination of its journey). An attendant at the entry station looks up the final destination, determines the roundabout exit that leads to that final destination, and tells the driver which roundabout exit to take.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_397.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Generalized forwarding. <span class="p">The attendant could also determine the car’s exit ramp on the basis of many other factors besides the destination. For example, the selected exit ramp might depend on the car’s origin, for example the state that issued the car’s license plate. Cars from a certain set of</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">states might be directed to use one exit ramp (that leads to the destination via a slow road), while cars from other states might be directed to use a different exit ramp (that leads to the destination via superhighway). The same decision might be made based on the model, make and year of the car. Or a car not deemed roadworthy might be blocked and not be allowed to pass through the roundabout. In the case of generalized forwarding, any number of factors may contribute to the attendant’s choice of the exit ramp for a given car.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Once the car enters the roundabout (which may be filled with other cars entering from other input roads and heading to other roundabout exits), it eventually leaves at the prescribed roundabout exit ramp, where it may encounter other cars leaving the roundabout at that exit.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark377" class="s124">We can easily recognize the principal router components in </a><a href="#bookmark377" class="a">Figure 4.4</a> <span class="p">in this analogy—the entry road and entry station correspond to the input port (with a lookup function to determine to local outgoing port); the roundabout corresponds to the switch fabric; and the roundabout exit road corresponds to the output</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">port. With this analogy, it’s instructive to consider where bottlenecks might occur. What happens if cars arrive blazingly fast (for example, the roundabout is in Germany or Italy!) but the station attendant is slow? How fast must the attendant work to ensure there’s no backup on an entry road? Even with a blazingly fast attendant, what happens if cars traverse the roundabout slowly—can backups still occur? And what happens if most of the cars entering at all of the roundabout’s entrance ramps all want to leave the roundabout at the same exit ramp—can backups occur at the exit ramp or elsewhere? How should the roundabout operate if we want to assign priorities to different cars, or block certain cars from entering the roundabout in the first place? These are all analogous to critical questions faced by router and switch designers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">In the following subsections, we’ll look at router functions in more detail. </a><a href="#bookmark848" class="a">[Iyer </a>2008<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Chao 200</a>1<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Chuang 200</a>5<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Turner 198</a>8<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">McKeown 1997</a>a<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Partridge 199</a>8<span class="p">; Sopranos 2011] provide a discussion of specific router architectures. For concreteness and simplicity, we’ll initially assume in this section that</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark433" class="s124">forwarding decisions are based only on the packet’s destination address, rather than on a generalized set of packet header fields. We will cover the case of more generalized packet forwarding in </a><a href="#bookmark433" class="a">Section 4.</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l193"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Input Port Processing and Destination-Based Forwarding</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark379" class="s124">A more detailed view of input processing is shown in </a><a href="#bookmark379" class="a">Figure 4.</a>5<span class="p">. As just discussed, the input port’s line- termination function and link-layer processing implement the physical and link layers for that individual input link. The lookup performed in the input port is central to the router’s operation—it is here that the</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">router uses the forwarding table to look up the output port to which an arriving packet will be forwarded via the switching fabric. The forwarding table is either computed and updated by the routing processor (using a routing protocol to interact with the routing processors in other network routers) or is received from a remote SDN controller. The forwarding table is copied from the routing processor to the line cards over a separate bus (e.g., a PCI bus) indicated by the dashed line from the routing processor to</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark377" class="s124">the input line cards in </a><a href="#bookmark377" class="a">Figure 4.</a>4<span class="p">. With such a shadow copy at each line card, forwarding decisions can be made locally, at each input port, without invoking the centralized routing processor on a per-packet basis and thus avoiding a centralized processing bottleneck.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now consider the “simplest” case that the output port to which an incoming packet is to be switched is based on the packet’s destination address. In the case of 32-bit IP addresses, a brute-force implementation of the forwarding table would have one entry for every possible destination address. Since there are more than 4 billion possible addresses, this option is totally out of the question.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="669" height="154" alt="image" src="计算机网络自顶向下7th-en/Image_398.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark379">Figure 4.5 Input port processing</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">As an example of how this issue of scale can be handled, let’s suppose that our router has four links, numbered 0 through 3, and that packets are to be forwarded to the link interfaces as follows:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173" colspan="4"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Destination Address Range</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Link Interface</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">11001000</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00010111</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00010000</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00000000</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173" rowspan="3"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">through</p></td><td/><td/><td style="border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/></tr><tr><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">11001000</p></td><td style="border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00010111</p></td><td style="border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00010111</p></td><td style="border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">11111111</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">11001000</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00010111</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00011000</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00000000</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">1</p></td></tr></table><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p class="s131" style="padding-left: 8pt;text-indent: 0pt;line-height: 14pt;text-align: left;">through</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">11001000 00010111 00011000 11111111</p></td><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">11001000 00010111 00011001 00000000</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">through</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">11001000 00010111 00011111 11111111</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">2</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Otherwise</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">3</p></td></tr></table><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Clearly, for this example, it is not necessary to have 4 billion entries in the router’s forwarding table. We could, for example, have the following forwarding table with just four entries:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173" colspan="3"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Prefix</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Link Interface</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">11001000</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00010111</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00010</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">11001000</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00010111</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00011000</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">1</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">11001000</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00010111</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 3pt;text-indent: 0pt;text-align: left;">00011</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">2</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173" colspan="3"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Otherwise</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">3</p></td></tr></table><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">With this style of forwarding table, the router matches a <span class="s20">prefix </span>of the packet’s destination address with the entries in the table; if there’s a match, the router forwards the packet to a link associated with the match. For example, suppose the packet’s destination address is  <span class="s30">11001000 00010111 00010110</span></p><p class="s30" style="padding-left: 5pt;text-indent: 0pt;line-height: 14pt;text-align: left;">10100001 <span class="p">; because the 21-bit prefix of this address matches the first entry in the table, the router</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">forwards the packet to link interface 0. If a prefix doesn’t match any of the first three entries, then the router forwards the packet to the default interface 3. Although this sounds simple enough, there’s a very important subtlety here. You may have noticed that it is possible for a destination address to match</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">more than one entry. For example, the first 24 bits of the address <span class="s30">11001000 00010111 00011000 10101010 </span>match the second entry in the table, and the first 21 bits of the address match the third entry in the table. When there are multiple matches, the router uses the <span class="s20">longest prefix matching rule</span>; that  is, it finds the longest matching entry in the table and forwards the packet to the link interface associated</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">with the longest prefix match. We’ll see exactly <i>why </i><a href="#bookmark423" class="s124">this longest prefix-matching rule is used when we study Internet addressing in more detail in </a><a href="#bookmark423" class="a">Section 4.</a><span class="s20">3</span>.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark380">Given the existence of a forwarding table, lookup is conceptually simple—hardware logic just searches through the forwarding table looking for the longest prefix match. But at Gigabit transmission rates, this lookup must be performed in nanoseconds (recall our earlier example of a 10 Gbps link and a 64-byte IP datagram). Thus, not only must lookup be performed in hardware, but techniques beyond a simple linear</a></p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">search through a large table are needed; surveys of fast lookup algorithms can be found in </a><a href="#bookmark848" class="a">[Gupta </a>2001<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Ruiz-Sanchez 2001</a>]<span class="p">. Special attention must also be paid to memory access times, resulting in designs with embedded on-chip DRAM and faster SRAM (used as a DRAM cache) memories. In</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark841" class="s124">practice, Ternary Content Addressable Memories (TCAMs) are also often used for lookup </a><a href="#bookmark841" class="a">[Yu 2004</a>]<span class="p">. With a TCAM, a 32-bit IP address is presented to the memory, which returns the content of the forwarding table entry for that address in essentially constant time. The Cisco Catalyst 6500 and 7600</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">Series routers and switches can hold upwards of a million TCAM forwarding table entries </a><a href="#bookmark848" class="a">[Cisco TCAM </a>2014]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Once a packet’s output port has been determined via the lookup, the packet can be sent into the switching fabric. In some designs, a packet may be temporarily blocked from entering the switching fabric if packets from other input ports are currently using the fabric. A blocked packet will be queued at the input port and then scheduled to cross the fabric at a later point in time. We’ll take a closer look at the blocking, queuing, and scheduling of packets (at both input ports and output ports) shortly. Although “lookup” is arguably the most important action in input port processing, many other actions must be taken: (1) physical- and link-layer processing must occur, as discussed previously; (2) the packet’s</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark423" class="s124">version number, checksum and time-to-live field—all of which we’ll study in </a><a href="#bookmark423" class="a">Section 4.</a>3<span class="p">—must be checked and the latter two fields rewritten; and (3) counters used for network management (such as the number of IP datagrams received) must be updated.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s close our discussion of input port processing by noting that the input port steps of looking up a destination IP address (“match”) and then sending the packet into the switching fabric to the specified output port (“action”) is a specific case of a more general “match plus action” abstraction that is</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark444" class="s124">performed in many networked devices, not just routers. In link-layer switches (covered in </a><a href="#bookmark444" class="a">Chapter </a>6<span class="p">), link-layer destination addresses are looked up and several actions may be taken in addition to sending</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark671" class="s124">the frame into the switching fabric towards the output port. In firewalls (covered in </a><a href="#bookmark671" class="a">Chapter </a>8<span class="p">)—devices that filter out selected incoming packets—an incoming packet whose header matches a given criteria (e.g., a combination of source/destination IP addresses and transport-layer port numbers) may be</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark423" class="s124">dropped (action). In a network address translator (NAT, covered in </a><a href="#bookmark423" class="a">Section 4.</a>3<span class="p">), an incoming packet whose transport-layer port number matches a given value will have its port number rewritten before forwarding (action). Indeed, the “match plus action” abstraction is both powerful and prevalent in</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark433" class="s124">network devices today, and is central to the notion of generalized forwarding that we’ll study in </a><a href="#bookmark433" class="a">Section 4.</a>4<span class="p">.</span></p></li><li style="padding-top: 3pt;padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Switching</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark381" class="s124">The switching fabric is at the very heart of a router, as it is through this fabric that the packets are actually switched (that is, forwarded) from an input port to an output port. Switching can be accomplished in a number of ways, as shown in </a><a href="#bookmark381" class="a">Figure 4.</a>6<span class="p">:</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_399.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Switching via memory. <span class="p">The simplest, earliest routers were traditional computers, with switching between input and output ports being done under direct control of the CPU (routing processor). Input and output ports functioned as traditional I/O devices in a traditional operating system. An input port</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">with an arriving packet first signaled the routing processor via an interrupt. The packet was then copied from the input port into processor memory. The routing processor then extracted the destination address from the header, looked up the appropriate output port in the forwarding table, and copied the packet to the output port’s buffers. In this scenario, if the memory bandwidth is such</p><p style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">that a maximum of <i>B </i>packets per second can be written into, or read from, memory, then the overall forwarding throughput (the total rate at which packets are transferred from input ports to output</p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">ports) must be less than <i>B</i>/2. Note also that two packets cannot be forwarded</p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="375" height="151" alt="image" src="计算机网络自顶向下7th-en/Image_400.jpg"/></span></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><h2 style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark381">Figure 4.6 Three switching techniques</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="317" height="245" alt="image" src="计算机网络自顶向下7th-en/Image_401.jpg"/></span></p><p style="padding-top: 4pt;padding-left: 19pt;text-indent: 0pt;text-align: left;"><span><img width="283" height="325" alt="image" src="计算机网络自顶向下7th-en/Image_402.jpg"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">at the same time, even if they have different destination ports, since only one memory read/write can be done at a time over the shared system bus.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">Some modern routers switch via memory. A major difference from early routers, however, is that the lookup of the destination address and the storing of the packet into the appropriate memory location are performed by processing on the input line cards. In some ways, routers that switch via memory look very much like shared-memory multiprocessors, with the processing on a line card switching (writing) packets into the memory of the appropriate output port. Cisco’s Catalyst 8500 series</p><p class="s20" style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">switches </a><a href="#bookmark848" class="a">[Cisco 8500 2016]</a> <span class="p">internally switches packets via a shared memory.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_403.png"/></span></p><p class="s28" style="padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;">Switching via a bus. <span class="p">In this approach, an input port transfers a packet directly to the output port over a shared bus, without intervention by the routing processor. This is typically done by having the input port pre-pend a switch-internal label (header) to the packet indicating the local output port to</span></p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">which this packet is being transferred and transmitting the packet onto the bus. All output ports receive the packet, but only the port that matches the label will keep the packet. The label is then removed at the output port, as this label is only used within the switch to cross the bus. If multiple packets arrive to the router at the same time, each at a different input port, all but one must wait since only one packet can cross the bus at a time. Because every packet must cross the single bus, the switching speed of the router is limited to the bus speed; in our roundabout analogy, this is as if the roundabout could only contain one car at a time. Nonetheless, switching via a bus is often sufficient for routers that operate in small local area and enterprise networks. The Cisco 6500 router</p><p class="s20" style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="a">[Cisco 6500 2016]</a> <span class="p">internally switches packets over a 32-Gbps-backplane bus.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_404.png"/></span></p><p class="s28" style="padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;">Switching via an interconnection network. <span class="p">One way to overcome the bandwidth limitation of a single, shared bus is to use a more sophisticated interconnection network, such as those that have been used in the past to interconnect processors in a multiprocessor computer architecture. A</span></p><p style="padding-top: 3pt;padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;">crossbar switch is an interconnection network consisting of 2<i>N </i>buses that connect <i>N </i>input ports to <i>N </i><a href="#bookmark381" class="s124">output ports, as shown in </a><a href="#bookmark381" class="a">Figure 4.</a><span class="s20">6</span>. Each vertical bus intersects each horizontal bus at a crosspoint, which can be opened or closed at any time by the switch fabric controller (whose logic is</p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark382">part of the switching fabric itself). When a packet arrives from port A and needs to be forwarded to port Y, the switch controller closes the crosspoint at the intersection of busses A and Y, and port A then sends the packet onto its bus, which is picked up (only) by bus Y. Note that a packet from port B can be forwarded to port X at the same time, since the A-to-Y and B-to-X packets use different input and output busses. Thus, unlike the previous two switching approaches, crossbar switches are capable of forwarding multiple packets in parallel. A crossbar switch is </a><span class="s20">non-blocking</span>—a packet being forwarded to an output port will not be blocked from reaching that output port as long as no other packet is currently being forwarded to that output port. However, if two packets from two different input ports are destined to that same output port, then one will have to wait at the input,</p><p class="s20" style="padding-top: 2pt;padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">since only one packet can be sent over any given bus at a time. Cisco 12000 series switches </a><a href="#bookmark848" class="a">[Cisco 12000 2016]</a> <a href="#bookmark848" class="s124">use a crossbar switching network; the Cisco 7600 series can be configured to use either a bus or crossbar switch </a><a href="#bookmark848" class="a">[Cisco 7600 </a>2016]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">More sophisticated interconnection networks use multiple stages of switching elements to allow packets from different input ports to proceed towards the same output port at the same time through the multi-stage switching fabric. See </a><a href="#bookmark848" class="a">[Tobagi 1990]</a> <span class="p">for a survey of switch architectures. The Cisco</span></p><p style="padding-left: 25pt;text-indent: 0pt;line-height: 11pt;text-align: left;">CRS employs a three-stage non-blocking switching strategy. A router’s switching capacity can also</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: 0pt;line-height: 153%;text-align: left;">be scaled by running multiple switching fabrics in parallel. In this approach, input ports and output ports are connected to <i>N </i>switching fabrics that operate in parallel. An input port breaks a packet into <i>K </i>smaller chunks, and sends (“sprays”) the chunks through <i>K </i>of these <i>N </i>switching fabrics to the</p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 13pt;text-align: left;">selected output port, which reassembles the <i>K </i>chunks back into the original packet.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark383">Output Port Processing</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark384" class="s124">Output port processing, shown in </a><a href="#bookmark384" class="a">Figure 4.</a>7<span class="p">, takes packets that have been stored in the output port’s memory and transmits them over the output link. This includes selecting and de-queueing packets for transmission, and performing the needed link-layer and physical-layer transmission functions.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Where Does Queuing Occur?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark381" class="s124">If we consider input and output port functionality and the configurations shown in </a><a href="#bookmark381" class="a">Figure 4.</a><span class="s20">6</span>, it’s clear that packet queues may form at both the input ports <i>and </i>the output ports, just as we identified cases where cars may wait at the inputs and outputs of the traffic intersection in our roundabout analogy. The</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">location and extent of queueing (either at the input port queues or the output port queues) will depend on the traffic load, the relative speed of the switching fabric, and the line speed. Let’s now consider these queues in a bit more detail, since as these queues grow large, the router’s memory can eventually be exhausted and <span class="s20">packet loss </span>will occur when no memory is available to store arriving packets. Recall that in our earlier discussions, we said that packets were “lost within the network” or “dropped at a</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">router.” <i>It is here, at these queues within a router, where such packets are actually dropped and lost.</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="667" height="154" alt="image" src="计算机网络自顶向下7th-en/Image_405.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark384">Figure 4.7 Output port processing</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">Suppose that the input and output line speeds (transmission rates) all have an identical transmission rate of <i>R</i><span class="s31">line </span>packets per second, and that there are <i>N </i>input ports and <i>N </i>output ports. To further simplify</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">the discussion, let’s assume that all packets have the same fixed length, and that packets arrive to input</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">ports in a synchronous manner. That is, the time to send a packet on any link is equal to the time to receive a packet on any link, and during such an interval of time, either zero or one packets can arrive on an input link. Define the switching fabric transfer rate <i>R</i><span class="s31">switch </span>as the rate at which packets can be moved from input port to output port. If <i>R</i><span class="s31">switch </span>is <i>N </i>times faster than <i>R</i><span class="s31">line</span>, then only negligible queuing will occur at the input ports. This is because even in the worst case, where all <i>N </i>input lines are receiving packets, and all packets are to be forwarded to the same output port, each batch of <i>N </i>packets (one</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">packet per input port) can be cleared through the switch fabric before the next batch arrives.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Input Queueing</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">But what happens if the switch fabric is not fast enough (relative to the input line speeds) to transfer <i>all </i>arriving packets through the fabric without delay? In this case, packet queuing can also occur at the input ports, as packets must join input port queues to wait their turn to be transferred through the</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">switching fabric to the output port. To illustrate an important consequence of this queuing, consider a crossbar switching fabric and suppose that (1) all link speeds are identical, (2) that one packet can be transferred from any one input port to a given output port in the same amount of time it takes for a packet to be received on an input link, and (3) packets are moved from a given input queue to their desired output queue in an FCFS manner. Multiple packets can be transferred in parallel, as long as their output ports are different. However, if two packets at the front of two input queues are destined for the same output queue, then one of the packets will be blocked and must wait at the input queue—the switching fabric can transfer only one packet to a given output port at a time.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark385" class="a">Figure 4.8</a> <span class="p">shows an example in which two packets (darkly shaded) at the front of their input queues are destined for the same upper-right output port. Suppose that the switch fabric chooses to transfer the packet from the front of the upper-left queue. In this case, the darkly shaded packet in the lower-left</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">queue must wait. But not only must this darkly shaded packet wait, so too must the lightly shaded</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">packet that is queued behind that packet in the lower-left queue, even though there is <i>no </i>contention for the middle-right output port (the destination for the lightly shaded packet). This phenomenon is known as <span class="s20">head-of-the-line (HOL) blocking </span>in an input-queued switch—a queued packet in an input queue</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">must wait for transfer through the fabric (even though its output port is free) because it is blocked by</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">another packet at the head of the line. </a><a href="#bookmark848" class="a">[Karol 1987]</a> <span class="p">shows that due to HOL blocking, the input queue will grow to unbounded length (informally, this is equivalent to saying that significant packet loss will occur) under certain assumptions as soon as the packet arrival rate on the input links reaches only 58</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">percent of their capacity. A number of solutions to HOL blocking are discussed in </a><a href="#bookmark848" class="a">[McKeown 1997</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="589" height="594" alt="image" src="计算机网络自顶向下7th-en/Image_406.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark385">Figure 4.8 HOL blocking at and input-queued switch</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Output Queueing</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Let’s next consider whether queueing can occur at a switch’s output ports. Suppose that <i>R</i><span class="s31">switch </span>is again <i>N </i>times faster than <i>R</i><span class="s31">line </span>and that packets arriving at each of the <i>N </i>input ports are destined to the same output port. In this case, in the time it takes to send a single packet onto the outgoing link, <i>N </i>new packets will arrive at this output port (one from each of the <i>N </i>input ports). Since the output port can</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">transmit only a single packet in a unit of time (the packet transmission time), the <i>N </i>arriving packets will have to queue (wait) for transmission over the outgoing link. Then <i>N </i>more packets can possibly arrive in the time it takes to transmit just one of the <i>N </i>packets that had just previously been queued. And so on. Thus, packet queues can form at the output ports even when the switching fabric is <i>N </i>times faster than</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">the port line speeds. Eventually, the number of queued packets can grow large enough to exhaust</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">available memory at the output port.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="584" height="499" alt="image" src="计算机网络自顶向下7th-en/Image_407.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark386">Figure 4.9 Output port queueing</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">When there is not enough memory to buffer an incoming packet, a decision must be made to either drop the arriving packet (a policy known as <span class="s20">drop-tail</span>) or remove one or more already-queued packets to make room for the newly arrived packet. In some cases, it may be advantageous to drop (or mark the</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;">header of) a packet <i>before </i>the buffer is full in order to provide a congestion signal to the sender. A number of proactive packet-dropping and -marking policies (which collectively have become known as <span class="s23">active</span><span class="s20"> queue management (AQM) </span><a href="#bookmark848" class="s124">algorithms) have been proposed and analyzed </a><a href="#bookmark848" class="a">[Labrador 199</a><span class="s20">9</span>,</p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 15pt;text-align: left;"><a href="#bookmark848" class="a">Hollot 2002</a>]<span class="p">. One of the most widely studied and implemented AQM algorithms is the </span><span class="s23">Random</span> Early</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span class="s23">Detection</span> (RED) <a href="#bookmark848" class="s124">algorithm </a><a href="#bookmark848" class="a">[Christiansen 200</a>1<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Floyd 2016</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark386" class="s124">Output port queuing is illustrated in </a><a href="#bookmark386" class="a">Figure 4.</a><span class="s20">9</span>. At time <i>t, </i>a packet has arrived at each of the incoming input ports, each destined for the uppermost outgoing port. Assuming identical line speeds and a switch operating at three times the line speed, one time unit later (that is, in the time needed to receive or send</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a name="bookmark387">a packet), all three original packets have been transferred to the outgoing port and are queued awaiting transmission. In the next time unit, one of these three packets will have been transmitted over the outgoing link. In our example, two </a><i>new </i>packets have arrived at the incoming side of the switch; one of</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">these packets is destined for this uppermost output port. A consequence of such queuing is that a</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">packet scheduler <span class="p">at the output port must choose one packet, among those queued, for transmission— a topic we’ll cover in the following section.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;">Given that router buffers are needed to absorb the fluctuations in traffic load, a natural question to ask is how <i>much </i><a href="#bookmark848" class="s124">buffering is required. For many years, the rule of thumb </a><a href="#bookmark848" class="a">[RFC 3439]</a><span class="s20"> </span>for buffer sizing was that the amount of buffering <i>(B) </i>should be equal to an average round-trip time (<i>RTT</i>, say 250 msec) times</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">the link capacity <i>(C)</i>. This result is based on an analysis of the queueing dynamics of a relatively small</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 21pt;text-align: left;"><a href="#bookmark848" class="s124">number of TCP flows </a><a href="#bookmark848" class="a">[Villamizar 1994</a><span class="s20">]</span>. Thus, a 10 Gbps link with an RTT of 250 msec would need an amount of buffering equal to <i>B 5 RTT </i>· <i>C </i><a href="#bookmark848" class="s124">5 2.5 Gbits of buffers. More recent theoretical and experimental efforts </a><a href="#bookmark848" class="a">[Appenzeller 2004</a><span class="s20">]</span>, however, suggest that when there are a large number of TCP flows (<i>N</i>) passing through a link, the amount of buffering needed is <span class="s27">B=</span>RTI<span class="s29">⋅</span><a href="#bookmark848" class="s124">C/N. With a large number of flows typically passing through large backbone router links (see, e.g., </a><a href="#bookmark848" class="a">[Fraleigh 2003</a><span class="s20">]</span>), the value of <i>N </i><a href="#bookmark848" class="s124">can be large, with the decrease in needed buffer size becoming quite significant. </a><a href="#bookmark848" class="a">[Appenzeller 200</a><span class="s20">4</span><a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Wischik 200</a><span class="s20">5</span><a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Beheshti 2008]</a><span class="s20"> </span>provide very readable discussions of the buffer-sizing problem from a</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">theoretical, implementation, and operational standpoint.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Packet Scheduling</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now return to the question of determining the order in which queued packets are transmitted over an outgoing link. Since you yourself have undoubtedly had to wait in long lines on many occasions and observed how waiting customers are served, you’re no doubt familiar with many of the queueing disciplines commonly used in routers. There is first-come-first-served (FCFS, also known as first-in-first- out, FIFO). The British are famous for patient and orderly FCFS queueing at bus stops and in the marketplace (“Oh, are you queueing?”). Other countries operate on a priority basis, with one class of waiting customers given priority service over other waiting customers. There is also round-robin queueing, where customers are again divided into classes (as in priority queueing) but each class of customer is given service in turn.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">First-in-First-Out (FIFO)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark388" class="a">Figure 4.10</a> <span class="p">shows the queuing model abstraction for the FIFO link-scheduling discipline. Packets arriving at the link output queue wait for transmission if the link is currently busy transmitting another packet. If there is not sufficient buffering space to hold the arriving packet, the queue’s packet-</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">discarding policy then determines whether the packet will be dropped (lost) or whether other packets will be removed from the queue to make space for the arriving packet, as discussed above. In our</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">discussion below, we’ll ignore packet discard. When a packet is completely transmitted over the outgoing link (that is, receives service) it is removed from the queue.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The FIFO (also known as first-come-first-served, or FCFS) scheduling discipline selects packets for link transmission in the same order in which they arrived at the output link queue. We’re all familiar with FIFO queuing from service centers, where</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="483" height="174" alt="image" src="计算机网络自顶向下7th-en/Image_408.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark388">Figure 4.10 FIFO queueing abstraction</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark389" class="s124">arriving customers join the back of the single waiting line, remain in order, and are then served when they reach the front of the line. </a><a href="#bookmark389" class="a">Figure 4.11</a> <span class="p">shows the FIFO queue in operation. Packet arrivals are</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">indicated by numbered arrows above the upper timeline, with the number indicating the order in which the packet arrived. Individual packet departures are shown below the lower timeline. The time that a packet spends in service (being transmitted) is indicated by the shaded rectangle between the two timelines. In our examples here, let’s assume that each packet takes three units of time to be transmitted. Under the FIFO discipline, packets leave in the same order in which they arrived. Note that after the departure of packet 4, the link remains idle (since packets 1 through 4 have been transmitted and removed from the queue) until the arrival of packet 5.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Priority Queuing</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark390" class="s124">Under priority queuing, packets arriving at the output link are classified into priority classes upon arrival at the queue, as shown in </a><a href="#bookmark390" class="a">Figure 4.1</a>2<span class="p">. In practice, a network operator may configure a queue so that</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">packets carrying network management information (e.g., as indicated by the source or destination TCP/UDP port number) receive priority over user traffic; additionally, real-time voice-over-IP packets might receive priority over non-real traffic such as SMTP or IMAP e-mail packets. Each</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="774" height="251" alt="image" src="计算机网络自顶向下7th-en/Image_409.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark389">Figure 4.11 The FIFO queue in operation</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="602" height="255" alt="image" src="计算机网络自顶向下7th-en/Image_410.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark390">Figure 4.12 The priority queueing model</a><a name="bookmark391">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">priority class typically has its own queue. When choosing a packet to transmit, the priority queuing discipline will transmit a packet from the highest priority class that has a nonempty queue (that is, has packets waiting for transmission). The choice among packets in the same priority class is typically done in a FIFO manner.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark392" class="a">Figure 4.13</a> <span class="p">illustrates the operation of a priority queue with two priority classes. Packets 1, 3, and 4 belong to the high-priority class, and packets 2 and 5 belong to the low-priority class. Packet 1 arrives and, finding the link idle, begins transmission. During the transmission of packet 1, packets 2 and 3</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">arrive and are queued in the low- and high-priority queues, respectively. After the transmission of packet 1, packet 3 (a high-priority packet) is selected for transmission over packet 2 (which, even though it arrived earlier, is a low-priority packet). At the end of the transmission of packet 3, packet 2 then begins transmission. Packet 4 (a high-priority packet) arrives during the transmission of packet 2 (a low-priority packet). Under a <span class="s20">non-preemptive priority queuing </span>discipline, the transmission of a packet is not interrupted once it has</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="774" height="252" alt="image" src="计算机网络自顶向下7th-en/Image_411.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark392">Figure 4.13 The priority queue in operation</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="774" height="251" alt="image" src="计算机网络自顶向下7th-en/Image_412.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark393">Figure 4.14 The two-class robin queue in operation</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">begun. In this case, packet 4 queues for transmission and begins being transmitted after the transmission of packet 2 is completed.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Round Robin and Weighted Fair Queuing (WFQ)</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Under the round robin queuing discipline, packets are sorted into classes as with priority queuing. However, rather than there being a strict service priority among classes, a round robin scheduler alternates service among the classes. In the simplest form of round robin scheduling, a class 1 packet is transmitted, followed by a class 2 packet, followed by a class 1 packet, followed by a class 2 packet, and so on. A so-called <span class="s20">work-conserving queuing </span>discipline will never allow the link to remain idle whenever there are packets (of any class) queued for transmission. A work-conserving round robin discipline that looks for a packet of a given class but finds none will immediately check the next class in the round robin sequence.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark393" class="a">Figure 4.14</a> <span class="p">illustrates the operation of a two-class round robin queue. In this example, packets 1, 2, and</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark394">4 belong to class 1, and packets 3 and 5 belong to the second class. Packet 1 begins transmission immediately upon arrival at the output queue. Packets 2 and 3 arrive during the transmission of packet 1 and thus queue for transmission. After the transmission of packet 1, the link scheduler looks for a class 2 packet and thus transmits packet 3. After the transmission of packet 3, the scheduler looks for a class 1 packet and thus transmits packet 2. After the transmission of packet 2, packet 4 is the only queued packet; it is thus transmitted immediately after packet 2.</a><a name="bookmark395">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 139%;text-align: left;"><span class="p">A generalized form of round robin queuing that has been widely implemented in routers is the so-called </span><span class="s23">weighted</span><a href="#bookmark848" class="a"> fair queuing (WFQ) discipline [Demers </a>1990<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Parekh </a>1993<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Cisco QoS 2016</a>]<a href="#bookmark397" class="s124">. WFQ is illustrated in </a><a href="#bookmark397" class="a">Figure 4.1</a>5<span class="p">. Here, arriving packets are classified and queued in the appropriate per-class waiting area. As in round robin scheduling, a WFQ scheduler will serve classes in a circular manner—</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark396">first serving class 1, then serving class 2, then serving class 3, and then (assuming there are three classes) repeating the service pattern. WFQ is also a work-conserving</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="634" height="261" alt="image" src="计算机网络自顶向下7th-en/Image_413.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark397">Figure 4.15 Weighted fair queueing</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">queuing discipline and thus will immediately move on to the next class in the service sequence when it finds an empty class queue.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 159%;text-align: left;">WFQ differs from round robin in that each class may receive a differential amount of service in any interval of time. Specifically, each class, <i>i</i>, is assigned a weight, <i>w</i><span class="s31">i</span>. Under WFQ, during any interval of time during which there are class <i>i </i>packets to send, class <i>i </i>will then be guaranteed to receive a fraction</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">of service equal to wi/(∑wj), where the sum in the denominator is taken over all classes that also have</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">packets queued for transmission. In the worst case, even if all classes have queued packets, class <i>i </i>will still be guaranteed to receive a fraction wi/(∑wj) of the bandwidth, where in this worst case the sum in</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 127%;text-align: left;">the denominator is over <i>all </i>classes. Thus, for a link with transmission rate <i>R</i>, class <i>i </i>will always achieve a throughput of at least R<span class="s29">⋅</span>wi/(∑wj). Our description of WFQ has been idealized, as we have not considered the fact that packets are discrete and a packet’s transmission will not be interrupted to begin</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">transmission of another packet; </a><a href="#bookmark848" class="a">[Demers </a>1990<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Parekh 1993]</a> <span class="p">discuss this packetization issue.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l194"><ol id="l195"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark398">The Internet Protocol (IP): IPv4, Addressing, IPv6, and More</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark368" class="s124">Our study of the network layer thus far in </a><a href="#bookmark368" class="a">Chapter </a>4<span class="p">—the notion of the data and control plane component of the network layer, our distinction between forwarding and routing, the identification of various network service models, and our look inside a router—have often been without reference to any</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">specific computer network architecture or protocol. In this section we’ll focus on key aspects of the network layer on today’s Internet and the celebrated Internet Protocol (IP).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">There are two versions of IP in use today. We’ll first examine the widely deployed IP protocol version 4, which is usually referred to simply as IPv4 </a><a href="#bookmark848" class="a">[RFC 791]</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="557" height="404" alt="image" src="计算机网络自顶向下7th-en/Image_414.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark399">Figure 4.16 IPv4 datagram format</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark400" class="s124">in </a><a href="#bookmark400" class="a">Section 4.3.</a>1<a href="#bookmark848" class="s124">. We’ll examine IP version 6 </a><a href="#bookmark848" class="a">[RFC </a>2460<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 4291</a>]<a href="#bookmark424" class="s124">, which has been proposed to replace IPv4, in </a><a href="#bookmark424" class="a">Section 4.3.</a>5<span class="p">. In between, we’ll primarily cover Internet addressing—a topic that might seem rather dry and detail-oriented but we’ll see is crucial to understanding how the Internet’s network</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">layer works. To master IP addressing is to master the Internet’s network layer itself!</p><ol id="l196"><li style="padding-top: 3pt;padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">IPv4 Datagram Format</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Recall that the Internet’s network-layer packet is referred to as a <i>datagram</i>. We begin our study of IP with an overview of the syntax and semantics of the IPv4 datagram. You might be thinking that nothing could be drier than the syntax and semantics of a packet’s bits. Nevertheless, the datagram plays a</p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">central role in the Internet—every networking student and professional needs to see it, absorb it, and master it. (And just to see that protocol headers can indeed be fun to study, check out </a><a href="#bookmark848" class="a">[Pomeranz </a>2010]<a href="#bookmark399" class="s124">). The IPv4 datagram format is shown in </a><a href="#bookmark399" class="a">Figure 4.1</a>6<span class="p">. The key fields in the IPv4 datagram are the</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">following:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_415.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Version number. <span class="p">These 4 bits specify the IP protocol version of the datagram. By looking at the version number, the router can determine how to interpret the remainder of the IP datagram. Different versions of IP use different datagram formats. The datagram format for IPv4 is shown in</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_416.png"/></span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark399" class="a">Figure 4.1</a>6<a href="#bookmark424" class="s124">. The datagram format for the new version of IP (IPv6) is discussed in </a><a href="#bookmark424" class="a">Section 4.3.</a>5<span class="p">. </span><span style=" color: #333;">Header length. </span><span class="p">Because an IPv4 datagram can contain a variable number of options (which are included in the IPv4 datagram header), these 4 bits are needed to determine where in the IP</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">datagram the payload (e.g., the transport-layer segment being encapsulated in this datagram) actually begins. Most IP datagrams do not contain options, so the typical IP datagram has a 20-byte header.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_417.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Type of service. <span class="p">The type of service (TOS) bits were included in the IPv4 header to allow different types of IP datagrams to be distinguished from each other. For example, it might be useful to distinguish real-time datagrams (such as those used by an IP telephony application) from non-real-</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark356" class="s124">time traffic (for example, FTP). The specific level of service to be provided is a policy issue determined and configured by the network administrator for that router. We also learned in </a><a href="#bookmark356" class="a">Section</a></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 12pt;text-align: left;"><a href="#bookmark356" class="a">3.7.2</a> <span class="p">that two of the TOS bits are used for Explicit Congestion Notification.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_418.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Datagram length. <span class="p">This is the total length of the IP datagram (header plus data), measured in bytes. Since this field is 16 bits long, the theoretical maximum size of the IP datagram is 65,535 bytes. However, datagrams are rarely larger than 1,500 bytes, which allows an IP datagram to fit in the</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">payload field of a maximally sized Ethernet frame.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_419.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Identifier, flags, fragmentation offset. <span class="p">These three fields have to do with so-called IP fragmentation, a topic we will consider shortly. Interestingly, the new version of IP, IPv6, does not allow for fragmentation.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_420.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Time-to-live. <span class="p">The time-to-live (TTL) field is included to ensure that datagrams do not circulate forever (due to, for example, a long-lived routing loop) in the network. This field is decremented by one each time the datagram is processed by a router. If the TTL field reaches 0, a router must drop</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">that datagram.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_421.png"/></span></p><p class="s28" style="padding-left: 25pt;text-indent: 0pt;line-height: 138%;text-align: left;">Protocol. <span class="p">This field is typically used only when an IP datagram reaches its final destination. The value of this field indicates the specific transport-layer protocol to which the data portion of this IP datagram should be passed. For example, a value of 6 indicates that the data portion is passed to</span></p><p style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;text-align: left;">TCP, while a value of 17 indicates that the data is passed to UDP. For a list of all possible values,</p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark400">see </a><a href="#bookmark848" class="a">[IANA Protocol Numbers </a>2016]<span class="p">. Note that the protocol number in the IP datagram has a role that is analogous to the role of the port number field in the transport-layer segment. The protocol number is the glue that binds the network and transport layers together, whereas the port number is</span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark513" class="s124">the glue that binds the transport and application layers together. We’ll see in </a><a href="#bookmark513" class="a">Chapter 6</a> <span class="p">that the link- layer frame also has a special field that binds the link layer to the network layer.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_422.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Header checksum. <span class="p">The header checksum aids a router in detecting bit errors in a received IP datagram. The header checksum is computed by treating each 2 bytes in the header as a number</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark271" class="s124">and summing these numbers using 1s complement arithmetic. As discussed in </a><a href="#bookmark271" class="a">Section 3.</a>3<span class="p">, the 1s complement of this sum, known as the Internet checksum, is stored in the checksum field. A router computes the header checksum for each received IP datagram and detects an error condition if the</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">checksum carried in the datagram header does not equal the computed checksum. Routers typically discard datagrams for which an error has been detected. Note that the checksum must be recomputed and stored again at each router, since the TTL field, and possibly the options field as well, will change. An interesting discussion of fast algorithms for computing the Internet checksum is</p><p class="s20" style="padding-top: 2pt;padding-left: 25pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="a">[RFC </a>1071]<span class="p">. A question often asked at this point is, why does TCP/IP perform error checking at both the transport and network layers? There are several reasons for this repetition. First, note that only the IP header is checksummed at the IP layer, while the TCP/UDP checksum is computed over the</span></p><p class="s20" style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">entire TCP/UDP segment. Second, TCP/UDP and IP do not necessarily both have to belong to the same protocol stack. TCP can, in principle, run over a different network-layer protocol (for example, ATM) </a><a href="#bookmark848" class="a">[Black </a>1995]<span class="p">) and IP can carry data that will not be passed to TCP/UDP.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_423.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 13pt;text-align: left;">Source and destination IP addresses. <span class="p">When a source creates a datagram, it inserts its IP address</span></p><p class="s20" style="padding-top: 4pt;padding-left: 25pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark138" class="s124">into the source IP address field and inserts the address of the ultimate destination into the destination IP address field. Often the source host determines the destination address via a DNS lookup, as discussed in </a><a href="#bookmark138" class="a">Chapter </a>2<a href="#bookmark416" class="s124">. We’ll discuss IP addressing in detail in </a><a href="#bookmark416" class="a">Section 4.3.</a>3<span class="p">.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_424.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 13pt;text-align: left;">Options. <span class="p">The options fields allow an IP header to be extended. Header options were meant to be</span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">used rarely—hence the decision to save overhead by not including the information in options fields in every datagram header. However, the mere existence of options does complicate matters—since datagram headers can be of variable length, one cannot determine a priori where the data field will start. Also, since some datagrams may require options processing and others may not, the amount of time needed to process an IP datagram at a router can vary greatly. These considerations become particularly important for IP processing in high-performance routers and hosts. For these</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_425.png"/></span></p><p style="padding-top: 2pt;padding-left: 25pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark424" class="s124">reasons and others, IP options were not included in the IPv6 header, as discussed in </a><a href="#bookmark424" class="a">Section 4.3.</a><span class="s20">5</span>. <b>Data (payload). </b>Finally, we come to the last and most important field—the <i>raison d’etre </i>for the datagram in the first place! In most circumstances, the data field of the IP datagram contains the</p><p class="s20" style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark496" class="s124">transport-layer segment (TCP or UDP) to be delivered to the destination. However, the data field can carry other types of data, such as ICMP messages (discussed in </a><a href="#bookmark496" class="a">Section 5.</a>6<span class="p">).</span></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Note that an IP datagram has a total of 20 bytes of header (assuming no options). If the datagram carries a TCP segment, then each (non-fragmented) datagram carries a total of 40 bytes of header (20 bytes of IP header plus 20 bytes of TCP header) along with the application-layer message.</p></li><li style="padding-top: 3pt;padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">IPv4 Datagram Fragmentation</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark513" class="s124">We’ll see in </a><a href="#bookmark513" class="a">Chapter 6</a> <span class="p">that not all link-layer protocols can carry network-layer packets of the same size. Some protocols can carry big datagrams, whereas other protocols can carry only little datagrams. For example, Ethernet frames can carry up to 1,500 bytes of data, whereas frames for some wide-area links</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">can carry no more than 576 bytes. The maximum amount of data that a link-layer frame can carry is called the <span class="s20">maximum transmission unit (MTU)</span>. Because each IP datagram is encapsulated within the link-layer frame for transport from one router to the next router, the MTU of the link-layer protocol places a hard limit on the length of an IP datagram. Having a hard limit on the size of an IP datagram is not much of a problem. What is a problem is that each of the links along the route between sender and destination can use different link-layer protocols, and each of these protocols can have different MTUs.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">To understand the forwarding issue better, imagine that <i>you </i>are a router that interconnects several links, each running different link-layer protocols with different MTUs. Suppose you receive an IP datagram from one link. You check your forwarding table to determine the outgoing link, and this outgoing link has</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">an MTU that is smaller than the length of the IP datagram. Time to panic—how are you going to squeeze this oversized IP datagram into the payload field of the link-layer frame? The solution is to fragment the payload in the IP datagram into two or more smaller IP datagrams, encapsulate each of these smaller IP datagrams in a separate link-layer frame; and send these frames over the outgoing link. Each of these smaller datagrams is referred to as a <span class="s20">fragment</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Fragments need to be reassembled before they reach the transport layer at the destination. Indeed, both TCP and UDP are expecting to receive complete, unfragmented segments from the network layer. The designers of IPv4 felt that reassembling datagrams in the routers would introduce significant complication into the protocol and put a damper on router performance. (If you were a router, would you want to be reassembling fragments on top of everything else you had to do?) Sticking to the principle of keeping the network core simple, the designers of IPv4 decided to put the job of datagram reassembly in the end systems rather than in network routers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">When a destination host receives a series of datagrams from the same source, it needs to determine whether any of these datagrams are fragments of some original, larger datagram. If some datagrams are fragments, it must further determine when it has received the last fragment and how the fragments it has received should be pieced back together to form the original datagram. To allow the destination host</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">to perform these reassembly tasks, the designers of IP (version 4) put <i>identification, flag, </i>and <i>fragmentation offset </i>fields in the IP datagram header. When a datagram is created, the sending host stamps the datagram with an identification number as well as source and destination addresses.</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Typically, the sending host increments the identification number for each datagram it sends. When a router needs to fragment a datagram, each resulting datagram (that is, fragment) is stamped with the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">source address, destination address, and identification number of the original datagram. When the destination receives a series of datagrams from the same sending host, it can examine the identification numbers of the datagrams to determine which of the datagrams are actually fragments of the same larger datagram. Because IP is an unreliable service, one or more of the fragments may never arrive at the destination. For this reason, in order for the destination host to be absolutely sure it has received the last fragment of</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="624" height="467" alt="image" src="计算机网络自顶向下7th-en/Image_426.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark401">Figure 4.17 IP fragmentation and reassembly</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the original datagram, the last fragment has a flag bit set to 0, whereas all the other fragments have this flag bit set to 1. Also, in order for the destination host to determine whether a fragment is missing (and also to be able to reassemble the fragments in their proper order), the offset field is used to specify where the fragment fits within the original IP datagram.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark401" class="a">Figure 4.17</a> <span class="p">illustrates an example. A datagram of 4,000 bytes (20 bytes of IP header plus 3,980 bytes of IP payload) arrives at a router and must be forwarded to a link with an MTU of 1,500 bytes. This implies that the 3,980 data bytes in the original datagram must be allocated to three separate fragments</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">(each of which is also an IP datagram).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The online material for this book, and the problems at the end of this chapter will allow you to explore fragmentation in more detail. Also, on this book’s Web site, we provide a Java applet that generates fragments. You provide the incoming datagram size, the MTU, and the incoming datagram identification.</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="http://www.pearsonhighered.com/cs-" class="s124" target="_blank" name="bookmark402">The applet automatically generates the fragments for you. See </a><a href="http://www.pearsonhighered.com/cs-" class="a" target="_blank">http://www.pearsonhighered.com/</a>cs- resources/<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">IPv4 Addressing</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">We now turn our attention to IPv4 addressing. Although you may be thinking that addressing must be a straightforward topic, hopefully by the end of this section you’ll be convinced that Internet addressing is not only a juicy, subtle, and interesting topic but also one that is of central importance to the Internet. An</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">excellent treatment of IPv4 addressing can be found in the first chapter in </a><a href="#bookmark848" class="a">[Stewart </a>1999]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before discussing IP addressing, however, we’ll need to say a few words about how hosts and routers are connected into the Internet. A host typically has only a single link into the network; when IP in the host wants to send a datagram, it does so over this link. The boundary between the host and the physical link is called an <span class="s20">interface</span>. Now consider a router and its interfaces. Because a router’s job is to receive a datagram on one link and forward the datagram on some other link, a router necessarily has two or more links to which it is connected. The boundary between the router and any one of its links is also called an interface. A router thus has multiple interfaces, one for each of its links. Because every host and router is capable of sending and receiving IP datagrams, IP requires each host and router</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">interface to have its own IP address. <i>Thus, an IP address is technically associated with an interface, rather than with the host or router containing that interface.</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 144%;text-align: left;">Each IP address is 32 bits long (equivalently, 4 bytes), and there are thus a total of 2<span class="s21">32</span><span class="s22"> </span>(or approximately 4 billion) possible IP addresses. These addresses are typically written in so-called <span class="s20">dotted-decimal notation</span>, in which each byte of the address is written in its decimal form and is separated by a period (dot) from other bytes in the address. For example, consider the IP address 193.32.216.9. The 193 is the decimal equivalent of the first 8 bits of the address; the 32 is the decimal equivalent of the second 8 bits of the address, and so on. Thus, the address 193.32.216.9 in binary notation is</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s132" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="1" height="29" alt="image" src="计算机网络自顶向下7th-en/Image_427.png"/></span>       <span class="p">11000001 00100000 11011000 00001001</span></p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark419" class="s124">Each interface on every host and router in the global Internet must have an IP address that is globally unique (except for interfaces behind NATs, as discussed in </a><a href="#bookmark419" class="a">Section 4.3.</a>4<span class="p">). These addresses cannot be</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">chosen in a willy-nilly manner, however. A portion of an interface’s IP address will be determined by the subnet to which it is connected.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark404" class="a">Figure 4.18</a> <span class="p">provides an example of IP addressing and interfaces. In this figure, one router (with three interfaces) is used to interconnect seven hosts. Take a close look at the IP addresses assigned to the host and router interfaces, as there are several things to notice. The three hosts in the upper-left portion</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark404" class="s124">of </a><a href="#bookmark404" class="a">Figure 4.1</a>8<span class="p">, and the router interface to which they are connected, all have an IP address of the form</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">223.1.1.xxx. That is, they all have the same leftmost 24 bits in their IP address. These four interfaces</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">are also interconnected to each other by a network <i>that contains no routers</i>. This network could be interconnected by an Ethernet LAN, in which case the interfaces would be interconnected by an</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark513" class="s124">Ethernet switch (as we’ll discuss in </a><a href="#bookmark513" class="a">Chapter </a>6<a href="#bookmark591" class="s124">), or by a wireless access point (as we’ll discuss in </a><a href="#bookmark591" class="a">Chapter </a>7<a href="#bookmark513" class="s124">). We’ll represent this routerless network connecting these hosts as a cloud for now, and dive into the internals of such networks in </a><a href="#bookmark513" class="a">Chapters 6</a> <a href="#bookmark591" class="s124">and </a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a name="bookmark403">In IP terms, this network interconnecting three host interfaces and one router interface forms a </a><a href="#bookmark848" class="a">subnet [RFC 950</a><span class="s20">]</span>. (A subnet is also called an <i>IP network </i>or simply</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="600" height="418" alt="image" src="计算机网络自顶向下7th-en/Image_428.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark404">Figure 4.18 Interface addresses and subnets</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">a <i>network </i>in the Internet literature.) IP addressing assigns an address to this subnet: 223.1.1.0/24, where the /24 (“slash-24”) notation, sometimes known as a <span class="s20">subnet mask</span>, indicates that the leftmost 24 bits of the 32-bit quantity define the subnet address. The 223.1.1.0/24 subnet thus consists of the three</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;">host interfaces (223.1.1.1, 223.1.1.2, and 223.1.1.3) and one router interface (223.1.1.4). Any additional hosts attached to the 223.1.1.0/24 subnet would be <i>required </i><a href="#bookmark404" class="s124">to have an address of the form 223.1.1.xxx. There are two additional subnets shown in </a><a href="#bookmark404" class="a">Figure 4.1</a><span class="s20">8</span>: the 223.1.2.0/24 network and the 223.1.3.0/24</p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark405" class="s124">subnet. </a><a href="#bookmark405" class="a">Figure 4.19</a> <a href="#bookmark404" class="s124">illustrates the three IP subnets present in </a><a href="#bookmark404" class="a">Figure 4.1</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark407" class="s124">The IP definition of a subnet is not restricted to Ethernet segments that connect multiple hosts to a router interface. To get some insight here, consider </a><a href="#bookmark407" class="a">Figure 4.2</a>0<span class="p">, which shows three routers that are</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">interconnected with each other by point-to-point links. Each router has three interfaces, one for each point-to-point link and one for the broadcast link that directly connects the router to a pair of hosts. What</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">subnets are present here? Three subnets, 223.1.1.0/24, 223.1.2.0/24, and 223.1.3.0/24, are similar to</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark404" class="s124">the subnets we encountered in </a><a href="#bookmark404" class="a">Figure 4.1</a>8<span class="p">. But note that there are three additional subnets in this example as well: one subnet, 223.1.9.0/24, for the interfaces that connect routers R1 and R2; another subnet, 223.1.8.0/24, for the interfaces that connect routers R2 and R3; and a third subnet,</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">223.1.7.0/24, for the interfaces that connect routers R3 and R1. For a general interconnected system of routers and hosts, we can use the following recipe to define the subnets in the system:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="600" height="402" alt="image" src="计算机网络自顶向下7th-en/Image_429.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark405">Figure 4.19 Subnet addresses</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="85" alt="image" src="计算机网络自顶向下7th-en/Image_430.png"/></span></p><p class="s17" style="padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">To determine the subnets, detach each interface from its host or router, creating islands of isolated networks, with interfaces terminating the end points of the isolated networks. Each of these isolated networks is called a <span class="s133">subnet</span><span class="p">.</span></p><p class="s20" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 40pt;text-align: left;"><a href="#bookmark407" class="s124">If we apply this procedure to the interconnected system in </a><a href="#bookmark407" class="a">Figure 4.2</a>0<span class="p">, we get six islands or subnets. From the discussion above, it’s clear that an organization (such as a company or academic institution)</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">with multiple Ethernet segments and point-to-point links will have multiple subnets, with all of the devices on a given subnet having the same subnet address. In principle, the different subnets could have quite different subnet addresses. In practice, however, their subnet addresses often have much in common. To understand why, let’s next turn our attention to how addressing is handled in the global Internet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;">The Internet’s address assignment strategy is known as <span class="s20">Classless Interdomain Routing (CIDR</span>— pronounced <i>cider</i><a href="#bookmark848" class="s124">) </a><a href="#bookmark848" class="a">[RFC </a><span class="s20">4632]</span>. CIDR generalizes the notion of subnet addressing. As with subnet</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">addressing, the 32-bit IP address is divided into two parts and again has the dotted-decimal form</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">a.b.c.d/x<span class="p">, where </span>x <span class="p">indicates the number of bits in the first part of the address.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 129%;text-align: left;">The <i>x </i>most significant bits of an address of the form <i>a.b.c.d/x </i>constitute the network portion of the IP address, and are often referred to as the <span class="s23">prefix</span><span class="s20"> </span>(or <i>network prefix</i>) of the address. An organization is typically assigned a block of contiguous addresses, that is, a range of addresses with a common prefix</p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark408" class="s124" name="bookmark406">(see the </a><a href="#bookmark408" class="a">Principles in Practice</a> <span class="p">feature). In this case, the IP addresses of devices within the organization will share the common prefix. When we cover the Internet’s BGP routing protocol in</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="471" height="515" alt="image" src="计算机网络自顶向下7th-en/Image_431.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark407">Figure 4.20 Three routers interconnecting six subnets</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark480" class="a">Section 5.</a><span class="s20">4</span>, we’ll see that only these <i>x </i>leading prefix bits are considered by routers outside the organization’s network. That is, when a router outside the organization forwards a datagram whose</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">destination address is inside the organization, only the leading <i>x </i>bits of the address need be considered. This considerably reduces the size of the forwarding table in these routers, since a <i>single </i>entry of the form <i>a.b.c.d/x </i>will be sufficient to forward packets to <i>any </i>destination within the organization.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">The remaining 32-<i>x </i>bits of an address can be thought of as distinguishing among the devices <i>within </i>the organization, all of which have the same network prefix. These are the bits that will be considered when</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">forwarding packets at routers <i>within </i>the organization. These lower-order bits may (or may not) have an</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">additional subnetting structure, such as that discussed above. For example, suppose the first 21 bits of the CIDRized address a.b.c.d/21 specify the organization’s network prefix and are common to the IP addresses of all devices in that organization. The remaining 11 bits then identify the specific hosts in the organization. The organization’s internal structure might be such that these 11 rightmost bits are used for subnetting within the organization, as discussed above. For example, a.b.c.d/24 might refer to a specific subnet within the organization.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before CIDR was adopted, the network portions of an IP address were constrained to be 8, 16, or 24 bits in length, an addressing scheme known as <span class="s20">classful addressing</span>, since subnets with 8-, 16-, and 24-bit subnet addresses were known as class A, B, and C networks, respectively. The requirement that the subnet portion of an IP address be exactly 1, 2, or 3 bytes long turned out to be problematic for</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;">supporting the rapidly growing number of organizations with small and medium-sized subnets. A class C (/24) subnet could accommodate only up to 2<span class="s21">8</span><span class="s22"> </span>− 2 = 254 hosts (two of the 2<span class="s21">8</span><span class="s22"> </span>= 256 addresses are reserved for special use)—too small for many organizations. However, a class B (/16) subnet, which supports up to 65,634 hosts, was too large. Under classful addressing, an organization with, say, 2,000 hosts was typically allocated a class B (/16) subnet address. This led to a rapid depletion of the class B address space and poor utilization of the assigned address space. For example, the organization that used a class B address for its 2,000 hosts was allocated enough of the address space for up to 65,534 interfaces—leaving more than 63,000 addresses that could not be used by other organizations.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="574" alt="image" src="计算机网络自顶向下7th-en/Image_432.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">PRINCIPLES IN PRACTICE</p><p style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">This example of an ISP that connects eight organizations to the Internet nicely illustrates how</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark409" class="s124">carefully allocated CIDRized addresses facilitate routing. Suppose, as shown in </a><a href="#bookmark409" class="a">Figure 4.2</a>1<span class="p">, that the ISP (which we’ll call Fly-By-Night-ISP) advertises to the outside world that it should be sent any datagrams whose first 20 address bits match 200.23.16.0/20. The rest of the world</span></p><p style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">need not know that within the address block 200.23.16.0/20 there are in fact eight other organizations, each with its own subnets. This ability to use a single prefix to advertise multiple networks is often referred to as <span class="s20">address aggregation </span>(also <span class="s20">route aggregation </span>or <span class="s20">route summarization</span>).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Address aggregation works extremely well when addresses are allocated in blocks to ISPs and then from ISPs to client organizations. But what happens when addresses are not allocated in such a hierarchical manner? What would happen, for example, if Fly-By-Night-ISP acquires ISPs-R-Us and then has Organization 1 connect to the Internet through its subsidiary ISPs-R-</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark409" class="s124">Us? As shown in </a><a href="#bookmark409" class="a">Figure 4.2</a>1<span class="p">, the subsidiary ISPs-R-Us owns the address block 199.31.0.0/16, but Organization 1’s IP addresses are unfortunately outside of this address block. What should be done here? Certainly, Organization 1 could renumber all of its routers and hosts to have</span></p><p class="s20" style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark410" class="s124">addresses within the ISPs-R-Us address block. But this is a costly solution, and Organization 1 might well be reassigned to another subsidiary in the future. The solution typically adopted is for Organization 1 to keep its IP addresses in 200.23.18.0/23. In this case, as shown in </a><a href="#bookmark410" class="a">Figure 4.2</a>2<span class="p">,</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="224" alt="image" src="计算机网络自顶向下7th-en/Image_433.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><a name="bookmark408">Fly-By-Night-ISP continues to advertise the address block 200.23.16.0/20 and ISPs-R-Us</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;">continues to advertise 199.31.0.0/16. However, ISPs-R-Us now <i>also </i>advertises the block of addresses for Organization 1, 200.23.18.0/23. When other routers in the larger Internet see the address blocks 200.23.16.0/20 (from Fly-By-Night-ISP) and 200.23.18.0/23 (from ISPs-R-Us)</p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;">and want to route to an address in the block 200.23.18.0/23, they will use <i>longest prefix matching </i><a href="#bookmark380" class="s124">(see </a><a href="#bookmark380" class="a">Section 4.2.</a><span class="s20">1</span>), and route toward ISPs-R-Us, as it advertises the longest (i.e., most-specific) address prefix that matches the destination address.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="436" alt="image" src="计算机网络自顶向下7th-en/Image_434.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark409">Figure 4.21 Hierarchical addressing and route aggregation</a></h2><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="670" height="436" alt="image" src="计算机网络自顶向下7th-en/Image_435.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark410">Figure 4.22 ISPs-R-Us has a more specific route to Organization 1</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We would be remiss if we did not mention yet another type of IP address, the IP broadcast address 255.255.255.255. When a host sends a datagram with destination address 255.255.255.255, the message is delivered to all hosts on the same subnet. Routers optionally forward the message into neighboring subnets as well (although they usually don’t).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having now studied IP addressing in detail, we need to know how hosts and subnets get their addresses in the first place. Let’s begin by looking at how an organization gets a block of addresses for its devices, and then look at how a device (such as a host) is assigned an address from within the organization’s block of addresses.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Obtaining a Block of Addresses</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In order to obtain a block of IP addresses for use within an organization’s subnet, a network administrator might first contact its ISP, which would provide addresses from a larger block of addresses that had already been allocated to the ISP. For example, the ISP may itself have been allocated the address block 200.23.16.0/20. The ISP, in turn, could divide its address block into eight equal-sized contiguous address blocks and give one of these address blocks out to each of up to eight organizations that are supported by this ISP, as shown below. (We have underlined the subnet part of these addresses for your convenience.)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">ISP’s block:     200.23.16.0/20     <u>11001000 00010111 0001</u>0000 00000000</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 292%;text-align: justify;">Organization 0   200.23.16.0/23     <u>11001000 00010111 0001000</u>0 00000000 Organization 1   200.23.18.0/23     <u>11001000 00010111 0001001</u>0 00000000 Organization 2   200.23.20.0/23     <u>11001000 00010111 0001010</u>0 00000000</p><p style="text-indent: 0pt;line-height: 13pt;text-align: center;">…   …                                     …</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Organization 7   200.23.30.0/23     <u>11001000 00010111 0001111</u>0 00000000</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">While obtaining a set of addresses from an ISP is one way to get a block of addresses, it is not the only way. Clearly, there must also be a way for the ISP itself to get a block of addresses. Is there a global authority that has ultimate responsibility for managing the IP address space and allocating address blocks to ISPs and other organizations? Indeed there is! IP addresses are managed under the authority</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">of the Internet Corporation for Assigned Names and Numbers (ICANN) </a><a href="#bookmark848" class="a">[ICANN </a>2016]<a href="#bookmark848" class="s124">, based on guidelines set forth in </a><a href="#bookmark848" class="a">[RFC </a>7020]<span class="p">. The role of the nonprofit ICANN organization [NTIA 1998] is not only to allocate IP addresses, but also to manage the DNS root servers. It also has the very contentious job</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">of assigning domain names and resolving domain name disputes. The ICANN allocates addresses to regional Internet registries (for example, ARIN, RIPE, APNIC, and LACNIC, which together form the Address Supporting Organization of ICANN </a><a href="#bookmark848" class="a">[ASO-ICANN </a>2016]<span class="p">), and handle the</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">allocation/management of addresses within their regions.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark411">Obtaining a Host Address: The Dynamic Host Configuration Protocol</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">Once an organization has obtained a block of addresses, it can assign individual IP addresses to the host and router interfaces in its organization. A system administrator will typically manually configure the IP addresses into the router (often remotely, with a network management tool). Host addresses can also be configured manually, but typically this is done using the </span>Dynamic Host Configuration Protocol <span class="s23">(DHCP)</span><a href="#bookmark848" class="a"> [RFC 2131</a>]<span class="p">. DHCP allows a host to obtain (be allocated) an IP address automatically. A</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">network administrator can configure DHCP so that a given host receives the same IP address each time</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">it connects to the network, or a host may be assigned a <span class="s20">temporary IP address </span>that will be different each time the host connects to the network. In addition to host IP address assignment, DHCP also allows a host to learn additional information, such as its subnet mask, the address of its first-hop router (often called the default gateway), and the address of its local DNS server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">Because of DHCP’s ability to automate the network-related aspects of connecting a host into a network, it is often referred to as a <span class="s20">plug-and-play </span>or <span class="s20">zeroconf </span>(zero-configuration) protocol. This capability makes it <i>very </i>attractive to the network administrator who would otherwise have to perform these tasks</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">manually! DHCP is also enjoying widespread use in residential Internet access networks, enterprise</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">networks, and in wireless LANs, where hosts join and leave the network frequently. Consider, for example, the student who carries a laptop from a dormitory room to a library to a classroom. It is likely that in each location, the student will be connecting into a new subnet and hence will need a new IP address at each location. DHCP is ideally suited to this situation, as there are many users coming and going, and addresses are needed for only a limited amount of time. The value of DHCP’s plug-and-play capability is clear, since it’s unimaginable that a system administrator would be able to reconfigure laptops at each location, and few students (except those taking a computer networking class!) would have the expertise to configure their laptops manually.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark407" class="s124">DHCP is a client-server protocol. A client is typically a newly arriving host wanting to obtain network configuration information, including an IP address for itself. In the simplest case, each subnet (in the addressing sense of </a><a href="#bookmark407" class="a">Figure 4.2</a>0<span class="p">) will have a DHCP server. If no server is present on the subnet, a</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">DHCP relay agent (typically a router) that knows the address of a DHCP server for that network is</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark412" class="s124">needed. </a><a href="#bookmark412" class="a">Figure 4.23</a> <span class="p">shows a DHCP server attached to subnet 223.1.2/24, with the router serving as the relay agent for arriving clients attached to subnets 223.1.1/24 and 223.1.3/24. In our discussion below, we’ll assume that a DHCP server is available on the subnet.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark414" class="s124">For a newly arriving host, the DHCP protocol is a four-step process, as shown in </a><a href="#bookmark414" class="a">Figure 4.24</a> <a href="#bookmark412" class="s124">for the network setting shown in </a><a href="#bookmark412" class="a">Figure 4.2</a>3<span class="p">. In this figure, </span><span class="s30">yiaddr </span><span class="p">(as in “your Internet address”) indicates the address being allocated to the newly arriving client. The four steps are:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="668" height="506" alt="image" src="计算机网络自顶向下7th-en/Image_436.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Figure 4.23 DHCP client and server</h2><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_437.png"/></span></p><p style="padding-top: 3pt;padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a name="bookmark412"><b>DHCP server discovery. </b></a>The first task of a newly arriving host is to find a DHCP server with which to interact. This is done using a <span class="s20">DHCP discover message</span>, which a client sends within a UDP packet to port 67. The UDP packet is encapsulated in an IP datagram. But to whom should this</p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">datagram be sent? The host doesn’t even know the IP address of the network to which it is attaching, much less the address of a DHCP server for this network. Given this, the DHCP client creates an IP datagram containing its DHCP discover message along with the broadcast destination IP address of 255.255.255.255 and a “this host” source IP address of 0.0.0.0. The DHCP client passes the IP datagram to the link layer, which then broadcasts this frame to all nodes attached to</p><p class="s20" style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;text-align: left;"><a href="#bookmark561" class="s124">the subnet (we will cover the details of link-layer broadcasting in </a><a href="#bookmark561" class="a">Section 6.</a>4<span class="p">).</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_438.png"/></span></p><p style="padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>DHCP server offer(s). </b>A DHCP server receiving a DHCP discover message responds to the client with a <span class="s20">DHCP offer message </span>that is broadcast to all nodes on the subnet, again using the IP broadcast address of 255.255.255.255. (You might want to think about why this server reply must</p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark413">also be broadcast). Since several DHCP servers can be present on the subnet, the client may find itself in the enviable position of being able to choose from among several offers. Each</a></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="506" height="699" alt="image" src="计算机网络自顶向下7th-en/Image_439.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark414">Figure 4.24 DHCP client-server interaction</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">server offer message contains the transaction ID of the received discover message, the proposed IP address for the client, the network mask, and an IP <span class="s20">address lease time</span>—the amount of time for which the IP address will be valid. It is common for the server to set the lease time to several hours</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">or days </a><a href="#bookmark848" class="a">[Droms </a>2002]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_440.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>DHCP request. </b>The newly arriving client will choose from among one or more server offers and respond to its selected offer with a <span class="s20">DHCP request message</span>, echoing back the configuration parameters.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_441.png"/></span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 126%;text-align: left;"><b>DHCP ACK. </b>The server responds to the DHCP request message with a <span class="s23">DHCP</span><span class="s20"> ACK message</span>, confirming the requested parameters.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark415">Once the client receives the DHCP ACK, the interaction is complete and the client can use the DHCP- allocated IP address for the lease duration. Since a client may want to use its address beyond the</a></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark416">lease’s expiration, DHCP also provides a mechanism that allows a client to renew its lease on an IP address.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark513" class="s124">From a mobility aspect, DHCP does have one very significant shortcoming. Since a new IP address is obtained from DHCP each time a node connects to a new subnet, a TCP connection to a remote application cannot be maintained as a mobile node moves between subnets. In </a><a href="#bookmark513" class="a">Chapter </a>6<span class="p">, we will</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">examine mobile IP—an extension to the IP infrastructure that allows a mobile node to use a single</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">permanent address as it moves between subnets. Additional details about DHCP can be found in </a><a href="#bookmark848" class="a">[Droms 2002]</a> <a href="#bookmark848" class="s124">and </a><a href="#bookmark848" class="a">[dhc 2016</a>]<a href="#bookmark848" class="s124">. An open source reference implementation of DHCP is available from the Internet Systems Consortium </a><a href="#bookmark848" class="a">[ISC 2016</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l197"><ol id="l198"><ol id="l199"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Network Address Translation (NAT)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;"><span class="p">Given our discussion about Internet addresses and the IPv4 datagram format, we’re now well aware that every IP-capable device needs an IP address. With the proliferation of small office, home office (SOHO) subnets, this would seem to imply that whenever a SOHO wants to install a LAN to connect multiple machines, a range of addresses would need to be allocated by the ISP to cover all of the SOHO’s IP devices (including phones, tablets, gaming devices, IP TVs, printers and more). If the subnet grew bigger, a larger block of addresses would have to be allocated. But what if the ISP had already allocated the contiguous portions of the SOHO network’s current address range? And what typical homeowner wants (or should need) to know how to manage IP addresses in the first place? Fortunately, there is a simpler approach to address allocation that has found increasingly widespread use in such scenarios: </span><span class="s23">network</span><a href="#bookmark848" class="a"> address translation (NAT) [RFC 266</a>3<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 302</a>2<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Huston 200</a>4<a href="#bookmark845" class="s124">, </a><a href="#bookmark845" class="a">Zhang 200</a>7<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Cisco NAT </a>2016]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark417" class="a">Figure 4.25</a> <a href="#bookmark417" class="s124">shows the operation of a NAT-enabled router. The NAT-enabled router, residing in the home, has an interface that is part of the home network on the right of </a><a href="#bookmark417" class="a">Figure 4.2</a>5<span class="p">. Addressing within the home network is exactly as we have seen above—all four interfaces in the home network have the</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">same subnet address of 10.0.0/24. The address space 10.0.0.0/8 is one of three portions of the IP address space that is reserved in </a><a href="#bookmark848" class="a">[RFC 1918]</a> <span class="p">for a </span><span class="s23">private</span> network <span class="p">or a </span><span class="s23">realm</span> with private addresses<a href="#bookmark417" class="s124">, such as the home network in </a><a href="#bookmark417" class="a">Figure 4.2</a>5<span class="p">. A realm with private addresses refers to a</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">network whose addresses only have meaning to devices within that network. To see why this is</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">important, consider the fact that there are hundreds of thousands of home networks, many using the same address space, 10.0.0.0/24. Devices within a given home network can send packets to each other using 10.0.0.0/24 addressing. However, packets forwarded <i>beyond </i>the home network into the larger</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">global Internet clearly cannot use these addresses (as either a source or a destination address)</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">because there are hundreds of thousands of networks using this block of addresses. That is, the 10.0.0.0/24 addresses can only have meaning within the</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="787" height="378" alt="image" src="计算机网络自顶向下7th-en/Image_442.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark417">Figure 4.25 Network address translation</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">given home network. But if private addresses only have meaning within a given network, how is addressing handled when packets are sent to or received from the global Internet, where addresses are necessarily unique? The answer lies in understanding NAT.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">The NAT-enabled router does not <i>look </i>like a router to the outside world. Instead the NAT router behaves to the outside world as a <i>single </i>device with a <i>single </i><a href="#bookmark417" class="s124">IP address. In </a><a href="#bookmark417" class="a">Figure 4.2</a><span class="s20">5</span>, all traffic leaving the home router for the larger Internet has a source IP address of 138.76.29.7, and all traffic</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">entering the home router must have a destination address of 138.76.29.7. In essence, the NAT-enabled router is hiding the details of the home network from the outside world. (As an aside, you might wonder where the home network computers get their addresses and where the router gets its single IP address. Often, the answer is the same—DHCP! The router gets its address from the ISP’s DHCP server, and the router runs a DHCP server to provide addresses to computers within the NAT-DHCP-router- controlled home network’s address space.)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">If all datagrams arriving at the NAT router from the WAN have the same destination IP address (specifically, that of the WAN-side interface of the NAT router), then how does the router know the internal host to which it should forward a given datagram? The trick is to use a <span class="s20">NAT translation table </span>at the NAT router, and to include port numbers as well as IP addresses in the table entries.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark417" class="s124">Consider the example in </a><a href="#bookmark417" class="a">Figure 4.2</a>5<span class="p">. Suppose a user sitting in a home network behind host 10.0.0.1 requests a Web page on some Web server (port 80) with IP address 128.119.40.186. The host 10.0.0.1 assigns the (arbitrary) source port number 3345 and sends the datagram into the LAN. The NAT router</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">receives the datagram, generates a new source port number 5001 for the datagram, replaces the</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">source IP address with its WAN-side IP address 138.76.29.7, and replaces the original source port number 3345 with the new source port number 5001. When generating a new source port number, the NAT router can select any source port number that is not currently in the NAT translation table. (Note that because a port number field is 16 bits long, the NAT protocol can support over 60,000 simultaneous connections with a single WAN-side IP address for the router!) NAT in the router also adds an entry to its NAT translation table. The Web server, blissfully unaware that the arriving datagram containing the HTTP request has been manipulated by the NAT router, responds with a datagram whose destination address is the IP address of the NAT router, and whose destination port number is 5001. When this datagram arrives at the NAT router, the router indexes the NAT translation table using the destination IP address and destination port number to obtain the appropriate IP address (10.0.0.1) and destination port number (3345) for the browser in the home network. The router then rewrites the datagram’s destination address and destination port number, and forwards the datagram into the home network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">NAT has enjoyed widespread deployment in recent years. But NAT is not without detractors. First, one might argue that, port numbers are meant to be used for addressing processes, not for addressing hosts. This violation can indeed cause problems for servers running on the home network, since, as we</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 139%;text-align: left;"><a href="#bookmark138" class="s124">have seen in </a><a href="#bookmark138" class="a">Chapter </a>2<span class="p">, server processes wait for incoming requests at well-known port numbers and peers in a P2P protocol need to accept incoming connections when acting as servers. Technical solutions to these problems include </span><span class="s23">NAT</span> traversal <a href="#bookmark848" class="s124">tools </a><a href="#bookmark848" class="a">[RFC 5389]</a> <a href="#bookmark848" class="s124">and Universal Plug and Play (UPnP), a protocol that allows a host to discover and configure a nearby NAT </a><a href="#bookmark848" class="a">[UPnP Forum 2016</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;">More “philosophical” arguments have also been raised against NAT by architectural purists. Here, the concern is that routers are meant to be layer 3 (i.e., network-layer) devices, and should process packets only up to the network layer. NAT violates this principle that hosts should be talking directly with each other, without interfering nodes modifying IP addresses, much less port numbers. But like it or not, NAT has not become an important component of the Internet, as have other so-called <span class="s23">middleboxes</span><a href="#bookmark848" class="a"> [Sekar 2011]</a><span class="s20"> </span>that operate at the network layer but have functions that are quite different from routers.</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Middleboxes do not perform traditional datagram forwarding, but instead perform functions such as</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">NAT, load balancing of traffic flows, traffic firewalling (see accompanying sidebar), and more. The</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark433" class="s124">generalized forwarding paradigm that we’ll study shortly in </a><a href="#bookmark433" class="a">Section 4.4</a> <span class="p">allows a number of these middlebox functions, as well as traditional router forwarding, to be accomplished in a common, integrated manner.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="212" alt="image" src="计算机网络自顶向下7th-en/Image_443.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><a name="bookmark418">FOCUS ON SECURITY</a></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">INSPECTING DATAGRAMS: FIREWALLS AND INTRUSION DETECTION SYSTEMS</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Suppose you are assigned the task of administering a home, departmental, university, or corporate network. Attackers, knowing the IP address range of your network, can easily send IP datagrams to addresses in your range. These datagrams can do all kinds of devious things, including mapping your network with ping sweeps and port scans, crashing vulnerable hosts with</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="784" alt="image" src="计算机网络自顶向下7th-en/Image_444.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark419">malformed packets, scanning for open TCP/UDP ports on servers in your network, and infecting hosts by including malware in the packets. As the network administrator, what are you going to do about all those bad guys out there, each capable of sending malicious packets into your network? Two popular defense mechanisms to malicious packet attacks are firewalls and intrusion detection systems (IDSs).</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">As a network administrator, you may first try installing a firewall between your network and the Internet. (Most access routers today have firewall capability.) Firewalls inspect the datagram and segment header fields, denying suspicious datagrams entry into the internal network. For</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark496" class="s124">example, a firewall may be configured to block all ICMP echo request packets (see </a><a href="#bookmark496" class="a">Section 5.</a>6<span class="p">), thereby preventing an attacker from doing a traditional port scan across your IP address range. Firewalls can also block packets based on source and destination IP addresses and port</span></p><p style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">numbers. Additionally, firewalls can be configured to track TCP connections, granting entry only to datagrams that belong to approved connections.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Additional protection can be provided with an IDS. An IDS, typically situated at the network boundary, performs “deep packet inspection,” examining not only header fields but also the payloads in the datagram (including application-layer data). An IDS has a database of packet signatures that are known to be part of attacks. This database is automatically updated as new attacks are discovered. As packets pass through the IDS, the IDS attempts to match header fields and payloads to the signatures in its signature database. If such a match is found, an alert is created. An intrusion prevention system (IPS) is similar to an IDS, except that it actually blocks</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark671" class="s124">packets in addition to creating alerts. In </a><a href="#bookmark671" class="a">Chapter </a>8<span class="p">, we’ll explore firewalls and IDSs in more detail.</span></p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Can firewalls and IDSs fully shield your network from all attacks? The answer is clearly no, as attackers continually find new attacks for which signatures are not yet available. But firewalls and traditional signature-based IDSs are useful in protecting your network from known attacks.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-top: 3pt;padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">IPv6</p></li></ol></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark420">In the early 1990s, the Internet Engineering Task Force began an effort to develop a successor to the IPv4 protocol. A prime motivation for this effort was the realization that the 32-bit IPv4 address space was beginning to be used up, with new subnets and IP nodes being attached to the Internet (and being allocated unique IP addresses) at a breathtaking rate. To respond to this need for a large IP address space, a new IP protocol, IPv6, was developed. The designers of IPv6 also took this opportunity to tweak and augment other aspects of IPv4, based on the accumulated operational experience with IPv4.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">The point in time when IPv4 addresses would be completely allocated (and hence no new networks</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark848" class="s124">could attach to the Internet) was the subject of considerable debate. The estimates of the two leaders of the IETF’s Address Lifetime Expectations working group were that addresses would become exhausted in 2008 and 2018, respectively </a><a href="#bookmark848" class="a">[Solensky </a>1996]<span class="p">. In February 2011, IANA allocated out the last</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">remaining pool of unassigned IPv4 addresses to a regional registry. While these registries still have</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">available IPv4 addresses within their pool, once these addresses are exhausted, there are no more available address blocks that can be allocated from a central pool </a><a href="#bookmark848" class="a">[Huston 2011a</a>]<a href="#bookmark848" class="s124">. A recent survey of IPv4 address-space exhaustion, and the steps taken to prolong the life of the address space is </a><a href="#bookmark848" class="a">[Richter</a></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">2015]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although the mid-1990s estimates of IPv4 address depletion suggested that a considerable amount of time might be left until the IPv4 address space was exhausted, it was realized that considerable time would be needed to deploy a new technology on such an extensive scale, and so the process to</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">develop IP version 6 (IPv6) </a><a href="#bookmark848" class="a">[RFC 2460]</a> <a href="#bookmark848" class="s124">was begun </a><a href="#bookmark848" class="a">[RFC </a>1752]<span class="p">. (An often-asked question is what happened to IPv5? It was initially envisioned that the ST-2 protocol would become IPv5, but ST-2 was</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">later dropped.) An excellent source of information about IPv6 is </a><a href="#bookmark848" class="a">[Huitema </a>1998]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">IPv6 Datagram Format</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark422" class="s124">The format of the IPv6 datagram is shown in </a><a href="#bookmark422" class="a">Figure 4.2</a>6<span class="p">. The most important changes introduced in IPv6 are evident in the datagram format:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_445.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Expanded addressing capabilities. <span class="p">IPv6 increases the size of the IP address from 32 to 128 bits. This ensures that the world won’t run out of IP addresses. Now, every grain of sand on the planet can be IP-addressable. In addition to unicast and multicast addresses, IPv6 has introduced a new</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: justify;">type of address, called an <span class="s20">anycast address</span>, that allows a datagram to be delivered to any one of a group of hosts. (This feature could be used, for example, to send an HTTP GET to the nearest of a number of mirror sites that contain a given document.)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_446.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">A streamlined 40-byte header. <span class="p">As discussed below, a number of IPv4 fields have been dropped or made optional. The resulting 40-byte fixed-length header allows for faster processing of the IP datagram by a router. A new encoding of options allows for more flexible options processing.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_447.png"/></span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 126%;text-align: left;"><a name="bookmark421"><b>Flow labeling. </b></a>IPv6 has an elusive definition of a <span class="s23">flow</span><a href="#bookmark848" class="s124">. </a><a href="#bookmark848" class="a">RFC 2460</a><span class="s20"> </span>states that this allows “labeling of packets belonging to particular flows for which the sender</p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="557" height="301" alt="image" src="计算机网络自顶向下7th-en/Image_448.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark422">Figure 4.26 IPv6 datagram format</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">requests special handling, such as a non-default quality of service or real-time service.” For example, audio and video transmission might likely be treated as a flow. On the other hand, the more traditional applications, such as file transfer and e-mail, might not be treated as flows. It is possible that the traffic carried by a high-priority user (for example, someone paying for better service for their traffic) might also be treated as a flow. What is clear, however, is that the designers of IPv6 foresaw the eventual need to be able to differentiate among the flows, even if the exact meaning of a flow had yet to be determined.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark422" class="s124">As noted above, a comparison of </a><a href="#bookmark422" class="a">Figure 4.26</a> <a href="#bookmark399" class="s124">with </a><a href="#bookmark399" class="a">Figure 4.16</a> <span class="p">reveals the simpler, more streamlined structure of the IPv6 datagram. The following fields are defined in IPv6:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_449.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Version. <span class="p">This 4-bit field identifies the IP version number. Not surprisingly, IPv6 carries a value of 6 in this field. Note that putting a 4 in this field does not create a valid IPv4 datagram. (If it did, life would be a lot simpler—see the discussion below regarding the transition from IPv4 to IPv6.)</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_450.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Traffic class. <span class="p">The 8-bit traffic class field, like the TOS field in IPv4, can be used to give priority to certain datagrams within a flow, or it can be used to give priority to datagrams from certain applications (for example, voice-over-IP) over datagrams from other applications (for example,</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">SMTP e-mail).</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_451.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;text-align: left;">Flow label. <span class="p">As discussed above, this 20-bit field is used to identify a flow of datagrams.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_452.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Payload length. <span class="p">This 16-bit value is treated as an unsigned integer giving the number of bytes in the IPv6 datagram following the fixed-length, 40-byte datagram header.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_453.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Next header. <span class="p">This field identifies the protocol to which the contents (data field) of this datagram will be delivered (for example, to TCP or UDP). The field uses the same values as the protocol field in the IPv4 header.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_454.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Hop limit. <span class="p">The contents of this field are decremented by one by each router that forwards the datagram. If the hop limit count reaches zero, the datagram is discarded.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_455.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Source and destination addresses. <span class="p">The various formats of the IPv6 128-bit address are described in RFC 4291.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_456.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Data. <span class="p">This is the payload portion of the IPv6 datagram. When the datagram reaches its destination, the payload will be removed from the IP datagram and passed on to the protocol specified in the next header field.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark422" class="s124">The discussion above identified the purpose of the fields that are included in the IPv6 datagram. Comparing the IPv6 datagram format in </a><a href="#bookmark422" class="a">Figure 4.26</a> <a href="#bookmark399" class="s124">with the IPv4 datagram format that we saw in </a><a href="#bookmark399" class="a">Figure 4.1</a>6<span class="p">, we notice that several fields appearing in the IPv4 datagram are no longer present in the</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">IPv6 datagram:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_457.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;">Fragmentation/reassembly. <span class="p">IPv6 does not allow for fragmentation and reassembly at intermediate routers; these operations can be performed only by the source and destination. If an IPv6 datagram received by a router is too large to be forwarded over the outgoing link, the router simply drops the</span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark496" class="s124">datagram and sends a “Packet Too Big” ICMP error message (see </a><a href="#bookmark496" class="a">Section 5.</a>6<span class="p">) back to the sender. The sender can then resend the data, using a smaller IP datagram size. Fragmentation and reassembly is a time-consuming operation; removing this functionality from the routers and placing it</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">squarely in the end systems considerably speeds up IP forwarding within the network.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_458.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Header checksum. <span class="p">Because the transport-layer (for example, TCP and UDP) and link-layer (for example, Ethernet) protocols in the Internet layers perform checksumming, the designers of IP probably felt that this functionality was sufficiently redundant in the network layer that it could be</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">removed. Once again, fast processing of IP packets was a central concern. Recall from our</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark400" class="s124">discussion of IPv4 in </a><a href="#bookmark400" class="a">Section 4.3.1</a> <span class="p">that since the IPv4 header contains a TTL field (similar to the hop limit field in IPv6), the IPv4 header checksum needed to be recomputed at every router. As with fragmentation and reassembly, this too was a costly operation in IPv4.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_459.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Options. <span class="p">An options field is no longer a part of the standard IP header. However, it has not gone away. Instead, the options field is one of the possible next headers pointed to from within the IPv6 header. That is, just as TCP or UDP protocol headers can be the next header within an IP packet, so</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">too can an options field. The removal of the options field results in a fixed-length, 40-byte IP header.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Transitioning from IPv4 to IPv6</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now that we have seen the technical details of IPv6, let us consider a very practical matter: How will the public Internet, which is based on IPv4, be transitioned to IPv6? The problem is that while new IPv6- capable systems can be made backward-compatible, that is, can send, route, and receive IPv4 datagrams, already deployed IPv4-capable systems are not capable of handling IPv6 datagrams.</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">Several options are possible </a><a href="#bookmark848" class="a">[Huston 2011</a>b<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">RFC 4213</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">One option would be to declare a flag day—a given time and date when all Internet machines would be turned off and upgraded from IPv4 to IPv6. The last major technology transition (from using NCP to</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">using TCP for reliable transport service) occurred almost 35 years ago. Even back then </a><a href="#bookmark848" class="a">[RFC 801</a>]<span class="p">, when the Internet was tiny and still being administered by a small number of “wizards,” it was realized that such a flag day was not possible. A flag day involving billions of devices is even more unthinkable</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">today.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">The approach to IPv4-to-IPv6 transition that has been most widely adopted in practice involves</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 126%;text-align: left;"><span class="s23">tunneling</span><a href="#bookmark848" class="a"> [RFC 4213</a><span class="s20">]</span>. The basic idea behind tunneling<b>—</b>a key concept with applications in many other scenarios beyond IPv4-to-IPv6 transition, including wide use in the all-IP cellular networks that we’ll</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">cover in Chapter 7<b>—</b><a href="#bookmark425" class="s124">is the following. Suppose two IPv6 nodes (in this example, B and E in </a><a href="#bookmark425" class="a">Figure 4.2</a><span class="s20">7</span>) want to interoperate using IPv6 datagrams but are connected to each other by intervening IPv4 routers. We refer to the intervening set of IPv4 routers between two IPv6 routers as a <span class="s20">tunnel</span>, as illustrated in</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark425" class="a">Figure 4.2</a><span class="s20">7</span>. With tunneling, the IPv6 node on the sending side of the tunnel (in this example, B) takes the <i>entire </i>IPv6 datagram and puts it in the data (payload) field of an IPv4 datagram. This IPv4 datagram is then addressed to the IPv6 node on the receiving side of the tunnel (in this example, E) and sent to</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">the first node in the tunnel (in this example, C). The intervening IPv4 routers in the tunnel route this IPv4 datagram among themselves, just as they would any other datagram, blissfully unaware that the IPv4 datagram itself contains a complete IPv6 datagram. The IPv6 node on the receiving side of the tunnel eventually receives the IPv4 datagram (it is the destination of the IPv4 datagram!), determines that the IPv4 datagram contains an IPv6 datagram (by observing that the protocol number field in the IPv4</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">datagram is 41 </a><a href="#bookmark848" class="a">[RFC </a>4213]<span class="p">, indicating that the IPv4 payload is a IPv6 datagram), extracts the IPv6 datagram, and then routes the IPv6 datagram exactly as it would if it had received the IPv6 datagram from a directly connected IPv6 neighbor.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark848" class="s124">We end this section by noting that while the adoption of IPv6 was initially slow to take off </a><a href="#bookmark848" class="a">[Lawton 200</a>1<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Huston 2008b</a>]<a href="#bookmark848" class="s124">, momentum has been building. NIST </a><a href="#bookmark848" class="a">[NIST IPv6 2015]</a> <span class="p">reports that more than a third of US government second-level domains are IPv6-enabled. On the client side, Google reports that only</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">about 8 percent of the clients accessing Google services do so via IPv6 </a><a href="#bookmark848" class="a">[Google IPv6 2015</a>]<a href="#bookmark848" class="s124">. But other recent measurements </a><a href="#bookmark848" class="a">[Czyz 2014]</a> <span class="p">indicate that IPv6 adoption is accelerating. The proliferation of devices such as IP-enabled phones and other portable devices</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="665" height="515" alt="image" src="计算机网络自顶向下7th-en/Image_460.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark423">Figure 4.27 Tunneling</a><a name="bookmark424">&zwnj;</a><a name="bookmark425">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">provides an additional push for more widespread deployment of IPv6. Europe’s Third Generation Partnership Program </a><a href="#bookmark848" class="a">[3GPP 2016]</a> <span class="p">has specified IPv6 as the standard addressing scheme for mobile</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">multimedia.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">One important lesson that we can learn from the IPv6 experience is that it is enormously difficult to change network-layer protocols. Since the early 1990s, numerous new network-layer protocols have been trumpeted as the next major revolution for the Internet, but most of these protocols have had limited penetration to date. These protocols include IPv6, multicast protocols, and resource reservation protocols; a discussion of these latter two protocols can be found in the online supplement to this text. Indeed, introducing new protocols into the network layer is like replacing the foundation of a house—it is difficult to do without tearing the whole house down or at least temporarily relocating the house’s residents. On the other hand, the Internet has witnessed rapid deployment of new protocols at the application layer. The classic examples, of course, are the Web, instant messaging, streaming media, distributed games, and various forms of social media. Introducing new application-layer protocols is like adding a new layer of paint to a house—it is relatively easy to do, and if you choose an attractive color, others in the neighborhood will copy you. In summary, in the future we can certainly expect to see changes in the Internet’s network layer, but these changes will likely occur on a time scale that is much slower than the changes that will occur at the application layer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l200"><ol id="l201"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark426">Generalized Forwarding and SDN</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark380" class="s124">In </a><a href="#bookmark380" class="a">Section 4.2.</a>1<span class="p">, we noted that an Internet router’s forwarding decision has traditionally been based solely on a packet’s destination address. In the previous section, however, we’ve also seen that there has been a proliferation of middleboxes that perform many layer-3 functions. NAT boxes rewrite header</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">IP addresses and port numbers; firewalls block traffic based on header-field values or redirect packets for additional processing, such as deep packet inspection (DPI). Load-balancers forward packets requesting a given service (e.g., an HTTP request) to one of a set of a set of servers that provide that</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">service. </a><a href="#bookmark848" class="a">[RFC 3234]</a> <span class="p">lists a number of common middlebox functions.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">This proliferation of middleboxes, layer-2 switches, and layer-3 routers </a><a href="#bookmark848" class="a">[Qazi 2013</a>]<span class="p">—each with its own specialized hardware, software and management interfaces—has undoubtedly resulted in costly headaches for many network operators. However, recent advances in software-defined networking have</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">promised, and are now delivering, a unified approach towards providing many of these network-layer functions, and certain link-layer functions as well, in a modern, elegant, and integrated manner.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark380" class="s124">Recall that </a><a href="#bookmark380" class="a">Section 4.2.1</a> <span class="p">characterized destination-based forwarding as the two steps of looking up a destination IP address (“match”), then sending the packet into the switching fabric to the specified output port (“action”). Let’s now consider a significantly more general “match-plus-action” paradigm, where the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">“match” can be made over multiple header fields associated with different protocols at different layers in the protocol stack. The “action” can include forwarding the packet to one or more output ports (as in destination-based forwarding), load balancing packets across multiple outgoing interfaces that lead to a service (as in load balancing), rewriting header values (as in NAT), purposefully blocking/dropping a packet (as in a firewall), sending a packet to a special server for further processing and action (as in DPI), and more.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark380" class="s124">In generalized forwarding, a match-plus-action table generalizes the notion of the destination-based forwarding table that we encountered in </a><a href="#bookmark380" class="a">Section 4.2.</a>1<span class="p">. Because forwarding decisions may be made</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark427" class="s124">using network-layer and/or link-layer source and destination addresses, the forwarding devices shown in </a><a href="#bookmark427" class="a">Figure 4.28</a> <a href="#bookmark492" class="s124">are more accurately described as “packet switches” rather than layer 3 “routers” or layer 2 “switches.” Thus, in the remainder of this section, and in </a><a href="#bookmark492" class="a">Section 5.</a>5<span class="p">, we’ll refer</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="728" height="562" alt="image" src="计算机网络自顶向下7th-en/Image_461.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark427">Figure 4.28 Generalized forwarding: Each packet switch contains a match-plus-action table that is computed and distributed by a remote controller</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">to these devices as packet switches, adopting the terminology that is gaining widespread adoption in SDN literature.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark427" class="a">Figure 4.28</a> <span class="p">shows a match-plus-action table in each packet switch, with the table being computed, installed, and updated by a remote controller. We note that while it is possible for the control components at the individual packet switch to interact with each other (e.g., in a manner similar to that in</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark371" class="a">Figure 4.</a>2<span class="p">), in practice generalized match-plus-action capabilities are implemented via a remote controller that computes, installs, and updates these tables. You might take a minute to compare</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark371" class="a">Figures 4.</a>2<a href="#bookmark372" class="s124">, </a><a href="#bookmark372" class="a">4.3</a> <a href="#bookmark427" class="s124">and </a><a href="#bookmark427" class="a">4.2</a>8<a href="#bookmark371" class="s124">—what similarities and differences do you notice between destination-based forwarding shown in </a><a href="#bookmark371" class="a">Figure 4.2</a> <a href="#bookmark372" class="s124">and </a><a href="#bookmark372" class="a">4.</a>3<a href="#bookmark427" class="s124">, and generalized forwarding shown in </a><a href="#bookmark427" class="a">Figure 4.2</a>8<span class="p">?</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">Our following discussion of generalized forwarding will be based on OpenFlow </a><a href="#bookmark848" class="a">[McKeown 200</a>8<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">OpenFlow 200</a>9<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Casado 201</a>4<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Tourrilhes 2014</a>]<span class="p">—a highly visible and successful standard that has pioneered the notion of the match-plus-action forwarding abstraction and controllers, as well as the SDN</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">revolution more generally </a><a href="#bookmark848" class="a">[Feamster </a>2013]<span class="p">. We’ll primarily consider OpenFlow 1.0, which introduced key SDN abstractions and functionality in a particularly clear and concise manner. Later versions of</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">OpenFlow introduced additional capabilities as a result of experience gained through implementation and use; current and earlier versions of the OpenFlow standard can be found at </a><a href="#bookmark848" class="a">[ONF 2016</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Each entry in the match-plus-action forwarding table, known as a <span class="s20">flow table </span>in OpenFlow, includes:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_462.png"/></span></p><p class="s17" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">A set of header field values <span class="p">to which an incoming packet will be matched. As in the case of destination-based forwarding, hardware-based matching is most rapidly performed in TCAM</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">memory, with more than a million destination address entries being possible </a><a href="#bookmark848" class="a">[Bosshart </a>2013]<span class="p">. A packet that matches no flow table entry can be dropped or sent to the remote controller for more processing. In practice, a flow table may be implemented by multiple flow tables for performance or</span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">cost reasons </a><a href="#bookmark848" class="a">[Bosshart </a>2013]<span class="p">, but we’ll focus here on the abstraction of a single flow table.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_463.png"/></span></p><p class="s17" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">A set of counters <span class="p">that are updated as packets are matched to flow table entries. These counters might include the number of packets that have been matched by that table entry, and the time since the table entry was last updated.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_464.png"/></span></p><p class="s17" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">A set of actions to be taken <span class="p">when a packet matches a flow table entry. These actions might be to forward the packet to a given output port, to drop the packet, makes copies of the packet and sent them to multiple output ports, and/or to rewrite selected header fields.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark430" class="s124">We’ll explore matching and actions in more detail in </a><a href="#bookmark430" class="a">Sections 4.4.1</a> <a href="#bookmark431" class="s124">and </a><a href="#bookmark431" class="a">4.4.</a>2<span class="p">, respectively. We’ll then study how the network-wide collection of per-packet switch matching rules can be used to implement a wide range of functions including routing, layer-2 switching, firewalling, load-balancing, virtual networks,</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark434" class="s124">and more in </a><a href="#bookmark434" class="a">Section 4.4.</a>3<a href="#bookmark434" class="s124">. In closing, we note that the flow table is essentially an API, the abstraction through which an individual packet switch’s behavior can be programmed; we’ll see in </a><a href="#bookmark434" class="a">Section </a>4.4.3 <span class="p">that network-wide behaviors can similarly be programmed by appropriately programming/configuring</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">these tables in a collection of network packet switches </a><a href="#bookmark848" class="a">[Casado </a>2014]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><ol id="l202"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Match</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark429" class="a" name="bookmark428">Figure 4.29</a> <span class="p">shows the eleven packet-header fields and the incoming port ID that can be matched in an OpenFlow 1.0 match-plus-action rule. Recall from</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="788" height="124" alt="image" src="计算机网络自顶向下7th-en/Image_465.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark429">Figure 4.29 Packet matching fields, OpenFlow 1.0 flow table</a></h2><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark95" class="a" name="bookmark430">Section 1.5.2</a> <span class="p">that a link-layer (layer 2) frame arriving to a packet switch will contain a network-layer (layer 3) datagram as its payload, which in turn will typically contain a transport-layer (layer 4) segment. The first observation we make is that OpenFlow’s match abstraction allows for a match to be made on</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">selected fields from </span><span class="s17">three </span><a href="#bookmark94" class="s124">layers of protocol headers (thus rather brazenly defying the layering principle we studied in </a><a href="#bookmark94" class="a">Section 1.</a>5<a href="#bookmark429" class="s124">). Since we’ve not yet covered the link layer, suffice it to say that the source and destination MAC addresses shown in </a><a href="#bookmark429" class="a">Figure 4.29</a> <span class="p">are the link-layer addresses associated with the</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">frame’s sending and receiving interfaces; by forwarding on the basis of Ethernet addresses rather than</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">IP addresses, we can see that an OpenFlow-enabled device can equally perform as a router (layer-3 device) forwarding datagrams as well as a switch (layer-2 device) forwarding frames. The Ethernet type field corresponds to the upper layer protocol (e.g., IP) to which the frame’s payload will be de- multiplexed, and the VLAN fields are concerned with so-called virtual local area networks that we’ll study</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark513" class="s124">in </a><a href="#bookmark513" class="a">Chapter </a>6<a href="#bookmark848" class="s124">. The set of twelve values that can be matched in the OpenFlow 1.0 specification has grown to 41 values in more recent OpenFlow specifications </a><a href="#bookmark848" class="a">[Bosshart </a>2014]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark400" class="s124">The ingress port refers to the input port at the packet switch on which a packet is received. The packet’s IP source address, IP destination address, IP protocol field, and IP type of service fields were discussed earlier in </a><a href="#bookmark400" class="a">Section 4.3.</a>1<span class="p">. The transport-layer source and destination port number fields can also be</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">matched.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Flow table entries may also have wildcards. For example, an IP address of 128.119.*.* in a flow table will match the corresponding address field of any datagram that has 128.119 as the first 16 bits of its address. Each flow table entry also has an associated priority. If a packet matches multiple flow table entries, the selected match and corresponding action will be that of the highest priority entry with which the packet matches.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">Lastly, we observe that not all fields in an IP header can be matched. For example OpenFlow does <i>not </i>allow matching on the basis of TTL field or datagram length field. Why are some fields allowed for matching, while others are not? Undoubtedly, the answer has to do with the tradeoff between</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">functionality and complexity. The “art” in choosing an abstraction is to provide for enough functionality to accomplish a task (in this case to implement, configure, and manage a wide range of network-layer functions that had previously been implemented through an assortment of network-layer devices), without over-burdening the abstraction with so much detail and generality that it becomes bloated and</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">unusable. Butler Lampson has famously noted </a><a href="#bookmark848" class="a">[Lampson 1983</a>]<span class="p">:</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="57" alt="image" src="计算机网络自顶向下7th-en/Image_466.png"/></span></p><p class="s17" style="padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">Do one thing at a time, and do it well. An interface should capture the minimum essentials of an abstraction. Don’t generalize; generalizations are generally wrong.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">Given OpenFlow’s success, one can surmise that its designers indeed chose their abstraction well. Additional details of OpenFlow matching can be found in </a><a href="#bookmark848" class="a">[OpenFlow 200</a>9<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">ONF 2016</a>]<span class="p">.</span></p></li><li style="padding-top: 3pt;padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark431">Action</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark427" class="s124">As shown in </a><a href="#bookmark427" class="a">Figure 4.2</a>8<span class="p">, each flow table entry has a list of zero or more actions that determine the processing that is to be applied to a packet that matches a flow table entry. If there are multiple actions, they are performed in the order specified in the list.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Among the most important possible actions are:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_467.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Forwarding. <span class="p">An incoming packet may be forwarded to a particular physical output port, broadcast over all ports (except the port on which it arrived) or multicast over a selected set of ports. The packet may be encapsulated and sent to the remote controller for this device. That controller then</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_468.png"/></span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;">may (or may not) take some action on that packet, including installing new flow table entries, and may return the packet to the device for forwarding under the updated set of flow table rules. <b>Dropping. </b>A flow table entry with no action indicates that a matched packet should be dropped.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_469.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 13pt;text-align: left;">Modify-field. <a href="#bookmark429" class="s124">The values in ten packet header fields (all layer 2, 3, and 4 fields shown in </a><a href="#bookmark429" class="a">Figure 4.29</a></p><p style="padding-top: 4pt;padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">except the IP Protocol field) may be re-written before the packet is forwarded to the chosen output port.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-top: 3pt;padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">OpenFlow Examples of Match-plus-action in Action</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark432" class="s124">Having now considered both the match and action components of generalized forwarding, let’s put these ideas together in the context of the sample network shown in </a><a href="#bookmark432" class="a">Figure 4.3</a>0<span class="p">. The network has 6 hosts (h1,</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">h2, h3, h4, h5 and h6) and three packet switches (s1, s2 and s3), each with four local interfaces (numbered 1 through 4). We’ll consider a number of network-wide behaviors that we’d like to implement, and the flow table entries in s1, s2 and s3 needed to implement this behavior.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="594" height="322" alt="image" src="计算机网络自顶向下7th-en/Image_470.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark432">Figure 4.30 OpenFlow match-plus-action network with three packet switches, 6 hosts, and an OpenFlow controller</a></h2><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">A First Example: Simple Forwarding</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">As a very simple example, suppose that the desired forwarding behavior is that packets from h5 or h6 destined to h3 or h4 are to be forwarded from s3 to s1, and then from s1 to s2 (thus completely avoiding the use of the link between s3 and s2). The flow table entry in s1 would be:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173" colspan="2"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">s1 Flow Table (Example 1)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Match</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Action</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Ingress Port = 1 ; IP Src = 10.3.*.* ; IP Dst = 10.2.*.*</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Forward(4)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">…</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">…</p></td></tr></table><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Of course, we’ll also need a flow table entry in s3 so that datagrams sent from h5 or h6 are forwarded to s1 over outgoing interface 3:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173" colspan="2"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">s3 Flow Table (Example 1)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Match</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Action</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">IP Src = 10.3.*.* ; IP Dst = 10.2.*.*</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Forward(3)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">…</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">…</p></td></tr></table><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Lastly, we’ll also need a flow table entry in s2 to complete this first example, so that datagrams arriving from s1 are forwarded to their destination, either host h3 or h4:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173" colspan="2"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">s2 Flow Table (Example 1)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Match</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Action</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Ingress port = 2 ; IP Dst = 10.2.0.3</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Forward(3)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Ingress port = 2 ; IP Dst = 10.2.0.4</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Forward(4)</p></td></tr></table><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">…</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">…</p></td></tr></table><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">A Second Example: Load Balancing</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">As a second example, let’s consider a load-balancing scenario, where datagrams from h3 destined to 10.1.*.* are to be forwarded over the direct link between s2 and s1, while datagrams from h4 destined to 10.1.*.* are to be forwarded over the link between s2 and s3 (and then from s3 to s1). Note that this behavior couldn’t be achieved with IP’s destination-based forwarding. In this case, the flow table in s2 would be:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173" colspan="2"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">s2 Flow Table (Example 2)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Match</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Action</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Ingress port = 3; IP Dst = 10.1.*.*</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Forward(2)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Ingress port = 4; IP Dst = 10.1.*.*</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Forward(1)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">…</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">…</p></td></tr></table><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Flow table entries are also needed at s1 to forward the datagrams received from s2 to either h1 or h2; and flow table entries are needed at s3 to forward datagrams received on interface 4 from s2 over interface 3 towards s1. See if you can figure out these flow table entries at s1 and s3.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">A Third Example: Firewalling</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">As a third example, let’s consider a firewall scenario in which s2 wants only to receive (on any of its interfaces) traffic sent from hosts attached to s3.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173" colspan="2"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">s2 Flow Table (Example 3)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Match</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Action</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">IP Src = 10.3.*.* IP Dst = 10.2.0.3</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Forward(3)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">IP Src = 10.3.*.* IP Dst = 10.2.0.4</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Forward(4)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">…</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">…</p></td></tr></table><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="791" height="9" alt="image" src="计算机网络自顶向下7th-en/Image_471.png"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark433">If there were no other entries in s2’s flow table, then only traffic from 10.3.*.* would be forwarded to the hosts attached to s2.</a><a name="bookmark434">&zwnj;</a><a name="bookmark435">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although we’ve only considered a few basic scenarios here, the versatility and advantages of generalized forwarding are hopefully apparent. In homework problems, we’ll explore how flow tables can be used to create many different logical behaviors, including virtual networks—two or more logically separate networks (each with their own independent and distinct forwarding behavior)—that use the</p><p class="s17" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">same <a href="#bookmark492" class="s124">physical set of packet switches and links. In </a><a href="#bookmark492" class="a">Section 5.</a><span class="s20">5</span><span class="p">, we’ll return to flow tables when we study the SDN controllers that compute and distribute the flow tables, and the protocol used for communicating between a packet switch and its controller.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l203"><ol id="l204"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark436">Summary</a><a name="bookmark437">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 136%;text-align: left;">In this chapter we’ve covered the <span class="s23">data</span><span class="s20"> plane </span>functions of the network layer—the <i>per-router </i>functions that determine how packets arriving on one of a router’s input links are forwarded to one of that router’s output links. We began by taking a detailed look at the internal operations of a router, studying input and</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">output port functionality and destination-based forwarding, a router’s internal switching mechanism, packet queue management and more. We covered both traditional IP forwarding (where forwarding is based on a datagram’s destination address) and generalized forwarding (where forwarding and other functions may be performed using values in several different fields in the datagram’s header) and seen the versatility of the latter approach.  We also studied the IPv4 and IPv6 protocols in detail, and Internet addressing, which we found to be much deeper, subtler, and more interesting than we might have expected.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark444" class="s124">With our newfound understanding of the network-layer’s data plane, we’re now ready to dive into the network layer’s control plane in </a><a href="#bookmark444" class="a">Chapter </a>5<span class="p">!</span></p><p class="s18" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark438">Homework Problems and Questions</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Chapter 4 Review Questions</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark439">SECTION 4.1</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R1. Let’s review some of the terminology used in this textbook. Recall that the name of a transport-layer packet is <i>segment </i>and that the name of a link-layer packet is <i>frame</i>. What is the name of a network-layer packet? Recall that both routers and link-layer switches are called</p><p class="s17" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">packet switches<span class="p">. What is the fundamental difference between a router and link-layer switch?</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R2. We noted that network layer functionality can be broadly divided into data plane functionality and control plane functionality. What are the main functions of the data plane? Of the control plane?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R3. We made a distinction between the forwarding function and the routing function performed in the network layer. What are the key differences between routing and forwarding?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R4. What is the role of the forwarding table within a router?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R5. We said that a network layer’s service model “defines the characteristics of end-to-end transport of packets between sending and receiving hosts.” What is the service model of the Internet’s network layer? What guarantees are made by the Internet’s service model regarding</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">the host-to-host delivery of datagrams?</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 4.2</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark394" class="s124">R6. In </a><a href="#bookmark394" class="a">Section 4.2</a> <span class="p">, we saw that a router typically consists of input ports, output ports, a switching fabric and a routing processor. Which of these are implemented in hardware and which are implemented in software? Why? Returning to the notion of the network layer’s data plane</span></p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">and control plane, which are implemented in hardware and which are implemented in software? Why?</p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R7. Discuss why each input port in a high-speed router stores a shadow copy of the forwarding table.</p><p class="s20" style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark433" class="s124">R8. What is meant by destination-based forwarding? How does this differ from generalized forwarding (assuming you’ve read </a><a href="#bookmark433" class="a">Section 4.4</a> <span class="p">, which of the two approaches are adopted by Software-Defined Networking)?</span></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R9. Suppose that an arriving packet matches two or more entries in a router’s forwarding table. With traditional destination-based forwarding, what rule does a router apply to determine which</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">of these rules should be applied to determine the output port to which the arriving packet should be switched?</p><p class="s20" style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark394" class="s124">R10. Three types of switching fabrics are discussed in </a><a href="#bookmark394" class="a">Section 4.2</a> <span class="p">. List and briefly describe each type. Which, if any, can send multiple packets across the fabric in parallel?</span></p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R11. Describe how packet loss can occur at input ports. Describe how packet loss at input ports can be eliminated (without using infinite buffers).</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R12. Describe how packet loss can occur at output ports. Can this loss be prevented by increasing the switch fabric speed?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R13. What is HOL blocking? Does it occur in input ports or output ports?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark394" class="s124">R14. In </a><a href="#bookmark394" class="a">Section 4.2</a> <span class="p">, we studied FIFO, Priority, Round Robin (RR), and Weighted Fair Queueing (WFQ) packet scheduling disciplines? Which of these queueing disciplines ensure that all packets depart in the order in which they arrived?</span></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R15. Give an example showing why a network operator might want one class of packets to be given priority over another class of packets.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R16. What is an essential different between RR and WFQ packet scheduling? Is there a case (Hint: Consider the WFQ weights) where RR and WFQ will behave exactly the same?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 4.3</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;">R17. Suppose Host A sends Host B a TCP segment encapsulated in an IP datagram. When Host B receives the datagram, how does the network layer in Host B know it should pass the segment (that is, the payload of the datagram) to TCP rather than to UDP or to some other</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">upper-layer protocol?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">R18. What field in the IP header can be used to ensure that a packet is forwarded through no more than <i>N </i>routers?</p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark270" class="s124">R19. Recall that we saw the Internet checksum being used in both transport-layer segment (in UDP and TCP headers, </a><a href="#bookmark270" class="a">Figures 3.7</a> <a href="#bookmark305" class="s124">and </a><a href="#bookmark305" class="a">3.29</a> <a href="#bookmark399" class="s124">respectively) and in network-layer datagrams (IP header, </a><a href="#bookmark399" class="a">Figure 4.16</a> <span class="p">). Now consider a transport layer segment encapsulated in an IP datagram.</span></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Are the checksums in the segment header and datagram header computed over any common</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">bytes in the IP datagram? Explain your answer.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R20. When a large datagram is fragmented into multiple smaller datagrams, where are these smaller datagrams reassembled into a single larger datagram?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R21. Do routers have IP addresses? If so, how many?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">R22. What is the 32-bit binary equivalent of the IP address 223.1.3.27?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R23. Visit a host that uses DHCP to obtain its IP address, network mask, default router, and IP address of its local DNS server. List these values.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R24. Suppose there are three routers between a source host and a destination host. Ignoring fragmentation, an IP datagram sent from the source host to the destination host will travel over how many interfaces? How many forwarding tables will be indexed to move the datagram from</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">the source to the destination?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R25. Suppose an application generates chunks of 40 bytes of data every 20 msec, and each chunk gets encapsulated in a TCP segment and then an IP datagram. What percentage of each datagram will be overhead, and what percentage will be application data?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R26. Suppose you purchase a wireless router and connect it to your cable modem. Also suppose that your ISP dynamically assigns your connected device (that is, your wireless router) one IP address. Also suppose that you have five PCs at home that use 802.11 to wirelessly</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">connect to your wireless router. How are IP addresses assigned to the five PCs? Does the wireless router use NAT? Why or why not?</p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R27. What is meant by the term “route aggregation”? Why is it useful for a router to perform route aggregation?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R28. What is meant by a “plug-and-play” or “zeroconf” protocol?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R29. What is a private network address? Should a datagram with a private network address ever be present in the larger public Internet? Explain.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R30. Compare and contrast the IPv4 and the IPv6 header fields. Do they have any fields in common?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R31. It has been said that when IPv6 tunnels through IPv4 routers, IPv6 treats the IPv4 tunnels as link-layer protocols. Do you agree with this statement? Why or why not?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 4.4</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R32. How does generalized forwarding differ from destination-based forwarding?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark374" class="s124">R33. What is the difference between a forwarding table that we encountered in destination- based forwarding in </a><a href="#bookmark374" class="a">Section 4.1</a> <a href="#bookmark433" class="s124">and OpenFlow’s flow table that we encountered in </a><a href="#bookmark433" class="a">Section 4.4</a></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 12pt;text-align: left;">?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R34. What is meant by the “match plus action” operation of a router or switch? In the case of destination-based forwarding packet switch, what is matched and what is the action taken? In the case of an SDN, name three fields that can be matched, and three actions that can be taken.</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R35. Name three header fields in an IP datagram that can be “matched” in OpenFlow 1.0 generalized forwarding. What are three IP datagram header fields that <i>cannot </i>be “matched” in OpenFlow?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Problems</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">P1. Consider the network below.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l205"><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Show the forwarding table in router A, such that all traffic destined to host H3 is forwarded through interface 3.</p></li><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Can you write down a forwarding table in router A, such that all traffic from H1 destined  to host H3 is forwarded through interface 3, while all traffic from H2 destined to host H3 is</p></li></ol></li></ol></ol><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;text-align: left;">forwarded through interface 4? (Hint: This is a trick question.)</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;"><span><img width="461" height="190" alt="image" src="计算机网络自顶向下7th-en/Image_472.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P2. Suppose two packets arrive to two different input ports of a router at exactly the same time. Also suppose there are no other packets anywhere in the router.</p><ol id="l206"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose the two packets are to be forwarded to two different output ports. Is it possible to forward the two packets through the switch fabric at the same time when the fabric</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">uses a shared bus?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose the two packets are to be forwarded to two different output ports. Is it possible to forward the two packets through the switch fabric at the same time when the fabric</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">uses switching via memory?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose the two packets are to be forwarded to the same output port. Is it possible to forward the two packets through the switch fabric at the same time when the fabric uses</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">a crossbar?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark394" class="s124">P3. In </a><a href="#bookmark394" class="a">Section 4.2</a><span class="s20"> </span>, we noted that the maximum queuing delay is <i>(n–1)D </i>if the switching fabric is <i>n </i>times faster than the input line rates. Suppose that all packets are of the same length, <i>n </i>packets arrive at the same time to the <i>n </i>input ports, and all <i>n </i>packets want to be forwarded to</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">different output ports. What is the maximum delay for a packet for the (a) memory, (b) bus, and</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l207"><li style="padding-left: 24pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">crossbar switching fabrics?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">P4. Consider the switch shown below. Suppose that all datagrams have the same fixed length, that the switch operates in a slotted, synchronous manner, and that in one time slot a datagram can be transferred from an input port to an output port. The switch fabric is a crossbar so that at</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">most one datagram can be transferred to a given output port in a time slot, but different output ports can receive datagrams from different input ports in a single time slot. What is the minimal number of time slots needed to transfer the packets shown from input ports to their output ports, assuming any input queue scheduling order you want (i.e., it need not have HOL blocking)? What is the largest number of slots needed, assuming the worst-case scheduling order you can devise, assuming that a non-empty input queue is never idle?</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="513" height="180" alt="image" src="计算机网络自顶向下7th-en/Image_473.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P5. Consider a datagram network using 32-bit host addresses. Suppose a router has four links, numbered 0 through 3, and packets are to be forwarded to the link interfaces as follows:</p><p style="text-indent: 0pt;line-height: 1pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:545pt;margin-left:5.7pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Destination Address Range</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Link Interface</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">11100000 00000000 00000000 00000000</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">through</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">11100000 00111111 11111111 11111111</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">11100000 01000000 00000000 00000000</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">through</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">11100000 01000000 11111111 11111111</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">1</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">11100000 01000001 00000000 00000000</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">through</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">11100001 01111111 11111111 11111111</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">otherwise</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">3</p></td></tr></table><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l208"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Provide a forwarding table that has five entries, uses longest prefix matching, and forwards packets to the correct link interfaces.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Describe how your forwarding table determines the appropriate link interface for datagrams with destination addresses:</p></li></ol></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="85" alt="image" src="计算机网络自顶向下7th-en/Image_474.png"/></span></p><p style="padding-left: 25pt;text-indent: 0pt;text-align: left;">11001000 10010001 01010001 01010101</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: 0pt;text-align: left;">11100001 01000000 11000011 00111100</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: 0pt;text-align: left;">11100001 10000000 00010001 01110111</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="730" height="43" alt="image" src="计算机网络自顶向下7th-en/Image_475.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P6. Consider a datagram network using 8-bit host addresses. Suppose a router uses longest prefix matching and has the following forwarding table:</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s126" style="padding-left: 15pt;text-indent: 0pt;text-align: left;">Prefix Match                                                                    Interface</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:545pt;margin-left:5.7pt" cellspacing="0"><tr><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">00</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">010</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">1</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">011</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">10</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">11</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">3</p></td></tr></table><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">For each of the four interfaces, give the associated range of destination host addresses and the number of addresses in the range.</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P7. Consider a datagram network using 8-bit host addresses. Suppose a router uses longest prefix matching and has the following forwarding table:</p><p style="text-indent: 0pt;line-height: 1pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:545pt;margin-left:5.7pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Prefix Match</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Interface</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">1</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">0</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">10</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">1</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">111</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">otherwise</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">3</p></td></tr></table><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">For each of the four interfaces, give the associated range of destination host addresses and the number of addresses in the range.</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P8. Consider a router that interconnects three subnets: Subnet 1, Subnet 2, and Subnet 3. Suppose all of the interfaces in each of these three subnets are required to have the prefix 223.1.17/24. Also suppose that Subnet 1 is required to support at least 60 interfaces, Subnet 2 is</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">to support at least 90 interfaces, and Subnet 3 is to support at least 12 interfaces. Provide three network addresses (of the form a.b.c.d/x) that satisfy these constraints.</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark382" class="s124">P9. In </a><a href="#bookmark382" class="a">Section 4.2.2</a> <span class="p">an example forwarding table (using longest prefix matching) is given. Rewrite this forwarding table using the a.b.c.d/x notation instead of the binary string notation.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P10. In Problem P5 you are asked to provide a forwarding table (using longest prefix matching). Rewrite this forwarding table using the a.b.c.d/x notation instead of the binary string notation.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">P11. Consider a subnet with prefix 128.119.40.128/26. Give an example of one IP address (of form xxx.xxx.xxx.xxx) that can be assigned to this network. Suppose an ISP owns the block of addresses of the form 128.119.40.64/26. Suppose it wants to create four subnets from this</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">block, with each block having the same number of IP addresses. What are the prefixes (of form</p><ol id="l209"><ol id="l210"><ol id="l211"><ol id="l212"><li style="padding-top: 3pt;padding-left: 44pt;text-indent: -38pt;text-align: left;"><p style="display: inline;">/x) for the four subnets?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark407" class="s124">P12. Consider the topology shown in </a><a href="#bookmark407" class="a">Figure 4.20</a> <span class="p">. Denote the three subnets with hosts (starting clockwise at 12:00) as Networks A, B, and C. Denote the subnets without hosts as Networks D, E, and F.</span></p><ol id="l213"><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Assign network addresses to each of these six subnets, with the following constraints: All addresses must be allocated from 214.97.254/23; Subnet A should have enough</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">addresses to support 250 interfaces; Subnet B should have enough addresses to support 120 interfaces; and Subnet C should have enough addresses to support 120 interfaces. Of course, subnets D, E and F should each be able to support two interfaces. For each subnet, the assignment should take the form a.b.c.d/x or a.b.c.d/x – e.f.g.h/y.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Using your answer to part (a), provide the forwarding tables (using longest prefix matching) for each of the three routers.</p></li></ol></li></ol></ol></ol></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="http://www.arin.net/whois" class="s124" target="_blank">P13. Use the whois service at the American Registry for Internet Numbers (</a><a href="http://www.arin.net/whois" class="a" target="_blank">http://www.arin.net/ whoi</a>s<span class="p">) to determine the IP address blocks for three universities. Can the whois services be used to determine with certainty the geographical location of a specific IP address? Use</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="http://www.maxmind.com/" class="a" target="_blank">www.maxmind.com</a> <span class="p">to determine the locations of the Web servers at each of these universities. P14. Consider sending a 2400-byte datagram into a link that has an MTU of 700 bytes. Suppose the original datagram is stamped with the identification number 422. How many fragments are</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">generated? What are the values in the various fields in the IP datagram(s) generated related to fragmentation?</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P15. Suppose datagrams are limited to 1,500 bytes (including header) between source Host A and destination Host B. Assuming a 20-byte IP header, how many datagrams would be required to send an MP3 consisting of 5 million bytes? Explain how you computed your answer.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark417" class="s124">P16. Consider the network setup in </a><a href="#bookmark417" class="a">Figure 4.25</a> <span class="p">. Suppose that the ISP instead assigns the router the address 24.34.112.235 and that the network address of the home network is 192.168.1/24.</span></p><ol id="l214"><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Assign addresses to all interfaces in the home network.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose each host has two ongoing TCP connections, all to port 80 at host 128.119.40.86. Provide the six corresponding entries in the NAT translation table.</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P17. Suppose you are interested in detecting the number of hosts behind a NAT. You observe that the IP layer stamps an identification number sequentially on each IP packet. The identification number of the first IP packet generated by a host is a random number, and the</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">identification numbers of the subsequent IP packets are sequentially assigned. Assume all IP packets generated by hosts behind the NAT are sent to the outside world.</p><ol id="l215"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Based on this observation, and assuming you can sniff all packets sent by the NAT to the outside, can you outline a simple technique that detects the number of unique hosts</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">behind a NAT? Justify your answer.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">If the identification numbers are not sequentially assigned but randomly assigned, would</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">your technique work? Justify your answer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P18. In this problem we’ll explore the impact of NATs on P2P applications. Suppose a peer with username Arnold discovers through querying that a peer with username Bernard has a file it wants to download. Also suppose that Bernard and Arnold are both behind a NAT. Try to devise</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">a technique that will allow Arnold to establish a TCP connection with Bernard without application- specific NAT configuration. If you have difficulty devising such a technique, discuss why.</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark432" class="s124">P19. Consider the SDN OpenFlow network shown in </a><a href="#bookmark432" class="a">Figure 4.30</a> <span class="p">. Suppose that the desired forwarding behavior for datagrams arriving at s2 is as follows:</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_476.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">any datagrams arriving on input port 1 from hosts h5 or h6 that are destined to hosts h1 or h2 should be forwarded over output port 2;</p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_477.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">any datagrams arriving on input port 2 from hosts h1 or h2 that are destined to hosts h5 or h6 should be forwarded over output port 1;</p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_478.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">any arriving datagrams on input ports 1 or 2 and destined to hosts h3 or h4 should be delivered to the host specified;</p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_479.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">hosts h3 and h4 should be able to send datagrams to each other.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Specify the flow table entries in s2 that implement this forwarding behavior.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark432" class="s124">P20. Consider again the SDN OpenFlow network shown in </a><a href="#bookmark432" class="a">Figure 4.30</a> <span class="p">. Suppose that the desired forwarding behavior for datagrams arriving from hosts h3 or h4 at s2 is as follows:</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_480.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">any datagrams arriving from host h3 and destined for h1, h2, h5 or h6 should be forwarded in a clockwise direction in the network;</p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_481.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">any datagrams arriving from host h4 and destined for h1, h2, h5 or h6 should be forwarded in a counter-clockwise direction in the network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Specify the flow table entries in s2 that implement this forwarding behavior.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P21. Consider again the scenario from P19 above. Give the flow tables entries at packet switches s1 and s3, such that any arriving datagrams with a source address of h3 or h4 are routed to the destination hosts specified in the destination address field in the IP datagram. (Hint:</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">Your forwarding table rules should include the cases that an arriving datagram is destined for a directly attached host or should be forwarded to a neighboring router for eventual host delivery there.)</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark432" class="s124">P22. Consider again the SDN OpenFlow network shown in </a><a href="#bookmark432" class="a">Figure 4.30</a> <span class="p">. Suppose we want switch s2 to function as a firewall. Specify the flow table in s2 that implements the following firewall behaviors (specify a different flow table for each of the four firewalling behaviors below)</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">for delivery of datagrams destined to h3 and h4. You do not need to specify the forwarding behavior in s2 that forwards traffic to other routers.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_482.png"/></span></p><p style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Only traffic arriving from hosts h1 and h6 should be delivered to hosts h3 or h4 (i.e., that arriving traffic from hosts h2 and h5 is blocked).</p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_483.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">Only TCP traffic is allowed to be delivered to hosts h3 or h4 (i.e., that UDP traffic is blocked).</p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_484.png"/></span></p><p style="padding-top: 3pt;padding-left: 69pt;text-indent: 0pt;text-align: left;">Only traffic destined to h3 is to be delivered (i.e., all traffic to h4 is blocked).</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_485.png"/></span></p><p style="padding-left: 69pt;text-indent: 0pt;text-align: left;">Only UDP traffic from h1 and destined to h3 is to be delivered. All other traffic is blocked.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark440">Wireshark Lab</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources" class="s124" target="_blank">In the Web site for this textbook, </a><a href="http://www.pearsonhighered.com/cs-resources" class="a" target="_blank">www.pearsonhighered.com/</a>cs-resources<span class="p">, you’ll find a Wireshark lab assignment that examines the operation of the IP protocol, and the IP datagram format in particular.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="909" alt="image" src="计算机网络自顶向下7th-en/Image_486.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">AN INTERVIEW WITH…</p><p class="s28" style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Vinton G. Cerf</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Vinton G. Cerf is Vice President and Chief Internet Evangelist for Google. He served for over 16 years at MCI in various positions, ending up his tenure there as Senior Vice President for Technology Strategy. He is widely known as the co-designer of the TCP/IP protocols and the architecture of the Internet. During his time from 1976 to 1982 at the US Department of Defense Advanced Research Projects Agency (DARPA), he played a key role leading the development of Internet and Internet-related data packet and security techniques. He received the US Presidential Medal of Freedom in 2005 and the US National Medal of Technology in 1997. He holds a BS in Mathematics from Stanford University and an MS and PhD in computer science from UCLA.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><span><img width="166" height="214" alt="image" src="计算机网络自顶向下7th-en/Image_487.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What brought you to specialize in networking?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">I was working as a programmer at UCLA in the late 1960s. My job was supported by the US Defense Advanced Research Projects Agency (called ARPA then, called DARPA now). I was working in the laboratory of Professor Leonard Kleinrock on the Network Measurement Center of the newly created ARPAnet. The first node of the ARPAnet was installed at UCLA on September 1, 1969. I was responsible for programming a computer that was used to capture performance information about the ARPAnet and to report this information back for comparison with mathematical models and predictions of the performance of the network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Several of the other graduate students and I were made responsible for working on the so-called</p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_488.png"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">host-level protocols of the ARPAnet—the procedures and formats that would allow many different kinds of computers on the network to interact with each other. It was a fascinating exploration into a new world (for me) of distributed computing and communication.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Did you imagine that IP would become as pervasive as it is today when you first designed the</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">protocol?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">When Bob Kahn and I first worked on this in 1973, I think we were mostly very focused on the central question: How can we make heterogeneous packet networks interoperate with one another, assuming we cannot actually change the networks themselves? We hoped that we could find a way to permit an arbitrary collection of packet-switched networks to be interconnected in a transparent fashion, so that host computers could communicate end-to-end without having to do any translations in between. I think we knew that we were dealing with powerful and expandable technology, but I doubt we had a clear image of what the world would be like with hundreds of millions of computers all interlinked on the Internet.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What do you now envision for the future of networking and the Internet? What major</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">challenges/obstacles do you think lie ahead in their development?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">I believe the Internet itself and networks in general will continue to proliferate. Already there is convincing evidence that there will be billions of Internet-enabled devices on the Internet, including appliances like cell phones, refrigerators, personal digital assistants, home servers, televisions, as well as the usual array of laptops, servers, and so on. Big challenges include support for mobility, battery life, capacity of the access links to the network, and ability to scale the optical core of the network up in an unlimited fashion. Designing an interplanetary extension of the Internet is a project in which I am deeply engaged at the Jet Propulsion Laboratory. We will need to cut over from IPv4 [32-bit addresses] to IPv6 [128 bits]. The list is long!</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Who has inspired you professionally?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">My colleague Bob Kahn; my thesis advisor, Gerald Estrin; my best friend, Steve Crocker (we met in high school and he introduced me to computers in 1960!); and the thousands of engineers who continue to evolve the Internet today.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Do you have any advice for students entering the networking/Internet field?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Think outside the limitations of existing systems—imagine what might be possible; but then do the hard work of figuring out how to get there from the current state of affairs. Dare to dream: A half dozen colleagues and I at the Jet Propulsion Laboratory have been working on the design of an interplanetary extension of the terrestrial Internet. It may take decades to implement this,</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="98" alt="image" src="计算机网络自顶向下7th-en/Image_489.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark441">mission by mission, but to paraphrase: “A man’s reach should exceed his grasp, or what are the heavens for?”</a><a name="bookmark442">&zwnj;</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="783" height="2" alt="image" src="计算机网络自顶向下7th-en/Image_490.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s16" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark443">Chapter </a><span class="h1">5 </span>The Network Layer: Control Plane<a name="bookmark444">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="1" alt="image" src="计算机网络自顶向下7th-en/Image_491.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">In this chapter, we’ll complete our journey through the network layer by covering the <span class="s20">control-plane</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">component of the network layer—the <i>network-wide </i>logic that controls not only how a datagram is forwarded among routers along an end-to-end path from the source host to the destination host, but also</p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark459" class="s124">how network-layer components and services are configured and managed. In </a><a href="#bookmark459" class="a">Section 5.</a>2<span class="p">, we’ll cover traditional routing algorithms for computing least cost paths in a graph; these algorithms are the basis</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark463" class="s124">for two widely deployed Internet routing protocols: OSPF and BGP, that we’ll cover in </a><a href="#bookmark463" class="a">Sections 5.3</a> <a href="#bookmark480" class="s124">and </a><a href="#bookmark480" class="a">5.</a>4<span class="p">, respectively. As we’ll see, OSPF is a routing protocol that operates within a single ISP’s network. BGP is a routing protocol that serves to interconnect all of the networks in the Internet; BGP is thus</span></p><p class="s20" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark368" class="s124">often referred to as the “glue” that holds the Internet together. Traditionally, control-plane routing protocols have been implemented together with data-plane forwarding functions, monolithically, within a router. As we learned in the introduction to </a><a href="#bookmark368" class="a">Chapter </a>4<span class="p">, software-defined networking (SDN) makes a</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">clear separation between the data and control planes, implementing control-plane functions in a</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark492" class="s124">separate “controller” service that is distinct, and remote, from the forwarding components of the routers it controls. We’ll cover SDN controllers in </a><a href="#bookmark492" class="a">Section 5.</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark496" class="s124">In </a><a href="#bookmark496" class="a">Sections 5.6</a> <a href="#bookmark502" class="s124">and </a><a href="#bookmark502" class="a">5.7</a> <span class="p">we’ll cover some of the nuts and bolts of managing an IP network: ICMP (the Internet Control Message Protocol) and SNMP (the Simple Network Management Protocol).</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l216"><ol id="l217"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark445">Introduction</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark371" class="s124">Let’s quickly set the context for our study of the network control plane by recalling </a><a href="#bookmark371" class="a">Figures 4.2</a> <a href="#bookmark372" class="s124">and </a><a href="#bookmark372" class="a">4.</a>3<span class="p">. There, we saw that the forwarding table (in the case of destination-based forwarding) and the flow table (in the case of generalized forwarding) were the principal elements that linked the network layer’s</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">data and control planes. We learned that these tables specify the local data-plane forwarding behavior</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark431" class="s124">of a router. We saw that in the case of generalized forwarding, the actions taken (</a><a href="#bookmark431" class="a">Section 4.4.</a>2<span class="p">) could include not only forwarding a packet to a router’s output port, but also dropping a packet, replicating a packet, and/or rewriting layer 2, 3 or 4 packet-header fields.</span></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark439" class="s124">In this chapter, we’ll study how those forwarding and flow tables are computed, maintained and installed. In our introduction to the network layer in </a><a href="#bookmark439" class="a">Section 4.</a>1<span class="p">, we learned that there are two possible</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">approaches for doing so.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_492.png"/></span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark446" style=" color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt;">Per-router control. </a><a href="#bookmark446" class="a">Figure 5.1</a> <span class="p">illustrates the case where a routing algorithm runs in each and every router; both a forwarding and a routing function are contained</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="702" height="466" alt="image" src="计算机网络自顶向下7th-en/Image_493.png"/></span></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><h2 style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark446">Figure 5.1 Per-router control: Individual routing algorithm components interact in the control plane</a></h2><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">within each router. Each router has a routing component that communicates with the routing components in other routers to compute the values for its forwarding table. This per-router control approach has been used in the Internet for decades. The OSPF and BGP protocols that we’ll study</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark463" class="s124">in </a><a href="#bookmark463" class="a">Sections 5.3</a> <a href="#bookmark480" class="s124">and </a><a href="#bookmark480" class="a">5.4</a> <span class="p">are based on this per-router approach to control.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_494.png"/></span></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark447" style=" color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt;">Logically centralized control. </a><a href="#bookmark447" class="a">Figure 5.2</a> <span class="p">illustrates the case in which a logically centralized controller computes and distributes the forwarding tables to be used by each and every router. As</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark433" class="s124">we saw in </a><a href="#bookmark433" class="a">Section 4.</a>4<span class="p">, the generalized match-plus-action abstraction allows the router to perform traditional IP forwarding as well as a rich set of other functions (load sharing, firewalling, and NAT) that had been previously implemented in separate middleboxes.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="728" height="598" alt="image" src="计算机网络自顶向下7th-en/Image_495.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark447">Figure 5.2 Logically centralized control: A distinct, typically remote, controller interacts with local control agents (CAs)</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The controller interacts with a control agent (CA) in each of the routers via a well-defined protocol to configure and manage that router’s flow table. Typically, the CA has minimum functionality; its job is to communicate with the controller, and to do as the controller commands. Unlike the routing algorithms in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark446" class="a">Figure 5.</a>1<span class="p">, the CAs do not directly interact with each other nor do they actively take part in computing</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark448">the forwarding table. This is a key distinction between per-router control and logically centralized control.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">By “logically centralized” control </a><a href="#bookmark848" class="a">[Levin 2012]</a> <span class="p">we mean that the routing control service is accessed as if it were a single central service point, even though the service is likely to be implemented via multiple</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark492" class="s124">servers for fault-tolerance, and performance scalability reasons. As we will see in </a><a href="#bookmark492" class="a">Section 5.</a>5<span class="p">, SDN adopts this notion of a logically centralized controller—an approach that is finding increased use in production deployments. Google uses SDN to control the routers in its internal B4 global wide-area</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">network that interconnects its data centers </a><a href="#bookmark848" class="a">[Jain 2013</a>]<a href="#bookmark848" class="s124">. SWAN </a><a href="#bookmark848" class="a">[Hong 2013</a>]<span class="p">, from Microsoft Research, uses a logically centralized controller to manage routing and forwarding between a wide area network and a data center network. China Telecom and China Unicom are using SDN both within data centers</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">and between data centers </a><a href="#bookmark848" class="a">[Li 2015</a>]<a href="#bookmark848" class="s124">. AT&amp;T has noted </a><a href="#bookmark848" class="a">[AT&amp;T 2013]</a> <span class="p">that it “supports many SDN capabilities and independently defined, proprietary mechanisms that fall under the SDN architectural framework.”</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark449">Routing Algorithms</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section we’ll study <span class="s20">routing algorithms</span>, whose goal is to determine good paths (equivalently, routes), from senders to receivers, through the network of routers. Typically, a “good” path is one that has the least cost. We’ll see that in practice, however, real-world concerns such as policy issues (for example,</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">a rule such as “router <i>x</i>, belonging to organization <i>Y</i>, should not forward any packets originating from the network owned by organization <i>Z</i> ”) also come into play. We note that whether the network control plane adopts a per-router control approach or a logically centralized approach, there must always be a well-</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">defined sequence of routers that a packet will cross in traveling from sending to receiving host. Thus, the routing algorithms that compute these paths are of fundamental importance, and another candidate for our top-10 list of fundamentally important networking concepts.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 134%;text-align: left;">A graph is used to formulate routing problems. Recall that a <span class="s23">graph</span><span class="s20"> </span><span class="s27">G=</span>(N, E) is a set <i>N </i>of nodes and a collection <i>E </i>of edges, where each edge is a pair of nodes from <i>N</i>. In the context of network-layer routing, the nodes in the graph represent</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="390" height="264" alt="image" src="计算机网络自顶向下7th-en/Image_496.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark450">Figure 5.3 Abstract graph model of a computer network</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark450" class="s124">routers—the points at which packet-forwarding decisions are made—and the edges connecting these nodes represent the physical links between these routers. Such a graph abstraction of a computer network is shown in </a><a href="#bookmark450" class="a">Figure 5.</a>3<a href="#bookmark848" class="s124">. To view some graphs representing real network maps, see </a><a href="#bookmark848" class="a">[Dodge 201</a>6<span class="p">,</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark848" class="a">Cheswick </a>2000]<span class="p">; for a discussion of how well different graph-based models model the Internet, see</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark843" class="a">[Zegura 199</a>7<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Faloutsos 199</a>9<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Li 2004</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark450" class="s124">As shown in </a><a href="#bookmark450" class="a">Figure 5.</a>3<span class="p">, an edge also has a value representing its cost. Typically, an edge’s cost may reflect the physical length of the corresponding link (for example, a transoceanic link might have a higher</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">cost than a short-haul terrestrial link), the link speed, or the monetary cost associated with a link. For our purposes, we’ll simply take the edge costs as a given and won’t worry about how they are determined. For any edge (<i>x</i>, <i>y</i>) in <i>E</i>, we denote <i>c</i>(<i>x</i>, <i>y</i>) as the cost of the edge between nodes <i>x </i>and <i>y. </i>If the pair (<i>x</i>, <i>y</i>)</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">does not belong to <i>E</i>, we set <span class="s27">c(x</span>, y)=∞. Also, we’ll only consider undirected graphs (i.e., graphs whose</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;">edges do not have a direction) in our discussion here, so that edge (<i>x</i>, <i>y</i>) is the same as edge (<i>y</i>, <i>x</i>) and that c(x, y)=c(y, x); however, the algorithms we’ll study can be easily extended to the case of directed links with a different cost in each direction. Also, a node <i>y </i>is said to be a <span class="s23">neighbor</span><span class="s20"> </span>of node <i>x </i>if (<i>x</i>, <i>y</i>) belongs to <i>E</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">Given that costs are assigned to the various edges in the graph abstraction, a natural goal of a routing algorithm is to identify the least costly paths between sources and destinations. To make this problem more precise, recall that a <span class="s20">path </span>in a graph G=(N, E) is a sequence of nodes (x1,x2,<span class="s29">⋯</span>,xp) such that each</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 16pt;text-align: left;">of the pairs <span class="s27">(</span>x1,x2),(x2,x3),<span class="s29">⋯</span>,(xp−1,xp) are edges in <i>E</i>. The cost of a path <span class="s27">(</span>x1,x2,<span class="s29">⋯</span>, xp) is simply the sum</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 133%;text-align: left;">of all the edge costs along the path, that is, <span class="s27">c</span>(x1,x2)+c(x2,x3)+<span class="s29">⋯</span>+c(xp−1,xp). Given any two nodes <i>x </i>and <i>y</i>, there are typically many paths between the two nodes, with each path having a cost. One or more of these paths is a <span class="s20">least-cost path</span>. The least-cost problem is therefore clear: Find a path between the</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark450" class="s124">source and destination that has least cost. In </a><a href="#bookmark450" class="a">Figure 5.</a><span class="s20">3</span>, for example, the least-cost path between source node <i>u </i>and destination node <i>w </i>is (<i>u</i>, <i>x</i>, <i>y</i>, <i>w</i>) with a path cost of 3. Note that if all edges in the graph have the same cost, the least-cost path is also the <span class="s20">shortest path </span>(that is, the path with the smallest number of</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">links between the source and the destination).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">As a simple exercise, try finding the least-cost path from node <i>u </i>to <i>z </i><a href="#bookmark450" class="s124">in </a><a href="#bookmark450" class="a">Figure 5.3</a><span class="s20"> </span>and reflect for a  moment on how you calculated that path. If you are like most people, you found the path from <i>u </i>to <i>z </i><a href="#bookmark450" class="s124">by examining </a><a href="#bookmark450" class="a">Figure 5.</a><span class="s20">3</span>, tracing a few routes from <i>u </i>to <i>z</i>, and somehow convincing yourself that the path you</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">had chosen had the least cost among all possible paths. (Did you check all of the 17 possible paths</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">between <i>u </i>and <i>z</i>? Probably not!) Such a calculation is an example of a centralized routing algorithm—the routing algorithm was run in one location, your brain, with complete information about the network. Broadly, one way in which we can classify routing algorithms is according to whether they are centralized</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">or decentralized.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_497.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 136%;text-align: left;">A <span class="s23">centralized</span><span class="s20"> routing algorithm </span>computes the least-cost path between a source and destination using complete, global knowledge about the network. That is, the algorithm takes the connectivity between all nodes and all link costs as inputs. This then requires that the algorithm somehow obtain</p><p class="s20" style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark447" class="s124">this information before actually performing the calculation. The calculation itself can be run at one site (e.g., a logically centralized controller as in </a><a href="#bookmark447" class="a">Figure 5.</a>2<a href="#bookmark446" class="s124">) or could be replicated in the routing component of each and every router (e.g., as in </a><a href="#bookmark446" class="a">Figure 5.</a>1<span class="p">). The key distinguishing feature here, however, is that</span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the algorithm has complete information about connectivity and link costs. Algorithms with global state</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 161%;text-align: left;"><span class="p">information are often referred to as </span>link-state (LS) algorithms<a href="#bookmark454" class="s124">, since the algorithm must be aware of the cost of each link in the network. We’ll study LS algorithms in </a><a href="#bookmark454" class="a">Section 5.2.</a>1<span class="p">.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_498.png"/></span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 12pt;text-align: left;">In a <span class="s23">decentralized</span><span class="s20"> routing algorithm</span>, the calculation of the least-cost path is carried out in an</p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">iterative, distributed manner by the routers. No node has complete information about the costs of all network links. Instead, each node begins with only the knowledge of the costs of its own directly attached links. Then, through an iterative process of calculation and exchange of information with its neighboring nodes, a node gradually calculates the least-cost path to a destination or set of</p><p class="s20" style="padding-top: 2pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark460" class="s124">destinations. The decentralized routing algorithm we’ll study below in </a><a href="#bookmark460" class="a">Section 5.2.2</a> <span class="p">is called a distance-vector (DV) algorithm, because each node maintains a vector of estimates of the costs (distances) to all other nodes in the network. Such decentralized algorithms, with interactive message</span></p><p class="s20" style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark446" class="s124">exchange between neighboring routers is perhaps more naturally suited to control planes where the routers interact directly with each other, as in </a><a href="#bookmark446" class="a">Figure 5.</a>1<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">A second broad way to classify routing algorithms is according to whether they are static or dynamic. In <span class="s20">static routing algorithms</span>, routes change very slowly over time, often as a result of human intervention (for example, a human manually editing a link costs). <span class="s20">Dynamic routing algorithms </span>change the routing paths as the network traffic loads or topology change. A dynamic algorithm can be run either periodically or in direct response to topology or link cost changes. While dynamic algorithms are more responsive to network changes, they are also more susceptible to problems such as routing loops and route oscillation.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">A third way to classify routing algorithms is according to whether they are load-sensitive or load- insensitive. In a <span class="s20">load-sensitive algorithm</span>, link costs vary dynamically to reflect the current level of congestion in the underlying link. If a high cost is associated with a link that is currently congested, a routing algorithm will tend to choose routes around such a congested link. While early ARPAnet routing</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 129%;text-align: left;"><a href="#bookmark848" class="s124">algorithms were load-sensitive </a><a href="#bookmark848" class="a">[McQuillan 1980</a>]<a href="#bookmark848" class="s124">, a number of difficulties were encountered </a><a href="#bookmark848" class="a">[Huitema </a>1998]<span class="p">. Today’s Internet routing algorithms (such as RIP, OSPF, and BGP) are </span><span class="s23">load-insensitive</span><span class="p">, as a link’s cost does not explicitly reflect its current (or recent past) level of congestion.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">5.2.1 The Link-State (LS) Routing Algorithm</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">Recall that in a link-state algorithm, the network topology and all link costs are known, that is, available as input to the LS algorithm. In practice this is accomplished by having each node broadcast link-state packets to <i>all </i>other nodes in the network, with each link-state packet containing the identities and costs of</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark463" class="s124">its attached links. In practice (for example, with the Internet’s OSPF routing protocol, discussed in </a><a href="#bookmark463" class="a">Section</a></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 136%;text-align: justify;"><a href="#bookmark463" class="a">5.</a>3<span class="p">) this is often accomplished by a </span><span class="s23">link-state</span> broadcast <a href="#bookmark848" class="s124">algorithm </a><a href="#bookmark848" class="a">[Perlman </a>1999]<span class="p">. The result of the nodes’ broadcast is that all nodes have an identical and complete view of the network. Each node can then run the LS algorithm and compute the same set of least-cost paths as every other node.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">The link-state routing algorithm we present below is known as <i>Dijkstra’s algorithm</i><a href="#bookmark848" class="s124">, named after its inventor. A closely related algorithm is Prim’s algorithm; see </a><a href="#bookmark848" class="a">[Cormen 2001]</a><span class="s20"> </span>for a general discussion of graph algorithms. Dijkstra’s algorithm computes the least-cost path from one node (the source, which we</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">will refer to as <i>u</i>) to all other nodes in the network. Dijkstra’s algorithm is iterative and has the property that</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">after the <i>k</i>th iteration of the algorithm, the least-cost paths are known to <i>k </i>destination nodes, and among the least-cost paths to all destination nodes, these <i>k </i>paths will have the <i>k </i>smallest costs. Let us define the following notation:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_499.png"/></span></p><p class="s17" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">D<span class="p">(</span>v<span class="p">): cost of the least-cost path from the source node to destination </span>v <span class="p">as of this iteration of the algorithm.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_500.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_501.png"/></span></p><p class="s17" style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">p<span class="p">(</span>v<span class="p">): previous node (neighbor of </span>v<span class="p">) along the current least-cost path from the source to </span>v. N<span class="p">′: subset of nodes; </span>v <span class="p">is in </span>N<span class="p">′ if the least-cost path from the source to </span>v <span class="p">is definitively known.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">The centralized routing algorithm consists of an initialization step followed by a loop. The number of times the loop is executed is equal to the number of nodes in the network. Upon termination, the algorithm will have calculated the shortest paths from the source node <i>u </i>to every other node in the network.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="802" height="501" alt="image" src="计算机网络自顶向下7th-en/Image_502.png"/></span></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Link-State (LS) Algorithm for Source Node u</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s47" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">1<span class="s30">  </span><b>Initialization:</b></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">2   N’ = {u}</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l218"><li style="padding-left: 61pt;text-indent: -30pt;text-align: left;"><p class="s30" style="display: inline;">for all nodes v</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 76pt;text-indent: -45pt;text-align: left;"><p class="s30" style="display: inline;">if v is a neighbor of u</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 91pt;text-indent: -61pt;text-align: left;"><p class="s30" style="display: inline;">then D(v) = c(u, v)</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 76pt;text-indent: -45pt;text-align: left;"><p class="s30" style="display: inline;">else D(v) = ∞</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">7</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><ol id="l219"><li style="padding-left: 30pt;text-indent: 0pt;text-align: left;"><p class="s45" style="display: inline;">Loop</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 61pt;text-indent: -30pt;text-align: left;"><p class="s30" style="display: inline;">find w not in N’ such that D(w) is a minimum</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 61pt;text-indent: -30pt;text-align: left;"><p class="s30" style="display: inline;">add w to N’</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;"><p class="s30" style="display: inline;">update D(v) for each neighbor v of w and not in N’: 12        D(v) = min(D(v), D(w)+ c(w, v) )</p></li></ol><ol id="l220"><li style="padding-left: 68pt;text-indent: -38pt;text-align: left;"><p class="s30" style="display: inline;">/* new cost to v is either old cost to v or known</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 76pt;text-indent: -45pt;text-align: left;"><p class="s30" style="display: inline;">least path cost to w plus cost from w to v */</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 53pt;text-indent: -22pt;text-align: left;"><p class="s46" style="display: inline;">until<span class="s45"> </span><span class="s30">N’= N</span></p></li></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark450" class="s124">As an example, let’s consider the network in </a><a href="#bookmark450" class="a">Figure 5.3</a> <span class="p">and compute the least-cost paths from </span><span class="s17">u </span><a href="#bookmark451" class="s124">to all possible destinations. A tabular summary of the algorithm’s computation is shown in </a><a href="#bookmark451" class="a">Table 5.</a>1<span class="p">, where each line in the table gives the values of the algorithm’s variables at the end of the iteration. Let’s consider</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the few first steps in detail.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_503.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">In the initialization step, the currently known least-cost paths from <i>u </i>to its directly attached neighbors,</p><p class="s17" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">v, x<span class="p">, and </span>w<span class="p">, are initialized to 2, 1, and 5, respectively. Note in</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark450" style=" color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt;" name="bookmark451">Table 5.1 Running the link-state algorithm on the network in </a><a href="#bookmark450" class="a">Figure 5.3</a></p><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:579pt;margin-left:25.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s134" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">step</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s134" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">N’</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s134" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">D (v), p (v)</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s134" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">D (w), p (w)</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s134" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">D (x), p (x)</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s134" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">D (y), p (y)</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s134" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">D (z), p (z)</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">0</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">u</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2, u</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">5, u</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">1,u</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">∞</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">∞</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">1</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">ux</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2, u</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">4, x</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2, x</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">∞</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">uxy</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2, u</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">3, y</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">4, y</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">3</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">uxyv</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">3, y</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">4, y</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">4</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">uxyvw</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">4, y</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">5</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">uxyvwz</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/></tr></table><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">particular that the cost to <i>w </i>is set to 5 (even though we will soon see that a lesser-cost path does indeed exist) since this is the cost of the direct (one hop) link from <i>u </i>to <i>w. </i>The costs to <i>y </i>and <i>z </i>are set to infinity because they are not directly connected to <i>u.</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_504.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the first iteration, we look among those nodes not yet added to the set <i>N</i>′ and find that node with the least cost as of the end of the previous iteration. That node is <i>x</i>, with a cost of 1, and thus <i>x </i>is added to the set <i>N</i>′. Line 12 of the LS algorithm is then performed to update <i>D</i>(<i>v</i>) for all nodes <i>v</i><a href="#bookmark451" class="s124">, yielding the results shown in the second line (Step 1) in </a><a href="#bookmark451" class="a">Table 5.</a><span class="s20">1</span>. The cost of the path to <i>v </i>is unchanged. The cost of the path to <i>w </i>(which was 5 at the end of the initialization) through node <i>x </i>is found to have a cost of</p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">4. Hence this lower-cost path is selected and <i>w</i>’s predecessor along the shortest path from <i>u </i>is set to</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 26pt;text-indent: 0pt;text-align: left;">x<span class="p">. Similarly, the cost to </span>y <span class="p">(through </span>x<span class="p">) is computed to be 2, and the table is updated accordingly.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_505.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the second iteration, nodes <i>v </i>and <i>y </i>are found to have the least-cost paths (2), and we break the tie arbitrarily and add <i>y </i>to the set <i>N</i>′ so that <i>N</i>′ now contains <i>u, x</i>, and <i>y. </i>The cost to the remaining nodes not yet in <i>N</i>′, that is, nodes <i>v, w</i>, and <i>z</i><a href="#bookmark451" class="s124">, are updated via line 12 of the LS algorithm, yielding the results shown in the third row in </a><a href="#bookmark451" class="a">Table 5.</a><span class="s20">1</span>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_506.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">And so on . . .</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">When the LS algorithm terminates, we have, for each node, its predecessor along the least-cost path from the source node. For each predecessor, we also have <i>its </i>predecessor, and so in this manner we can construct the entire path from the source to all destinations. The forwarding table in a node, say node <i>u</i>,</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">can then be constructed from this information by storing, for each destination, the next-hop node on the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">least-cost path from <i>u </i><a href="#bookmark452" class="s124">to the destination. </a><a href="#bookmark452" class="a">Figure 5.4</a><span class="s20"> </span>shows the resulting least-cost paths and forwarding table in <i>u </i><a href="#bookmark450" class="s124">for the network in </a><a href="#bookmark450" class="a">Figure 5.</a><span class="s20">3</span>.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="524" height="197" alt="image" src="计算机网络自顶向下7th-en/Image_507.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark452">Figure 5.4 Least cost path and forwarding table for node u</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">What is the computational complexity of this algorithm? That is, given <i>n </i>nodes (not counting the source), how much computation must be done in the worst case to find the least-cost paths from the source to all</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 127%;text-align: left;">destinations? In the first iteration, we need to search through all <i>n </i>nodes to determine the node, <i>w</i>, not in <i>N</i>′ that has the minimum cost. In the second iteration, we need to check <span class="s27">n</span>−1 nodes to determine the minimum cost; in the third iteration n−2 nodes, and so on. Overall, the total number of nodes we need to</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">search through over all the iterations is n(n+1)/2, and thus we say that the preceding implementation of the LS algorithm has worst-case complexity of order <i>n </i>squared: <i>O</i>(<i>n</i><span class="s21">2</span>). (A more sophisticated implementation of this algorithm, using a data structure known as a heap, can find the minimum in line 9 in logarithmic rather than linear time, thus reducing the complexity.)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark453" class="s124">Before completing our discussion of the LS algorithm, let us consider a pathology that can arise. </a><a href="#bookmark453" class="a">Figure</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark453" class="a">5.5</a> <span class="p">shows a simple network topology where link costs are equal to the load carried on the link, for example, reflecting the delay that would be experienced. In this example, link costs are not symmetric; that</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">is, <i>c</i>(<i>u, v</i>) equals <i>c</i>(<i>v, u</i>) only if the load carried on both directions on the link (<i>u, v</i>) is the same. In this example, node <i>z </i>originates a unit of traffic destined for <i>w</i>, node <i>x </i>also originates a unit of traffic destined for <i>w</i>, and node <i>y </i>injects an amount of traffic equal to <i>e</i>, also destined for <i>w</i><a href="#bookmark453" class="s124">. The initial routing is shown in </a><a href="#bookmark453" class="a">Figure 5.5(a)</a><span class="s20"> </span>with the link costs corresponding to the amount of traffic carried.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 21pt;text-align: left;">When the LS algorithm is next run, node <i>y </i><a href="#bookmark453" class="s124">determines (based on the link costs shown in </a><a href="#bookmark453" class="a">Figure 5.5(a</a><span class="s20">)</span>) that the clockwise path to <i>w </i>has a cost of 1, while the counterclockwise path to <i>w </i>(which it had been using) has a cost of <span class="s27">1</span>+e. Hence <i>y’</i>s least-cost path to <i>w </i>is now clockwise. Similarly, <i>x </i>determines that its new least-cost path to <i>w </i><a href="#bookmark453" class="s124">is also clockwise, resulting in costs shown in </a><a href="#bookmark453" class="a">Figure </a><span class="s20">5.5(b)</span>. When the LS algorithm is run next, nodes <i>x, y</i>, and <i>z </i>all detect a zero-cost path to <i>w </i>in the counterclockwise direction, and all route their traffic to the counterclockwise routes. The next time the LS algorithm is run, <i>x, y</i>, and <i>z </i>all then route</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">their traffic to the clockwise routes.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">What can be done to prevent such oscillations (which can occur in any algorithm, not just an LS algorithm, that uses a congestion or delay-based link metric)? One solution would be to mandate that link costs not depend on the amount of traffic</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="240" height="240" alt="image" src="计算机网络自顶向下7th-en/Image_508.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark453">Figure 5.5 Oscillations with congestion-sensitive routing</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="240" height="256" alt="image" src="计算机网络自顶向下7th-en/Image_509.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="240" height="256" alt="image" src="计算机网络自顶向下7th-en/Image_510.jpg"/></span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="240" height="256" alt="image" src="计算机网络自顶向下7th-en/Image_511.jpg"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark454">carried—an unacceptable solution since one goal of routing is to avoid highly congested (for example, high-delay) links. Another solution is to ensure that not all routers run the LS algorithm at the same time. This seems a more reasonable solution, since we would hope that even if routers ran the LS algorithm with the same periodicity, the execution instance of the algorithm would not be the same at each node. Interestingly, researchers have found that routers in the Internet can self-synchronize among themselves</a></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="a">[Floyd Synchronization 1994</a>]<span class="p">. That is, even though they initially execute the algorithm with the same period but at different instants of time, the algorithm execution instance can eventually become, and remain, synchronized at the routers. One way to avoid such self-synchronization is for each router to</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">randomize the time it sends out a link advertisement.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having studied the LS algorithm, let’s consider the other major routing algorithm that is used in practice today—the distance-vector routing algorithm.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l221"><ol id="l222"><ol id="l223"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The Distance-Vector (DV) Routing Algorithm</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;">Whereas the LS algorithm is an algorithm using global information, the <span class="s20">distance-vector (DV) </span>algorithm is iterative, asynchronous, and distributed. It is <i>distributed </i>in that each node receives some information from one or more of its <i>directly attached </i>neighbors, performs a calculation, and then distributes the results of its</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">calculation back to its neighbors. It is <i>iterative </i>in that this process continues on until no more information is</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">exchanged between neighbors. (Interestingly, the algorithm is also self-terminating—there is no signal that</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">the computation should stop; it just stops.) The algorithm is <i>asynchronous </i>in that it does not require all of the nodes to operate in lockstep with each other. We’ll see that an asynchronous, iterative, self- terminating, distributed algorithm is much more interesting and fun than a centralized algorithm!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">Before we present the DV algorithm, it will prove beneficial to discuss an important relationship that exists among the costs of the least-cost paths. Let <i>d</i><span class="s31">x</span>(<i>y</i>) be the cost of the least-cost path from node <i>x </i>to node <i>y</i>.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Then the least costs are related by the celebrated Bellman-Ford equation, namely,</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark455">dx(y)=minv{c(x,v)+dv(y)},                                                                                                                             </a><span class="s27">(5.1)</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 156%;text-align: left;">where the <i>min</i><span class="s31">v </span>in the equation is taken over all of <i>x</i>’s neighbors. The Bellman-Ford equation is rather intuitive. Indeed, after traveling from <i>x </i>to <i>v</i>, if we then take the least-cost path from <i>v </i>to <i>y</i>, the path cost will</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">be <span class="s27">c(x</span>,v)+dv(y). Since we must begin by traveling to some neighbor <i>v</i>, the least cost from <i>x </i>to <i>y </i>is the</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">minimum of <span class="s27">c(x</span>,v)+dv(y) taken over all neighbors <i>v</i>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">But for those who might be skeptical about the validity of the equation, let’s check it for source node <i>u </i>and destination node <i>z </i><a href="#bookmark450" class="s124">in </a><a href="#bookmark450" class="a">Figure 5.</a><span class="s20">3</span>. The source node <i>u </i>has three neighbors: nodes <i>v</i>, <i>x</i>, and <i>w</i><a href="#bookmark455" class="s124">. By walking along various paths in the graph, it is easy to see that dv(z)=5, dx(z)=3, and dw(z)=3. Plugging these values into </a><a href="#bookmark455" class="a">Equation 5.</a><span class="s20">1</span>, along with the costs <span class="s27">c</span>(u,v)=2, c(u,x)=1, and <span class="s27">c</span>(u,w)=5, gives</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">du(z)=min{2+5,5+3,1+3}=4, which is obviously true and which is exactly what the Dijskstra algorithm gave</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">us for the same network. This quick verification should help relieve any skepticism you may have.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">The Bellman-Ford equation is not just an intellectual curiosity. It actually has significant practical importance: the solution to the Bellman-Ford equation provides the entries in node <i>x</i>’s forwarding table. To see this, let <i>v* </i><a href="#bookmark455" class="s124">be any neighboring node that achieves the minimum in </a><a href="#bookmark455" class="a">Equation 5.</a><span class="s20">1</span>. Then, if node <i>x </i>wants</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">to send a packet to node <i>y </i>along a least-cost path, it should first forward the packet to node <i>v*</i>. Thus, node</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">x<span class="p">’s forwarding table would specify node </span>v* <span class="p">as the next-hop router for the ultimate destination </span>y<span class="p">. Another important practical contribution of the Bellman-Ford equation is that it suggests the form of the neighbor- to-neighbor communication that will take place in the DV algorithm.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 136%;text-align: left;">The basic idea is as follows. Each node <i>x </i>begins with <i>D</i><span class="s31">x</span>(<i>y</i>), an estimate of the cost of the least-cost path from itself to node <i>y</i>, for all nodes, <i>y</i>, in <i>N</i>. Let <span class="s27">D</span>x=[Dx(y): y in N] be node <i>x</i>’s distance vector, which is the vector of cost estimates from <i>x </i>to all other nodes, <i>y</i>, in <i>N. </i>With the DV algorithm, each node <i>x </i>maintains the following routing information:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_512.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">For each neighbor <i>v</i>, the cost <i>c</i>(<i>x, v</i>) from <i>x </i>to directly attached neighbor, <i>v</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_513.png"/></span></p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 139%;text-align: left;">Node <i>x</i>’s distance vector, that is, <span class="s27">D</span>x=[Dx(y): y in N], containing <i>x</i>’s estimate of its cost to all destinations, <i>y</i>, in <i>N</i></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_514.png"/></span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 16pt;text-align: left;">The distance vectors of each of its neighbors, that is, <span class="s27">D</span>v=[Dv(y): y in N] for each neighbor <i>v </i>of <i>x</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">In the distributed, asynchronous algorithm, from time to time, each node sends a copy of its distance vector to each of its neighbors. When a node <i>x </i>receives a new distance vector from any of its neighbors <i>w</i>, it saves <i>w</i>’s distance vector, and then uses the Bellman-Ford equation to update its own distance vector</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">as follows:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Dx(y)=minv{c(x,v)+Dv(y)}      for each node y in N</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">If node <i>x</i>’s distance vector has changed as a result of this update step, node <i>x </i>will then send its updated</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 154%;text-align: left;">distance vector to each of its neighbors, which can in turn update their own distance vectors. Miraculously enough, as long as all the nodes continue to exchange their distance vectors in an asynchronous fashion, each cost estimate <i>D</i><span class="s31">x</span>(<i>y</i>) converges to <i>d</i><span class="s31">x</span>(<i>y</i>), the actual cost of the least-cost path from node <i>x </i>to node <a href="#bookmark848" style=" color: #333; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt;">y </a><a href="#bookmark848" class="a">[Bertsekas </a><span class="s20">1991]</span>!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Distance-Vector (DV) Algorithm</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="802" height="597" alt="image" src="计算机网络自顶向下7th-en/Image_515.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">At each node, <i>x</i>:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><ol id="l224"><li style="padding-left: 55pt;text-indent: -22pt;text-align: left;"><p class="s45" style="display: inline;">Initialization:</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 69pt;text-indent: -38pt;text-align: left;"><p class="s30" style="display: inline;">for all destinations y in N:</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 91pt;text-indent: -61pt;text-align: left;"><p class="s30" style="display: inline;">D<span class="s135">x</span>(y)= c(x, y)/* if y is not a neighbor then c(x, y)= ∞ */</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 69pt;text-indent: -38pt;text-align: left;"><p class="s30" style="display: inline;">for each neighbor w</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 91pt;text-indent: -61pt;text-align: left;"><p class="s30" style="display: inline;">D<span class="s135">w</span>(y) = ? for all destinations y in N</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 69pt;text-indent: -38pt;text-align: left;"><p class="s30" style="display: inline;">for each neighbor w</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 91pt;text-indent: -61pt;text-align: left;"><p class="s30" style="display: inline;">send distance vector  <b>D</b><span class="s135">x</span></p></li></ol></li></ol></ol></ol><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">8</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><ol id="l225"><li style="padding-left: 30pt;text-indent: 0pt;text-align: left;"><p class="s45" style="display: inline;">loop</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">= [D<span class="s135">x</span>(y): y in N] to w</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 76pt;text-indent: -45pt;text-align: left;"><p class="s46" style="display: inline;">wait<span class="s45">  </span><span class="s30">(until I see a link cost change to some neighbor w or</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 30pt;text-indent: 0pt;line-height: 148%;text-align: left;"><p class="s30" style="display: inline;">until I receive a distance vector from some neighbor w) 12</p></li></ol><ol id="l226"><li style="padding-left: 76pt;text-indent: -45pt;text-align: left;"><p class="s30" style="display: inline;">for each y in N:</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 107pt;text-indent: -76pt;text-align: left;"><p class="s30" style="display: inline;">D<span class="s135">x</span>(y) = min<span class="s135">v</span>{c(x, v) + D<span class="s135">v</span>(y)}</p></li></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">15</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l227"><li style="padding-left: 53pt;text-indent: -22pt;text-align: left;"><p class="s46" style="display: inline;">if<span class="s45"> </span><span class="s30">Dx(y) changed for any destination y</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 99pt;text-indent: -68pt;text-align: left;"><p class="s30" style="display: inline;">send distance vector <b>D</b><span class="s135">x</span></p></li></ol><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">18</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s47" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">19<span class="s30"> </span><b>forever</b></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 13pt;text-indent: 0pt;text-align: left;">= [D<span class="s135">x</span>(y): y in N] to all neighbors</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">In the DV algorithm, a node <i>x </i>updates its distance-vector estimate when it either sees a cost change in one of its directly attached links or receives a distance-vector update from some neighbor. But to update</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">its own forwarding table for a given destination <i>y</i>, what node <i>x </i>really needs to know is not the shortest-path distance to <i>y </i>but instead the neighboring node <i>v*</i>(<i>y</i>) that is the next-hop router along the shortest path to <i>y</i>. As you might expect, the next-hop router <i>v*</i>(<i>y</i>) is the neighbor <i>v </i>that achieves the minimum in Line 14 of the DV algorithm. (If there are multiple neighbors <i>v </i>that achieve the minimum, then <i>v*</i>(<i>y</i>) can be any of the minimizing neighbors.) Thus, in Lines 13–14, for each destination <i>y</i>, node <i>x </i>also determines <i>v*</i>(<i>y</i>) and updates its forwarding table for destination <i>y</i>.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Recall that the LS algorithm is a centralized algorithm in the sense that it requires each node to first obtain</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">a complete map of the network before running the Dijkstra algorithm. The DV algorithm is <i>decentralized </i>and does not use such global information. Indeed, the only information a node will have is the costs of the links to its directly attached neighbors and information it receives from these neighbors. Each node waits</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">for an update from any neighbor (Lines 10–11), calculates its new distance vector when receiving an update (Line 14), and distributes its new distance vector to its neighbors (Lines 16–17). DV-like algorithms are used in many routing protocols in practice, including the Internet’s RIP and BGP, ISO IDRP, Novell IPX, and the original ARPAnet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark456" class="a">Figure 5.6</a> <span class="p">illustrates the operation of the DV algorithm for the simple three-node network shown at the top of the figure. The operation of the algorithm is illustrated in a synchronous manner, where all nodes simultaneously receive distance vectors from their neighbors, compute their new distance vectors, and</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">inform their neighbors if their distance vectors have changed. After studying this example, you should convince yourself that the algorithm operates correctly in an asynchronous manner as well, with node computations and update generation/reception occurring at any time.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">The leftmost column of the figure displays three initial <span class="s20">routing tables </span>for each of the three nodes. For example, the table in the upper-left corner is node <i>x</i>’s initial routing table. Within a specific routing table,</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">each row is a distance vector— specifically, each node’s routing table includes its own distance vector and</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">that of each of its neighbors. Thus, the first row in node <i>x</i>’s initial routing table is Dx=[Dx(x),Dx(y),Dx(z)]=[0,2,7]. The second and third rows in this table are the most recently received</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">distance vectors from nodes <i>y </i>and <i>z</i>, respectively. Because at initialization node <i>x </i>has not received anything from node <i>y </i>or <i>z</i>, the entries in the second and third rows are initialized to infinity.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">After initialization, each node sends its distance vector to each of its two neighbors. This is illustrated in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark456" class="a">Figure 5.6</a><span class="s20"> </span>by the arrows from the first column of tables to the second column of tables. For example, node <i>x </i>sends its distance vector <i><b>D</b></i><span class="s31">x </span><span class="s27">=</span> [0, 2, 7] to both nodes <i>y </i>and <i>z</i>. After receiving the updates, each node recomputes its own distance vector. For example, node <i>x </i>computes</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Dx(x)=0Dx(y)=min{c(x,y)+Dy(y),c(x,z)+Dz(y)}=min{2+0,   7+1}=2Dx(z)=min{c(x,y)+Dy(z),c(x,z)+Dz(z)}=min{2+1,7+0}=3</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The second column therefore displays, for each node, the node’s new distance vector along with distance vectors just received from its neighbors. Note, for example, that</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="504" height="738" alt="image" src="计算机网络自顶向下7th-en/Image_516.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark456">Figure 5.6 Distance-vector (DV) algorithm in operation</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 156%;text-align: left;">node <i>x</i>’s estimate for the least cost to node <i>z</i>, <i>D</i><span class="s31">x</span>(<i>z</i>), has changed from 7 to 3. Also note that for node <i>x</i>, neighboring node <i>y </i>achieves the minimum in line 14 of the DV algorithm; thus at this stage of the</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">algorithm, we have at node <i>x </i>that <span class="s27">v</span>*(y)=y and <span class="s27">v</span>*(z)=y.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark456" class="s124">After the nodes recompute their distance vectors, they again send their updated distance vectors to their neighbors (if there has been a change). This is illustrated in </a><a href="#bookmark456" class="a">Figure 5.6</a><span class="s20"> </span>by the arrows from the second column of tables to the third column of tables. Note that only nodes <i>x </i>and <i>z </i>send updates: node <i>y</i>’s</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">distance vector didn’t change so node <i>y </i>doesn’t send an update. After receiving the updates, the nodes</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">then recompute their distance vectors and update their routing tables, which are shown in the third column.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The process of receiving updated distance vectors from neighbors, recomputing routing table entries, and informing neighbors of changed costs of the least-cost path to a destination continues until no update messages are sent. At this point, since no update messages are sent, no further routing table calculations will occur and the algorithm will enter a quiescent state; that is, all nodes will be performing the wait in Lines 10–11 of the DV algorithm. The algorithm remains in the quiescent state until a link cost changes, as discussed next.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Distance-Vector Algorithm: Link-Cost Changes and Link Failure</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark457" class="s124">When a node running the DV algorithm detects a change in the link cost from itself to a neighbor (Lines 10–11), it updates its distance vector (Lines 13–14) and, if there’s a change in the cost of the least-cost path, informs its neighbors (Lines 16–17) of its new distance vector. </a><a href="#bookmark457" class="a">Figure 5.7(a)</a> <span class="p">illustrates a scenario</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">where the link cost from <i>y </i>to <i>x </i>changes from 4 to 1. We focus here only on <i>y</i>’ and <i>z</i>’s distance table entries</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">to destination <i>x</i>. The DV algorithm causes the following sequence of events to occur:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_517.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 140%;text-align: left;">At time <i>t</i><span class="s22">0</span>, <i>y </i>detects the link-cost change (the cost has changed from 4 to 1), updates its distance vector, and informs its neighbors of this change since its distance vector has changed.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_518.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 140%;text-align: left;">At time <i>t</i><span class="s22">1</span>, <i>z </i>receives the update from <i>y </i>and updates its table. It computes a new least cost to <i>x </i>(it has decreased from a cost of 5 to a cost of 2) and sends its new distance vector to its neighbors.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_519.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 156%;text-align: left;">At time <i>t</i><span class="s22">2</span>, <i>y </i>receives <i>z</i>’s update and updates its distance table. <i>y</i>’s least costs do not change and hence <i>y </i>does not send any message to <i>z</i>. The algorithm comes to a quiescent state.</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">Thus, only two iterations are required for the DV algorithm to reach a quiescent state. The good news about the decreased cost between <i>x </i>and <i>y </i>has propagated quickly through the network.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="600" height="177" alt="image" src="计算机网络自顶向下7th-en/Image_520.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark457">Figure 5.7 Changes in link cost</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Let’s now consider what can happen when a link cost <i>increases. </i>Suppose that the link cost between <i>x </i>and</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">y <a href="#bookmark457" class="s124">increases from 4 to 60, as shown in </a><a href="#bookmark457" class="a">Figure </a><span class="s20">5.7(b)</span><span class="p">.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><ol id="l228"><li style="padding-left: 48pt;text-indent: -19pt;text-align: left;"><p style="display: inline;">Before the link cost changes, <span class="s27">D</span>y(x)=4, Dy(z)=1, Dz(y)=1, and <span class="s27">D</span>z(x)=5. At time <i>t</i><span class="s22">0</span>, <i>y </i>detects the link-</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 130%;text-align: left;">cost change (the cost has changed from 4 to 60). <i>y </i>computes its new minimum-cost path to <i>x </i>to have a cost of</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">Dy(x)=min{c(y,x)+Dx(x), c(y,z)+Dz(x)}=min{60+0,1+5}=6</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 141%;text-align: left;">Of course, with our global view of the network, we can see that this new cost via <i>z </i>is <i>wrong. </i>But the only information node <i>y </i>has is that its direct cost to <i>x </i>is 60 and that <i>z </i>has last told <i>y </i>that <i>z </i>could get to <i>x </i>with a cost of 5. So in order to get to <i>x, y </i>would now route through <i>z</i>, fully expecting that <i>z </i>will be able to get to <i>x </i>with a cost of 5. As of <i>t</i><span class="s22">1 </span>we have a <span class="s23">routing</span><span class="s20"> loop</span>—in order to get to <i>x, y</i></p><p style="padding-top: 1pt;padding-left: 48pt;text-indent: 0pt;line-height: 143%;text-align: justify;">routes through <i>z</i>, and <i>z </i>routes through <i>y</i>. A routing loop is like a black hole—a packet destined for <i>x </i>arriving at <i>y </i>or <i>z </i>as of <i>t</i><span class="s22">1 </span>will bounce back and forth between these two nodes forever (or until the forwarding tables are changed).</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Since node <i>y </i>has computed a new minimum cost to <i>x</i>, it informs <i>z </i>of its new distance vector at time</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 48pt;text-indent: 0pt;text-align: left;">t<span class="s22">1</span><span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Sometime after <i>t</i><span class="s22">1</span>, <i>z </i>receives <i>y</i>’s new distance vector, which indicates that <i>y</i>’s minimum cost to <i>x </i>is</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 134%;text-align: left;">6. <i>z </i>knows it can get to <i>y </i>with a cost of 1 and hence computes a new least cost to <i>x </i>of <span class="s27">D</span>z(x)=min{50+0,1+6}=7. Since <i>z</i>’s least cost to <i>x </i>has increased, it then informs <i>y </i>of its new distance vector at <i>t</i><span class="s22">2</span>.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">In a similar manner, after receiving <i>z</i>’s new distance vector, <i>y </i>determines <span class="s27">D</span>y(x)=8 and sends <i>z </i>its distance vector. <i>z </i>then determines <span class="s27">D</span>z(x)=9 and sends <i>y </i>its distance vector, and so on.</p></li></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;">How long will the process continue? You should convince yourself that the loop will persist for 44 iterations (message exchanges between <i>y </i>and <i>z</i>)—until <i>z </i>eventually computes the cost of its path via <i>y </i>to be greater than 50. At this point, <i>z </i>will (finally!) determine that its least-cost path to <i>x </i>is via its direct connection to <i>x</i>. <i>y</i></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">will then route to <i>x </i>via <i>z</i>. The result of the bad news about the increase in link cost has indeed traveled</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">slowly! What would have happened if the link cost <i>c</i>(<i>y, x</i>) had changed from 4 to 10,000 and the cost <i>c</i>(<i>z,</i></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">x<span class="p">) had been 9,999? Because of such scenarios, the problem we have seen is sometimes referred to as the count-to-infinity problem.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Distance-Vector Algorithm: Adding Poisoned Reverse</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">The specific looping scenario just described can be avoided using a technique known as <i>poisoned reverse. </i>The idea is simple—if <i>z </i>routes through <i>y </i>to get to destination <i>x</i>, then <i>z </i>will advertise to <i>y </i>that its distance to <i>x </i>is infinity, that is, <i>z </i>will advertise to <i>y </i>that <span class="s27">D</span>z(x)=∞ (even though <i>z </i>knows <span class="s27">D</span>z(x)=5 in truth). <i>z </i>will continue telling this little white lie to <i>y </i>as long as it routes to <i>x </i>via <i>y</i>. Since <i>y </i>believes that <i>z </i>has no path to <i>x, y </i>will never attempt to route to <i>x </i>via <i>z</i>, as long as <i>z </i>continues to route to <i>x </i>via <i>y </i>(and lies about doing so).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 141%;text-align: left;"><a href="#bookmark453" class="s124">Let’s now see how poisoned reverse solves the particular looping problem we encountered before in </a><a href="#bookmark453" class="a">Figure </a><span class="s20">5.5(b)</span>. As a result of the poisoned reverse, <i>y</i>’s distance table indicates <span class="s27">D</span>z(x)=∞. When the cost of the (<i>x</i>, <i>y</i>) link changes from 4 to 60 at time <i>t</i><span class="s22">0</span>, <i>y </i>updates its table and continues to route directly to <i>x</i>, albeit</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">at a higher cost of 60, and informs <i>z </i>of its new cost to <i>x</i>, that is, <span class="s27">D</span>y(x)=60. After receiving the update at <i>t</i><span class="s22">1</span>,  <i>z </i>immediately shifts its route to <i>x </i>to be via the direct (<i>z, x</i>) link at a cost of 50. Since this is a new least-cost path to <i>x</i>, and since the path no longer passes through <i>y, z </i>now informs <i>y </i>that <span class="s27">D</span>z(x)=50 at <i>t</i><span class="s22">2</span>. After</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 16pt;text-align: left;">receiving the update from <i>z, y </i>updates its distance table with <span class="s27">D</span>y(x)=51. Also, since <i>z </i>is now on <i>y</i>’s least-</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">cost path to <i>x</i>, <i>y </i>poisons the reverse path from <i>z </i>to <i>x </i>by informing <i>z </i>at time <i>t</i><span class="s22">3 </span>that <span class="s27">D</span>y(x)=∞ (even though <i>y</i></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">knows that Dy(x)=51 in truth).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Does poisoned reverse solve the general count-to-infinity problem? It does not. You should convince yourself that loops involving three or more nodes (rather than simply two immediately neighboring nodes) will not be detected by the poisoned reverse technique.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">A Comparison of LS and DV Routing Algorithms</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">The DV and LS algorithms take complementary approaches toward computing routing. In the DV algorithm, each node talks to <i>only </i>its directly connected neighbors, but it provides its neighbors with least- cost estimates from itself to <i>all </i>the nodes (that it knows about) in the network. The LS algorithm requires</p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark371" class="s124">global information. Consequently, when implemented in each and every router, e.g., as in </a><a href="#bookmark371" class="a">Figure 4.2</a> <span class="p">and</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">5.1, each node would need to communicate with <i>all </i>other nodes (via broadcast), but it tells them <i>only </i>the costs of its directly connected links. Let’s conclude our study of LS and DV algorithms with a quick</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">comparison of some of their attributes. Recall that <i>N </i>is the set of nodes (routers) and <i>E </i>is the set of edges (links).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_521.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a name="bookmark458">Message complexity. </a><span class="p">We have seen that LS requires each node to know the cost of each link in the network. This requires O(|N| |E|) messages to be sent. Also, whenever a link cost changes, the new link cost must be sent to all nodes. The DV algorithm requires message exchanges between directly</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">connected neighbors at each iteration. We have seen that the time needed for the algorithm to converge can depend on many factors. When link costs change, the DV algorithm will propagate the results of the changed link cost only if the new link cost results in a changed least-cost path for one of the nodes attached to that link.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_522.png"/></span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 141%;text-align: left;"><b>Speed of convergence. </b>We have seen that our implementation of LS is an O(|N|<span class="s21">2</span>) algorithm requiring O(|N| |E|)) messages. The DV algorithm can converge slowly and can have routing loops while the algorithm is converging. DV also suffers from the count-to-infinity problem.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_523.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Robustness. <span class="p">What can happen if a router fails, misbehaves, or is sabotaged? Under LS, a router  could broadcast an incorrect cost for one of its attached links (but no others). A node could also corrupt or drop any packets it received as part of an LS broadcast. But an LS node is computing only its own</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">forwarding tables; other nodes are performing similar calculations for themselves. This means route calculations are somewhat separated under LS, providing a degree of robustness. Under DV, a node can advertise incorrect least-cost paths to any or all destinations. (Indeed, in 1997, a malfunctioning router in a small ISP provided national backbone routers with erroneous routing information. This caused other routers to flood the malfunctioning router with traffic and caused large portions of the</p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark459">Internet to become disconnected for up to several hours </a><a href="#bookmark848" class="a">[Neumann </a>1997]<span class="p">.) More generally, we note that, at each iteration, a node’s calculation in DV is passed on to its neighbor and then indirectly to its neighbor’s neighbor on the next iteration. In this sense, an incorrect node calculation can be diffused</span><a name="bookmark460">&zwnj;</a></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">through the entire network under DV.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the end, neither algorithm is an obvious winner over the other; indeed, both algorithms are used in the Internet.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l229"><ol id="l230"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark461">Intra-AS Routing in the Internet: OSPF</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In our study of routing algorithms so far, we’ve viewed the network simply as a collection of interconnected routers. One router was indistinguishable from another in the sense that all routers executed the same routing algorithm to compute routing paths through the entire network. In practice, this model and its view of a homogenous set of routers all executing the same routing algorithm is simplistic for two important reasons:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_524.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Scale. <span class="p">As the number of routers becomes large, the overhead involved in communicating, computing, and storing routing information becomes prohibitive. Today’s Internet consists of hundreds of millions of routers. Storing routing information for possible destinations at each of these</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">routers would clearly require enormous amounts of memory. The overhead required to broadcast connectivity and link cost updates among all of the routers would be huge! A distance-vector algorithm that iterated among such a large number of routers would surely never converge. Clearly, something must be done to reduce the complexity of route computation in a network as large as the Internet.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_525.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 25pt;text-indent: 0pt;line-height: 138%;text-align: left;">Administrative autonomy. <a href="#bookmark59" class="s124">As described in </a><a href="#bookmark59" class="a">Section 1.</a><span style=" color: #1E79B8;">3</span><span class="p">, the Internet is a network of ISPs, with each ISP consisting of its own network of routers. An ISP generally desires to operate its network as it pleases (for example, to run whatever routing algorithm it chooses within its network) or to hide</span></p><p style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">aspects of its network’s internal organization from the outside. Ideally, an organization should be able to operate and administer its network as it wishes, while still being able to connect its network to other outside networks.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Both of these problems can be solved by organizing routers into <span class="s20">autonomous systems (ASs)</span>, with each AS consisting of a group of routers that are under the same administrative control. Often the routers in an ISP, and the links that interconnect them, constitute a single AS. Some ISPs, however, partition their network into multiple ASs. In particular, some tier-1 ISPs use one gigantic AS for their entire network, whereas others break up their ISP into tens of interconnected ASs. An autonomous</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">system is identified by its globally unique autonomous system number (ASN) </a><a href="#bookmark848" class="a">[RFC </a>1930]<a href="#bookmark848" class="s124">. AS numbers, like IP addresses, are assigned by ICANN regional registries </a><a href="#bookmark848" class="a">[ICANN </a>2016]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Routers within the same AS all run the same routing algorithm and have information about each other. The routing algorithm running within an autonomous system is called an <span class="s20">intra-autonomous system routing protocol</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Open Shortest Path First (OSPF)</p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">OSPF routing and its closely related cousin, IS-IS, are widely used for intra-AS routing in the Internet. The Open in OSPF indicates that the routing protocol specification is publicly available (for example, as opposed to Cisco’s EIGRP protocol, which was only recently became open </a><a href="#bookmark848" class="a">[Savage </a>2015]<span class="p">, after roughly</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">20 years as a Cisco-proprietary protocol). The most recent version of OSPF, version 2, is defined in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="a">[RFC </a>2328]<span class="p">, a public document.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">OSPF is a link-state protocol that uses flooding of link-state information and a Dijkstra’s least-cost path algorithm. With OSPF, each router constructs a complete topological map (that is, a graph) of the entire autonomous system. Each router then locally runs Dijkstra’s shortest-path algorithm to determine a</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">shortest-path tree to all <i>subnets</i><a href="#bookmark462" class="s124">, with itself as the root node. Individual link costs are configured by the network administrator (see sidebar, </a><a href="#bookmark462" class="a">Principles and Practice: Setting OSPF Weight</a><span class="s20">s</span>). The administrator might choose to set all link costs to 1,</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="683" alt="image" src="计算机网络自顶向下7th-en/Image_526.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><a name="bookmark462">PRINCIPLES IN PRACTICE</a></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">SETTING OSPF LINK WEIGHTS</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Our discussion of link-state routing has implicitly assumed that link weights are set, a routing algorithm such as OSPF is run, and traffic flows according to the routing tables computed by the LS algorithm. In terms of cause and effect, the link weights are given (i.e., they come first) and result (via Dijkstra’s algorithm) in routing paths that minimize overall cost. In this viewpoint, link weights reflect the cost of using a link (e.g., if link weights are inversely proportional to capacity, then the use of high-capacity links would have smaller weight and thus be more attractive from a routing standpoint) and Dijsktra’s algorithm serves to minimize overall cost.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark848" class="s124">In practice, the cause and effect relationship between link weights and routing paths may be reversed, with network operators configuring link weights in order to obtain routing paths that achieve certain traffic engineering goals </a><a href="#bookmark848" class="a">[Fortz 200</a>0<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Fortz 2002</a>]<span class="p">. For example, suppose a</span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 11pt;text-align: left;">network operator has an estimate of traffic flow entering the network at each ingress point and</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">destined for each egress point. The operator may then want to put in place a specific routing of ingress-to-egress flows that minimizes the maximum utilization over all of the network’s links. But with a routing algorithm such as OSPF, the operator’s main “knobs” for tuning the routing of flows through the network are the link weights. Thus, in order to achieve the goal of minimizing the maximum link utilization, the operator must find the set of link weights that achieves this goal. This is a reversal of the cause and effect relationship—the desired routing of flows is known, and the OSPF link weights must be found such that the OSPF routing algorithm results in this desired routing of flows.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;">thus achieving minimum-hop routing, or might choose to set the link weights to be inversely proportional to link capacity in order to discourage traffic from using low-bandwidth links. OSPF does not mandate a policy for how link weights are set (that is the job of the network administrator), but instead provides</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the mechanisms (protocol) for determining least-cost path routing for the given set of link weights.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">With OSPF, a router broadcasts routing information to <i>all </i>other routers in the autonomous system, not just to its neighboring routers. A router broadcasts link-state information whenever there is a change in a link’s state (for example, a change in cost or a change in up/down status). It also broadcasts a link’s</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">state periodically (at least once every 30 minutes), even if the link’s state has not changed. RFC 2328 notes that “this periodic updating of link state advertisements adds robustness to the link state algorithm.” OSPF advertisements are contained in OSPF messages that are carried directly by IP, with an upper-layer protocol of 89 for OSPF. Thus, the OSPF protocol must itself implement functionality such as reliable message transfer and link-state broadcast. The OSPF protocol also checks that links are operational (via a HELLO message that is sent to an attached neighbor) and allows an OSPF router to obtain a neighboring router’s database of network-wide link state.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Some of the advances embodied in OSPF include the following:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_527.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Security. <span class="p">Exchanges between OSPF routers (for example, link-state updates) can be authenticated. With authentication, only trusted routers can participate in the OSPF protocol within an AS, thus preventing malicious intruders (or networking students taking their newfound knowledge out for a</span></p><p class="s20" style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark671" class="s124">joyride) from injecting incorrect information into router tables. By default, OSPF packets between routers are not authenticated and could be forged. Two types of authentication can be configured— simple and MD5 (see </a><a href="#bookmark671" class="a">Chapter 8</a> <span class="p">for a discussion on MD5 and authentication in general). With simple</span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 11pt;text-align: left;">authentication, the same password is configured on each router. When a router sends an OSPF</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: justify;">packet, it includes the password in plaintext. Clearly, simple authentication is not very secure. MD5 authentication is based on shared secret keys that are configured in all the routers. For each OSPF packet that it sends, the router computes the MD5 hash of the content of the OSPF packet</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark671" class="s124">appended with the secret key. (See the discussion of message authentication codes in </a><a href="#bookmark671" class="a">Chapter </a>8<span class="p">.) Then the router includes the resulting hash value in the OSPF packet. The receiving router, using the preconfigured secret key, will compute an MD5 hash of the packet and compare it with the hash</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">value that the packet carries, thus verifying the packet’s authenticity. Sequence numbers are also used with MD5 authentication to protect against replay attacks.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_528.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Multiple same-cost paths. <span class="p">When multiple paths to a destination have the same cost, OSPF allows multiple paths to be used (that is, a single path need not be chosen for carrying all traffic when multiple equal-cost paths exist).</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_529.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Integrated support for unicast and multicast routing. <a href="#bookmark848" class="s124">Multicast OSPF (MOSPF) </a><a href="#bookmark848" class="a">[RFC </a><span style=" color: #1E79B8;">1584] </span><span class="p">provides simple extensions to OSPF to provide for multicast routing. MOSPF uses the existing OSPF link database and adds a new type of link-state advertisement to the existing OSPF link-state</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">broadcast mechanism.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_530.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Support for hierarchy within a single AS. <span class="p">An OSPF autonomous system can be configured hierarchically into areas. Each area runs its own OSPF link-state routing algorithm, with each router in an area broadcasting its link state to all other routers in that area. Within each area, one or more</span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark463">area border routers are responsible for routing packets outside the area. Lastly, exactly one OSPF area in the AS is configured to be the backbone area. The primary role of the backbone area is to route traffic between the other areas in the AS. The backbone always contains all area border routers in the AS and may contain non-border routers as well. Inter-area routing within the AS requires that the packet be first routed to an area border router (intra-area routing), then routed through the backbone to the area border router that is in the destination area, and then routed to the final destination.</a><a name="bookmark464">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">OSPF is a relatively complex protocol, and our coverage here has been necessarily brief; </a><a href="#bookmark848" class="a">[Huitema </a>1998<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Moy 199</a>8<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 2328]</a> <span class="p">provide additional details.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark465">Routing Among the ISPs: BGP</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We just learned that OSPF is an example of an intra-AS routing protocol. When routing a packet between a source and destination within the same AS, the route the packet follows is entirely determined by the intra-AS routing protocol. However, to route a packet across multiple ASs, say from a smartphone in Timbuktu to a server in a datacenter in Silicon Valley, we need an <span class="s20">inter-autonomous system routing protocol</span>. Since an inter-AS routing protocol involves coordination among multiple ASs, communicating ASs must run the same inter-AS routing protocol. In fact, in the Internet, all ASs run the same inter-AS routing protocol, called the Border Gateway Protocol, more commonly known as <span class="s20">BGP</span></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="a">[RFC </a>4271<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Stewart 1999</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark394" class="s124">BGP is arguably the most important of all the Internet protocols (the only other contender would be the IP protocol that we studied in </a><a href="#bookmark394" class="a">Section 4.</a>3<span class="p">), as it is the protocol that glues the thousands of ISPs in the</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Internet together. As we will soon see, BGP is a decentralized and asynchronous protocol in the vein of</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark460" class="s124">distance-vector routing described in </a><a href="#bookmark460" class="a">Section 5.2.</a>2<span class="p">. Although BGP is a complex and challenging protocol, to understand the Internet on a deep level, we need to become familiar with its underpinnings and operation. The time we devote to learning BGP will be well worth the effort.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><ol id="l231"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The Role of BGP</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To understand the responsibilities of BGP, consider an AS and an arbitrary router in that AS. Recall that every router has a forwarding table, which plays the central role in the process of forwarding arriving packets to outbound router links. As we have learned, for destinations that are within the same AS, the entries in the router’s forwarding table are determined by the AS’s intra-AS routing protocol. But what about destinations that are outside of the AS? This is precisely where BGP comes to the rescue.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In BGP, packets are not routed to a specific destination address, but instead to CIDRized prefixes, with each prefix representing a subnet or a collection of subnets. In the world of BGP, a destination may take the form 138.16.68/22, which for this example includes 1,024 IP addresses. Thus, a router’s forwarding</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">table will have entries of the form (<i>x</i>, <i>I</i>), where <i>x </i>is a prefix (such as 138.16.68/22) and <i>I </i>is an interface number for one of the router’s interfaces.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">As an inter-AS routing protocol, BGP provides each router a means to:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><ol id="l232"><li style="padding-left: 48pt;text-indent: -19pt;text-align: left;"><p class="s28" style="display: inline;">Obtain prefix reachability information from neighboring ASs. <span class="p">In particular, BGP allows each</span></p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark466">subnet to advertise its existence to the rest of the Internet. A subnet screams, “I exist and I am here,” and BGP makes sure that all the routers in the Internet know about this subnet. If it weren’t for BGP, each subnet would be an isolated island—alone, unknown and unreachable by the rest of the Internet.</a></p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p class="s28" style="display: inline;">Determine the “best” routes to the prefixes. <span class="p">A router may learn about two or more different routes to a specific prefix. To determine the best route, the router will locally run a BGP route-</span></p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">selection procedure (using the prefix reachability information it obtained via neighboring routers). The best route will be determined based on policy as well as the reachability information.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Let us now delve into how BGP carries out these two tasks.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">++++++++++++++++++++++++++++++++++++++++++++++++++++++++</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Advertising BGP Route Information</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark467" class="s124">Consider the network shown in </a><a href="#bookmark467" class="a">Figure 5.</a>8<span class="p">. As we can see, this simple network has three autonomous systems: AS1, AS2, and AS3. As shown, AS3 includes a subnet with prefix x. For each AS, each router is either a </span>gateway router <span class="p">or an </span>internal router<span class="p">. A gateway router is a router on the edge of an AS that</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">directly connects to one or more routers in other ASs. An <span class="s20">internal router </span>connects only to hosts and routers within its own AS. In AS1, for example, router 1c is a gateway router; routers 1a, 1b, and 1d are internal routers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Let’s consider the task of advertising reachability information for prefix x to all of the routers shown in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark467" class="a">Figure 5.</a>8<span class="p">. At a high level, this is straightforward. First, AS3 sends a BGP message to AS2, saying that x exists and is in AS3; let’s denote this message as “AS3 x”. Then AS2 sends a BGP message to AS1, saying that x exists and that you can get to x by first passing through AS2 and then going to AS3; let’s</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">denote that message as “AS2 AS3 x”. In this manner, each of the autonomous systems will not only learn about the existence of x, but also learn about a path of autonomous systems that leads to x.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although the discussion in the above paragraph about advertising BGP reachability information should get the general idea across, it is not precise in the sense that autonomous systems do not actually send messages to each other, but instead routers do. To understand this, let’s now re-examine the example</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark467" class="s124">in </a><a href="#bookmark467" class="a">Figure 5.</a>8<span class="p">. In BGP,</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="729" height="285" alt="image" src="计算机网络自顶向下7th-en/Image_531.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark467">Figure 5.8 Network with three autonomous systems. AS3 includes a subnet with prefix x</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">pairs of routers exchange routing information over semi-permanent TCP connections using port 179. Each such TCP connection, along with all the BGP messages sent over the connection, is called a <span class="s20">BGP connection</span>. Furthermore, a BGP connection that spans two ASs is called an <span class="s20">external BGP (eBGP) </span>connection, and a BGP session between routers in the same AS is called an <span class="s20">internal BGP (iBGP)</span></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark467" class="s124">connection. Examples of BGP connections for the network in </a><a href="#bookmark467" class="a">Figure 5.8</a> <a href="#bookmark470" class="s124">are shown in </a><a href="#bookmark470" class="a">Figure 5.</a>9<span class="p">. There is typically one eBGP connection for each link that directly connects gateway routers in different ASs;</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark470" class="s124">thus, in </a><a href="#bookmark470" class="a">Figure 5.</a>9<span class="p">, there is an eBGP connection between gateway routers 1c and 2a and an eBGP connection between gateway routers 2c and 3a.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark470" class="s124">There are also iBGP connections between routers within each of the ASs. In particular, </a><a href="#bookmark470" class="a">Figure 5.9</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">displays a common configuration of one BGP connection for each pair of routers internal to an AS,</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark470" class="s124">creating a mesh of TCP connections within each AS. In </a><a href="#bookmark470" class="a">Figure 5.</a>9<span class="p">, the eBGP connections are shown with the long dashes; the iBGP connections are shown with the short dashes. Note that iBGP connections do not always correspond to physical links.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark468">In order to propagate the reachability information, both iBGP and eBGP sessions are used. Consider again advertising the reachability information for prefix x to all routers in AS1 and AS2. In this process, gateway router 3a first sends an eBGP message “AS3 x” to gateway router 2c. Gateway router 2c then sends the iBGP message “AS3 x” to all of the other routers in AS2, including to gateway router 2a. Gateway router 2a then sends the eBGP message “AS2 AS3 x” to gateway router 1c.</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="729" height="352" alt="image" src="计算机网络自顶向下7th-en/Image_532.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark469">Figure 5.9 eBGP and iBGP connections</a><a name="bookmark470">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Finally, gateway router 1c uses iBGP to send the message “AS2 AS3 x” to all the routers in AS1. After this process is complete, each router in AS1 and AS2 is aware of the existence of x and is also aware of an AS path that leads to x.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark471" class="s124">Of course, in a real network, from a given router there may be many different paths to a given destination, each through a different sequence of ASs. For example, consider the network in </a><a href="#bookmark471" class="a">Figure 5.1</a>0<a href="#bookmark467" class="s124">, which is the original network in </a><a href="#bookmark467" class="a">Figure 5.</a>8<span class="p">, with an additional physical link from router 1d to router</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">3d. In this case, there are two paths from AS1 to x: the path “AS2 AS3 x” via router 1c; and the new path</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">“AS3 x” via the router 1d.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Determining the Best Routes</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">As we have just learned, there may be many paths from a given router to a destination subnet. In fact, in the Internet, routers often receive reachability information about dozens of different possible paths. How does a router choose among these paths (and then configure its forwarding table accordingly)?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before addressing this critical question, we need to introduce a little more BGP terminology. When a router advertises a prefix across a BGP connection, it includes with the prefix several <span class="s20">BGP attributes</span>. In BGP jargon, a prefix along with its attributes is called a <span class="s20">route</span>. Two of the more important attributes are AS-PATH and NEXT-HOP. The AS-PATH attribute contains the list of ASs through which the</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="729" height="287" alt="image" src="计算机网络自顶向下7th-en/Image_533.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark471">Figure 5.10 Network augmented with peering link between AS1 and AS3</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark471" class="s124">advertisement has passed, as we’ve seen in our examples above. To generate the AS-PATH value, when a prefix is passed to an AS, the AS adds its ASN to the existing list in the AS-PATH. For example, in </a><a href="#bookmark471" class="a">Figure 5.1</a>0<span class="p">, there are two routes from AS1 to subnet x: one which uses the AS-PATH “AS2 AS3”;</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">and another that uses the AS-PATH “A3”. BGP routers also use the AS-PATH attribute to detect and</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">prevent looping advertisements; specifically, if a router sees that its own AS is contained in the path list, it will reject the advertisement.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">Providing the critical link between the inter-AS and intra-AS routing protocols, the NEXT-HOP attribute has a subtle but important use. The NEXT-HOP is the </span><span class="s17">IP address of the router interface that begins the AS-PATH</span><a href="#bookmark471" class="s124">. To gain insight into this attribute, let’s again refer to </a><a href="#bookmark471" class="a">Figure 5.1</a>0<a href="#bookmark471" class="s124">. As indicated in </a><a href="#bookmark471" class="a">Figure 5.1</a>0<span class="p">,</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the NEXT-HOP attribute for the route “AS2 AS3 x” from AS1 to x that passes through AS2 is the IP</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">address of the left interface on router 2a. The NEXT-HOP attribute for the route “AS3 x” from AS1 to x that bypasses AS2 is the IP address of the leftmost interface of router 3d. In summary, in this toy example, each router in AS1 becomes aware of two BGP routes to prefix x:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="82" alt="image" src="计算机网络自顶向下7th-en/Image_534.png"/></span></p><p style="padding-left: 25pt;text-indent: 0pt;line-height: 276%;text-align: left;">IP address of leftmost interface for router 2a; AS2 AS3; x IP address of leftmost interface of router 3d; AS3; x</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;">Here, each BGP route is written as a list with three components: NEXT-HOP; AS-PATH; destination prefix. In practice, a BGP route includes additional attributes, which we will ignore for the time being. Note that the NEXT-HOP attribute is an IP address of a router that does <i>not </i>belong to AS1; however,</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the subnet that contains this IP address directly attaches to AS1.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Hot Potato Routing</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">We are now <i>finally </i>in position to talk about BGP routing algorithms in a precise manner. We will begin with one of the simplest routing algorithms, namely, <span class="s20">hot potato routing</span>.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark471" class="s124">Consider router 1b in the network in </a><a href="#bookmark471" class="a">Figure 5.1</a>0<span class="p">. As just described, this router will learn about two possible BGP routes to prefix x. In hot potato routing, the route chosen (from among all possible routes) is that route with the least cost to the NEXT-HOP router beginning that route. In this example, router 1b</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">will consult its intra-AS routing information to find the least-cost intra-AS path to NEXT-HOP router 2a and the least-cost intra-AS path to NEXT-HOP router 3d, and then select the route with the smallest of these least-cost paths. For example, suppose that cost is defined as the number of links traversed. Then the least cost from router 1b to router 2a is 2, the least cost from router 1b to router 2d is 3, and router 2a would therefore be selected. Router 1b would then consult its forwarding table (configured by its</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">intra-AS algorithm) and find the interface <i>I </i>that is on the least-cost path to router 2a. It then adds (<i>x</i>, <i>I</i>) to its forwarding table.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark472" class="s124">The steps for adding an outside-AS prefix in a router’s forwarding table for hot potato routing are summarized in </a><a href="#bookmark472" class="a">Figure 5.1</a>1<span class="p">. It is important to note that when adding an outside-AS prefix into a</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">forwarding table, both the inter-AS routing protocol (BGP) and the intra-AS routing protocol (e.g., OSPF) are used.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The idea behind hot-potato routing is for router 1b to get packets out of its AS as quickly as possible (more specifically, with the least cost possible) without worrying about the cost of the remaining portions of the path outside of its AS to the destination. In the name “hot potato routing,” a packet is analogous to a hot potato that is burning in your hands. Because it is burning hot, you want to pass it off to another person (another AS) as quickly as possible. Hot potato routing is thus</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="782" height="122" alt="image" src="计算机网络自顶向下7th-en/Image_535.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark472">Figure 5.11 Steps in adding outside-AS destination in a router’s forwarding table</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">a selfish algorithm—it tries to reduce the cost in its own AS while ignoring the other components of the end-to-end costs outside its AS. Note that with hot potato routing, two routers in the same AS may choose two different AS paths to the same prefix. For example, we just saw that router 1b would send packets through AS2 to reach x. However, router 1d would bypass AS2 and send packets directly to AS3 to reach x.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Route-Selection Algorithm</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark473">In practice, BGP uses an algorithm that is more complicated than hot potato routing, but nevertheless incorporates hot potato routing. For any given destination prefix, the input into BGP’s route-selection algorithm is the set of all routes to that prefix that have been learned and accepted by the router. If there is only one such route, then BGP obviously selects that route. If there are two or more routes to the same prefix, then BGP sequentially invokes the following elimination rules until one route remains:</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l233"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 124%;text-align: left;"><p style="display: inline;">A route is assigned a <span class="s23">local</span><span class="s20"> preference </span>value as one of its attributes (in addition to the AS-PATH and NEXT-HOP attributes). The local preference of a route could have been set by the router or</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">could have been learned from another router in the same AS. The value of the local preference attribute is a policy decision that is left entirely up to the AS’s network administrator. (We will shortly discuss BGP policy issues in some detail.) The routes with the highest local preference values are selected.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">From the remaining routes (all with the same highest local preference value), the route with the shortest AS-PATH is selected. If this rule were the only rule for route selection, then BGP would</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">be using a DV algorithm for path determination, where the distance metric uses the number of AS hops rather than the number of router hops.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">From the remaining routes (all with the same highest local preference value and the same AS- PATH length), hot potato routing is used, that is, the route with the closest NEXT-HOP router is</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">selected.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">If more than one route still remains, the router uses BGP identifiers to select the route; see</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 48pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="a">[Stewart </a>1999]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark471" class="s124">As an example, let’s again consider router 1b in </a><a href="#bookmark471" class="a">Figure 5.1</a>0<span class="p">. Recall that there are exactly two BGP routes to prefix x, one that passes through AS2 and one that bypasses AS2. Also recall that if hot potato routing on its own were used, then BGP would route packets through AS2 to prefix x. But in the above</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">route-selection algorithm, rule 2 is applied before rule 3, causing BGP to select the route that bypasses AS2, since that route has a shorter AS PATH. So we see that with the above route-selection algorithm, BGP is no longer a selfish algorithm—it first looks for routes with short AS paths (thereby likely reducing end-to-end delay).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">As noted above, BGP is the <i>de facto </i><a href="http://www.routeviews.org/" class="s124" target="_blank">standard for inter-AS routing for the Internet. To see the contents of various BGP routing tables (large!) extracted from routers in tier-1 ISPs, see </a><a href="http://www.routeviews.org/" class="a" target="_blank">http:// www.routeviews.or</a><span class="s20">g</span>. BGP routing tables often contain over half a million routes (that is, prefixes and</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">corresponding attributes). Statistics about the size and characteristics of BGP routing tables are</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">presented in </a><a href="#bookmark848" class="a">[Potaroo 2016</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">IP-Anycast</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">In addition to being the Internet’s inter-AS routing protocol, BGP is often used to implement the IP-</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">anycast service </a><a href="#bookmark848" class="a">[RFC </a>1546<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">RFC 7094</a>]<span class="p">, which is commonly used in DNS. To motivate IP-anycast, consider that in many applications, we are interested in (1) replicating the same content on different servers in many different dispersed geographical locations, and (2) having each user access the content</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">from the server that is closest. For example, a CDN may replicate videos and other objects on servers in different countries. Similarly, the DNS system can replicate DNS records on DNS servers throughout the world. When a user wants to access this replicated content, it is desirable to point the user to the “nearest” server with the replicated content. BGP’s route-selection algorithm provides an easy and natural mechanism for doing so.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark475" class="s124">To make our discussion concrete, let’s describe how a CDN might use IP-anycast. As shown in </a><a href="#bookmark475" class="a">Figure 5.1</a><span class="s20">2</span>, during the IP-anycast configuration stage, the CDN company assigns the <i>same </i>IP address to each of its servers, and uses standard BGP to advertise this IP address from each of the servers. When a</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">BGP router receives multiple route advertisements for this IP address, it treats these advertisements as providing different paths to the same physical location (when, in fact, the advertisements are for different paths to different physical locations). When configuring its routing table, each router will locally use the BGP route-selection algorithm to pick the “best” (for example, closest, as determined by AS-hop counts) route to that IP address. For example, if one BGP route (corresponding to one location) is only one AS hop away from the router, and all other BGP routes (corresponding to other locations) are two or more AS hops away, then the BGP router would choose to route packets to the location that is one hop away. After this initial BGP address-advertisement phase, the CDN can do its main job of distributing content. When a client requests the video, the CDN returns to the client the common IP address used by the geographically dispersed servers, no matter where the client is located. When the client sends a request to that IP address, Internet routers then forward the request packet to the “closest” server, as defined by the BGP route-selection algorithm.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although the above CDN example nicely illustrates how IP-anycast can be used, in practice CDNs generally choose not to use IP-anycast because BGP routing changes can result in different packets of the same TCP connection arriving at different instances of the Web server. But IP-anycast is extensively</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark206" class="s124">used by the DNS system to direct DNS queries to the closest root DNS server. Recall from </a><a href="#bookmark206" class="a">Section 2.</a>4<span class="p">, there are currently 13 IP addresses for root DNS servers. But corresponding</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="776" height="540" alt="image" src="计算机网络自顶向下7th-en/Image_536.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark474">Figure 5.12 Using IP-anycast to bring users to the closest CDN server</a><a name="bookmark475">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">to each of these addresses, there are multiple DNS root servers, with some of these addresses having over 100 DNS root servers scattered over all corners of the world. When a DNS query is sent to one of these 13 IP addresses, IP anycast is used to route the query to the nearest of the DNS root servers that is responsible for that address.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Routing Policy</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">When a router selects a route to a destination, the AS routing policy can trump all other considerations, such as shortest AS path or hot potato routing. Indeed, in the route-selection algorithm, routes are first selected according to the local-preference attribute, whose value is fixed by the policy of the local AS.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark477" class="s124" name="bookmark476">Let’s illustrate some of the basic concepts of BGP routing policy with a simple example. </a><a href="#bookmark477" class="a">Figure </a>5.13 <span class="p">shows six interconnected autonomous systems: A, B, C, W, X, and Y. It is important to note that A, B, C, W, X, and Y are ASs, not routers. Let’s</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="581" height="163" alt="image" src="计算机网络自顶向下7th-en/Image_537.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark477">Figure 5.13 A simple BGP policy scenario</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">assume that autonomous systems W, X, and Y are access ISPs and that A, B, and C are backbone provider networks. We’ll also assume that A, B, and C, directly send traffic to each other, and provide full BGP information to their customer networks. All traffic entering an ISP access network must be destined for that network, and all traffic leaving an ISP access network must have originated in that network. W and Y are clearly access ISPs. X is a <span class="s20">multi-homed access ISP</span>, since it is connected to the rest of the network via two different providers (a scenario that is becoming increasingly common in practice). However, like W and Y, X itself must be the source/destination of all traffic leaving/entering X. But how will this stub network behavior be implemented and enforced? How will X be prevented from forwarding traffic between B and C? This can easily be accomplished by controlling the manner in which BGP routes are advertised. In particular X will function as an access ISP network if it advertises (to its neighbors B and C) that it has no paths to any other destinations except itself. That is, even though X may know of a path, say XCY, that reaches network Y, it will not advertise this path to B. Since B is unaware that X has a path to Y, B would never forward traffic destined to Y (or C) via X. This simple example illustrates how a selective route advertisement policy can be used to implement customer/provider routing relationships.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s next focus on a provider network, say AS B. Suppose that B has learned (from A) that A has a path AW to W. B can thus install the route AW into its routing information base. Clearly, B also wants to advertise the path BAW to its customer, X, so that X knows that it can route to W via B. But should B advertise the path BAW to C? If it does so, then C could route traffic to W via BAW. If A, B, and C are all backbone providers, than B might rightly feel that it should not have to shoulder the burden (and cost!)  of carrying transit traffic between A and C. B might rightly feel that it is A’s and C’s job (and cost!) to make sure that C can route to/from A’s customers via a direct connection between A and C. There are currently no official standards that govern how backbone ISPs route among themselves. However, a  rule of thumb followed by commercial ISPs is that any traffic flowing across an ISP’s backbone network must have either a source or a destination (or both) in a network that is a customer of that ISP;  otherwise the traffic would be getting a free ride on the ISP’s network. Individual peering agreements (that would govern questions such as</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="60" alt="image" src="计算机网络自顶向下7th-en/Image_538.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">PRINCIPLES IN PRACTICE</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="860" alt="image" src="计算机网络自顶向下7th-en/Image_539.png"/></span></p><p class="s24" style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><a name="bookmark478">WHY ARE THERE DIFFERENT INTER-AS AND INTRA-AS ROUTING PROTOCOLS?</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having now studied the details of specific inter-AS and intra-AS routing protocols deployed in today’s Internet, let’s conclude by considering perhaps the most fundamental question we could ask about these protocols in the first place (hopefully, you have been wondering this all along, and have not lost the forest for the trees!): Why are different inter-AS and intra-AS routing protocols used?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">The answer to this question gets at the heart of the differences between the goals of routing within an AS and among ASs:</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_540.png"/></span></p><p class="s28" style="padding-left: 49pt;text-indent: 0pt;line-height: 138%;text-align: left;">Policy. <span class="p">Among ASs, policy issues dominate. It may well be important that traffic originating  in a given AS not be able to pass through another specific AS. Similarly, a given AS may well want to control what transit traffic it carries between other ASs. We have seen that BGP</span></p><p style="padding-top: 1pt;padding-left: 49pt;text-indent: 0pt;line-height: 146%;text-align: left;">carries path attributes and provides for controlled distribution of routing information so that such policy-based routing decisions can be made. Within an AS, everything is nominally under the same administrative control, and thus policy issues play a much less important role in choosing routes within the AS.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_541.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 49pt;text-indent: 0pt;line-height: 138%;text-align: left;">Scale. <span class="p">The ability of a routing algorithm and its data structures to scale to handle routing to/among large numbers of networks is a critical issue in inter-AS routing. Within an AS, scalability is less of a concern. For one thing, if a single ISP becomes too large, it is always</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_542.png"/></span></p><p style="padding-top: 1pt;padding-left: 49pt;text-indent: 0pt;line-height: 153%;text-align: left;">possible to divide it into two ASs and perform inter-AS routing between the two new ASs. (Recall that OSPF allows such a hierarchy to be built by splitting an AS into areas.) <b>Performance. </b>Because inter-AS routing is so policy oriented, the quality (for example,</p><p style="padding-left: 49pt;text-indent: 0pt;line-height: 11pt;text-align: left;">performance) of the routes used is often of secondary concern (that is, a longer or more</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 49pt;text-indent: 0pt;line-height: 146%;text-align: left;">costly route that satisfies certain policy criteria may well be taken over a route that is shorter but does not meet that criteria). Indeed, we saw that among ASs, there is not even the notion of cost (other than AS hop count) associated with routes. Within a single AS, however, such policy concerns are of less importance, allowing routing to focus more on the level of performance realized on a route.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">those raised above) are typically negotiated between pairs of ISPs and are often confidential; </a><a href="#bookmark848" class="a">[Huston 1999a]</a> <a href="#bookmark848" class="s124">provides an interesting discussion of peering agreements. For a detailed description of how routing policy reflects commercial relationships among ISPs, see </a><a href="#bookmark848" class="a">[Gao 200</a>1<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Dmitiropoulos 2007</a>]<a href="#bookmark848" class="s124">. For a discussion of BGP routing polices from an ISP standpoint, see </a><a href="#bookmark848" class="a">[Caesar </a>2005b]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">This completes our brief introduction to BGP. Understanding BGP is important because it plays a central role in the Internet. We encourage you to see the references </a><a href="#bookmark848" class="a">[Griffin 201</a>2<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Stewart 199</a>9<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Labovitz </a>1997<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Halabi 200</a>0<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Huitema </a>1998<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Gao 200</a>1<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Feamster </a>2004<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Caesar </a>2005b<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Li 2007]</a> <span class="p">to learn more</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">about BGP.</p></li><li style="padding-top: 3pt;padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Putting the Pieces Together: Obtaining Internet Presence</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Although this subsection is not about BGP <i>per se</i>, it brings together many of the protocols and concepts we’ve seen thus far, including IP addressing, DNS, and BGP.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">Suppose you have just created a small company that has a number of servers, including a public Web server that describes your company’s products and services, a mail server from which your employees obtain their e-mail messages, and a DNS server. Naturally, you would like the entire world to be able to visit your Web site in order to learn about your exciting products and services. Moreover, you would like your employees to be able to send and receive e-mail to potential customers throughout the world.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To meet these goals, you first need to obtain Internet connectivity, which is done by contracting with, and connecting to, a local ISP. Your company will have a gateway router, which will be connected to a router in your local ISP. This connection might be a DSL connection through the existing telephone infrastructure, a leased line to the ISP’s router, or one of the many other access solutions described in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark5" class="a">Chapter </a>1<span class="p">. Your local ISP will also provide you with an IP address range, e.g., a /24 address range consisting of 256 addresses. Once you have your physical connectivity and your IP address range, you will assign one of the IP addresses (in your address range) to your Web server, one to your mail server,</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">one to your DNS server, one to your gateway router, and other IP addresses to other servers and networking devices in your company’s network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark138" class="s124">In addition to contracting with an ISP, you will also need to contract with an Internet registrar to obtain a domain name for your company, as described in </a><a href="#bookmark138" class="a">Chapter </a>2<a href="http://xanadu.com/" class="s124" target="_blank">. For example, if your company’s name is, say, Xanadu Inc., you will naturally try to obtain the domain name </a>xanadu.com<span class="p">. Your company must</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">also obtain presence in the DNS system. Specifically, because outsiders will want to contact your DNS</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark138" class="s124">server to obtain the IP addresses of your servers, you will also need to provide your registrar with the IP address of your DNS server. Your registrar will then put an entry for your DNS server (domain name and corresponding IP address) in the .com top-level-domain servers, as described in </a><a href="#bookmark138" class="a">Chapter </a>2<span class="p">. After this</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="http://xanadu.com/" class="s124" target="_blank">step is completed, any user who knows your domain name (e.g., </a>xanadu.com<span class="p">) will be able to obtain the</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">IP address of your DNS server via the DNS system.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="http://www.xanadu.com/" class="s124" target="_blank">So that people can discover the IP addresses of your Web server, in your DNS server you will need to include entries that map the host name of your Web server (e.g., </a><a href="http://www.xanadu.com/" class="a" target="_blank">www.xanadu.co</a>m<span class="p">) to its IP address.</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;"><a name="bookmark479">You will want to have similar entries for other publicly available servers in your company, including your mail server. In this manner, if Alice wants to browse your Web server, the DNS system will contact your DNS server, find the IP address of your Web server, and give it to Alice. Alice can then establish a TCP connection directly with your Web server.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">However, there still remains one other necessary and crucial step to allow outsiders from around the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark480">world to access your Web server. Consider what happens when Alice, who knows the IP address of your Web server, sends an IP datagram (e.g., a TCP SYN segment) to that IP address. This datagram will be routed through the Internet, visiting a series of routers in many different ASs, and eventually reach your Web server. When any one of the routers receives the datagram, it is going to look for an entry in its forwarding table to determine on which outgoing port it should forward the datagram. Therefore, each of the routers needs to know about the existence of your company’s /24 prefix (or some aggregate entry). How does a router become aware of your company’s prefix? As we have just seen, it becomes aware of it from BGP! Specifically, when your company contracts with a local ISP and gets assigned a prefix (i.e., an address range), your local ISP will use BGP to advertise your prefix to the ISPs to which it connects. Those ISPs will then, in turn, use BGP to propagate the advertisement. Eventually, all Internet routers will know about your prefix (or about some aggregate that includes your prefix) and thus be able to appropriately forward datagrams destined to your Web and mail servers.</a><a name="bookmark481">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s18" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark482">5.5 The SDN Control Plane</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section, we’ll dive into the SDN control plane—the network-wide logic that controls packet forwarding among a network’s SDN-enabled devices, as well as the configuration and management of these devices and their services. Our study here builds on our earlier discussion of generalized SDN</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark433" class="s124">forwarding in </a><a href="#bookmark433" class="a">Section 4.</a>4<a href="#bookmark448" class="s124">, so you might want to first review that section, as well as </a><a href="#bookmark448" class="a">Section 5.1</a> <a href="#bookmark433" class="s124">of this chapter, before continuing on. As in </a><a href="#bookmark433" class="a">Section 4.</a>4<span class="p">, we’ll again adopt the terminology used in the SDN literature and refer to the network’s forwarding devices as “packet switches” (or just switches, with</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">“packet” being understood), since forwarding decisions can be made on the basis of network-layer source/destination addresses, link-layer source/destination addresses, as well as many other values in transport-, network-, and link-layer packet-header fields.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">Four key characteristics of an SDN architecture can be identified </a><a href="#bookmark848" class="a">[Kreutz </a>2015]<span class="p">:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_543.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Flow-based forwarding. <span class="p">Packet forwarding by SDN-controlled switches can be based on any number of header field values in the transport-layer, network-layer, or link-layer header. We saw in</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark433" class="a">Section 4.4</a> <span class="p">that the OpenFlow1.0 abstraction allows forwarding based on eleven different header field values. This contrasts sharply with the traditional approach to router-based forwarding that we</span></p><p class="s20" style="padding-top: 4pt;padding-left: 25pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark459" class="s124">studied in </a><a href="#bookmark459" class="a">Sections 5.</a>2<a href="#bookmark480" class="s124">–</a><a href="#bookmark480" class="a">5.</a>4<a href="#bookmark447" class="s124">, where forwarding of IP datagrams was based solely on a datagram’s destination IP address. Recall from </a><a href="#bookmark447" class="a">Figure 5.2</a> <span class="p">that packet forwarding rules are specified in a switch’s flow table; it is the job of the SDN control plane to compute, manage and install flow table</span></p><p style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;text-align: left;">entries in all of the network’s switches.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_544.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;text-align: left;">Separation of data plane and control plane. <a href="#bookmark447" class="s124">This separation is shown clearly in </a><a href="#bookmark447" class="a">Figures 5.2</a> <span class="p">and</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark483" class="a">5.1</a>4<span class="p">. The data plane consists of the network’s switches— relatively simple (but fast) devices that execute the “match plus action” rules in their flow tables. The control plane consists of servers and software that determine and manage the switches’ flow tables.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_545.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Network control functions: external to data-plane switches. <span class="p">Given that the “S” in SDN is for “software,” it’s perhaps not surprising that the SDN control plane is implemented in software. Unlike traditional routers, however, this software executes on servers that are both distinct and remote from</span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark483" class="s124">the network’s switches. As shown in </a><a href="#bookmark483" class="a">Figure 5.1</a>4<span class="p">, the control plane itself consists of two components</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">—an SDN controller (or network operating system </a><a href="#bookmark848" class="a">[Gude 2008</a>]<span class="p">) and a set of network-control applications. The controller maintains accurate network state information (e.g., the state of remote links, switches, and hosts); provides this information to the network-control applications running in</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">the control plane; and provides the means through which these applications can monitor, program,</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark483" class="s124">and control the underlying network devices. Although the controller in </a><a href="#bookmark483" class="a">Figure 5.14</a> <span class="p">is shown as a single central server, in practice the controller is only logically centralized; it is typically implemented on several servers that provide coordinated, scalable performance and high availability.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_546.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">A programmable network. <span class="p">The network is programmable through the network-control applications running in the control plane. These applications represent the “brains” of the SDN control plane, using the APIs provided by the SDN controller to specify and control the data plane in the network</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">devices. For example, a routing network-control application might determine the end-end paths between sources and destinations (e.g., by executing Dijkstra’s algorithm using the node-state and link-state information maintained by the SDN controller). Another network application might perform access control, i.e., determine which packets are to be blocked at a switch, as in our third example in</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark434" class="a">Section 4.4.</a>3<a href="#bookmark434" class="s124">. Yet another application might forward packets in a manner that performs server load balancing (the second example we considered in </a><a href="#bookmark434" class="a">Section 4.4.</a>3<span class="p">).</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">From this discussion, we can see that SDN represents a significant “unbundling” of network functionality</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">—data plane switches, SDN controllers, and network-control applications are separate entities that may each be provided by different vendors and organizations. This contrasts with the pre-SDN model in which a switch/router (together with its embedded control plane software and protocol implementations) was monolithic, vertically integrated, and sold by a single vendor. This unbundling of network functionality in SDN has been likened to the earlier evolution from mainframe computers (where hardware, system software, and applications were provided by a single vendor) to personal computers (with their separate hardware, operating systems, and applications). The unbundling of computing hardware, system software, and applications has arguably led to a rich, open ecosystem driven by innovation in all three of these areas; one hope for SDN is that it too will lead to a such rich innovation.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark483" class="s124">Given our understanding of the SDN architecture of </a><a href="#bookmark483" class="a">Figure 5.1</a>4<span class="p">, many questions naturally arise. How and where are the flow tables actually computed? How are these tables updated in response to events at SDN-controlled devices (e.g., an attached link going up/down)? And how are the flow table entries at</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">multiple switches coordinated in such a way as to result in orchestrated and consistent network-wide functionality (e.g., end-to-end paths for forwarding packets from sources to destinations, or coordinated distributed firewalls)? It is the role of the SDN control plane to provide these, and many other, capabilities.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="587" height="520" alt="image" src="计算机网络自顶向下7th-en/Image_547.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark483">Figure 5.14 Components of the SDN architecture: SDN-controlled switches, the SDN controller, network-control applications</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">5.5.2 The SDN Control Plane: SDN Controller and SDN Network-control Applications</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s begin our discussion of the SDN control plane in the abstract, by considering the generic capabilities that the control plane must provide. As we’ll see, this abstract, “first principles” approach will lead us to an overall architecture that reflects how SDN control planes have been implemented in practice.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">As noted above, the SDN control plane divides broadly into two components—the SDN controller and the SDN network-control applications. Let’s explore the controller first. Many SDN controllers have been developed since the earliest SDN controller </a><a href="#bookmark848" class="a">[Gude 2008</a>]<a href="#bookmark848" class="s124">; see </a><a href="#bookmark848" class="a">[Kreutz 2015]</a> <span class="p">for an extremely thorough</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark484" class="s124">and up-to-date survey. </a><a href="#bookmark484" class="a">Figure 5.15</a> <span class="p">provides a more detailed view of a generic SDN controller. A</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">controller’s functionality can be broadly organized into three layers. Let’s consider these layers in an uncharacteristically bottom-up fashion:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_548.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">A communication layer: communicating between the SDN controller and controlled network devices. <span class="p">Clearly, if an SDN controller is going to control the operation of a remote SDN-enabled</span></p><p style="padding-top: 3pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">switch, host, or other device, a protocol is needed to transfer information between the controller and that device. In addition, a device must be able to communicate locally-observed events to the controller (e.g., a message indicating that an attached link has gone up or down, that a device has just joined the network, or a heartbeat indicating that a device is up and operational). These events provide the SDN controller with an up-to-date view of the network’s state. This protocol constitutes</p><p class="s20" style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark484" class="s124">the lowest layer of the controller architecture, as shown in </a><a href="#bookmark484" class="a">Figure 5.1</a>5<span class="p">. The communication between the controller and the controlled devices cross what has come to be known as the controller’s</span></p><p class="s20" style="padding-top: 4pt;padding-left: 19pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark486" class="s124">“southbound” interface. In </a><a href="#bookmark486" class="a">Section 5.5.</a>2<span class="p">, we’ll study OpenFlow—a specific protocol that provides this communication functionality. OpenFlow is implemented in most, if not all, SDN controllers.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_549.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;">A network-wide state-management layer. <span class="p">The ultimate control decisions made by the SDN control plane—e.g., configuring flow tables in all switches to achieve the desired end-end forwarding, to implement load balancing, or to implement a particular firewalling capability—will require that the</span></p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">controller have up-to-date information about state of the networks’ hosts, links, switches, and other SDN-controlled devices. A switch’s flow table contains counters whose values might also be profitably used by network-control applications; these values should thus be available to the applications. Since the ultimate aim of the control plane is to determine flow tables for the various controlled devices, a controller might also maintain a copy of these tables. These pieces of information all constitute examples of the network-wide “state” maintained by the SDN controller.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_550.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;line-height: 130%;text-align: left;">The interface to the network-control application layer. <span class="p">The controller interacts with network- control applications through its “northbound” interface. This API</span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="581" height="660" alt="image" src="计算机网络自顶向下7th-en/Image_551.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark484">Figure 5.15 Components of an SDN controller</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">allows network-control applications to read/write network state and flow tables within the state- management layer. Applications can register to be notified when state-change events occur, so that they can take actions in response to network event notifications sent from SDN-controlled devices. Different types of APIs may be provided; we’ll see that two popular SDN controllers communicate</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">with their applications using a REST </a><a href="#bookmark848" class="a">[Fielding 2000]</a> <span class="p">request-response interface.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark485">We have noted several times that an SDN controller can be considered to be “logically centralized,” i.e., that the controller may be viewed externally (e.g., from the point of view of SDN-controlled devices and external network-control applications) as a single, monolithic service. However, these services and</a></p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">the databases used to hold state information are implemented in practice by a <i>distributed </i>set of servers for fault tolerance, high availability, or for performance reasons. With controller functions being</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">implemented by a <i>set </i><a href="#bookmark848" class="s124">of servers, the semantics of the controller’s internal operations (e.g., maintaining logical time ordering of events, consistency, consensus, and more) must be considered </a><a href="#bookmark848" class="a">[Panda 2013</a><span class="s20">]</span>.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark486">Such concerns are common across many different distributed systems; see </a><a href="#bookmark848" class="a">[Lamport 198</a>9<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Lampson 1996]</a> <a href="#bookmark848" class="s124">for elegant solutions to these challenges. Modern controllers such as OpenDaylight </a><a href="#bookmark848" class="a">[OpenDaylight Lithium 2016]</a> <a href="#bookmark848" class="s124">and ONOS </a><a href="#bookmark848" class="a">[ONOS 2016]</a> <span class="p">(see sidebar) have placed considerable</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">emphasis on architecting a logically centralized but physically distributed controller platform that</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">provides scalable services and high availability to the controlled devices and network-control applications alike.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark484" class="s124">The architecture depicted in </a><a href="#bookmark484" class="a">Figure 5.15</a> <a href="#bookmark848" class="s124">closely resembles the architecture of the originally proposed NOX controller in 2008 </a><a href="#bookmark848" class="a">[Gude 2008</a>]<a href="#bookmark848" class="s124">, as well as that of today’s OpenDaylight </a><a href="#bookmark848" class="a">[OpenDaylight Lithium 2016]</a> <a href="#bookmark848" class="s124">and ONOS </a><a href="#bookmark848" class="a">[ONOS 2016]</a> <a href="#bookmark489" class="s124">SDN controllers (see sidebar). We’ll cover an example of controller operation in </a><a href="#bookmark489" class="a">Section 5.5.</a>3<span class="p">. First, however, let’s examine the OpenFlow protocol, which lies in the</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">controller’s communication layer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l234"><ol id="l235"><ol id="l236"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">OpenFlow Protocol</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">The OpenFlow protocol </a><a href="#bookmark848" class="a">[OpenFlow 200</a>9<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">ONF 2016]</a> <span class="p">operates between an SDN controller and an SDN-controlled switch or other device implementing the OpenFlow API that we studied earlier in</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 276%;text-align: left;"><a href="#bookmark433" class="a">Section 4.4.</a> <span class="p">The OpenFlow protocol operates over TCP, with a default port number of 6653. Among the important messages flowing from the controller to the controlled switch are the following:</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_552.png"/></span></p><p class="s28" style="padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">Configuration. <span class="p">This message allows the controller to query and set a switch’s configuration parameters.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_553.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">Modify-State. <span class="p">This message is used by a controller to add/delete or modify entries in the switch’s flow table, and to set switch port properties.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_554.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">Read-State. <span class="p">This message is used by a controller to collect statistics and counter values from the switch’s flow table and ports.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_555.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">Send-Packet. <span class="p">This message is used by the controller to send a specific packet out of a specified port at the controlled switch. The message itself contains the packet to be sent in its payload.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Among the messages flowing from the SDN-controlled switch to the controller are the following:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_556.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;"><b>Flow-Removed. </b>This message informs the controller that a flow table entry has been removed, for example by a timeout or as the result of a received <i>modify-state </i>message.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_557.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_558.png"/></span></p><p class="s28" style="padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">Port-status. <span class="p">This message is used by a switch to inform the controller of a change in port status. </span>Packet-in. <a href="#bookmark433" class="s124">Recall from </a><a href="#bookmark433" class="a">Section 4.4</a> <span class="p">that a packet arriving at a switch port and not matching any flow table entry is sent to the controller for additional processing. Matched packets may also be sent to</span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">the controller, as an action to be taken on a match. The <i>packet-in </i>message is used to send such packets to the controller.</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark487">Additional OpenFlow messages are defined in </a><a href="#bookmark848" class="a">[OpenFlow 200</a>9<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">ONF 2016</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="935" alt="image" src="计算机网络自顶向下7th-en/Image_559.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Principles in Practice</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Google’s Software-Defined Global Network</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark228" class="s124">Recall from the case study in </a><a href="#bookmark228" class="a">Section 2.6</a> <span class="p">that Google deploys a dedicated wide-area network (WAN) that interconnects its data centers and server clusters (in IXPs and ISPs). This network, called B4, has a Google-designed SDN control plane built on OpenFlow. Google’s network is</span></p><p class="s20" style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">able to drive WAN links at near 70% utilization over the long run (a two to three fold increase over typical link utilizations) and split application flows among multiple paths based on application priority and existing flow demands </a><a href="#bookmark848" class="a">[Jain 2013</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;">The Google B4 network is particularly it well-suited for SDN: <i>(i) </i>Google controls all devices from the edge servers in IXPs and ISPs to routers in their network core; <i>(ii) </i>the most bandwidth- intensive applications are large-scale data copies between sites that can defer to higher-priority</p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;line-height: 130%;text-align: left;">interactive applications during times of resource congestion; <i>(iii) </i>with only a few dozen data centers being connected, centralized control is feasible.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark447" class="s124">Google’s B4 network uses custom-built switches, each implementing a slightly extended version of OpenFlow, with a local Open Flow Agent (OFA) that is similar in spirit to the control agent we encountered in </a><a href="#bookmark447" class="a">Figure 5.</a>2<span class="p">. Each OFA in turn connects to an Open Flow Controller (OFC) in the</span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 11pt;text-align: left;">network control server (NCS), using a separate “out of band” network, distinct from the network</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark484" class="s124">that carries data-center traffic between data centers. The OFC thus provides the services used by the NCS to communicate with its controlled switches, similar in spirit to the lowest layer in the SDN architecture shown in </a><a href="#bookmark484" class="a">Figure 5.1</a>5<span class="p">. In B4, the OFC also performs state management</span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 11pt;text-align: left;">functions, keeping node and link status in a Network Information Base (NIB). Google’s</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">implementation of the OFC is based on the ONIX SDN controller </a><a href="#bookmark848" class="a">[Koponen 2010</a>]<span class="p">. Two routing protocols, BGP (for routing between the data centers) and IS-IS (a close relative of OSPF, for</span></p><p class="s20" style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">routing within a data center), are implemented. Paxos </a><a href="#bookmark848" class="a">[Chandra 2007]</a> <span class="p">is used to execute hot replicas of NCS components to protect against failure.</span></p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">A traffic engineering network-control application, sitting logically above the set of network control servers, interacts with these servers to provide global, network-wide bandwidth provisioning for groups of application flows. With B4, SDN made an important leap forward into the operational</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">networks of a global network provider. See </a><a href="#bookmark848" class="a">[Jain 2013]</a> <span class="p">for a detailed description of B4.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Data and Control Plane Interaction: An Example</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark488" class="s124">In order to solidify our understanding of the interaction between SDN-controlled switches and the SDN controller, let’s consider the example shown in </a><a href="#bookmark488" class="a">Figure 5.1</a>6<a href="#bookmark459" class="s124">, in which Dijkstra’s algorithm (which we studied in </a><a href="#bookmark459" class="a">Section 5.</a>2<a href="#bookmark488" class="s124">) is used to determine shortest path routes. The SDN scenario in </a><a href="#bookmark488" class="a">Figure 5.16</a> <span class="p">has</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark454" class="s124">two important differences from the earlier per-router-control scenario of </a><a href="#bookmark454" class="a">Sections 5.2.1</a> <a href="#bookmark463" class="s124">and </a><a href="#bookmark463" class="a">5.</a>3<span class="p">, where</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Dijkstra’s algorithm was implemented in each and every router and link-state updates were flooded among all network routers:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_560.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_561.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">Dijkstra’s algorithm is executed as a separate application, outside of the packet switches. Packet switches send link updates to the SDN controller and not to each other.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this example, let’s assume that the link between switch s1 and s2 goes down; that shortest path routing is implemented, and consequently and that incoming and outgoing flow forwarding rules at s1, s3, and s4 are affected, but that s2’s</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="444" height="577" alt="image" src="计算机网络自顶向下7th-en/Image_562.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark488">Figure 5.16 SDN controller scenario: Link-state change</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">operation is unchanged. Let’s also assume that OpenFlow is used as the communication layer protocol, and that the control plane performs no other function other than link-state routing.</p><ol id="l237"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 139%;text-align: left;"><p style="display: inline;"><a name="bookmark489">Switch s1, experiencing a link failure between itself and s2, notifies the SDN controller of the link-state change using the OpenFlow </a><i>port-status </i>message.</p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 16pt;text-align: left;"><p style="display: inline;">The SDN controller receives the OpenFlow message indicating the link-state change, and</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">notifies the link-state manager, which updates a link-state database.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The network-control application that implements Dijkstra’s link-state routing has previously registered to be notified when link state changes. That application receives the notification of the</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">link-state change.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The link-state routing application interacts with the link-state manager to get updated link state; it might also consult other components in the state-management layer. It then computes the new</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">least-cost paths.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The link-state routing application then interacts with the flow table manager, which determines the flow tables to be updated.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The flow table manager then uses the OpenFlow protocol to update flow table entries at affected switches—s1 (which will now route packets destined to s2 via s4), s2 (which will now begin</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">receiving packets from s1 via intermediate switch s4), and s4 (which must now forward packets from s1 destined to s2).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">This example is simple but illustrates how the SDN control plane provides control-plane services (in this case network-layer routing) that had been previously implemented with per-router control exercised in each and every network router. One can now easily appreciate how an SDN-enabled ISP could easily switch from least-cost path routing to a more hand-tailored approach to routing. Indeed, since the</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">controller can tailor the flow tables as it pleases, it can implement <i>any </i>form of forwarding that it pleases</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">—simply by changing its application-control software. This ease of change should be contrasted to the case of a traditional per-router control plane, where software in all routers (which might be provided to the ISP by multiple independent vendors) must be changed.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">SDN: Past and Future</p></li></ol></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">Although the intense interest in SDN is a relatively recent phenomenon, the technical roots of SDN, and the separation of the data and control planes in particular, go back considerably further. In 2004, </a><a href="#bookmark848" class="a">[Feamster </a>2004<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Lakshman 200</a>4<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">RFC 3746]</a> <span class="p">all argued for the separation of the network’s data and</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark848" class="s124">control planes. </a><a href="#bookmark848" class="a">[van der Merwe 1998]</a> <a href="#bookmark848" class="s124">describes a control framework for ATM networks </a><a href="#bookmark848" class="a">[Black 1995]</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">with multiple controllers, each controlling a number of ATM switches. The Ethane project </a><a href="#bookmark848" class="a">[Casado </a>2007] <span class="p">pioneered the notion of a network of simple flow-based Ethernet switches with match-plus-action flow tables, a centralized controller that managed flow admission and routing, and the forwarding of</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">unmatched packets from the switch to the controller. A network of more than 300 Ethane switches was operational in 2007. Ethane quickly evolved into the OpenFlow project, and the rest (as the saying goes) is history!</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Numerous research efforts are aimed at developing future SDN architectures and capabilities. As we have seen, the SDN revolution is leading to the disruptive replacement of dedicated monolithic switches and routers (with both data and control planes) by simple commodity switching hardware and a sophisticated software control plane. A generalization of SDN known as network functions virtualization (NFV) similarly aims at disruptive replacement of sophisticated middleboxes (such as middleboxes with dedicated hardware and proprietary software for media caching/service) with simple commodity servers,</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">switching, and storage </a><a href="#bookmark848" class="a">[Gember-Jacobson </a>2014]<a href="#bookmark848" class="s124">. A second area of important research seeks to extend SDN concepts from the intra-AS setting to the inter-AS setting </a><a href="#bookmark848" class="a">[Gupta 2014</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="859" alt="image" src="计算机网络自顶向下7th-en/Image_563.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">PRINCIPLES IN PRACTICE</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">SDN Controller Case Studies: The OpenDaylight and ONOS Controllers</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">In the earliest days of SDN, there was a single SDN protocol (OpenFlow </a><a href="#bookmark848" class="a">[McKeown 200</a>8<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">OpenFlow 2009</a>]<a href="#bookmark848" class="s124">) and a single SDN controller (NOX </a><a href="#bookmark848" class="a">[Gude 2008</a>]<a href="#bookmark848" class="s124">). Since then, the number of SDN controllers in particular has grown significantly </a><a href="#bookmark848" class="a">[Kreutz </a>2015]<a href="#bookmark848" class="s124">. Some SDN controllers are company-specific and proprietary, e.g., ONIX </a><a href="#bookmark848" class="a">[Koponen 2010</a>]<a href="#bookmark848" class="s124">, Juniper Networks Contrail </a><a href="#bookmark848" class="a">[Juniper Contrail 2016</a>]<a href="#bookmark848" class="s124">, and Google’s controller </a><a href="#bookmark848" class="a">[Jain 2013]</a> <span class="p">for its B4 wide-area network. But</span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 12pt;text-align: left;">many more controllers are open-source and implemented in a variety of programming languages</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="a">[Erickson </a>2013]<a href="#bookmark848" class="s124">. Most recently, the OpenDaylight controller </a><a href="#bookmark848" class="a">[OpenDaylight Lithium 2016]</a> <a href="#bookmark848" class="s124">and the ONOS controller </a><a href="#bookmark848" class="a">[ONOS 2016]</a> <span class="p">have found considerable industry support. They are both open-source and are being developed in partnership with the Linux Foundation.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">The OpenDaylight Controller</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark490" class="a">Figure 5.17</a> <a href="#bookmark848" class="s124">presents a simplified view of the OpenDaylight Lithium SDN controller platform </a><a href="#bookmark848" class="a">[OpenDaylight Lithium 2016</a>]<a href="#bookmark484" class="s124">. ODL’s main set of controller components correspond closely to those we developed in </a><a href="#bookmark484" class="a">Figure 5.1</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 28pt;text-indent: 0pt;line-height: 130%;text-align: left;">Network-Service Applications <span class="p">are the applications that determine how data-plane forwarding and other services, such as firewalling and load balancing, are accomplished in the controlled</span></p><p style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark484" class="s124">switches. Unlike the canonical controller in </a><a href="#bookmark484" class="a">Figure 5.1</a><span class="s20">5</span>, the ODL controller has <i>two </i>interfaces through which applications may communicate with native controller services and each other: external applications communicate with controller modules using a REST request-response API</p><p style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">running over HTTP. Internal applications communicate with each other via the Service Abstraction Layer (SAL). The choice as to whether a controller application is implemented externally or internally is up to the application designer;</p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_564.png"/></span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><span><img width="624" height="606" alt="image" src="计算机网络自顶向下7th-en/Image_565.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;"><a name="bookmark490">Figure 5.17 The OpenDaylight controller</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 32pt;text-align: left;"><a href="#bookmark490" class="s124">the particular configuration of applications shown in </a><a href="#bookmark490" class="a">Figure 5.17</a><span class="s20"> </span>is only meant as an example. ODL’s <i>Basic Network-Service Functions </i>are at the heart of the controller, and they correspond</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark484" class="s124">closely to the network-wide state management capabilities that we encountered in </a><a href="#bookmark484" class="a">Figure 5.1</a>5<span class="p">. The SAL is the controller’s nerve center, allowing controller components and applications to invoke each other’s services and to subscribe to events they generate. It also provides a uniform</span></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;line-height: 130%;text-align: left;">abstract interface to the specific <i>underlying communications protocols </i>in the communication layer, including OpenFlow and SNMP (the Simple Network Management Protocol—a network</p><p class="s20" style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark502" class="s124">management protocol that we will cover in </a><a href="#bookmark502" class="a">Section 5.</a>7<span class="p">). OVSDB is a protocol used to manage data center switching, an important application area for SDN technology. We’ll introduce data</span></p><p class="s20" style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;text-align: left;"><a href="#bookmark513" class="s124">center networking in </a><a href="#bookmark513" class="a">Chapter </a>6<span class="p">.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_566.png"/></span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><span><img width="660" height="547" alt="image" src="计算机网络自顶向下7th-en/Image_567.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;"><a name="bookmark491">Figure 5.18 ONOS controller architecture</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">The ONOS Controller</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark491" class="a">Figure 5.18</a> <a href="#bookmark848" class="s124">presents a simplified view of the ONOS controller </a><a href="#bookmark848" class="a">ONOS 2016</a>]<a href="#bookmark484" class="s124">. Similar to the canonical controller in </a><a href="#bookmark484" class="a">Figure 5.1</a>5<span class="p">, three layers can be identified in the ONOS controller:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_568.png"/></span></p><p class="s28" style="padding-left: 49pt;text-indent: 0pt;line-height: 138%;text-align: left;">Northbound abstractions and protocols. <span class="p">A unique feature of ONOS is its intent framework, which allows an application to request a high-level service (e.g., to setup a connection between host A and Host B, or conversely to not allow Host A and host B to</span></p><p style="padding-top: 1pt;padding-left: 49pt;text-indent: 0pt;line-height: 146%;text-align: left;">communicate) without having to know the details of how this service is performed. State information is provided to network-control applications across the northbound API either synchronously (via query) or asynchronously (via listener callbacks, e.g., when network state changes).</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_569.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 49pt;text-indent: 0pt;line-height: 138%;text-align: left;">Distributed core. <span class="p">The state of the network’s links, hosts, and devices is maintained in ONOS’s distributed core. ONOS is deployed as a service on a set of interconnected servers, with each server running an identical copy of the ONOS software; an increased number of</span></p><p style="padding-top: 1pt;padding-left: 49pt;text-indent: 0pt;line-height: 146%;text-align: justify;">servers offers an increased service capacity. The ONOS core provides the mechanisms for service replication and coordination among instances, providing the applications above and the network devices below with the abstraction of logically centralized core services.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="196" alt="image" src="计算机网络自顶向下7th-en/Image_570.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_571.png"/></span></p><p class="s28" style="padding-left: 49pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a name="bookmark492">Southbound abstractions and protocols. </a><span class="p">The southbound abstractions mask the heterogeneity of the underlying hosts, links, switches, and protocols, allowing the distributed core to be both device and protocol agnostic. Because of this abstraction, the southbound</span><a name="bookmark493">&zwnj;</a></p><p style="padding-top: 1pt;padding-left: 49pt;text-indent: 0pt;text-align: left;">interface below the distributed core is logically higher than in our canonical controller in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 49pt;text-indent: 0pt;text-align: left;"><a href="#bookmark483" class="a">Figure 5.14</a> <a href="#bookmark490" class="s124">or the ODL controller in </a><a href="#bookmark490" class="a">Figure 5.1</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l238"><ol id="l239"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark494">ICMP: The Internet Control Message Protocol</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">The Internet Control Message Protocol (ICMP), specified in </a><a href="#bookmark848" class="a">[RFC 792</a>]<span class="p">, is used by hosts and routers to communicate network-layer information to each other. The most typical use of ICMP is for error reporting. For example, when running an HTTP session, you may have encountered an error message</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">such as “Destination network unreachable.” This message had its origins in ICMP. At some point, an IP router was unable to find a path to the host specified in your HTTP request. That router created and sent an ICMP message to your host indicating the error.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">ICMP is often considered part of IP, but architecturally it lies just above IP, as ICMP messages are carried inside IP datagrams. That is, ICMP messages are carried as IP payload, just as TCP or UDP segments are carried as IP payload. Similarly, when a host receives an IP datagram with ICMP specified as the upper-layer protocol (an upper-layer protocol number of 1), it demultiplexes the datagram’s contents to ICMP, just as it would demultiplex a datagram’s content to TCP or UDP.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark495" class="s124">ICMP messages have a type and a code field, and contain the header and the first 8 bytes of the IP datagram that caused the ICMP message to be generated in the first place (so that the sender can determine the datagram that caused the error). Selected ICMP message types are shown in </a><a href="#bookmark495" class="a">Figure</a></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark495" class="a">5.1</a>9<span class="p">. Note that ICMP messages are used not only for signaling error conditions.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The well-known ping program sends an ICMP type 8 code 0 message to the specified host. The destination host, seeing the echo request, sends back a type 0 code 0 ICMP echo reply. Most TCP/IP implementations support the ping server directly in the operating system; that is, the server is not a</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">process. Chapter 11 of </a><a href="#bookmark848" class="a">[Stevens 1990]</a> <span class="p">provides the source code for the ping client program. Note that the client program needs to be able to instruct the operating system to generate an ICMP message of type 8 code 0.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Another interesting ICMP message is the source quench message. This message is seldom used in practice. Its original purpose was to perform congestion control—to allow a congested router to send an ICMP source quench message to a host to force</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="488" alt="image" src="计算机网络自顶向下7th-en/Image_572.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark495">Figure 5.19 ICMP message types</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark254" class="s124">that host to reduce its transmission rate. We have seen in </a><a href="#bookmark254" class="a">Chapter 3</a> <span class="p">that TCP has its own congestion- control mechanism that operates at the transport layer, without the use of network-layer feedback such as the ICMP source quench message.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark5" class="s124">In </a><a href="#bookmark5" class="a">Chapter 1</a> <span class="p">we introduced the Traceroute program, which allows us to trace a route from a host to any other host in the world. Interestingly, Traceroute is implemented with ICMP messages. To determine the names and addresses of the routers between source and destination, Traceroute in the source sends a</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">series of ordinary IP datagrams to the destination. Each of these datagrams carries a UDP segment with an unlikely UDP port number. The first of these datagrams has a TTL of 1, the second of 2, the third of 3, and so on. The source also starts timers for each of the datagrams. When the <i>n</i>th datagram arrives at</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">the <i>n</i>th router, the <i>n</i>th router observes that the TTL of the datagram has just expired. According to the</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">rules of the IP protocol, the router discards the datagram and sends an ICMP warning message to the source (type 11 code 0). This warning message includes the name of the router and its IP address. When this ICMP message arrives back at the source, the source obtains the round-trip time from the</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">timer and the name and IP address of the <i>n</i>th router from the ICMP message.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">How does a Traceroute source know when to stop sending UDP segments? Recall that the source increments the TTL field for each datagram it sends. Thus, one of the datagrams will eventually make it all the way to the destination host. Because this datagram contains a UDP segment with an unlikely port</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark496">number, the destination host sends a port unreachable ICMP message (type 3 code 3) back to the source. When the source host receives this particular ICMP message, it knows it does not need to send additional probe packets. (The standard Traceroute program actually sends sets of three packets with the same TTL; thus the Traceroute output provides three results for each TTL.)</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this manner, the source host learns the number and the identities of routers that lie between it and the destination host and the round-trip time between the two hosts. Note that the Traceroute client program must be able to instruct the operating system to generate UDP datagrams with specific TTL values and must also be able to be notified by its operating system when ICMP messages arrive. Now that you understand how Traceroute works, you may want to go back and play with it some more.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A new version of ICMP has been defined for IPv6 in RFC 4443. In addition to reorganizing the existing ICMP type and code definitions, ICMPv6 also added new types and codes required by the new IPv6 functionality. These include the “Packet Too Big” type and an “unrecognized IPv6 options” error code.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark497">Network Management and SNMP</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having now made our way to the end of our study of the network layer, with only the link-layer before us, we’re well aware that a network consists of many complex, interacting pieces of hardware and software</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">—from the links, switches, routers, hosts, and other devices that comprise the physical components of the network to the many protocols that control and coordinate these devices. When hundreds or thousands of such components are brought together by an organization to form a network, the job of the</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark492" class="s124">network administrator to keep the network “up and running” is surely a challenge. We saw in </a><a href="#bookmark492" class="a">Section</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark492" class="a">5.5</a> <span class="p">that the logically centralized controller can help with this process in an SDN context. But the challenge of network management has been around long before SDN, with a rich set of network management tools and approaches that help the network administrator monitor, manage, and control</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">the network. We’ll study these tools and techniques in this section.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">An often-asked question is “What is network management?” A well-conceived, single-sentence (albeit a rather long run-on sentence) definition of network management from </a><a href="#bookmark848" class="a">[Saydam 1996]</a> <span class="p">is:</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="113" alt="image" src="计算机网络自顶向下7th-en/Image_573.png"/></span></p><p class="s17" style="padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">Network management includes the deployment, integration, and coordination of the hardware, software, and human elements to monitor, test, poll, configure, analyze, evaluate, and control the network and element resources to meet the real-time, operational performance, and Quality of Service requirements at a reasonable cost.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">Given this broad definition, we’ll cover only the rudiments of network management in this section—the architecture, protocols, and information base used by a network administrator in performing their task. We’ll not cover the administrator’s decision-making processes, where topics such as fault identification</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="a">[Labovitz 199</a>7<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Steinder 200</a>2<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Feamster </a>2005<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Wu 200</a>5<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Teixeira 2006</a>]<a href="#bookmark848" class="s124">, anomaly detection </a><a href="#bookmark848" class="a">[Lakhina 200</a>5<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Barford </a>2009]<a href="#bookmark848" class="s124">, network design/engineering to meet contracted Service Level Agreements (SLA’s) </a><a href="#bookmark848" class="a">[Huston 1999a</a>]<span class="p">, and more come into consideration. Our focus is thus purposefully</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">narrow; the interested reader should consult these references, the excellent network-management text</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">by Subramanian </a><a href="#bookmark848" class="a">[Subramanian 2000</a>]<span class="p">, and the more detailed treatment of network management available on the Web site for this text.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l240"><ol id="l241"><ol id="l242"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The Network Management Framework</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark499" class="a">Figure 5.20</a> <span class="p">shows the key components of network management:</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_574.png"/></span></p><p style="padding-top: 3pt;padding-left: 19pt;text-indent: 0pt;line-height: 136%;text-align: left;">The <span class="s23">managing</span><span class="s20"> server </span>is an application, typically with a human in the loop, running in a centralized network management station in the network operations center (NOC). The managing server is the locus of activity for network management; it controls the collection, processing, analysis, and/or</p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">display of network management information. It is here that actions are initiated to control network behavior and here that the human network administrator interacts with the network’s devices.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_575.png"/></span></p><p style="padding-left: 19pt;text-indent: 0pt;line-height: 136%;text-align: left;">A <span class="s23">managed</span><span class="s20"> device </span>is a piece of network equipment (including its software) that resides on a managed network. A managed device might be a host, router, switch, middlebox, modem, thermometer, or other network-connected device. There may be several so-called <span class="s20">managed objects</span></p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">within a managed device. These managed objects are the actual pieces of hardware within the managed device (for example, a network interface card is but one component of a host or router), and configuration parameters for these hardware and software components (for example, an intra- AS routing protocol such as OSPF).</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_576.png"/></span></p><p style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;">Each managed object within a managed device associated information that is collected into a <span class="s20">Management Information Base (MIB)</span>; we’ll see that the values of these pieces of information are available to (and in many cases able to be set by) the managing server. A MIB object might be a</p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">counter, such as the number of IP datagrams discarded at a router due to errors in an IP datagram header, or the number of UDP segments received at a host; descriptive information such as the version of the software running on a DNS server; status information such as whether a particular device is functioning correctly; or protocol-specific information such as a routing path to a destination. MIB objects are specified in a data description language known as SMI (Structure of</p><p class="s20" style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">Management Information) </a><a href="#bookmark848" class="a">[RFC </a>2578<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 257</a>9<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 2580</a>]<span class="p">. A formal definition language is used to ensure that the syntax and semantics of the network management data are well defined and unambiguous. Related MIB objects are gathered into MIB modules. As of mid-2015, there were</span></p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">nearly 400 MIB modules defined by RFCs, and a much larger number of vendor-specific (private) MIB modules.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_577.png"/></span></p><p style="padding-left: 19pt;text-indent: 0pt;line-height: 126%;text-align: left;">Also resident in each managed device is a <span class="s23">network</span><span class="s20"> management agent</span>, a process running in the managed device that communicates with the managing server,</p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="596" height="543" alt="image" src="计算机网络自顶向下7th-en/Image_578.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark498">Figure 5.20 Elements of network management: Managing server, managed devices, MIB data, remote agents, SNMP</a><a name="bookmark499">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark447" class="s124">taking local actions at the managed device under the command and control of the managing server. The network management agent is similar to the routing agent that we saw in </a><a href="#bookmark447" class="a">Figure 5.</a>2<span class="p">.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_579.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 12pt;text-align: left;">The final component of a network management framework is the <span class="s23">network</span><span class="s20"> management protocol</span>.</p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">The protocol runs between the managing server and the managed devices, allowing the managing server to query the status of managed devices and indirectly take actions at these devices via its agents. Agents can use the network management protocol to inform the managing server of exceptional events (for example, component failures or violation of performance thresholds). It’s important to note that the network management protocol does not itself manage the network. Instead, it provides capabilities that a network administrator can use to manage (“monitor, test, poll, configure, analyze, evaluate, and control”) the network. This is a subtle, but important, distinction. In the following section, we’ll cover the Internet’s SNMP (Simple Network Management Protocol) protocol.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The Simple Network Management Protocol (SNMP)</p></li></ol></ol></ol><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 136%;text-align: left;"><span class="p">The </span><span class="s23">Simple</span> Network Management Protocol <a href="#bookmark848" class="s124">version 2 (SNMPv2) </a><a href="#bookmark848" class="a">[RFC 3416]</a> <span class="p">is an application-layer protocol used to convey network-management control and information messages between a managing server and an agent executing on behalf of that managing server. The most common usage of SNMP is</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">in a request-response mode in which an SNMP managing server sends a request to an SNMP agent, who receives the request, performs some action, and sends a reply to the request. Typically, a request will be used to query (retrieve) or modify (set) MIB object values associated with a managed device. A second common usage of SNMP is for an agent to send an unsolicited message, known as a trap message, to a managing server. Trap messages are used to notify a managing server of an exceptional situation (e.g., a link interface going up or down) that has resulted in changes to MIB object values.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark500" class="s124">SNMPv2 defines seven types of messages, known generically as protocol data units—PDUs—as shown in </a><a href="#bookmark500" class="a">Table 5.2</a> <a href="#bookmark501" class="s124">and described below. The format of the PDU is shown in </a><a href="#bookmark501" class="a">Figure 5.2</a>1<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_580.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;">The <span class="s30">GetRequest </span>, <span class="s30">GetNextRequest, </span>and <span class="s30">GetBulkRequest </span>PDUs are all sent from a managing server to an agent to request the value of one or more MIB objects at the agent’s managed device. The MIB objects whose values are being</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><h2 style="padding-left: 26pt;text-indent: 0pt;text-align: justify;">Table 5.2 SNMPv2 PDU types</h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:567pt;margin-left:25.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">SNMPv2 PDU</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Type</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Sender-receiver</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Description</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">GetRequest</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 2pt;text-indent: 0pt;line-height: 146%;text-align: left;">manager-to- agent</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">get value of one or more MIB object instances</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">GetNextRequest</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 2pt;text-indent: 0pt;line-height: 146%;text-align: left;">manager-to- agent</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">get value of next MIB object instance in list or table</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">GetBulkRequest</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 2pt;text-indent: 0pt;line-height: 146%;text-align: left;">manager-to- agent</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 18pt;text-indent: 0pt;line-height: 146%;text-align: left;">get values in large block of data, for example, values in a large table</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">InformRequest</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 2pt;text-indent: 0pt;line-height: 146%;text-align: left;">manager-to- manager</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">inform remote managing entity of MIB values remote to its access</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">SetRequest</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 2pt;text-indent: 0pt;line-height: 146%;text-align: left;">manager-to- agent</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">set value of one or more MIB object instances</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">Response</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 36pt;text-indent: 0pt;line-height: 146%;text-align: left;">agent-to- manager or</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">generated in response to</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 2pt;text-indent: 0pt;line-height: 146%;text-align: left;">manager-to- manager</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s136" style="padding-left: 8pt;text-indent: 0pt;text-align: left;"> <span class="s122"> </span><span class="s130">GetRequest,</span></p></td></tr></table><p style="text-indent: 0pt;line-height: 4pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:567pt;margin-left:18.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s136" style="padding-left: 8pt;text-indent: 0pt;text-align: left;"><a name="bookmark500"> </a><span class="s122"> </span><span class="s130">GetNextRequest,</span></p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s136" style="padding-left: 8pt;text-indent: 0pt;text-align: left;"> <span class="s122"> </span><span class="s130">GetBulkRequest,</span></p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s136" style="padding-left: 8pt;text-indent: 0pt;text-align: left;"> <span class="s122"> </span><span class="s130">SetRequest PDU, </span>or</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s136" style="padding-left: 8pt;text-indent: 0pt;text-align: left;"> <span class="s122"> </span><span class="s130">InformRequest</span></p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s130" style="padding-left: 11pt;text-indent: 0pt;text-align: left;">SNMPv2-Trap</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 50pt;text-indent: 0pt;line-height: 146%;text-align: left;">agent-to- manager</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">inform manager of an exceptional event #</p></td></tr></table><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 19pt;text-indent: 0pt;text-align: left;"><span><img width="699" height="328" alt="image" src="计算机网络自顶向下7th-en/Image_581.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 19pt;text-indent: 0pt;text-align: left;"><a name="bookmark501">Figure 5.21 SNMP PDU format</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 18pt;text-indent: 0pt;line-height: 145%;text-align: left;">requested are specified in the variable binding portion of the PDU. <span class="s30">­GetRequest </span>, <span class="s30">GetNextRequest </span>, and GetBulkRequest differ in the granularity of their data requests. <span class="s30">GetRequest </span>can request an arbitrary set of MIB values; multiple <span class="s30">GetNextRequest </span>s can be used to sequence through a list or table of MIB objects; <span class="s30">GetBulkRequest </span>allows a large block of data to be returned, avoiding the overhead incurred if multiple  <span class="s30">GetRequest </span>or  <span class="s30">GetNextRequest </span>messages were to be sent. In all three cases, the agent responds with a <span class="s30">Response PDU </span>containing</p><p style="padding-left: 18pt;text-indent: 0pt;line-height: 12pt;text-align: left;">the object identifiers and their associated values.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_582.png"/></span></p><p style="padding-left: 18pt;text-indent: 0pt;line-height: 138%;text-align: left;">The <span class="s30">SetRequest </span>PDU is used by a managing server to set the value of one or more MIB objects in a managed device. An agent replies with a <span class="s30">Response </span>PDU with the “noError” error status to confirm that the value has indeed been set.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_583.png"/></span></p><p style="padding-top: 3pt;padding-left: 19pt;text-indent: 0pt;text-align: left;">The <span class="s30">InformRequest </span>PDU is used by a managing server to notify another managing server of MIB</p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: left;"><a name="bookmark502">information that is remote to the receiving server.</a><a name="bookmark503">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_584.png"/></span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">The <span class="s30">Response PDU </span>is typically sent from a managed device to the managing server in response to a request message from that server, returning the requested information.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_585.png"/></span></p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">The final type of SNMPv2 PDU is the trap message. Trap messages are generated asynchronously; that is, they are not generated in response to a received request but rather in response to an event for which the managing server requires notification. RFC 3418 defines well-known trap types that</p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">include a cold or warm start by a device, a link going up or down, the loss of a neighbor, or an authentication failure event. A received trap request has no required response from a managing server.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Given the request-response nature of SNMP, it is worth noting here that although SNMP PDUs can be carried via many different transport protocols, the SNMP PDU is typically carried in the payload of a UDP datagram. Indeed, RFC 3417 states that UDP is “the preferred transport mapping.” However, since UDP is an unreliable transport protocol, there is no guarantee that a request, or its response, will</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark501" class="s124">be received at the intended destination. The request ID field of the PDU (see </a><a href="#bookmark501" class="a">Figure 5.2</a>1<span class="p">) is used by the managing server to number its requests to an agent; the agent’s response takes its request ID from that of the received request. Thus, the request ID field can be used by the managing server to detect</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">lost requests or replies. It is up to the managing server to decide whether to retransmit a request if no corresponding response is received after a given amount of time. In particular, the SNMP standard does not mandate any particular procedure for retransmission, or even if retransmission is to be done in the first place. It only requires that the managing server “needs to act responsibly in respect to the frequency and duration of retransmissions.” This, of course, leads one to wonder how a “responsible” protocol should act!</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">SNMP has evolved through three versions. The designers of SNMPv3 have said that “SNMPv3 can be thought of as SNMPv2 with additional security and administration capabilities” </a><a href="#bookmark848" class="a">[RFC </a>3410]<span class="p">. Certainly,</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">there are changes in SNMPv3 over SNMPv2, but nowhere are those changes more evident than in the area of administration and security. The central role of security in SNMPv3 was particularly important, since the lack of adequate security resulted in SNMP being used primarily for monitoring rather than</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 137%;text-align: left;">control (for example, <span class="s30">SetRequest </span><a href="#bookmark671" class="s124">is rarely used in SNMPv1). Once again, we see that security—a topic we’ll cover in detail in </a><a href="#bookmark671" class="a">Chapter 8</a><span class="s20"> </span>— is of critical concern, but once again a concern whose importance had been realized perhaps a bit late and only then “added on.”</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l243"><ol id="l244"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark504">Summary</a><a name="bookmark505">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark368" class="s124">We have now completed our two-chapter journey into the network core—a journey that began with our study of the network layer’s data plane in </a><a href="#bookmark368" class="a">Chapter 4</a> <span class="p">and finished here with our study of the network</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">layer’s control plane. We learned that the control plane is the network-wide logic that controls not only how a datagram is forwarded among routers along an end-to-end path from the source host to the destination host, but also how network-layer components and services are configured and managed.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We learned that there are two broad approaches towards building a control plane: traditional <i>per-router control </i>(where a routing algorithm runs in each and every router and the routing component in the router communicates with the routing components in other routers) and <i>software-defined networking </i>(SDN)</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">control (where a logically centralized controller computes and distributes the forwarding tables to be</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">used by each and every router). We studied two fundamental routing algorithms for computing least cost</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark459" class="s124">paths in a graph—link-state routing and distance-vector routing—in </a><a href="#bookmark459" class="a">Section 5.</a>2<span class="p">; these algorithms find application in both per-router control and in SDN control. These algorithms are the basis for two widely-</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark463" class="s124">deployed Internet routing protocols, OSPF and BGP, that we covered in </a><a href="#bookmark463" class="a">Sections 5.3</a> <a href="#bookmark480" class="s124">and </a><a href="#bookmark480" class="a">5.</a>4<a href="#bookmark492" class="s124">. We covered the SDN approach to the network-layer control plane in </a><a href="#bookmark492" class="a">Section 5.</a>5<span class="p">, investigating SDN network-control applications, the SDN controller, and the OpenFlow protocol for communicating</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark496" class="s124">between the controller and SDN-controlled devices. In </a><a href="#bookmark496" class="a">Sections 5.6</a> <a href="#bookmark502" class="s124">and </a><a href="#bookmark502" class="a">5.</a>7<span class="p">, we covered some of the nuts and bolts of managing an IP network: ICMP (the Internet Control Message Protocol) and SNMP (the Simple Network Management Protocol).</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having completed our study of the network layer, our journey now takes us one step further down the protocol stack, namely, to the link layer. Like the network layer, the link layer is part of each and every network-connected device. But we will see in the next chapter that the link layer has the much more localized task of moving packets between nodes on the same link or LAN. Although this task may appear on the surface to be rather simple compared with that of the network layer’s tasks, we will see that the link layer involves a number of important and fascinating issues that can keep us busy for a long time.</p><p class="s18" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark506">Homework Problems and Questions</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Chapter 5 Review Questions</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 5.1</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R1. What is meant by a control plane that is based on per-router control? In such cases, when we say the network control and data planes are implemented “monolithically,” what do we mean?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R2. What is meant by a control plane that is based on logically centralized control? In such cases, are the data plane and the control plane implemented within the same device or in separate devices? Explain.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 5.2</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R3. Compare and contrast the properties of a centralized and a distributed routing algorithm. Give an example of a routing protocol that takes a centralized and a decentralized approach.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">R4. Compare and contrast link-state and distance-vector routing algorithms. R5. What is the “count to infinity” problem in distance vector routing?</p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R6. Is it necessary that every autonomous system use the same intra-AS routing algorithm? Why or why not?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTIONS 5.3–5.4</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R7. Why are different inter-AS and intra-AS protocols used in the Internet?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R8. True or false: When an OSPF route sends its link state information, it is sent only to those nodes directly attached neighbors. Explain.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R9. What is meant by an <i>area </i>in an OSPF autonomous system? Why was the concept of an area introduced?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R10. Define and contrast the following terms: <i>subnet, prefix</i>, and <i>BGP route</i>.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R11. How does BGP use the NEXT-HOP attribute? How does it use the AS-PATH attribute? R12. Describe how a network administrator of an upper-tier ISP can implement policy when configuring BGP.</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R13. True or false: When a BGP router receives an advertised path from its neighbor, it must add its own identity to the received path and then send that new path on to all of its neighbors.</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">Explain.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 5.5</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R14. Describe the main role of the communication layer, the network-wide state-management layer, and the network-control application layer in an SDN controller.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R15. Suppose you wanted to implement a new routing protocol in the SDN control plane. At which layer would you implement that protocol? Explain.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R16. What types of messages flow across an SDN controller’s northbound and southbound APIs? Who is the recipient of these messages sent from the controller across the southbound interface, and who sends messages to the controller across the northbound interface?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R17. Describe the purpose of two types of OpenFlow messages (of your choosing) that are sent from a controlled device to the controller. Describe the purpose of two types of Openflow messages (of your choosing) that are send from the controller to a controlled device.</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R18. What is the purpose of the service abstraction layer in the OpenDaylight SDN controller?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTIONS 5.6–5.7</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R19. Names four different types of ICMP messages</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">R20. What two types of ICMP messages are received at the sending host executing the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 47pt;text-indent: 0pt;text-align: left;">Traceroute <span class="p">program?</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R21. Define the following terms in the context of SNMP: managing server, managed device, network management agent and MIB.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">R22. What are the purposes of the SNMP <i>GetRequest </i>and <i>SetRequest </i>messages? R23. What is the purpose of the SNMP trap message?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Problems</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark450" class="s124">P1. Looking at </a><a href="#bookmark450" class="a">Figure 5.3</a><span class="s20"> </span>, enumerate the paths from <i>y </i>to <i>u </i>that do not contain any loops. P2. Repeat Problem P1 for paths from <i>x </i>to <i>z, z </i>to <i>u</i>, and <i>z </i>to <i>w</i>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="730" height="165" alt="image" src="计算机网络自顶向下7th-en/Image_586.png"/></span></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">P3. Consider the following network. With the indicated link costs, use Dijkstra’s shortest-path algorithm to compute the shortest path from <i>x </i><a href="#bookmark451" class="s124">to all network nodes. Show how the algorithm works by computing a table similar to </a><a href="#bookmark451" class="a">Table 5.1</a><span class="s20"> </span>.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 70pt;text-indent: 0pt;text-align: left;">Dijkstra’s algorithm: discussion and example</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="738" height="37" alt="image" src="计算机网络自顶向下7th-en/Image_587.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="360" height="331" alt="image" src="计算机网络自顶向下7th-en/Image_588.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark451" class="s124">P4. Consider the network shown in Problem P3. Using Dijkstra’s algorithm, and showing your work using a table similar to </a><a href="#bookmark451" class="a">Table 5.1</a> <span class="p">, do the following:</span></p><ol id="l245"><li style="padding-left: 49pt;text-indent: -18pt;line-height: 15pt;text-align: left;"><p style="display: inline;">Compute the shortest path from <i>t </i>to all network nodes.</p></li><li style="padding-top: 4pt;padding-left: 49pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Compute the shortest path from <i>u </i>to all network nodes.</p></li><li style="padding-top: 4pt;padding-left: 49pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Compute the shortest path from <i>v </i>to all network nodes.</p></li><li style="padding-top: 4pt;padding-left: 49pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Compute the shortest path from <i>w </i>to all network nodes.</p></li><li style="padding-top: 4pt;padding-left: 49pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Compute the shortest path from <i>y </i>to all network nodes.</p></li><li style="padding-top: 4pt;padding-left: 49pt;text-indent: -15pt;text-align: left;"><p style="display: inline;">Compute the shortest path from <i>z </i>to all network nodes.</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">P5. Consider the network shown below, and assume that each node initially knows the costs to each of its neighbors. Consider the distance-vector algorithm and show the distance table</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">entries at node <i>z</i>.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="317" height="196" alt="image" src="计算机网络自顶向下7th-en/Image_589.png"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">P6. Consider a general topology (that is, not the specific network shown above) and a</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">synchronous version of the distance-vector algorithm. Suppose that at each iteration, a node exchanges its distance vectors with its neighbors and receives their distance vectors. Assuming that the algorithm begins with each node knowing only the costs to its immediate neighbors, what is the maximum number of iterations required before the distributed algorithm converges? Justify your answer.</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">P7. Consider the network fragment shown below. <i>x </i>has only two attached neighbors, <i>w </i>and <i>y</i>. <i>w </i>has a minimum-cost path to destination <i>u </i>(not shown) of 5, and <i>y </i>has a minimum-cost path to <i>u </i>of 6. The complete paths from <i>w </i>and <i>y </i>to <i>u </i>(and between <i>w </i>and <i>y</i>) are not shown. All link costs</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">in the network have strictly positive integer values.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="235" height="147" alt="image" src="计算机网络自顶向下7th-en/Image_590.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l246"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Give <i>x</i>’s distance vector for destinations <i>w, y, </i>and <i>u</i>.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 139%;text-align: left;"><p style="display: inline;">Give a link-cost change for either <i>c</i>(<i>x, w</i>) or <i>c</i>(<i>x, y</i>) such that <i>x </i>will inform its neighbors of a new minimum-cost path to <i>u </i>as a result of executing the distance-vector algorithm.</p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 16pt;text-align: left;"><p style="display: inline;">Give a link-cost change for either <i>c</i>(<i>x, w</i>) or <i>c</i>(<i>x, y</i>) such that <i>x </i>will <i>not </i>inform its neighbors</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 29pt;text-indent: 0pt;text-align: center;">of a new minimum-cost path to <i>u </i>as a result of executing the distance-vector algorithm.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 129%;text-align: left;"><a href="#bookmark456" class="s124">P8. Consider the three-node topology shown in </a><a href="#bookmark456" class="a">Figure 5.6</a> <a href="#bookmark456" class="s124">. Rather than having the link costs shown in </a><a href="#bookmark456" class="a">Figure 5.6</a> <span class="p">, the link costs are </span><span class="s27">c</span><span class="p">(x,y)=3, c(y,z)=6, c(z,x)=4. Compute the distance tables after the initialization step and after each iteration of a synchronous version of the distance-</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark456" class="s124">vector algorithm (as we did in our earlier discussion of </a><a href="#bookmark456" class="a">Figure 5.6</a> <span class="p">).</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P9. Consider the count-to-infinity problem in the distance vector routing. Will the count-to-infinity problem occur if we decrease the cost of a link? Why? How about if we connect two nodes which do not have a link?</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark456" class="s124">P10. Argue that for the distance-vector algorithm in </a><a href="#bookmark456" class="a">Figure 5.6</a><span class="s20"> </span>, each value in the distance vector <i>D(x) </i>is non-increasing and will eventually stabilize in a finite number of steps.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P11. Consider Figure 5.7. Suppose there is another router w, connected to router y and z. The costs of all links are given as follows: c(x,y)=4, c(x,z)=50, c(y,w)=1, c(z,w)=1, c(y,z)=3. Suppose that poisoned reverse is used in the distance-vector routing algorithm.</p><ol id="l247"><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">When the distance vector routing is stabilized, router w, y, and z inform their distances to x to each other. What distance values do they tell each other?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Now suppose that the link cost between x and y increases to 60. Will there be a count-to- infinity problem even if poisoned reverse is used? Why or why not? If there is a count-to-</p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: center;">infinity problem, then how many iterations are needed for the distance-vector routing to</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">reach a stable state again? Justify your answer.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">How do you modify <i>c(y, z) </i>such that there is no count-to-infinity problem at all if <i>c(y,x)</i></p></li></ol><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">changes from 4 to 60?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P12. Describe how loops in paths can be detected in BGP.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P13. Will a BGP router always choose the loop-free route with the shortest ASpath length? Justify your answer.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P14. Consider the network shown below. Suppose AS3 and AS2 are running OSPF for their intra-AS routing protocol. Suppose AS1 and AS4 are running RIP for their intra-AS routing protocol. Suppose eBGP and iBGP are used for the inter-AS routing protocol. Initially suppose</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">there is <i>no </i>physical link between AS2 and AS4.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l248"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Router 3c learns about prefix <i>x </i>from which routing protocol: OSPF, RIP, eBGP, or iBGP?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Router 3a learns about <i>x </i>from which routing protocol?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Router 1c learns about <i>x </i>from which routing protocol?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Router 1d learns about <i>x </i>from which routing protocol?</p></li></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="670" height="340" alt="image" src="计算机网络自顶向下7th-en/Image_591.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P15. Referring to the previous problem, once router 1d learns about <i>x </i>it will put an entry (<i>x</i>, <i>I</i>) in its forwarding table.</p><ol id="l249"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Will <i>I </i>be equal to <i>I</i><span class="s22">1 </span>or <i>I</i><span class="s22">2 </span>for this entry? Explain why in one sentence.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 142%;text-align: left;"><p style="display: inline;">Now suppose that there is a physical link between AS2 and AS4, shown by the dotted line. Suppose router 1d learns that <i>x </i>is accessible via AS2 as well as via AS3. Will <i>I </i>be set to <i>I</i><span class="s22">1 </span>or <i>I</i><span class="s22">2</span>? Explain why in one sentence.</p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 142%;text-align: justify;"><p style="display: inline;">Now suppose there is another AS, called AS5, which lies on the path between AS2 and AS4 (not shown in diagram). Suppose router 1d learns that <i>x </i>is accessible via AS2 AS5 AS4 as well as via AS3 AS4. Will <i>I </i>be set to <i>I</i><span class="s22">1 </span>or <i>I</i><span class="s22">2</span>? Explain why in one sentence.</p></li></ol><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">P16. Consider the following network. ISP B provides national backbone service to regional ISP</p><p style="text-indent: 0pt;text-align: left;"><span><img width="549" height="361" alt="image" src="计算机网络自顶向下7th-en/Image_592.png"/></span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A. ISP C provides national backbone service to regional ISP D. Each ISP consists of one AS. B and C peer with each other in two places using BGP. Consider traffic going from A to D. B would prefer to hand that traffic over to C on the West Coast (so that C would have to absorb the cost of carrying the traffic cross-country), while C would prefer to get the traffic via its East Coast peering point with B (so that B would have carried the traffic across the country). What BGP mechanism might C use, so that B would hand over A-to-D traffic at its East Coast peering point? To answer this question, you will need to dig into the BGP specification.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P17. In Figure 5.13 , consider the path information that reaches stub networks W, X, and Y. Based on the information available at W and X, what are their respective views of the network topology? Justify your answer. The topology view at Y is shown below.</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="357" height="150" alt="image" src="计算机网络自顶向下7th-en/Image_593.png"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P18. Consider Figure 5.13 . B would never forward traffic destined to Y via X based on BGP routing. But there are some very popular applications for which data packets go to X first and then flow to Y. Identify one such application, and describe how data packets follow a path not</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">given by BGP routing.</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">P19. In Figure 5.13 , suppose that there is another stub network V that is a customer of ISP A. Suppose that B and C have a peering relationship, and A is a customer of both B and C. Suppose that A would like to have the traffic destined to W to come from B only, and the traffic</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">destined to V from either B or C. How should A advertise its routes to B and C? What AS routes does C receive?</p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">P20. Suppose ASs X and Z are not directly connected but instead are connected by AS Y. Further suppose that X has a peering agreement with Y, and that Y has a peering agreement with Z. Finally, suppose that Z wants to transit all of Y’s traffic but does not want to transit X’s</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">traffic. Does BGP allow Z to implement this policy?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">P21. Consider the two ways in which communication occurs between a managing entity and a managed device: request-response mode and trapping. What are the pros and cons of these two approaches, in terms of (1) overhead, (2) notification time when exceptional events occur, and</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">(3) robustness with respect to lost messages between the managing entity and the device?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark502" class="s124">P22. In </a><a href="#bookmark502" class="a">Section 5.7</a> <span class="p">we saw that it was preferable to transport SNMP messages in unreliable UDP datagrams. Why do you think the designers of SNMP chose UDP rather than TCP as the transport protocol of choice for SNMP?</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark507">Socket Programming Assignment</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark138" class="s124">At the end of </a><a href="#bookmark138" class="a">Chapter </a>2<span class="p">, there are four socket programming assignments. Below, you will find a fifth assignment which employs ICMP, a protocol discussed in this chapter.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Assignment 5: ICMP Ping</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Ping is a popular networking application used to test from a remote location whether a particular host is up and reachable. It is also often used to measure latency between the client host and the target host. It works by sending ICMP “echo request” packets (i.e., ping packets) to the target host and listening for ICMP “echo response” replies (i.e., pong packets). Ping measures the RRT, records packet loss, and calculates a statistical summary of multiple ping-pong exchanges (the minimum, mean, max, and standard deviation of the round-trip times).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this lab, you will write your own Ping application in Python. Your application will use ICMP. But in order to keep your program simple, you will not exactly follow the official specification in RFC 1739. Note that you will only need to write the client side of the program, as the functionality needed on the server side is built into almost all operating systems. You can find full details of this assignment, as well as</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources" class="s124" target="_blank">important snippets of the Python code, at the Web site </a><a href="http://www.pearsonhighered.com/cs-resources" class="a" target="_blank">http://www.pearsonhighered.com/cs- </a>resources<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Programming Assignment</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this programming assignment, you will be writing a “distributed” set of procedures that implements a distributed asynchronous distance-vector routing for the network shown below.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">You are to write the following routines that will “execute” asynchronously within the emulated environment provided for this assignment. For node 0, you will write the routines:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="172" height="160" alt="image" src="计算机网络自顶向下7th-en/Image_594.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_595.png"/></span></p><p class="s17" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;">rtinit0()<span class="p">. This routine will be called once at the beginning of the emulation. </span>rtinit0() <span class="p">has no arguments. It should initialize your distance table in node 0 to reflect the direct costs of 1, 3, and 7 to nodes 1, 2, and 3, respectively. In the figure above, all links are bidirectional and the costs in both directions are</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">identical. After initializing the distance table and any other data structures needed by your node 0 routines, it should then send its directly connected neighbors (in this case, 1, 2, and 3) the cost of its minimum-cost paths to all other network nodes. This minimum-cost information is sent to</p><p style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">neighboring nodes in a routing update packet by calling the routine <i>tolayer2(), </i>as described in the full assignment. The format of the routing update packet is also described in the full assignment.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_596.png"/></span></p><p class="s17" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">rtupdate0(struct rtpkt *rcvdpkt)<span class="p">. This routine will be called when node 0 receives a routing packet that was sent to it by one of its directly connected neighbors. The parameter </span>*rcvdpkt <span class="p">is a pointer to the packet that was received. </span>rtupdate0() <span class="p">is the “heart” of the distance-vector algorithm. The values it receives in a routing update packet from some other node </span>i <span class="p">contain </span>i’<span class="p">s current shortest-path costs to all other network nodes. </span>rtupdate0() <span class="p">uses these received values to update its own distance table (as</span></p><p style="padding-left: 25pt;text-indent: 0pt;line-height: 12pt;text-align: left;">specified by the distance-vector algorithm). If its own minimum cost to another node changes as a</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">result of the update, node 0 informs its directly connected neighbors of this change in minimum cost by sending them a routing packet. Recall that in the distance-vector algorithm, only directly connected nodes will exchange routing packets. Thus, nodes 1 and 2 will communicate with each other, but nodes 1 and 3 will not communicate with each other.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Similar routines are defined for nodes 1, 2, and 3. Thus, you will write eight procedures in all: <i>rtinit0(), rtinit1(), rtinit2(), rtinit3(), rtupdate0(), rtupdate1(), rtupdate2(), </i>and <i>rtupdate3(). </i>These routines will together implement a distributed, asynchronous computation of the distance tables for the topology and</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">costs shown in the figure on the preceding page.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resource" class="s124" target="_blank">You can find the full details of the programming assignment, as well as C code that you will need to create the simulated hardware/software environment, at </a><a href="http://www.pearsonhighered.com/cs-resource" class="s123" target="_blank">http://www.pearsonhighered.com/cs-resource</a><a href="http://www.pearsonhighered.com/cs-resource" class="s124" target="_blank">.</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">A Java version of the assignment is also available.</p><p class="s24" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark508">Wireshark Lab</a><a name="bookmark509">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources" class="s124" target="_blank">In the Web site for this textbook, </a><a href="http://www.pearsonhighered.com/cs-resources" class="a" target="_blank">www.pearsonhighered.com/</a>cs-resources<span class="p">, you’ll find a Wireshark lab assignment that examines the use of the ICMP protocol in the ping and traceroute commands.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="957" alt="image" src="计算机网络自顶向下7th-en/Image_597.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 130%;text-align: left;">An Interview With… Jennifer Rexford</p><p style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Jennifer Rexford is a Professor in the Computer Science department at Princeton University. Her research has the broad goal of making computer networks easier to design and manage, with particular emphasis on routing protocols. From 1996–2004, she was a member of the Network Management and Performance department at AT&amp;T Labs–Research. While at AT&amp;T, she designed techniques and tools for network measurement, traffic engineering, and router configuration that were deployed in AT&amp;T’s backbone network. Jennifer is co-author of the book “Web Protocols and Practice: Networking Protocols, Caching, and Traffic Measurement,” published by Addison-Wesley in May 2001. She served as the chair of ACM SIGCOMM from 2003 to 2007. She received her BSE degree in electrical engineering from Princeton University in 1991, and her PhD degree in electrical engineering and computer science from the University of Michigan in 1996. In 2004, Jennifer was the winner of ACM’s Grace Murray Hopper Award for outstanding young computer professional and appeared on the MIT TR-100 list of top innovators under the age of 35.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><span><img width="168" height="216" alt="image" src="计算机网络自顶向下7th-en/Image_598.gif"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;line-height: 43pt;text-align: left;">Please describe one or two of the most exciting projects you have worked on during your career. What were the biggest challenges?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">When I was a researcher at AT&amp;T, a group of us designed a new way to manage routing in Internet Service Provider backbone networks. Traditionally, network operators configure each router individually, and these routers run distributed protocols to compute paths through the network. We believed that network management would be simpler and more flexible if network</p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_599.png"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">operators could exercise direct control over how routers forward traffic based on a network-wide view of the topology and traffic. The Routing Control Platform (RCP) we designed and built could compute the routes for all of AT&amp;T’s backbone on a single commodity computer, and could control legacy routers without modification. To me, this project was exciting because we had a provocative idea, a working system, and ultimately a real deployment in an operational network. Fast forward a few years, and software-defined networking (SDN) has become a mainstream technology, and standard protocols (like OpenFlow) have made it much easier to tell the underlying switches what to do.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">How do you think software-defined networking should evolve in the future?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;">In a major break from the past, control-plane software can be created by many different programmers, not just at companies selling network equipment. Yet, unlike the applications running on a server or a smart phone, controller apps must work <i>together </i>to handle the same</p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 11pt;text-align: left;">traffic. Network operators do not want to perform load balancing on some traffic and routing on</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;">other traffic; instead, they want to perform load balancing and routing, together, on the same traffic. Future SDN controller platforms should offer good programming abstractions for <i>composing </i>independently written multiple controller applications together. More broadly, good</p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 11pt;text-align: left;">programming abstractions can make it easier to create controller applications, without having to</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">worry about low-level details like flow table entries, traffic counters, bit patterns in packet headers, and so on. Also, while an SDN controller is logically centralized, the network still consists of a distributed collection of devices. Future controllers should offer good abstractions for updating the flow tables across the network, so apps can reason about what happens to packets in flight while the devices are updated. Programming abstractions for control-plane software is an exciting area for interdisciplinary research between computer networking, distributed systems, and programming languages, with a real chance for practical impact in the years ahead.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Where do you see the future of networking and the Internet?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Networking is an exciting field because the applications and the underlying technologies change all the time. We are always reinventing ourselves! Who would have predicted even ten years ago the dominance of smart phones, allowing mobile users to access existing applications as well as new location-based services? The emergence of cloud computing is fundamentally changing the relationship between users and the applications they run, and networked sensors and actuators (the “Internet of Things”) are enabling a wealth of new applications (and security vulnerabilities!). The pace of innovation is truly inspiring.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">The underlying network is a crucial component in all of these innovations. Yet, the network is notoriously “in the way”—limiting performance, compromising reliability, constraining applications, and complicating the deployment and management of services. We should strive to make the network of the future as invisible as the air we breathe, so it never stands in the way of</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="833" alt="image" src="计算机网络自顶向下7th-en/Image_600.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: justify;"><a name="bookmark510">new ideas and valuable services. To do this, we need to raise the level of abstraction above individual network devices and protocols (and their attendant acronyms!), so we can reason about the network and the user’s high-level goals as a whole.</a><a name="bookmark511">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What people inspired you professionally?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">I’ve long been inspired by Sally Floyd at the International Computer Science Institute. Her research is always purposeful, focusing on the important challenges facing the Internet. She digs deeply into hard questions until she understands the problem and the space of solutions completely, and she devotes serious energy into “making things happen,” such as pushing her ideas into protocol standards and network equipment. Also, she gives back to the community, through professional service in numerous standards and research organizations and by creating tools (such as the widely used ns-2 and ns-3 simulators) that enable other researchers to succeed. She retired in 2009 but her influence on the field will be felt for years to come.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What are your recommendations for students who want careers in computer science and</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">networking?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Networking is an inherently interdisciplinary field. Applying techniques from other disciplines breakthroughs in networking come from such diverse areas as queuing theory, game theory, control theory, distributed systems, network optimization, programming languages, machine learning, algorithms, data structures, and so on. I think that becoming conversant in a related field, or collaborating closely with experts in those fields, is a wonderful way to put networking on a stronger foundation, so we can learn how to build networks that are worthy of society’s trust. Beyond the theoretical disciplines, networking is exciting because we create real artifacts that real people use. Mastering how to design and build systems—by gaining experience in operating systems, computer architecture, and so on—is another fantastic way to amplify your knowledge of networking to help make the world a better place.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="783" height="2" alt="image" src="计算机网络自顶向下7th-en/Image_601.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s16" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark512">Chapter </a><span class="h1">6 </span>The Link Layer and LANs</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="1" alt="image" src="计算机网络自顶向下7th-en/Image_602.png"/></span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">In the previous two chapters we learned that the network layer provides a communication service between <i>any </i>two network hosts. Between the two hosts, datagrams travel over a series of</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">communication links, some wired and some wireless, starting at the source host, passing through a series of packet switches (switches and routers) and ending at the destination host. As we continue down the protocol stack, from the network layer to the link layer, we naturally wonder how packets are</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">sent across the <i>individual links </i>that make up the end-to-end communication path. How are the network- layer datagrams encapsulated in the link-layer frames for transmission over a single link? Are different link-layer protocols used in the different links along the communication path? How are transmission</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">conflicts in broadcast links resolved? Is there addressing at the link layer and, if so, how does the link-</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark368" class="s124">layer addressing operate with the network-layer addressing we learned about in </a><a href="#bookmark368" class="a">Chapter </a>4<span class="p">? And what exactly is the difference between a switch and a router? We’ll answer these and other important questions in this chapter.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In discussing the link layer, we’ll see that there are two fundamentally different types of link-layer channels. The first type are broadcast channels, which connect multiple hosts in wireless LANs, satellite networks, and hybrid fiber-coaxial cable (HFC) access networks. Since many hosts are connected to the same broadcast communication channel, a so-called medium access protocol is needed to coordinate frame transmission. In some cases, a central controller may be used to coordinate transmissions; in other cases, the hosts themselves coordinate transmissions. The second type of link-layer channel is the point-to-point communication link, such as that often found between two routers connected by a</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">long-distance link, or between a user’s office computer and the nearby Ethernet switch to which it is connected. Coordinating access to a point-to-point link is simpler; the reference material on this book’s Web site has a detailed discussion of the Point-to-Point Protocol (PPP), which is used in settings ranging from dial-up service over a telephone line to high-speed point-to-point frame transport over fiber-optic links.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark254" class="s124">We’ll explore several important link-layer concepts and technologies in this chapter. We’ll dive deeper into error detection and correction, a topic we touched on briefly in </a><a href="#bookmark254" class="a">Chapter </a>3<span class="p">. We’ll consider multiple</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">access networks and switched LANs, including Ethernet—by far the most prevalent wired LAN technology. We’ll also look at virtual LANs, and data center networks. Although WiFi, and more generally wireless LANs, are link-layer topics, we’ll postpone our study of these important topics until</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark591" class="a" name="bookmark513">Chapter </a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l250"><ol id="l251"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark514">Introduction to the Link Layer</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">Let’s begin with some important terminology. We’ll find it convenient in this chapter to refer to any device that runs a link-layer (i.e., layer 2) protocol as a </span>node<a href="#bookmark591" class="s124">. Nodes include hosts, routers, switches, and WiFi access points (discussed in </a><a href="#bookmark591" class="a">Chapter </a>7<span class="p">). We will also refer to the communication channels that connect</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">adjacent nodes along the communication path as <span class="s20">links</span>. In order for a datagram to be transferred from</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">source host to destination host, it must be moved over each of the <i>individual links </i><a href="#bookmark515" class="s124">in the end-to-end path. As an example, in the company network shown at the bottom of </a><a href="#bookmark515" class="a">Figure 6.</a><span class="s20">1</span>, consider sending a datagram from one of the wireless hosts to one of the servers. This datagram will actually pass through</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">six links: a WiFi link between sending host and WiFi access point, an Ethernet link between the access point and a link-layer switch; a link between the link-layer switch and the router, a link between the two routers; an Ethernet link between the router and a link-layer switch; and finally an Ethernet link between the switch and the server. Over a given link, a transmitting node encapsulates the datagram in a <span class="s20">link- layer frame </span>and transmits the frame into the link.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In order to gain further insight into the link layer and how it relates to the network layer, let’s consider a transportation analogy. Consider a travel agent who is planning a trip for a tourist traveling from Princeton, New Jersey, to Lausanne, Switzerland. The travel agent decides that it is most convenient for the tourist to take a limousine from Princeton to JFK airport, then a plane from JFK airport to Geneva’s airport, and finally a train from Geneva’s airport to Lausanne’s train station. Once the travel agent makes the three reservations, it is the responsibility of the Princeton limousine company to get the tourist from Princeton to JFK; it is the responsibility of the airline company to get the tourist from JFK to Geneva; and it is the responsibility</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="657" height="858" alt="image" src="计算机网络自顶向下7th-en/Image_603.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark515">Figure 6.1 Six link-layer hops between wireless host and server</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">of the Swiss train service to get the tourist from Geneva to Lausanne. Each of the three segments of the trip is “direct” between two “adjacent” locations. Note that the three transportation segments are managed by different companies and use entirely different transportation modes (limousine, plane, and train). Although the transportation modes are different, they each provide the basic service of moving passengers from one location to an adjacent location. In this transportation analogy, the tourist is a datagram, each transportation segment is a link, the transportation mode is a link-layer protocol, and the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">travel agent is a routing protocol.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l252"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The Services Provided by the Link Layer</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although the basic service of any link layer is to move a datagram from one node to an adjacent node over a single communication link, the details of the provided service can vary from one link-layer protocol to the next. Possible services that can be offered by a link-layer protocol include:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_604.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Framing. <span class="p">Almost all link-layer protocols encapsulate each network-layer datagram within a link-layer frame before transmission over the link. A frame consists of a data field, in which the network-layer datagram is inserted, and a number of header fields. The structure of the frame is specified by the</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">link-layer protocol. We’ll see several different frame formats when we examine specific link-layer protocols in the second half of this chapter.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_605.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Link access. <span class="p">A medium access control (MAC) protocol specifies the rules by which a frame is transmitted onto the link. For point-to-point links that have a single sender at one end of the link and a single receiver at the other end of the link, the MAC protocol is simple (or nonexistent)—the sender</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">can send a frame whenever the link is idle. The more interesting case is when multiple nodes share a single broadcast link—the so-called multiple access problem. Here, the MAC protocol serves to coordinate the frame transmissions of the many nodes.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_606.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Reliable delivery. <span class="p">When a link-layer protocol provides reliable delivery service, it guarantees to move each network-layer datagram across the link without error. Recall that certain transport-layer protocols (such as TCP) also provide a reliable delivery service. Similar to a transport-layer reliable</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">delivery service, a link-layer reliable delivery service can be achieved with acknowledgments and</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark298" class="s124">retransmissions (see </a><a href="#bookmark298" class="a">Section 3.</a>4<span class="p">). A link-layer reliable delivery service is often used for links that are prone to high error rates, such as a wireless link, with the goal of correcting an error locally—on the link where the error occurs—rather than forcing an end-to-end retransmission of the data by a</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">transport- or application-layer protocol. However, link-layer reliable delivery can be considered an unnecessary overhead for low bit-error links, including fiber, coax, and many twisted-pair copper links. For this reason, many wired link-layer protocols do not provide a reliable delivery service.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_607.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Error detection and correction. <span class="p">The link-layer hardware in a receiving node can incorrectly decide that a bit in a frame is zero when it was transmitted as a one, and vice versa. Such bit errors are introduced by signal attenuation and electromagnetic noise. Because there is no need to forward a</span></p><p class="s20" style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark254" class="s124">datagram that has an error, many link-layer protocols provide a mechanism to detect such bit errors. This is done by having the transmitting node include error-detection bits in the frame, and having the receiving node perform an error check. Recall from </a><a href="#bookmark254" class="a">Chapters 3</a> <a href="#bookmark368" class="s124">and </a><a href="#bookmark368" class="a">4</a> <span class="p">that the Internet’s transport</span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 11pt;text-align: left;">layer and network layer also provide a limited form of error detection—the Internet checksum. Error</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">detection in the link layer is usually more sophisticated and is implemented in hardware. Error correction is similar to error detection, except that a receiver not only detects when bit errors have occurred in the frame but also determines exactly where in the frame the errors have occurred (and</p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark516">then corrects these errors).</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Where Is the Link Layer Implemented?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark368" class="s124">Before diving into our detailed study of the link layer, let’s conclude this introduction by considering the question of where the link layer is implemented. We’ll focus here on an end system, since we learned in </a><a href="#bookmark368" class="a">Chapter 4</a> <span class="p">that the link layer is implemented in a router’s line card. Is a host’s link layer implemented in</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">hardware or software? Is it implemented on a separate card or chip, and how does it interface with the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">rest of a host’s hardware and operating system components?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark519" class="a">Figure 6.2</a> <span class="p">shows a typical host architecture. For the most part, the link layer is implemented in a </span>network adapter<span class="p">, also sometimes known as a </span>network interface card (NIC)<span class="p">. At the heart of the network adapter is the link-layer controller, usually a single, special-purpose chip that implements many</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">of the link-layer services (framing, link access, error detection, and so on). Thus, much of a link-layer controller’s functionality is implemented in hardware. For example, Intel’s 710 adapter </a><a href="#bookmark848" class="a">[Intel </a>2016] <a href="#bookmark568" class="s124">implements the Ethernet protocols we’ll study in </a><a href="#bookmark568" class="a">Section 6.</a>5<a href="#bookmark848" class="s124">; the Atheros AR5006 </a><a href="#bookmark848" class="a">[Atheros 2016]</a></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark591" class="s124">controller implements the 802.11 WiFi protocols we’ll study in </a><a href="#bookmark591" class="a">Chapter </a>7<span class="p">. Until the late 1990s, most</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">network adapters were physically separate cards (such as a PCMCIA card or a plug-in card fitting into a PC’s PCI card slot) but increasingly, network adapters are being integrated onto the host’s motherboard</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">—a so-called LAN-on-motherboard configuration.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">On the sending side, the controller takes a datagram that has been created and stored in host memory by the higher layers of the protocol stack, encapsulates the datagram in a link-layer frame (filling in the frame’s various fields), and then transmits the frame into the communication link, following the link- access protocol. On the receiving side, a controller receives the entire frame, and extracts the network- layer datagram. If the link layer performs error detection, then it is the sending controller that sets the error-detection bits in the frame header and it is the receiving controller that performs error detection.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark519" class="a">Figure 6.2</a> <span class="p">shows a network adapter attaching to a host’s bus (e.g., a PCI or PCI-X bus), where it looks much like any other I/O device to the other host</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="542" height="419" alt="image" src="计算机网络自顶向下7th-en/Image_608.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark517">Figure 6.2 Network adapter: Its relationship to other host components and to protocol stack functionality</a><a name="bookmark518">&zwnj;</a><a name="bookmark519">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark519" class="s124">components. </a><a href="#bookmark519" class="a">Figure 6.2</a> <span class="p">also shows that while most of the link layer is implemented in hardware, part of the link layer is implemented in software that runs on the host’s CPU. The software components of the link layer implement higher-level link-layer functionality such as assembling link-layer addressing</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">information and activating the controller hardware. On the receiving side, link-layer software responds to controller interrupts (e.g., due to the receipt of one or more frames), handling error conditions and passing a datagram up to the network layer. Thus, the link layer is a combination of hardware and</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">software—the place in the protocol stack where software meets hardware. </a><a href="#bookmark848" class="a">[Intel 2016]</a> <span class="p">provides a readable overview (as well as a detailed description) of the XL710 controller from a software- programming point of view.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li></ol></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark520">Error-Detection and -Correction Techniques</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">In the previous section, we noted that </span>bit-level error detection and correction<a href="#bookmark254" class="s124">—detecting and correcting the corruption of bits in a link-layer frame sent from one node to another physically connected neighboring node—are two services often provided by the link layer. We saw in </a><a href="#bookmark254" class="a">Chapter 3</a> <span class="p">that error-</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">detection and -correction services are also often offered at the transport layer as well. In this section,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark848" class="s124">we’ll examine a few of the simplest techniques that can be used to detect and, in some cases, correct such bit errors. A full treatment of the theory and implementation of this topic is itself the topic of many textbooks (for example, </a><a href="#bookmark848" class="a">[Schwartz 1980]</a> <a href="#bookmark848" class="s124">or </a><a href="#bookmark848" class="a">[Bertsekas </a>1991]<span class="p">), and our treatment here is necessarily</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">brief. Our goal here is to develop an intuitive feel for the capabilities that error-detection and -correction</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">techniques provide and to see how a few simple techniques work and are used in practice in the link layer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark521" class="a">Figure 6.3</a><span class="s20"> </span>illustrates the setting for our study. At the sending node, data, <i>D</i>, to be protected against bit errors is augmented with error-detection and -correction bits (<i>EDC</i>). Typically, the data to be protected includes not only the datagram passed down from the network layer for transmission across the link, but</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">also link-level addressing information, sequence numbers, and other fields in the link frame header. Both <i>D </i>and <i>EDC </i>are sent to the receiving node in a link-level frame. At the receiving node, a sequence of bits, <i>D</i>′ and <i>EDC</i>′ is received. Note that <i>D</i>′ and <i>EDC</i>′ may differ from the original <i>D </i>and <i>EDC </i>as a</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">result of in-transit bit flips.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">The receiver’s challenge is to determine whether or not <i>D</i>′ is the same as the original <i>D</i>, given that it has only received <i>D</i>′ and <i>EDC</i><a href="#bookmark521" class="s124">′. The exact wording of the receiver’s decision in </a><a href="#bookmark521" class="a">Figure 6.3</a><span class="s20"> </span>(we ask whether an error is detected, not whether an error has occurred!) is important. Error-detection and -correction</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">techniques allow the receiver to sometimes, <i>but not always</i>, detect that bit errors have occurred. Even with the use of error-detection bits there still may be <span class="s20">undetected bit errors</span>; that is, the receiver may be unaware that the received information contains bit errors. As a</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="670" height="422" alt="image" src="计算机网络自顶向下7th-en/Image_609.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark521">Figure 6.3 Error-detection and -correction scenario</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">consequence, the receiver might deliver a corrupted datagram to the network layer, or be unaware that the contents of a field in the frame’s header has been corrupted. We thus want to choose an error- detection scheme that keeps the probability of such occurrences small. Generally, more sophisticated error-detection and-correction techniques (that is, those that have a smaller probability of allowing undetected bit errors) incur a larger overhead—more computation is needed to compute and transmit a larger number of error-detection and -correction bits.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now examine three techniques for detecting errors in the transmitted data—parity checks (to illustrate the basic ideas behind error detection and correction), checksumming methods (which are more typically used in the transport layer), and cyclic redundancy checks (which are more typically used in the link layer in an adapter).</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l253"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Parity Checks</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">Perhaps the simplest form of error detection is the use of a single <span class="s20">parity bit</span>. Suppose that the information to be sent, <i>D </i><a href="#bookmark522" class="s124">in </a><a href="#bookmark522" class="a">Figure 6.</a><span class="s20">4</span>, has <i>d </i>bits. In an even parity scheme, the sender simply includes</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark522" class="s124">one additional bit and chooses its value such that the total number of 1s in the d+1 bits (the original information plus a parity bit) is even. For odd parity schemes, the parity bit value is chosen such that there is an odd number of 1s. </a><a href="#bookmark522" class="a">Figure 6.4</a> <span class="p">illustrates an even parity scheme, with the single parity bit</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">being stored in a separate field.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Receiver operation is also simple with a single parity bit. The receiver need only count the number of 1s in the received d+1 bits. If an odd number of 1-valued bits are found with an even parity scheme, the receiver knows that at least one bit error has occurred. More precisely, it knows that some <i>odd </i>number</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">of bit errors have occurred.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">But what happens if an even number of bit errors occur? You should convince yourself that this would result in an undetected error. If the probability of bit errors is small and errors can be assumed to occur independently from one bit to the next, the probability of multiple bit errors in a packet would be extremely small. In this case, a single parity bit might suffice. However, measurements have shown that, rather than occurring independently, errors are often clustered together in “bursts.” Under burst error conditions, the probability of undetected errors in a frame protected by single-bit parity can approach 50</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">percent </a><a href="#bookmark848" class="a">[Spragins 1991</a>]<span class="p">. Clearly, a more robust error-detection scheme is needed (and, fortunately, is used in practice!). But before examining error-detection schemes that are used in practice, let’s consider a simple</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="302" height="106" alt="image" src="计算机网络自顶向下7th-en/Image_610.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;"><a name="bookmark522">Figure 6.4 One-bit even parity</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: justify;">generalization of one-bit parity that will provide us with insight into error-correction techniques.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark524" class="a">Figure 6.5</a><span class="s20"> </span>shows a two-dimensional generalization of the single-bit parity scheme. Here, the <i>d </i>bits in <i>D </i>are divided into <i>i </i>rows and <i>j </i>columns. A parity value is computed for each row and for each column. The resulting i+j+1 parity bits comprise the link-layer frame’s error-detection bits.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 126%;text-align: justify;">Suppose now that a single bit error occurs in the original <i>d </i>bits of information. With this <span class="s23">two-</span><span class="s20"> dimensional parity </span>scheme, the parity of both the column and the row containing the flipped bit will be</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">in error. The receiver can thus not only <i>detect </i>the fact that a single bit error has occurred, but can use the column and row indices of the column and row with parity errors to actually identify the bit that was</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: justify;">corrupted and <i>correct </i><a href="#bookmark524" class="s124">that error! </a><a href="#bookmark524" class="a">Figure 6.5</a><span class="s20"> </span>shows an example in which the 1-valued bit in position (2,2) is corrupted and switched to a 0—an error that is both detectable and correctable at the receiver.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">Although our discussion has focused on the original <i>d </i>bits of information, a single error in the parity bits themselves is also detectable and correctable. Two-dimensional parity can also detect (but not correct!) any combination of two errors in a packet. Other properties of the two-dimensional parity scheme are</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">explored in the problems at the end of the chapter.</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="418" height="529" alt="image" src="计算机网络自顶向下7th-en/Image_611.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark523">Figure 6.5 Two-dimensional even parity</a><a name="bookmark524">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The ability of the receiver to both detect and correct errors is known as <span class="s20">forward error correction (FEC)</span>. These techniques are commonly used in audio storage and playback devices such as audio CDs. In a network setting, FEC techniques can be used by themselves, or in conjunction with link-layer ARQ</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark254" class="s124">techniques similar to those we examined in </a><a href="#bookmark254" class="a">Chapter </a>3<span class="p">. FEC techniques are valuable because they can decrease the number of sender retransmissions required. Perhaps more important, they allow for immediate correction of errors at the receiver. This avoids having to wait for the round-trip propagation</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">delay needed for the sender to receive a NAK packet and for the retransmitted packet to propagate back</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">to the receiver—a potentially important advantage for real-time network applications </a><a href="#bookmark848" class="a">[Rubenstein 1998]</a></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">or links (such as deep-space links) with long propagation delays. Research examining the use of FEC in error-control protocols includes </a><a href="#bookmark848" class="a">[Biersack </a>1992<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Nonnenmacher 199</a>8<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Byers </a>1998<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Shacham 1990</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Checksumming Methods</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">In checksumming techniques, the <i>d </i><a href="#bookmark522" class="s124">bits of data in </a><a href="#bookmark522" class="a">Figure 6.4</a><span class="s20"> </span>are treated as a sequence of <i>k</i>-bit integers. One simple checksumming method is to simply sum these <i>k</i>-bit integers and use the resulting sum as the error-detection bits. The <span class="s20">Internet checksum </span>is based on this approach—bytes of data are</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark525">treated as 16-bit integers and summed. The 1s complement of this sum then forms the Internet</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark271" class="s124">checksum that is carried in the segment header. As discussed in </a><a href="#bookmark271" class="a">Section 3.</a>3<span class="p">, the receiver checks the checksum by taking the 1s complement of the sum of the received data (including the checksum) and checking whether the result is all 1 bits. If any of the bits are 0, an error is indicated. RFC 1071</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">discusses the Internet checksum algorithm and its implementation in detail. In the TCP and UDP protocols, the Internet checksum is computed over all fields (header and data fields included). In IP the checksum is computed over the IP header (since the UDP or TCP segment has its own checksum). In</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">other protocols, for example, XTP </a><a href="#bookmark848" class="a">[Strayer </a>1992]<span class="p">, one checksum is computed over the header and another checksum is computed over the entire packet.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Checksumming methods require relatively little packet overhead. For example, the checksums in TCP and UDP use only 16 bits. However, they provide relatively weak protection against errors as compared with cyclic redundancy check, which is discussed below and which is often used in the link layer. A natural question at this point is, Why is checksumming used at the transport layer and cyclic redundancy check used at the link layer? Recall that the transport layer is typically implemented in software in a host as part of the host’s operating system. Because transport-layer error detection is implemented in software, it is important to have a simple and fast error-detection scheme such as checksumming. On the other hand, error detection at the link layer is implemented in dedicated hardware in adapters, which</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">can rapidly perform the more complex CRC operations. Feldmeier </a><a href="#bookmark848" class="a">[Feldmeier 1995]</a> <span class="p">presents fast software implementation techniques for not only weighted checksum codes, but CRC (see below) and other codes as well.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Cyclic Redundancy Check (CRC)</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">An error-detection technique used widely in today’s computer networks is based on <span class="s20">cyclic redundancy check (CRC) codes</span>. CRC codes are also known as <span class="s20">polynomial codes</span>, since it is possible to view the bit string to be sent as a polynomial whose coefficients are the 0 and 1 values in the bit string, with operations on the bit string interpreted as polynomial arithmetic.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;">CRC codes operate as follows. Consider the <i>d</i>-bit piece of data, <i>D</i>, that the sending node wants to send to the receiving node. The sender and receiver must first agree on an r+1 bit pattern, known as a <span class="s23">generato</span><span class="s20">r</span>, which we will denote as <i>G</i>. We will require that the most significant (leftmost) bit of <i>G </i><a href="#bookmark526" class="s124">be a 1. The key idea behind CRC codes is shown in </a><a href="#bookmark526" class="a">Figure 6.</a><span class="s20">6</span>. For a given piece of data, <i>D</i>, the sender will</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 15pt;text-align: left;">choose <i>r </i>additional bits, <i>R</i>, and append them to <i>D </i>such that the resulting <span class="s27">d</span>+r bit pattern (interpreted as a</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 127%;text-align: left;">binary number) is exactly divisible by <i>G </i>(i.e., has no remainder) using modulo-2 arithmetic. The process of error checking with CRCs is thus simple: The receiver divides the <span class="s27">d</span>+r received bits by <i>G</i>. If the remainder is nonzero, the receiver knows that an error has occurred; otherwise the data is accepted as</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">being correct.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="134" alt="image" src="计算机网络自顶向下7th-en/Image_612.png"/></span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">All CRC calculations are done in modulo-2 arithmetic without carries in addition or borrows in subtraction. This means that addition and subtraction are identical, and both are equivalent to the bitwise exclusive-or (XOR) of the operands. Thus, for example,</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">1011 XOR 0101 = 1110</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">1001 XOR 1101 = 0100</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="134" alt="image" src="计算机网络自顶向下7th-en/Image_613.png"/></span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Also, we similarly have</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">1011 - 0101 = 1110</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">1001 - 1101 = 0100</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Multiplication and division are the same as in base-2 arithmetic, except that any required addition or subtraction is done without carries or borrows. As in regular</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="524" height="121" alt="image" src="计算机网络自顶向下7th-en/Image_614.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark526">Figure 6.6 CRC</a></h2><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 123%;text-align: left;">binary arithmetic, multiplication by 2<span class="s121">k</span><span class="s31"> </span>left shifts a bit pattern by <i>k </i>places. Thus, given <i>D </i>and <i>R</i>, the quantity <span class="s27">D</span><span class="s29">⋅</span>2rXOR R yields the <span class="s27">d</span><a href="#bookmark526" class="s124">+r bit pattern shown in </a><a href="#bookmark526" class="a">Figure 6.</a><span class="s20">6</span>. We’ll use this algebraic characterization of the <span class="s27">d</span><a href="#bookmark526" class="s124">+r bit pattern from </a><a href="#bookmark526" class="a">Figure 6.6</a><span class="s20"> </span>in our discussion below.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Let us now turn to the crucial question of how the sender computes <i>R</i>. Recall that we want to find <i>R</i></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">such that there is an <i>n </i>such that</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">D<span class="s29">⋅</span>2rXOR R=nG</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 136%;text-align: left;">That is, we want to choose <i>R </i>such that <i>G </i>divides into <span class="s27">D</span><span class="s29">⋅</span>2rXOR R without remainder. If we XOR (that is, add modulo-2, without carry) <i>R </i>to both sides of the above equation, we get</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark527">D</a><span class="s29">⋅</span>2r=nG XOR R<a name="bookmark528">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 136%;text-align: left;">This equation tells us that if we divide <span class="s27">D</span><span class="s29">⋅</span>2r by G, the value of the remainder is precisely <i>R</i>. In other words, we can calculate <i>R </i>as</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">R=remainderD<span class="s29">⋅</span>2rG</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark529" class="a">Figure 6.7</a><span class="s20"> </span>illustrates this calculation for the case of <span class="s27">D</span>=101110, d=6, G=1001, and <span class="s27">r</span>=3. The 9 bits transmitted in this case are 101 110  011. You should check these calculations for yourself and also check that indeed D<span class="s29">⋅</span>2r=101011<span class="s29">⋅</span>G XOR R.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="270" height="363" alt="image" src="计算机网络自顶向下7th-en/Image_615.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark529">Figure 6.7 A sample CRC calculation</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">International standards have been defined for 8-, 12-, 16-, and 32-bit generators, <i>G</i>. The CRC-32 32-bit standard, which has been adopted in a number of link-level IEEE protocols, uses a generator of</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">GCRC-32=100000100110000010001110110110111</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">Each of the CRC standards can detect burst errors of fewer than r+1 bits. (This means that all</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">consecutive bit errors of <i>r </i>bits or fewer will be detected.) Furthermore, under appropriate assumptions, a burst of length greater than r+1 bits is detected with probability 1−0.5r. Also, each of the CRC standards can detect any odd number of bit errors. See [Williams 1993] for a discussion of implementing CRC</p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">checks. The theory behind CRC codes and even more powerful codes is beyond the scope of this text. The text </a><a href="#bookmark848" class="a">[Schwartz 1980]</a> <span class="p">provides an excellent introduction to this topic.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l254"><ol id="l255"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark530">Multiple Access Links and Protocols</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the introduction to this chapter, we noted that there are two types of network links: point-to-point links and broadcast links. A <span class="s20">point-to-point link </span>consists of a single sender at one end of the link and a single receiver at the other end of the link. Many link-layer protocols have been designed for point-to-point links; the point-to-point protocol (PPP) and high-level data link control (HDLC) are two such protocols. The second type of link, a <span class="s20">broadcast link</span>, can have multiple sending and receiving nodes all connected</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">to the same, single, shared broadcast channel. The term <i>broadcast </i>is used here because when any one node transmits a frame, the channel broadcasts the frame and each of the other nodes receives a copy. Ethernet and wireless LANs are examples of broadcast link-layer technologies. In this section we’ll take</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">a step back from specific link-layer protocols and first examine a problem of central importance to the link layer: how to coordinate the access of multiple sending and receiving nodes to a shared broadcast channel—the <span class="s20">multiple access problem</span>. Broadcast channels are often used in LANs, networks that are geographically concentrated in a single building (or on a corporate or university campus). Thus, we’ll look at how multiple access channels are used in LANs at the end of this section.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We are all familiar with the notion of broadcasting—television has been using it since its invention. But traditional television is a one-way broadcast (that is, one fixed node transmitting to many receiving nodes), while nodes on a computer network broadcast channel can both send and receive. Perhaps a more apt human analogy for a broadcast channel is a cocktail party, where many people gather in a large room (the air providing the broadcast medium) to talk and listen. A second good analogy is something many readers will be familiar with—a classroom—where teacher(s) and student(s) similarly share the same, single, broadcast medium. A central problem in both scenarios is that of determining who gets to talk (that is, transmit into the channel) and when. As humans, we’ve evolved an elaborate set of protocols for sharing the broadcast channel:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 219%;text-align: left;">“Give everyone a chance to speak.” “Don’t speak until you are spoken to.” “Don’t monopolize the conversation.” “Raise your hand if you have a question.”</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 219%;text-align: left;">“Don’t interrupt when someone is speaking.” “Don’t fall asleep when someone is talking.”</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Computer networks similarly have protocols—so-called <span class="s20">multiple access protocols</span>—by which nodes</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark531" class="s124">regulate their transmission into the shared broadcast channel. As shown in </a><a href="#bookmark531" class="a">Figure 6.</a>8<span class="p">, multiple access protocols are needed in a wide variety of network settings, including both wired and wireless access networks, and satellite networks. Although technically each node accesses the broadcast channel</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">through its adapter, in this section we will refer to the <i>node </i>as the sending and</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="668" height="531" alt="image" src="计算机网络自顶向下7th-en/Image_616.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark531">Figure 6.8 Various multiple access channels</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">receiving device. In practice, hundreds or even thousands of nodes can directly communicate over a broadcast channel.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Because all nodes are capable of transmitting frames, more than two nodes can transmit frames at the same time. When this happens, all of the nodes receive multiple frames at the same time; that is, the transmitted frames <span class="s20">collide </span>at all of the receivers. Typically, when there is a collision, none of the receiving nodes can make any sense of any of the frames that were transmitted; in a sense, the signals of the colliding frames become inextricably tangled together. Thus, all the frames involved in the collision are lost, and the broadcast channel is wasted during the collision interval. Clearly, if many nodes want to transmit frames frequently, many transmissions will result in collisions, and much of the bandwidth of the broadcast channel will be wasted.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">In order to ensure that the broadcast channel performs useful work when multiple nodes are active, it is</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">necessary to somehow coordinate the transmissions of the active nodes. This coordination job is the responsibility of the multiple access protocol. Over the past 40 years, thousands of papers and hundreds of PhD dissertations have been written on multiple access protocols; a comprehensive survey</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">of the first 20 years of this body of work is </a><a href="#bookmark848" class="a">[Rom 1990</a>]<span class="p">. Furthermore, active research in multiple access protocols continues due to the continued emergence of new types of links, particularly new wireless links.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Over the years, dozens of multiple access protocols have been implemented in a variety of link-layer technologies. Nevertheless, we can classify just about any multiple access protocol as belonging to one of three categories: <span class="s20">channel partitioning protocols</span>, <span class="s20">random access protocols</span>, and <span class="s20">taking-turns protocols</span>. We’ll cover these categories of multiple access protocols in the following three subsections.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;">Let’s conclude this overview by noting that, ideally, a multiple access protocol for a broadcast channel of rate <i>R </i>bits per second should have the following desirable characteristics:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><ol id="l256"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">When only one node has data to send, that node has a throughput of <i>R </i>bps.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 138%;text-align: left;"><p style="display: inline;">When <i>M </i>nodes have data to send, each of these nodes has a throughput of <i>R</i>/<i>M </i>bps. This need not necessarily imply that each of the <i>M </i>nodes always has an instantaneous rate of <i>R</i>/<i>M</i>, but rather that each node should have an average transmission rate of <i>R</i>/<i>M </i>over some suitably defined interval of time.</p></li><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The protocol is decentralized; that is, there is no master node that represents a single point of failure for the network.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The protocol is simple, so that it is inexpensive to implement.</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><ol id="l257"><ol id="l258"><ol id="l259"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Channel Partitioning Protocols</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark59" class="s124">Recall from our early discussion back in </a><a href="#bookmark59" class="a">Section 1.3</a> <span class="p">that time-division multiplexing (TDM) and frequency-division multiplexing (FDM) are two techniques that can</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="472" height="403" alt="image" src="计算机网络自顶向下7th-en/Image_617.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark532">Figure 6.9 A four-node TDM and FDM example</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">be used to partition a broadcast channel’s bandwidth among all nodes sharing that channel. As an example, suppose the channel supports <i>N </i>nodes and that the transmission rate of the channel is <i>R </i>bps.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">TDM divides time into <span class="s23">time</span><span class="s20"> frames </span>and further divides each time frame into <i>N </i><span class="s23">time</span><span class="s20"> slots</span>. (The TDM</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">time frame should not be confused with the link-layer unit of data exchanged between sending and receiving adapters, which is also called a frame. In order to reduce confusion, in this subsection we’ll refer to the link-layer unit of data exchanged as a packet.) Each time slot is then assigned to one of the</p><p class="s17" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">N <span class="p">nodes. Whenever a node has a packet to send, it transmits the packet’s bits during its assigned time slot in the revolving TDM frame. Typically, slot sizes are chosen so that a single packet can be</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark532" class="s124">transmitted during a slot time. </a><a href="#bookmark532" class="a">Figure 6.9</a> <span class="p">shows a simple four-node TDM example. Returning to our cocktail party analogy, a TDM-regulated cocktail party would allow one partygoer to speak for a fixed period of time, then allow another partygoer to speak for the same amount of time, and so on. Once</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">everyone had had a chance to talk, the pattern would repeat.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">TDM is appealing because it eliminates collisions and is perfectly fair: Each node gets a dedicated transmission rate of <i>R</i>/<i>N </i>bps during each frame time. However, it has two major drawbacks. First, a node is limited to an average rate of <i>R</i>/<i>N </i>bps even when it is the only node with packets to send. A</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">second drawback is that a node must always wait for its turn in the transmission sequence—again, even</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">when it is the only node with a frame to send. Imagine the partygoer who is the only one with anything to say (and imagine that this is the even rarer circumstance where everyone wants to hear what that one person has to say). Clearly, TDM would be a poor choice for a multiple access protocol for this particular party.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark533">While TDM shares the broadcast channel in time, FDM divides the </a><i>R </i>bps channel into different frequencies (each with a bandwidth of <i>R</i>/<i>N</i>) and assigns each frequency to one of the <i>N </i>nodes. FDM thus creates <i>N </i>smaller channels of <i>R</i>/<i>N </i>bps out of the single, larger <i>R </i>bps channel. FDM shares both</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">the advantages and drawbacks of TDM. It avoids collisions and divides the bandwidth fairly among the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">N <span class="p">nodes. However, FDM also shares a principal disadvantage with TDM—a node is limited to a bandwidth of </span>R<span class="p">/</span>N<span class="p">, even when it is the only node with packets to send.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">A third channel partitioning protocol is <span class="s20">code division multiple access (CDMA)</span>. While TDM and FDM assign time slots and frequencies, respectively, to the nodes, CDMA assigns a different <i>code </i>to each</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">node. Each node then uses its unique code to encode the data bits it sends. If the codes are chosen</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">carefully, CDMA networks have the wonderful property that different nodes can transmit <i>simultaneously </i>and yet have their respective receivers correctly receive a sender’s encoded data bits (assuming the receiver knows the sender’s code) in spite of interfering transmissions by other nodes. CDMA has been</p><p class="s20" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark591" class="s124">used in military systems for some time (due to its anti-jamming properties) and now has widespread civilian use, particularly in cellular telephony. Because CDMA’s use is so tightly tied to wireless channels, we’ll save our discussion of the technical details of CDMA until </a><a href="#bookmark591" class="a">Chapter </a>7<span class="p">. For now, it will</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">suffice to know that CDMA codes, like time slots in TDM and frequencies in FDM, can be allocated to</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">the multiple access channel users.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Random Access Protocols</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">The second broad class of multiple access protocols are random access protocols. In a random access protocol, a transmitting node always transmits at the full rate of the channel, namely, <i>R </i>bps. When there</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">is a collision, each node involved in the collision repeatedly retransmits its frame (that is, packet) until its frame gets through without a collision. But when a node experiences a collision, it doesn’t necessarily retransmit the frame right away. <i>Instead it waits a random delay before retransmitting the frame</i>. Each</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">node involved in a collision chooses independent random delays. Because the random delays are</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">independently chosen, it is possible that one of the nodes will pick a delay that is sufficiently less than the delays of the other colliding nodes and will therefore be able to sneak its frame into the channel without a collision.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">There are dozens if not hundreds of random access protocols described in the literature </a><a href="#bookmark848" class="a">[Rom </a>1990<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Bertsekas </a>1991]<a href="#bookmark848" class="s124">. In this section we’ll describe a few of the most commonly used random access protocols—the ALOHA protocols </a><a href="#bookmark848" class="a">[Abramson </a>1970<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Abramson 198</a>5<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Abramson 2009]</a> <a href="#bookmark848" class="s124">and the carrier sense multiple access (CSMA) protocols </a><a href="#bookmark848" class="a">[Kleinrock 1975b</a>]<a href="#bookmark848" class="s124">. Ethernet </a><a href="#bookmark848" class="a">[Metcalfe 1976]</a> <span class="p">is a popular and</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">widely deployed CSMA protocol.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Slotted ALOHA</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s begin our study of random access protocols with one of the simplest random access protocols, the slotted ALOHA protocol. In our description of slotted ALOHA, we assume the following:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_618.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">All frames consist of exactly <i>L </i>bits.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_619.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_620.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">Time is divided into slots of size <i>L</i>/<i>R </i>seconds (that is, a slot equals the time to transmit one frame). Nodes start to transmit frames only at the beginnings of slots.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_621.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">The nodes are synchronized so that each node knows when the slots begin.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_622.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">If two or more frames collide in a slot, then all the nodes detect the collision event before the slot ends.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Let <i>p </i>be a probability, that is, a number between 0 and 1. The operation of slotted ALOHA in each node is simple:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_623.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">When the node has a fresh frame to send, it waits until the beginning of the next slot and transmits the entire frame in the slot.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_624.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">If there isn’t a collision, the node has successfully transmitted its frame and thus need not consider retransmitting the frame. (The node can prepare a new frame for transmission, if it has one.)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_625.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">If there is a collision, the node detects the collision before the end of the slot. The node retransmits its frame in each subsequent slot with probability <i>p </i>until the frame is transmitted without a collision.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">By retransmitting with probability <i>p</i>, we mean that the node effectively tosses a biased coin; the event heads corresponds to “retransmit,” which occurs with probability <i>p</i>. The event tails corresponds to “skip the slot and toss the coin again in the next slot”; this occurs with probability (1−p). All nodes involved in</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the collision toss their coins independently.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">Slotted ALOHA would appear to have many advantages. Unlike channel partitioning, slotted ALOHA allows a node to transmit continuously at the full rate, <i>R</i>, when that node is the only active node. (A node</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">is said to be active if it has frames to send.) Slotted ALOHA is also highly decentralized, because each node detects collisions and independently decides when to retransmit. (Slotted ALOHA does, however, require the slots to be synchronized in the nodes; shortly we’ll discuss an unslotted version of the ALOHA protocol, as well as CSMA protocols, none of which require such synchronization.) Slotted ALOHA is also an extremely simple protocol.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Slotted ALOHA works well when there is only one active node, but how efficient is it when there are multiple active nodes? There are two possible efficiency</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="670" height="346" alt="image" src="计算机网络自顶向下7th-en/Image_626.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark534">Figure 6.10 Nodes 1, 2, and 3 collide in the first slot. Node 2 finally succeeds in the fourth slot, node 1 in the eighth slot, and node 3 in the ninth slot</a></h2><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark534" class="s124">concerns here. First, as shown in </a><a href="#bookmark534" class="a">Figure 6.1</a>0<span class="p">, when there are multiple active nodes, a certain fraction of the slots will have collisions and will therefore be “wasted.” The second concern is that another fraction</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">of the slots will be <i>empty </i>because all active nodes refrain from transmitting as a result of the probabilistic transmission policy. The only “unwasted” slots will be those in which exactly one node transmits. A slot in which exactly one node transmits is said to be a <span class="s20">successful slot</span>. The <span class="s20">efficiency </span>of</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">a slotted multiple access protocol is defined to be the long-run fraction of successful slots in the case when there are a large number of active nodes, each always having a large number of frames to send. Note that if no form of access control were used, and each node were to immediately retransmit after each collision, the efficiency would be zero. Slotted ALOHA clearly increases the efficiency beyond zero, but by how much?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;">We now proceed to outline the derivation of the maximum efficiency of slotted ALOHA. To keep this derivation simple, let’s modify the protocol a little and assume that each node attempts to transmit a frame in each slot with probability <i>p</i>. (That is, we assume that each node always has a frame to send</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">and that the node transmits with probability <i>p </i>for a fresh frame as well as for a frame that has already</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">suffered a collision.) Suppose there are <i>N </i>nodes. Then the probability that a given slot is a successful slot is the probability that one of the nodes transmits and that the remaining N−1 nodes do not transmit.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 126%;text-align: left;">The probability that a given node transmits is <i>p; </i>the probability that the remaining nodes do not transmit is <span class="s27">(</span>1−p)N−1. Therefore the probability a given node has a success is <span class="s27">p</span>(1−p)N−1. Because there are <i>N </i>nodes, the probability that any one of the <i>N </i>nodes has a success is <span class="s27">N</span>p(1−p)N−1.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark535">Thus, when there are </a><i>N </i>active nodes, the efficiency of slotted ALOHA is <span class="s27">N</span>p(1−p)N−1. To obtain the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">maximum <span class="p">efficiency for </span>N <span class="p">active nodes, we have to find the </span>p<span class="p">* that maximizes this expression. (See the</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 147%;text-align: left;">homework problems for a general outline of this derivation.) And to obtain the maximum efficiency for a large number of active nodes, we take the limit of <span class="s27">N</span>p*(1−p*)N−1 as <i>N </i>approaches infinity. (Again, see</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the homework problems.) After performing these calculations, we’ll find that the maximum efficiency of</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">the protocol is given by 1/e=0.37. That is, when a large number of nodes have many frames to transmit, then (at best) only 37 percent of the slots do useful work. Thus the effective transmission rate of the channel is not <i>R </i>bps but only 0.37 <i>R </i>bps! A similar analysis also shows that 37 percent of the slots go</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">empty and 26 percent of slots have collisions. Imagine the poor network administrator who has</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">purchased a 100-Mbps slotted ALOHA system, expecting to be able to use the network to transmit data among a large number of users at an aggregate rate of, say, 80 Mbps! Although the channel is capable of transmitting a given frame at the full channel rate of 100 Mbps, in the long run, the successful throughput of this channel will be less than 37 Mbps.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">ALOHA</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">The slotted ALOHA protocol required that all nodes synchronize their transmissions to start at the beginning of a slot. The first ALOHA protocol </a><a href="#bookmark848" class="a">[Abramson 1970]</a> <span class="p">was actually an unslotted, fully</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">decentralized protocol. In pure ALOHA, when a frame first arrives (that is, a network-layer datagram is passed down from the network layer at the sending node), the node immediately transmits the frame in its entirety into the broadcast channel. If a transmitted frame experiences a collision with one or more other transmissions, the node will then immediately (after completely transmitting its collided frame)</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">retransmit the frame with probability <i>p</i>. Otherwise, the node waits for a frame transmission time. After this wait, it then transmits the frame with probability <i>p</i>, or waits (remaining idle) for another frame time with probability 1 – <i>p</i>.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">To determine the maximum efficiency of pure ALOHA, we focus on an individual node. We’ll make the same assumptions as in our slotted ALOHA analysis and take the frame transmission time to be the unit of time. At any given time, the probability that a node is transmitting a frame is <i>p</i>. Suppose this frame</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">begins transmission at time <i>t</i><span class="s22">0</span><a href="#bookmark536" class="s124">. As shown in </a><a href="#bookmark536" class="a">Figure 6.1</a><span class="s20">1</span>, in order for this frame to be successfully</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">transmitted, no other nodes can begin their transmission in the interval of time [ t0−1,t0]. Such a</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">transmission would overlap with the beginning of the transmission of node <i>i</i>’s frame. The probability that all other nodes do not begin a transmission in this interval is (1−p)N−1. Similarly, no other node can</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">begin a transmission while node <i>i </i>is transmitting, as such a transmission would overlap with the latter part of node <i>i</i>’s transmission. The probability that all other nodes do not begin a transmission in this interval is also (1−p)N−1. Thus, the probability that a given node has a successful transmission is</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">p(1−p)2(N−1). By taking limits as in the slotted ALOHA case, we find that the maximum efficiency of the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">pure ALOHA protocol is only 1/(2<i>e</i>)—exactly half that of slotted ALOHA. This then is the price to be paid for a fully decentralized ALOHA protocol.</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="668" height="279" alt="image" src="计算机网络自顶向下7th-en/Image_627.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark536">Figure 6.11 Interfering transmissions in pure ALOHA</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Carrier Sense Multiple Access (CSMA)</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In both slotted and pure ALOHA, a node’s decision to transmit is made independently of the activity of the other nodes attached to the broadcast channel. In particular, a node neither pays attention to whether another node happens to be transmitting when it begins to transmit, nor stops transmitting if another node begins to interfere with its transmission. In our cocktail party analogy, ALOHA protocols are quite like a boorish partygoer who continues to chatter away regardless of whether other people are talking. As humans, we have human protocols that allow us not only to behave with more civility, but also to decrease the amount of time spent “colliding” with each other in conversation and, consequently, to increase the amount of data we exchange in our conversations. Specifically, there are two important rules for polite human conversation:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_628.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>Listen before speaking. </b>If someone else is speaking, wait until they are finished. In the networking world, this is called <span class="s20">carrier sensing</span>—a node listens to the channel before transmitting. If a frame from another node is currently being transmitted into the channel, a node then waits until it detects</p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">no transmissions for a short amount of time and then begins transmission.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_629.png"/></span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><b>If someone else begins talking at the same time, stop talking. </b>In the networking world, this is called <span class="s20">collision detection</span>—a transmitting node listens to the channel while it is transmitting. If it detects that another node is transmitting an interfering frame, it stops transmitting and waits a</p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">random amount of time before repeating the sense-and-transmit-when-idle cycle.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 147%;text-align: left;"><span class="p">These two rules are embodied in the family of </span>carrier sense multiple access (CSMA) <span class="p">and </span>CSMA with <span class="s23">collision</span> detection (CSMA/CD) <a href="#bookmark848" class="s124">protocols </a><a href="#bookmark848" class="a">[Kleinrock 1975</a>b<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Metcalfe </a>1976<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Lam 198</a>0<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Rom 1990</a>]<span class="p">.</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Many variations on CSMA and</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="53" alt="image" src="计算机网络自顶向下7th-en/Image_630.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">CASE HISTORY</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="580" alt="image" src="计算机网络自顶向下7th-en/Image_631.png"/></span></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">NORM ABRAMSON AND ALOHANET</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Norm Abramson, a PhD engineer, had a passion for surfing and an interest in packet switching. This combination of interests brought him to the University of Hawaii in 1969. Hawaii consists of many mountainous islands, making it difficult to install and operate land-based networks. When not surfing, Abramson thought about how to design a network that does packet switching over radio. The network he designed had one central host and several secondary nodes scattered over the Hawaiian Islands. The network had two channels, each using a different frequency band. The downlink channel broadcasted packets from the central host to the secondary hosts; and the upstream channel sent packets from the secondary hosts to the central host. In addition to sending informational packets, the central host also sent on the downstream channel an acknowledgment for each packet successfully received from the secondary hosts.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Because the secondary hosts transmitted packets in a decentralized fashion, collisions on the upstream channel inevitably occurred. This observation led Abramson to devise the pure ALOHA protocol, as described in this chapter. In 1970, with continued funding from ARPA, Abramson connected his ALOHAnet to the ARPAnet. Abramson’s work is important not only because it was the first example of a radio packet network, but also because it inspired Bob Metcalfe. A few years later, Metcalfe modified the ALOHA protocol to create the CSMA/CD protocol and the Ethernet LAN.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">CSMA/CD have been proposed. Here, we’ll consider a few of the most important, and fundamental, characteristics of CSMA and CSMA/CD.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The first question that you might ask about CSMA is why, if all nodes perform carrier sensing, do collisions occur in the first place? After all, a node will refrain from transmitting whenever it senses that another node is transmitting. The answer to the question can best be illustrated using space-time</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">diagrams </a><a href="#bookmark848" class="a">[Molle 1987</a>]<a href="#bookmark537" class="s124">. </a><a href="#bookmark537" class="a">Figure 6.12</a> <span class="p">shows a space-time diagram of four nodes (A, B, C, D) attached</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">to a linear broadcast bus. The horizontal axis shows the position of each node in space; the vertical axis represents time.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">At time <i>t</i><span class="s22">0</span>, node B senses the channel is idle, as no other nodes are currently transmitting. Node B thus begins transmitting, with its bits propagating in both directions along the broadcast medium. The</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark537" class="s124">downward propagation of B’s bits in </a><a href="#bookmark537" class="a">Figure 6.12</a> <span class="p">with increasing time indicates that a nonzero amount of time is needed for B’s bits actually to propagate (albeit at near the speed of light) along the broadcast medium. At time t1(t1&gt;t0), node D has a frame to send. Although node B is currently transmitting at time</span></p><p class="s17" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">t<span class="s22">1</span><span class="p">, the bits being transmitted by B have yet to reach D, and thus D senses</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="521" height="575" alt="image" src="计算机网络自顶向下7th-en/Image_632.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark537">Figure 6.12 Space-time diagram of two CSMA nodes with colliding transmissions</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 156%;text-align: left;">the channel idle at <i>t</i><span class="s22">1</span><a href="#bookmark537" class="s124">. In accordance with the CSMA protocol, D thus begins transmitting its frame. A short time later, B’s transmission begins to interfere with D’s transmission at D. From </a><a href="#bookmark537" class="a">Figure 6.1</a><span class="s20">2</span>, it is</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">evident that the end-to-end <span class="s20">channel propagation delay </span>of a broadcast channel—the time it takes for a</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">signal to propagate from one of the nodes to another—will play a crucial role in determining its performance. The longer this propagation delay, the larger the chance that a carrier-sensing node is not yet able to sense a transmission that has already begun at another node in the network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Carrier Sense Multiple Access with Collision Dection (CSMA/CD)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark537" class="s124">In </a><a href="#bookmark537" class="a">Figure 6.1</a>2<span class="p">, nodes do not perform collision detection; both B and D continue to transmit their frames in their entirety even though a collision has occurred. When a node performs collision detection, it</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark538" class="s124">ceases transmission as soon as it detects a collision. </a><a href="#bookmark538" class="a">Figure 6.13</a> <span class="p">shows the same scenario as in</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark537" class="a">Figure 6.1</a>2<span class="p">, except that the two</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="521" height="578" alt="image" src="计算机网络自顶向下7th-en/Image_633.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a name="bookmark538">Figure 6.13 CSMA with collision detection</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">nodes each abort their transmission a short time after detecting a collision. Clearly, adding collision detection to a multiple access protocol will help protocol performance by not transmitting a useless, damaged (by interference with a frame from another node) frame in its entirety.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before analyzing the CSMA/CD protocol, let us now summarize its operation from the perspective of an adapter (in a node) attached to a broadcast channel:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l260"><li style="padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The adapter obtains a datagram from the network layer, prepares a link-layer frame, and puts the frame adapter buffer.</p></li><li style="padding-top: 3pt;padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If the adapter senses that the channel is idle (that is, there is no signal energy entering the adapter from the channel), it starts to transmit the frame. If, on the other hand, the adapter</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">senses that the channel is busy, it waits until it senses no signal energy and then starts to transmit the frame.</p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">While transmitting, the adapter monitors for the presence of signal energy coming from other adapters using the broadcast channel.</p></li><li style="padding-top: 3pt;padding-left: 47pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">If the adapter transmits the entire frame without detecting signal energy from other adapters, the</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">adapter is finished with the frame. If, on the other hand, the adapter detects signal energy from other adapters while transmitting, it aborts the transmission (that is, it stops transmitting its frame).</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: center;"><p style="display: inline;">After aborting, the adapter waits a random amount of time and then returns to step 2.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The need to wait a random (rather than fixed) amount of time is hopefully clear—if two nodes transmitted frames at the same time and then both waited the same fixed amount of time, they’d continue colliding forever. But what is a good interval of time from which to choose the random backoff time? If the interval is large and the number of colliding nodes is small, nodes are likely to wait a large amount of time (with the channel remaining idle) before repeating the sense-and-transmit-when-idle step. On the other hand, if the interval is small and the number of colliding nodes is large, it’s likely that the chosen random values will be nearly the same, and transmitting nodes will again collide. What we’d like is an interval that is short when the number of colliding nodes is small, and long when the number of colliding nodes is large.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><span class="p">The </span>binary exponential backoff <a href="#bookmark848" class="s124">algorithm, used in Ethernet as well as in DOCSIS cable network multiple access protocols </a><a href="#bookmark848" class="a">[DOCSIS 2011</a>]<span class="p">, elegantly solves this problem. Specifically, when transmitting</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">a frame that has already experienced <i>n </i>collisions, a node chooses the value of <i>K </i>at random from <span class="s27">{</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 21pt;text-align: left;"><span class="s27">0</span>,1,2,…2n−1}. Thus, the more collisions experienced by a frame, the larger the interval from which <i>K </i>is chosen. For Ethernet, the actual amount of time a node waits is <span class="s27">K</span><span class="s29">⋅</span>512 bit times (i.e., <i>K </i>times the amount of time needed to send 512 bits into the Ethernet) and the maximum value that <i>n </i>can take is capped at</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">10.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s look at an example. Suppose that a node attempts to transmit a frame for the first time and while transmitting it detects a collision. The node then chooses K=0 with probability 0.5 or chooses K=1 with probability 0.5. If the node chooses K=0, then it immediately begins sensing the channel. If the node chooses K=1, it waits 512 bit times (e.g., 5.12 microseconds for a 100 Mbps Ethernet) before beginning</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the sense-and-transmit-when-idle cycle. After a second collision, <i>K </i>is chosen with equal probability from</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">{0,1,2,3}. After three collisions, <i>K </i>is chosen with equal probability from {0,1,2,3,4,5,6,7}. After 10 or more collisions, <i>K </i>is chosen with equal probability from {0,1,2,…, 1023}. Thus, the size of the sets from which <i>K </i>is chosen grows exponentially with the number of collisions; for this reason this algorithm is referred to</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">as binary exponential backoff.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We also note here that each time a node prepares a new frame for transmission, it runs the CSMA/CD algorithm, not taking into account any collisions that may have occurred in the recent past. So it is possible that a node with a new frame will immediately be able to sneak in a successful transmission while several other nodes are in the exponential backoff state.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">CSMA/CD Efficiency</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark539">When only one node has a frame to send, the node can transmit at the full channel rate (e.g., for Ethernet typical rates are 10 Mbps, 100 Mbps, or 1 Gbps). However, if many nodes have frames to transmit, the effective transmission rate of the channel can be much less. We define the </a><span class="s20">efficiency of CSMA/CD </span>to be the long-run fraction of time during which frames are being transmitted on the channel without collisions when there is a large number of active nodes, with each node having a large number</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 148%;text-align: left;">of frames to send. In order to present a closed-form approximation of the efficiency of Ethernet, let <i>d</i><span class="s22">prop </span>denote the maximum time it takes signal energy to propagate between any two adapters. Let <i>d</i><span class="s22">trans </span>be the time to transmit a maximum-size frame (approximately 1.2 msecs for a 10 Mbps Ethernet). A derivation</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">of the efficiency of CSMA/CD is beyond the scope of this book (see </a><a href="#bookmark848" class="a">[Lam 1980]</a> <a href="#bookmark848" class="s124">and </a><a href="#bookmark848" class="a">[Bertsekas </a>1991]<span class="p">). Here we simply state the following approximation:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Efficiency=11+5dprop/dtrans</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 140%;text-align: left;">We see from this formula that as <i>d</i><span class="s22">prop </span>approaches 0, the efficiency approaches 1. This matches our intuition that if the propagation delay is zero, colliding nodes will abort immediately without wasting the</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 143%;text-align: left;">channel. Also, as <i>d</i><span class="s22">trans  </span>becomes very large, efficiency approaches 1. This is also intuitive because when a frame grabs the channel, it will hold on to the channel for a very long time; thus, the channel will be doing productive work most of the time.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Taking-Turns Protocols</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Recall that two desirable properties of a multiple access protocol are (1) when only one node is active, the active node has a throughput of <i>R </i>bps, and (2) when <i>M </i>nodes are active, then each active node has a throughput of nearly <i>R</i>/<i>M </i>bps. The ALOHA and CSMA protocols have this first property but not the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">second. This has motivated researchers to create another class of protocols—the <span class="s20">taking-turns</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">protocols<span class="p">. As with random access protocols, there are dozens of taking-turns protocols, and each one of these protocols has many variations. We’ll discuss two of the more important protocols here. The first one is the </span>polling protocol<span class="p">. The polling protocol requires one of the nodes to be designated as a master node. The master node </span>polls <span class="p">each of the nodes in a round-robin fashion. In particular, the master node first sends a message to node 1, saying that it (node 1) can transmit up to some maximum number of frames. After node 1 transmits some frames, the master node tells node 2 it (node 2) can transmit up to the maximum number of frames. (The master node can determine when a node has finished sending its frames by observing the lack of a signal on the channel.) The procedure continues in this manner, with the master node polling each of the nodes in a cyclic manner.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">The polling protocol eliminates the collisions and empty slots that plague random access protocols. This allows polling to achieve a much higher efficiency. But it also has a few drawbacks. The first drawback is that the protocol introduces a polling delay—the amount of time required to notify a node that it can</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a name="bookmark540">transmit. If, for example, only one node is active, then the node will transmit at a rate less than </a><i>R </i>bps, as the master node must poll each of the inactive nodes in turn each time the active node has sent its maximum number of frames. The second drawback, which is potentially more serious, is that if the</p><p class="s20" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark542" class="s124">master node fails, the entire channel becomes inoperative. The 802.15 protocol and the Bluetooth protocol we will study in </a><a href="#bookmark542" class="a">Section 6.3</a> <span class="p">are examples of polling protocols.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The second taking-turns protocol is the <span class="s20">token-passing protocol</span>. In this protocol there is no master node. A small, special-purpose frame known as a <span class="s20">token </span>is exchanged among the nodes in some fixed order. For example, node 1 might always send the token to node 2, node 2 might always send the token</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">to node 3, and node <i>N </i>might always send the token to node 1. When a node receives a token, it holds onto the token only if it has some frames to transmit; otherwise, it immediately forwards the token to the next node. If a node does have frames to transmit when it receives the token, it sends up to a maximum</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">number of frames and then forwards the token to the next node. Token passing is decentralized and highly efficient. But it has its problems as well. For example, the failure of one node can crash the entire channel. Or if a node accidentally neglects to release the token, then some recovery procedure must be invoked to get the token back in circulation. Over the years many token-passing protocols have been</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">developed, including the fiber distributed data interface (FDDI) protocol </a><a href="#bookmark848" class="a">[Jain 1994]</a> <a href="#bookmark848" class="s124">and the IEEE 802.5 token ring protocol </a><a href="#bookmark848" class="a">[IEEE 802.5 2012</a>]<span class="p">, and each one had to address these as well as other sticky issues.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">DOCSIS: The Link-Layer Protocol for Cable Internet Access</p></li></ol></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">In the previous three subsections, we’ve learned about three broad classes of multiple access protocols: channel partitioning protocols, random access protocols, and taking turns protocols. A cable access network will make for an excellent case study here, as we’ll find aspects of <i>each </i>of these three classes</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">of multiple access protocols with the cable access network!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark33" class="s124">Recall from </a><a href="#bookmark33" class="a">Section 1.2.1</a> <span class="p">that a cable access network typically connects several thousand residential cable modems to a cable modem termination system (CMTS) at the cable network headend. The Data-</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">Over-Cable Service Interface Specifications (DOCSIS) </a><a href="#bookmark848" class="a">[DOCSIS 2011]</a> <span class="p">specifies the cable data network architecture and its protocols. DOCSIS uses FDM to divide the downstream (CMTS to modem) and upstream (modem to CMTS) network segments into multiple frequency channels. Each downstream</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">channel is 6 MHz wide, with a maximum throughput of approximately 40 Mbps per channel (although this data rate is seldom seen at a cable modem in practice); each upstream channel has a maximum channel width of 6.4 MHz, and a maximum upstream throughput of approximately 30 Mbps. Each upstream and</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="673" height="344" alt="image" src="计算机网络自顶向下7th-en/Image_634.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark541">Figure 6.14 Upstream and downstream channels between CMTS and cable modems</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">downstream channel is a broadcast channel. Frames transmitted on the downstream channel by the CMTS are received by all cable modems receiving that channel; since there is just a single CMTS transmitting into the downstream channel, however, there is no multiple access problem. The upstream direction, however, is more interesting and technically challenging, since multiple cable modems share the same upstream channel (frequency) to the CMTS, and thus collisions can potentially occur.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark541" class="s124">As illustrated in </a><a href="#bookmark541" class="a">Figure 6.1</a>4<span class="p">, each upstream channel is divided into intervals of time (TDM-like), each containing a sequence of mini-slots during which cable modems can transmit to the CMTS. The CMTS explicitly grants permission to individual cable modems to transmit during specific mini-slots. The CMTS</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">accomplishes this by sending a control message known as a MAP message on a downstream channel to specify which cable modem (with data to send) can transmit during which mini-slot for the interval of time specified in the control message. Since mini-slots are explicitly allocated to cable modems, the CMTS can ensure there are no colliding transmissions during a mini-slot.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark541" class="s124">But how does the CMTS know which cable modems have data to send in the first place? This is accomplished by having cable modems send mini-slot-request frames to the CMTS during a special set of interval mini-slots that are dedicated for this purpose, as shown in </a><a href="#bookmark541" class="a">Figure 6.1</a>4<span class="p">. These mini-slot-</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">request frames are transmitted in a random access manner and so may collide with each other. A cable</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">modem can neither sense whether the upstream channel is busy nor detect collisions. Instead, the cable modem infers that its mini-slot-request frame experienced a collision if it does not receive a response to the requested allocation in the next downstream control message. When a collision is inferred, a cable modem uses binary exponential backoff to defer the retransmission of its mini-slot-request frame to a future time slot. When there is little traffic on the upstream channel, a cable modem may actually transmit data frames during slots nominally assigned for mini-slot-request frames (and thus avoid having</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark542">to wait for a mini-slot assignment).</a><a name="bookmark543">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A cable access network thus serves as a terrific example of multiple access protocols in action—FDM, TDM, random access, and centrally allocated time slots all within one network!</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s18" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark544">6.4 Switched Local Area Networks</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark545" class="s124">Having covered broadcast networks and multiple access protocols in the previous section, let’s turn our attention next to switched local networks. </a><a href="#bookmark545" class="a">Figure 6.15</a> <span class="p">shows a switched local network connecting three</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">departments, two servers and a router with four switches. Because these switches operate at the link layer, they switch link-layer frames (rather than network-layer datagrams), don’t recognize network-layer addresses, and don’t use routing algorithms like RIP or OSPF to determine</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="781" height="500" alt="image" src="计算机网络自顶向下7th-en/Image_635.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark545">Figure 6.15 An institutional network connected together by four switches</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark551" class="s124">paths through the network of layer-2 switches. Instead of using IP addresses, we will soon see that they use link-layer addresses to forward link-layer frames through the network of switches. We’ll begin our study of switched LANs by first covering link-layer addressing (</a><a href="#bookmark551" class="a">Section 6.4.</a>1<span class="p">). We then examine the</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark551" class="s124">celebrated Ethernet protocol (</a><a href="#bookmark551" class="a">Section 6.5.</a>2<span class="p">). After examining link-layer addressing and Ethernet, we’ll</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark558" class="s124">look at how link-layer switches operate (</a><a href="#bookmark558" class="a">Section 6.4.</a>3<a href="#bookmark562" class="s124">), and then see (</a><a href="#bookmark562" class="a">Section 6.4.</a>4<span class="p">) how these switches are often used to build large-scale LANs.</span></p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">6.4.1 Link-Layer Addressing and ARP</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark368" class="s124">Hosts and routers have link-layer addresses. Now you might find this surprising, recalling from </a><a href="#bookmark368" class="a">Chapter 4</a> <span class="p">that hosts and routers have network-layer addresses as well. You might be asking, why in the world do we need to have addresses at both the network and link layers? In addition to describing the syntax</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">and function of the link-layer addresses, in this section we hope to shed some light on why the two layers of addresses are useful and, in fact, indispensable. We’ll also cover the Address Resolution Protocol (ARP), which provides a mechanism to translate IP addresses to link-layer addresses.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">MAC Addresses</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark546" class="s124">In truth, it is not hosts and routers that have link-layer addresses but rather their adapters (that is, network interfaces) that have link-layer addresses. A host or router with multiple network interfaces will thus have multiple link-layer addresses associated with it, just as it would also have multiple IP addresses associated with it. It&#39;s important to note, however, that link-layer switches do not have link- layer addresses associated with their interfaces that connect to hosts and routers. This is because the job of the link-layer switch is to carry datagrams between hosts and routers; a switch does this job transparently, that is, without the host or router having to explicitly address the frame to the intervening switch. This is illustrated in </a><a href="#bookmark546" class="a">Figure 6.1</a>6<span class="p">. A link-layer address is variously called a </span><span class="s23">LAN</span> address<span class="p">, a</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">physical address<span class="p">, or a </span>MAC address<span class="p">. Because MAC address seems to be the most popular term, we’ll</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">henceforth refer to link-layer addresses as MAC addresses. For most LANs (including Ethernet and</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 151%;text-align: left;">802.11 wireless LANs), the MAC address is 6 bytes long, giving 2<span class="s21">48</span><span class="s22"> </span><a href="#bookmark546" class="s124">possible MAC addresses. As shown in </a><a href="#bookmark546" class="a">Figure 6.1</a><span class="s20">6</span>, these 6-byte addresses are typically expressed in hexadecimal notation, with each byte</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">of the address expressed as a pair of hexadecimal numbers. Although MAC addresses were designed</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">to be permanent, it is now possible to change an adapter’s MAC address via software. For the rest of this section, however, we’ll assume that an adapter’s MAC address is fixed.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">One interesting property of MAC addresses is that no two adapters have the same address. This might seem surprising given that adapters are manufactured in many countries by many companies. How does a company manufacturing adapters in Taiwan make sure that it is using different addresses from a company manufacturing</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="360" height="332" alt="image" src="计算机网络自顶向下7th-en/Image_636.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark546">Figure 6.16 Each interface connected to a LAN has a unique MAC address</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 144%;text-align: left;">adapters in Belgium? The answer is that the IEEE manages the MAC address space. In particular, when a company wants to manufacture adapters, it purchases a chunk of the address space consisting of 2<span class="s21">24</span><span class="s22"> </span>addresses for a nominal fee. IEEE allocates the chunk of 2<span class="s21">24</span><span class="s22"> </span>addresses by fixing the first 24 bits of a MAC address and letting the company create unique combinations of the last 24 bits for each adapter.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">An adapter’s MAC address has a flat structure (as opposed to a hierarchical structure) and doesn’t change no matter where the adapter goes. A laptop with an Ethernet interface always has the same MAC address, no matter where the computer goes. A smartphone with an 802.11 interface always has the same MAC address, no matter where the smartphone goes. Recall that, in contrast, IP addresses have a hierarchical structure (that is, a network part and a host part), and a host’s IP addresses needs to be changed when the host moves, i.e., changes the network to which it is attached. An adapter’s MAC address is analogous to a person’s social security number, which also has a flat addressing structure and which doesn’t change no matter where the person goes. An IP address is analogous to a person’s postal address, which is hierarchical and which must be changed whenever a person moves. Just as a person may find it useful to have both a postal address and a social security number, it is useful for a host and router interfaces to have both a network-layer address and a MAC address.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">When an adapter wants to send a frame to some destination adapter, the sending adapter inserts the destination adapter’s MAC address into the frame and then sends the frame into the LAN. As we will soon see, a switch occasionally broadcasts an incoming frame onto all of its interfaces. We’ll see in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark591" class="a">Chapter 7</a> <span class="p">that 802.11 also broadcasts frames. Thus, an adapter may receive a frame that isn’t addressed to it. Thus, when an adapter receives a frame, it will check to see whether the destination MAC address in the frame matches its own MAC address. If there is a match, the adapter extracts the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">enclosed datagram and passes the datagram up the protocol stack. If there isn’t a match, the adapter discards the frame, without passing the network-layer datagram up. Thus, the destination only will be</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">interrupted when the frame is received.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 129%;text-align: left;">However, sometimes a sending adapter <i>does </i>want all the other adapters on the LAN to receive and <i>process </i>the frame it is about to send. In this case, the sending adapter inserts a special MAC <span class="s23">broadcast</span><span class="s20"> address </span>into the destination address field of the frame. For LANs that use 6-byte addresses (such as</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Ethernet and 802.11), the broadcast address is a string of 48 consecutive 1s (that is, FF-FF-FF-FF-FF- FF in hexadecimal notation).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Address Resolution Protocol (ARP)</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Because there are both network-layer addresses (for example, Internet IP addresses) and link-layer addresses (that is, MAC addresses), there is a need to translate between them. For the Internet, this is <span class="s49">the</span> job of the <a href="#bookmark848" class="a">Address Resolution Protocol (ARP) </a><a href="#bookmark848" class="s48">[RFC</a><a href="#bookmark848" class="a"> 826</a><span class="s20">]</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark547" class="s124">To understand the need for a protocol such as ARP, consider the network shown in </a><a href="#bookmark547" class="a">Figure 6.1</a>7<span class="p">. In this simple example, each host and router has a single IP address and single MAC address. As usual, IP addresses are shown in dotted-decimal</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="557" alt="image" src="计算机网络自顶向下7th-en/Image_637.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">PRINCIPLES IN PRACTICE</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">KEEPING THE LAYERS INDEPENDENT</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">There are several reasons why hosts and router interfaces have MAC addresses in addition to network-layer addresses. First, LANs are designed for arbitrary network-layer protocols, not just for IP and the Internet. If adapters were assigned IP addresses rather than “neutral” MAC addresses, then adapters would not easily be able to support other network-layer protocols (for example, IPX or DECnet). Second, if adapters were to use network-layer addresses instead of MAC addresses, the network-layer address would have to be stored in the adapter RAM and reconfigured every time the adapter was moved (or powered up). Another option is to not use any addresses in the adapters and have each adapter pass the data (typically, an IP datagram) of each frame it receives up the protocol stack. The network layer could then check for a matching network-layer address. One problem with this option is that the host would be interrupted by every frame sent on the LAN, including by frames that were destined for other hosts on the same broadcast LAN. In summary, in order for the layers to be largely independent building blocks in a network architecture, different layers need to have their own addressing scheme. We have now seen three types of addresses: host names for the application layer, IP addresses for the network layer, and MAC addresses for the link layer.</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="548" height="330" alt="image" src="计算机网络自顶向下7th-en/Image_638.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark547">Figure 6.17 Each interface on a LAN has an IP address and a MAC address</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">notation and MAC addresses are shown in hexadecimal notation. For the purposes of this discussion, we will assume in this section that the switch broadcasts all frames; that is, whenever a switch receives a frame on one interface, it forwards the frame on all of its other interfaces. In the next section, we will provide a more accurate explanation of how switches operate.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark382" class="s124">Now suppose that the host with IP address 222.222.222.220 wants to send an IP datagram to host 222.222.222.222. In this example, both the source and destination are in the same subnet, in the addressing sense of </a><a href="#bookmark382" class="a">Section 4.3.</a>3<span class="p">. To send a datagram, the source must give its adapter not only the</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">IP datagram but also the MAC address for destination 222.222.222.222. The sending adapter will then</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">construct a link-layer frame containing the destination’s MAC address and send the frame into the LAN.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The important question addressed in this section is, How does the sending host determine the MAC address for the destination host with IP address 222.222.222.222? As you might have guessed, it uses ARP. An ARP module in the sending host takes any IP address on the same LAN as input, and returns the corresponding MAC address. In the example at hand, sending host 222.222.222.220 provides its ARP module the IP address 222.222.222.222, and the ARP module returns the corresponding MAC address 49-BD-D2-C7-56-2A.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark216" class="s124">So we see that ARP resolves an IP address to a MAC address. In many ways it is analogous to DNS (studied in </a><a href="#bookmark216" class="a">Section 2.</a>5<span class="p">), which resolves host names to IP addresses. However, one important difference</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark548">between the two resolvers is that DNS resolves host names for hosts anywhere in the Internet, whereas ARP resolves IP addresses only for hosts and router interfaces on the same subnet. If a node in California were to try to use ARP to resolve the IP address for a node in Mississippi, ARP would return with an error.</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="114" alt="image" src="计算机网络自顶向下7th-en/Image_639.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark549">Figure 6.18 A possible ARP table in 222.222.222.220</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Now that we have explained what ARP does, let’s look at how it works. Each host and router has an</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 136%;text-align: left;"><span class="s23">ARP</span> table <a href="#bookmark549" class="s124">in its memory, which contains mappings of IP addresses to MAC addresses. </a><a href="#bookmark549" class="a">Figure </a>6.18 <span class="p">shows what an ARP table in host 222.222.222.220 might look like. The ARP table also contains a time- to-live (TTL) value, which indicates when each mapping will be deleted from the table. Note that a table</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">does not necessarily contain an entry for every host and router on the subnet; some may have never been entered into the table, and others may have expired. A typical expiration time for an entry is 20 minutes from when an entry is placed in an ARP table.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now suppose that host 222.222.222.220 wants to send a datagram that is IP-addressed to another host or router on that subnet. The sending host needs to obtain the MAC address of the destination given the IP address. This task is easy if the sender’s ARP table has an entry for the destination node. But what if the ARP table doesn’t currently have an entry for the destination? In particular, suppose 222.222.222.220 wants to send a datagram to 222.222.222.222. In this case, the sender uses the ARP protocol to resolve the address. First, the sender constructs a special packet called an <span class="s20">ARP packet</span>. An ARP packet has several fields, including the sending and receiving IP and MAC addresses. Both ARP query and response packets have the same format. The purpose of the ARP query packet is to query all the other hosts and routers on the subnet to determine the MAC address corresponding to the IP address that is being resolved.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Returning to our example, 222.222.222.220 passes an ARP query packet to the adapter along with an indication that the adapter should send the packet to the MAC broadcast address, namely, FF-FF-FF- FF-FF-FF. The adapter encapsulates the ARP packet in a link-layer frame, uses the broadcast address for the frame’s destination address, and transmits the frame into the subnet. Recalling our social security number/postal address analogy, an ARP query is equivalent to a person shouting out in a crowded room of cubicles in some company (say, AnyCorp): “What is the social security number of the person whose postal address is Cubicle 13, Room 112, AnyCorp, Palo Alto, California?” The frame containing the ARP query is received by all the other adapters on the subnet, and (because of the broadcast address) each adapter passes the ARP packet within the frame up to its ARP module. Each of these ARP modules checks to see if its IP address matches the destination IP address in the ARP packet. The one with a match sends back to the querying host a response ARP packet with the desired mapping. The querying host 222.222.222.220 can then update its ARP table and send its IP datagram, encapsulated in a link-layer frame whose destination MAC is that of the host or router responding to the earlier ARP query.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">There are a couple of interesting things to note about the ARP protocol. First, the query ARP message is sent within a broadcast frame, whereas the response ARP message is sent within a standard frame. Before reading on you should think about why this is so. Second, ARP is plug-and-play; that is, an ARP table gets built automatically—it doesn’t have to be configured by a system administrator. And if a host becomes disconnected from the subnet, its entry is eventually deleted from the other ARP tables in the subnet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Students often wonder if ARP is a link-layer protocol or a network-layer protocol. As we’ve seen, an  ARP packet is encapsulated within a link-layer frame and thus lies architecturally above the link layer. However, an ARP packet has fields containing link-layer addresses and thus is arguably a link-layer protocol, but it also contains network-layer addresses and thus is also arguably a network-layer protocol. In the end, ARP is probably best considered a protocol that straddles the boundary between the link and</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark5" class="s124">network layers—not fitting neatly into the simple layered protocol stack we studied in </a><a href="#bookmark5" class="a">Chapter </a>1<span class="p">. Such are the complexities of real-world protocols!</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Sending a Datagram off the Subnet</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">It should now be clear how ARP operates when a host wants to send a datagram to another host <i>on the same subnet. </i>But now let’s look at the more complicated situation when a host on a subnet wants to send a network-layer datagram to a host <i>off the subnet </i><a href="#bookmark550" class="s124">(that is, across a router onto another subnet). Let’s discuss this issue in the context of </a><a href="#bookmark550" class="a">Figure 6.1</a><span class="s20">9</span>, which shows a simple network consisting of two</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">subnets interconnected by a router.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark550" class="s124">There are several interesting things to note about </a><a href="#bookmark550" class="a">Figure 6.1</a>9<a href="#bookmark368" class="s124">. Each host has exactly one IP address and one adapter. But, as discussed in </a><a href="#bookmark368" class="a">Chapter </a>4<span class="p">, a router has an IP address for </span><span class="s17">each </span><span class="p">of its interfaces. For each router interface there is also an ARP module (in the router) and an adapter. Because the</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark550" class="s124">router in </a><a href="#bookmark550" class="a">Figure 6.19</a> <span class="p">has two interfaces, it has two IP addresses, two ARP modules, and two adapters. Of course, each adapter in the network has its own MAC address.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="780" height="203" alt="image" src="计算机网络自顶向下7th-en/Image_640.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark550">Figure 6.19 Two subnets interconnected by a router</a></h2><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark551">Also note that Subnet 1 has the network address 111.111.111/24 and that Subnet 2 has the network address 222.222.222/24. Thus all of the interfaces connected to Subnet 1 have addresses of the form 111.111.111.xxx and all of the interfaces connected to Subnet 2 have addresses of the form 222.222.222.xxx.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now let’s examine how a host on Subnet 1 would send a datagram to a host on Subnet 2. Specifically, suppose that host 111.111.111.111 wants to send an IP datagram to a host 222.222.222.222. The sending host passes the datagram to its adapter, as usual. But the sending host must also indicate to its adapter an appropriate destination MAC address. What MAC address should the adapter use? One might be tempted to guess that the appropriate MAC address is that of the adapter for host 222.222.222.222, namely, 49-BD-D2-C7-56-2A. This guess, however, would be wrong! If the sending adapter were to use that MAC address, then none of the adapters on Subnet 1 would bother to pass</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the IP datagram up to its network layer, since the frame’s destination address would not match the MAC address of any adapter on Subnet 1. The datagram would just die and go to datagram heaven.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark550" class="s124">If we look carefully at </a><a href="#bookmark550" class="a">Figure 6.1</a>9<span class="p">, we see that in order for a datagram to go from 111.111.111.111 to a host on Subnet 2, the datagram must first be sent to the router interface 111.111.111.110, which is the IP address of the first-hop router on the path to the final destination. Thus, the appropriate MAC address</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">for the frame is the address of the adapter for router interface 111.111.111.110, namely, E6-E9-00-17- BB-4B. How does the sending host acquire the MAC address for 111.111.111.110? By using ARP, of course! Once the sending adapter has this MAC address, it creates a frame (containing the datagram addressed to 222.222.222.222) and sends the frame into Subnet 1. The router adapter on Subnet 1 sees that the link-layer frame is addressed to it, and therefore passes the frame to the network layer of the router. Hooray—the IP datagram has successfully been moved from source host to the router! But we are not finished. We still have to move the datagram from the router to the destination. The router now has to determine the correct interface on which the datagram is to be forwarded. As discussed in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark368" class="a">Chapter </a>4<span class="p">, this is done by consulting a forwarding table in the router. The forwarding table tells the router that the datagram is to be forwarded via router interface 222.222.222.220. This interface then passes the datagram to its adapter, which encapsulates the datagram in a new frame and sends the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">frame into Subnet 2. This time, the destination MAC address of the frame is indeed the MAC address of the ultimate destination. And how does the router obtain this destination MAC address? From ARP, of course!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">ARP for Ethernet is defined in RFC 826. A nice introduction to ARP is given in the TCP/IP tutorial, RFC 1180. We’ll explore ARP in more detail in the homework problems.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">6.4.2 Ethernet</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Ethernet has pretty much taken over the wired LAN market. In the 1980s and the early 1990s, Ethernet faced many challenges from other LAN technologies, including token ring, FDDI, and ATM. Some of these other technologies succeeded in capturing a part of the LAN market for a few years. But since its invention in the mid-1970s, Ethernet has continued to evolve and grow and has held on to its dominant position. Today, Ethernet is by far the most prevalent wired LAN technology, and it is likely to remain so for the foreseeable future. One might say that Ethernet has been to local area networking what the Internet has been to global networking.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">There are many reasons for Ethernet’s success. First, Ethernet was the first widely deployed high-speed LAN. Because it was deployed early, network administrators became intimately familiar with Ethernet— its wonders and its quirks—and were reluctant to switch over to other LAN technologies when they came on the scene. Second, token ring, FDDI, and ATM were more complex and expensive than Ethernet, which further discouraged network administrators from switching over. Third, the most compelling reason to switch to another LAN technology (such as FDDI or ATM) was usually the higher data rate of the new technology; however, Ethernet always fought back, producing versions that operated at equal data rates or higher. Switched Ethernet was also introduced in the early 1990s, which further increased its effective data rates. Finally, because Ethernet has been so popular, Ethernet hardware (in particular, adapters and switches) has become a commodity and is remarkably cheap.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The original Ethernet LAN was invented in the mid-1970s by Bob Metcalfe and David Boggs. The original Ethernet LAN used a coaxial bus to interconnect the nodes. Bus topologies for Ethernet actually persisted throughout the 1980s and into the mid-1990s. Ethernet with a bus topology is a broadcast LAN</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">—all transmitted frames travel to and are processed by <i>all </i><a href="#bookmark539" class="s124">adapters connected to the bus. Recall that we covered Ethernet’s CSMA/CD multiple access protocol with binary exponential backoff in </a><a href="#bookmark539" class="a">Section 6.3.</a><span class="s20">2</span>.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">By the late 1990s, most companies and universities had replaced their LANs with Ethernet installations using a hub-based star topology. In such an installation the hosts (and routers) are directly connected to a hub with twisted-pair copper wire. A <span class="s20">hub </span>is a physical-layer device that acts on individual bits rather than frames. When a bit, representing a zero or a one, arrives from one interface, the hub simply re- creates the bit, boosts its energy strength, and transmits the bit onto all the other interfaces. Thus, Ethernet with a hub-based star topology is also a broadcast LAN—whenever a hub receives a bit from one of its interfaces, it sends a copy out on all of its other interfaces. In particular, if a hub receives frames from two different interfaces at the same time, a collision occurs and the nodes that created the frames must retransmit.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the early 2000s Ethernet experienced yet another major evolutionary change. Ethernet installations continued to use a star topology, but the hub at the center was replaced with a <span class="s20">switch</span>. We’ll be examining switched Ethernet in depth later in this chapter. For now, we only mention that a switch is not only “collision-less” but is also a bona-fide store-and-forward packet switch; but unlike routers, which operate up through layer 3, a switch operates only up through layer 2.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="670" height="84" alt="image" src="计算机网络自顶向下7th-en/Image_641.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark552">Figure 6.20 Ethernet frame structure</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Ethernet Frame Structure</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark552" class="s124">We can learn a lot about Ethernet by examining the Ethernet frame, which is shown in </a><a href="#bookmark552" class="a">Figure 6.2</a>0<span class="p">. To give this discussion about Ethernet frames a tangible context, let’s consider sending an IP datagram from one host to another host, with both hosts on the same Ethernet LAN (for example, the Ethernet</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark547" class="s124">LAN in </a><a href="#bookmark547" class="a">Figure 6.1</a>7<span class="p">.) (Although the payload of our Ethernet frame is an IP datagram, we note that an Ethernet frame can carry other network-layer packets as well.) Let the sending adapter, adapter A, have the MAC address AA-AA-AA-AA-AA-AA and the receiving adapter, adapter B, have the MAC address</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">BB-BB-BB-BB-BB-BB. The sending adapter encapsulates the IP datagram within an Ethernet frame and passes the frame to the physical layer. The receiving adapter receives the frame from the physical layer, extracts the IP datagram, and passes the IP datagram to the network layer. In this context, let’s now</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark552" class="s124">examine the six fields of the Ethernet frame, as shown in </a><a href="#bookmark552" class="a">Figure 6.2</a>0<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_642.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Data field (46 to 1,500 bytes). <span class="p">This field carries the IP datagram. The maximum transmission unit (MTU) of Ethernet is 1,500 bytes. This means that if the IP datagram exceeds 1,500 bytes, then the</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark430" class="s124">host has to fragment the datagram, as discussed in </a><a href="#bookmark430" class="a">Section 4.3.</a>2<span class="p">. The minimum size of the data field is 46 bytes. This means that if the IP datagram is less than 46 bytes, the data field has to be “stuffed” to fill it out to 46 bytes. When stuffing is used, the data passed to the network layer contains</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">the stuffing as well as an IP datagram. The network layer uses the length field in the IP datagram header to remove the stuffing.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_643.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Destination address (6 bytes). <span class="p">This field contains the MAC address of the destination adapter, BB- BB-BB-BB-BB-BB. When adapter B receives an Ethernet frame whose destination address is either BB-BB-BB-BB-BB-BB or the MAC broadcast address, it passes the contents of the frame’s data field</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">to the network layer; if it receives a frame with any other MAC address, it discards the frame.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_644.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Source address (6 bytes). <span class="p">This field contains the MAC address of the adapter that transmits the frame onto the LAN, in this example, AA-AA-AA-AA-AA-AA.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_645.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Type field (2 bytes). <span class="p">The type field permits Ethernet to multiplex network-layer protocols. To understand this, we need to keep in mind that hosts can use other network-layer protocols besides IP. In fact, a given host may support multiple network-layer protocols using different protocols for</span></p><p style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">different applications. For this reason, when the Ethernet frame arrives at adapter B, adapter B needs to know to which network-layer protocol it should pass (that is, demultiplex) the contents of  the data field. IP and other network-layer protocols (for example, Novell IPX or AppleTalk) each have their own, standardized type number. Furthermore, the ARP protocol (discussed in the previous</p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">section) has its own type number, and if the arriving frame contains an ARP packet (i.e., has a type field of 0806 hexadecimal), the ARP packet will be demultiplexed up to the ARP protocol. Note that the type field is analogous to the protocol field in the network-layer datagram and the port-number fields in the transport-layer segment; all of these fields serve to glue a protocol at one layer to a protocol at the layer above.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_646.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">Cyclic redundancy check (CRC) (4 bytes). <a href="#bookmark528" class="s124">As discussed in </a><a href="#bookmark528" class="a">Section 6.2.</a><span style=" color: #1E79B8;">3</span><span class="p">, the purpose of the CRC field is to allow the receiving adapter, adapter B, to detect bit errors in the frame.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_647.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">Preamble (8 bytes). <span class="p">The Ethernet frame begins with an 8-byte preamble field. Each of the first 7 bytes of the preamble has a value of 10101010; the last byte is 10101011. The first 7 bytes of the preamble serve to “wake up” the receiving adapters and to synchronize their clocks to that of the</span></p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">sender’s clock. Why should the clocks be out of synchronization? Keep in mind that adapter A aims to transmit the frame at 10 Mbps, 100 Mbps, or 1 Gbps, depending on the type of Ethernet LAN. However, because nothing is absolutely perfect, adapter A will not transmit the frame at exactly the</p><p style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">target rate; there will always be some <i>drift </i>from the target rate, a drift which is not known <i>a priori </i>by the other adapters on the LAN. A receiving adapter can lock onto adapter A’s clock simply by locking onto the bits in the first 7 bytes of the preamble. The last 2 bits of the eighth byte of the preamble</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">(the first two consecutive 1s) alert adapter B that the “important stuff” is about to come.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">All of the Ethernet technologies provide connectionless service to the network layer. That is, when adapter A wants to send a datagram to adapter B, adapter A encapsulates the datagram in an Ethernet frame and sends the frame into the LAN, without first handshaking with adapter B. This layer-2 connectionless service is analogous to IP’s layer-3 datagram service and UDP’s layer-4 connectionless service.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Ethernet technologies provide an unreliable service to the network layer. Specifically, when adapter B receives a frame from adapter A, it runs the frame through a CRC check, but neither sends an acknowledgment when a frame passes the CRC check nor sends a negative acknowledgment when a frame fails the CRC check. When a frame fails the CRC check, adapter B simply discards the frame. Thus, adapter A has no idea whether its transmitted frame reached adapter B and passed the CRC check. This lack of reliable transport (at the link layer) helps to make Ethernet simple and cheap. But it also means that the stream of datagrams passed to the network layer can have gaps.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="240" alt="image" src="计算机网络自顶向下7th-en/Image_648.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">CASE HISTORY</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">BOB METCALFE AND ETHERNET</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">As a PhD student at Harvard University in the early 1970s, Bob Metcalfe worked on the ARPAnet at MIT. During his studies, he also became exposed to Abramson’s work on ALOHA and random access protocols. After completing his PhD and just before beginning a job at Xerox Palo Alto Research Center (Xerox PARC), he visited Abramson and his University of Hawaii colleagues for three months, getting a firsthand look at ALOHAnet. At Xerox PARC, Metcalfe</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="392" alt="image" src="计算机网络自顶向下7th-en/Image_649.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">became exposed to Alto computers, which in many ways were the forerunners of the personal computers of the 1980s. Metcalfe saw the need to network these computers in an inexpensive manner. So armed with his knowledge about ARPAnet, ALOHAnet, and random access protocols, Metcalfe—along with colleague David Boggs—invented Ethernet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Metcalfe and Boggs’s original Ethernet ran at 2.94 Mbps and linked up to 256 hosts separated by up to one mile. Metcalfe and Boggs succeeded at getting most of the researchers at Xerox PARC to communicate through their Alto computers. Metcalfe then forged an alliance between Xerox, Digital, and Intel to establish Ethernet as a 10 Mbps Ethernet standard, ratified by the IEEE. Xerox did not show much interest in commercializing Ethernet. In 1979, Metcalfe formed his own company, 3Com, which developed and commercialized networking technology, including Ethernet technology. In particular, 3Com developed and marketed Ethernet cards in the early 1980s for the immensely popular IBM PCs.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">If there are gaps due to discarded Ethernet frames, does the application at Host B see gaps as well? As</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark254" class="s124">we learned in </a><a href="#bookmark254" class="a">Chapter </a>3<span class="p">, this depends on whether the application is using UDP or TCP. If the application is using UDP, then the application in Host B will indeed see gaps in the data. On the other hand, if the application is using TCP, then TCP in Host B will not acknowledge the data contained in</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">discarded frames, causing TCP in Host A to retransmit. Note that when TCP retransmits data, the data will eventually return to the Ethernet adapter at which it was discarded. Thus, in this sense, Ethernet does retransmit data, although Ethernet is unaware of whether it is transmitting a brand-new datagram with brand-new data, or a datagram that contains data that has already been transmitted at least once.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Ethernet Technologies</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">In our discussion above, we’ve referred to Ethernet as if it were a single protocol standard. But in fact, Ethernet comes in <i>many </i>different flavors, with somewhat bewildering acronyms such as 10BASE-T,</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">10BASE-2, 100BASE-T, 1000BASE-LX, 10GBASE-T and 40GBASE-T. These and many other Ethernet technologies have been standardized over the years by the IEEE 802.3 CSMA/CD (Ethernet) working group </a><a href="#bookmark848" class="a">[IEEE 802.3 </a>2012]<span class="p">. While these acronyms may appear bewildering, there is actually considerable</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">order here. The first part of the acronym refers to the speed of the standard: 10, 100, 1000, or 10G, for</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">10 Megabit (per second), 100 Megabit, Gigabit, 10 Gigabit and 40 Gigibit Ethernet, respectively. “BASE” refers to baseband Ethernet, meaning that the physical media only carries Ethernet traffic; almost all of the 802.3 standards are for baseband Ethernet. The final part of the acronym refers to the physical</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">media itself; Ethernet is both a link-layer <i>and </i>a physical-layer specification and is carried over a variety of physical media including coaxial cable, copper wire, and fiber. Generally, a “T” refers to twisted-pair copper wires.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Historically, an Ethernet was initially conceived of as a segment of coaxial cable. The early 10BASE-2 and 10BASE-5 standards specify 10 Mbps Ethernet over two types of coaxial cable, each limited in</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">length to 500 meters. Longer runs could be obtained by using a <span class="s20">repeater</span>—a physical-layer device that receives a signal on the input side, and regenerates the signal on the output side. A coaxial cable corresponds nicely to our view of Ethernet as a broadcast medium—all frames transmitted by one interface are received at other interfaces, and Ethernet’s CDMA/CD protocol nicely solves the multiple</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">access problem. Nodes simply attach to the cable, and <i>voila</i>, we have a local area network!</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Ethernet has passed through a series of evolutionary steps over the years, and today’s Ethernet is very different from the original bus-topology designs using coaxial cable. In most installations today, nodes are connected to a switch via point-to-point segments made of twisted-pair copper wires or fiber-optic</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark545" class="s124">cables, as shown in </a><a href="#bookmark545" class="a">Figures 6.1</a>5<a href="#bookmark547" class="s124">–</a><a href="#bookmark547" class="a">6.1</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark553" class="s124">In the mid-1990s, Ethernet was standardized at 100 Mbps, 10 times faster than 10 Mbps Ethernet. The original Ethernet MAC protocol and frame format were preserved, but higher-speed physical layers were defined for copper wire (100BASE-T) and fiber (100BASE-FX, 100BASE-SX, 100BASE-BX). </a><a href="#bookmark553" class="a">Figure</a></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark553" class="a">6.21</a> <span class="p">shows these different standards and the common Ethernet MAC protocol and frame format. 100</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Mbps Ethernet is limited to a 100-meter distance over twisted pair, and to</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="575" height="155" alt="image" src="计算机网络自顶向下7th-en/Image_650.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark553">Figure 6.21 100 Mbps Ethernet standards: A common link layer, different physical layers</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 42pt;text-align: left;">several kilometers over fiber, allowing Ethernet switches in different buildings to be connected. Gigabit Ethernet is an extension to the highly successful 10 Mbps and 100 Mbps Ethernet standards.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Offering a raw data rate of 40,000 Mbps, 40 Gigabit Ethernet maintains full compatibility with the huge installed base of Ethernet equipment. The standard for Gigabit Ethernet, referred to as IEEE 802.3z, does the following:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_651.png"/></span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark552" class="s124">Uses the standard Ethernet frame format (</a><a href="#bookmark552" class="a">Figure 6.2</a>0<span class="p">) and is backward compatible with 10BASE-T and 100BASE-T technologies. This allows for easy integration of Gigabit Ethernet with the existing installed base of Ethernet equipment.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_652.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Allows for point-to-point links as well as shared broadcast channels. Point-to-point links use switches while broadcast channels use hubs, as described earlier. In Gigabit Ethernet jargon, hubs are called</p><p class="s17" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">buffered distributors<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_653.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">Uses CSMA/CD for shared broadcast channels. In order to have acceptable efficiency, the</p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark554">maximum distance between nodes must be severely restricted.</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_654.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">Allows for full-duplex operation at 40 Gbps in both directions for point-to-point channels.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Initially operating over optical fiber, Gigabit Ethernet is now able to run over category 5 UTP cabling.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark542" class="s124">Let’s conclude our discussion of Ethernet technology by posing a question that may have begun troubling you. In the days of bus topologies and hub-based star topologies, Ethernet was clearly a broadcast link (as defined in </a><a href="#bookmark542" class="a">Section 6.</a>3<span class="p">) in which frame collisions occurred when nodes transmitted at</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the same time. To deal with these collisions, the Ethernet standard included the CSMA/CD protocol,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">which is particularly effective for a wired broadcast LAN spanning a small geographical region. But if the prevalent use of Ethernet today is a switch-based star topology, using store-and-forward packet switching, is there really a need anymore for an Ethernet MAC protocol? As we’ll see shortly, a switch coordinates its transmissions and never forwards more than one frame onto the same interface at any time. Furthermore, modern switches are full-duplex, so that a switch and a node can each send frames to each other at the same time without interference. In other words, in a switch-based Ethernet LAN there are no collisions and, therefore, there is no need for a MAC protocol!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">As we’ve seen, today’s Ethernets are <i>very </i>different from the original Ethernet conceived by Metcalfe and Boggs more than 30 years ago—speeds have increased by three orders of magnitude, Ethernet frames are carried over a variety of media, switched-Ethernets have become dominant, and now even the MAC</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">protocol is often unnecessary! Is all of this <i>really </i>still Ethernet? The answer, of course, is “yes, by definition.” It is interesting to note, however, that through all of these changes, there has indeed been one enduring constant that has remained unchanged over 30 years—Ethernet’s frame format. Perhaps</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">this then is the one true and timeless centerpiece of the Ethernet standard.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l261"><ol id="l262"><ol id="l263"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Link-Layer Switches</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Up until this point, we have been purposefully vague about what a switch actually does and how it works. The role of the switch is to receive incoming link-layer frames and forward them onto outgoing links; we’ll study this forwarding function in detail in this subsection. We’ll see that the switch itself is <span class="s20">transparent </span>to the hosts and routers in the subnet; that is, a host/router addresses a frame to another host/router (rather than addressing the frame to the switch) and happily sends the frame into the LAN, unaware that a switch will be receiving the frame and forwarding it. The rate at which frames arrive to any one of the switch’s output interfaces may temporarily exceed the link capacity of that interface. To accommodate this problem, switch output interfaces have buffers, in much the same way that router output interfaces have buffers for datagrams. Let’s now take a closer look at how switches operate.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Forwarding and Filtering</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Filtering <span class="p">is the switch function that determines whether a frame should be forwarded to some interface or should just be dropped. </span>Forwarding <span class="p">is the switch function that determines the interfaces to which a frame should be directed, and then moves the frame to those interfaces. Switch filtering and forwarding are done with a </span>switch table<span class="p">. The switch table contains entries for some, but not necessarily all, of the hosts and routers on a LAN. An entry in the switch table contains (1) a MAC address, (2) the switch interface that leads toward that MAC address, and (3) the time at which the entry was placed in the</span></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark545" class="s124">table. An example switch table for the uppermost switch in </a><a href="#bookmark545" class="a">Figure 6.15</a> <a href="#bookmark555" class="s124">is shown in </a><a href="#bookmark555" class="a">Figure 6.2</a>2<span class="p">. This description of frame forwarding may sound similar to our discussion of datagram forwarding</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="148" alt="image" src="计算机网络自顶向下7th-en/Image_655.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark545" style=" color: #575757; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt;" name="bookmark555">Figure 6.22 Portion of a switch table for the uppermost switch in </a><a href="#bookmark545" class="a">Figure 6.15</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark368" class="s124">in </a><a href="#bookmark368" class="a">Chapter </a>4<a href="#bookmark433" class="s124">. Indeed, in our discussion of generalized forwarding in </a><a href="#bookmark433" class="a">Section 4.</a>4<span class="p">, we learned that many modern packet switches can be configured to forward on the basis of layer-2 destination MAC addresses (i.e., function as a layer-2 switch) or layer-3 IP destination addresses (i.e., function as a</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">layer-3 router). Nonetheless, we’ll make the important distinction that switches forward packets based on MAC addresses rather than on IP addresses. We will also see that a traditional (i.e., in a non-SDN context) switch table is constructed in a very different manner from a router’s forwarding table.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">To understand how switch filtering and forwarding work, suppose a frame with destination address DD- DD-DD-DD-DD-DD arrives at the switch on interface <i>x</i>. The switch indexes its table with the MAC</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">address DD-DD-DD-DD-DD-DD. There are three possible cases:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_656.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">There is no entry in the table for DD-DD-DD-DD-DD-DD. In this case, the switch forwards copies of the frame to the output buffers preceding <i>all </i>interfaces except for interface <i>x</i>. In other words, if there is no entry for the destination address, the switch broadcasts the frame.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_657.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">There is an entry in the table, associating DD-DD-DD-DD-DD-DD with interface <i>x</i>. In this case, the frame is coming from a LAN segment that contains adapter DD-DD-DD-DD-DD-DD. There being no need to forward the frame to any of the other interfaces, the switch performs the filtering function by</p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">discarding the frame.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_658.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 143%;text-align: left;">There is an entry in the table, associating DD-DD-DD-DD-DD-DD with interface <span class="s27">y</span>≠x. In this case, the frame needs to be forwarded to the LAN segment attached to interface <i>y</i>. The switch performs its forwarding function by putting the frame in an output buffer that precedes interface <i>y</i>.</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark545" class="s124">Let’s walk through these rules for the uppermost switch in </a><a href="#bookmark545" class="a">Figure 6.15</a> <a href="#bookmark555" class="s124">and its switch table in </a><a href="#bookmark555" class="a">Figure</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l264"><ol id="l265"><li style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><p style="display: inline;">Suppose that a frame with destination address 62-FE-F7-11-89-A3 arrives at the switch from interface 1. The switch examines its table and sees that the destination is on the LAN segment connected to interface 1 (that is, Electrical Engineering). This means that the frame has already been</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">broadcast on the LAN segment that contains the destination. The switch therefore filters (that is, discards) the frame. Now suppose a frame with the same destination address arrives from interface 2. The switch again examines its table and sees that the destination is in the direction of interface 1; it therefore forwards the frame to the output buffer preceding interface 1. It should be clear from this example that as long as the switch table is complete and accurate, the switch forwards frames toward destinations without any broadcasting.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this sense, a switch is “smarter” than a hub. But how does this switch table get configured in the first place? Are there link-layer equivalents to network-layer routing protocols? Or must an overworked manager manually configure the switch table?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Self-Learning</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">A switch has the wonderful property (particularly for the already-overworked network administrator) that its table is built automatically, dynamically, and autonomously—without any intervention from a network administrator or from a configuration protocol. In other words, switches are <span class="s20">self-learning</span>. This capability is accomplished as follows:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l266"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The switch table is initially empty.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 139%;text-align: left;"><p style="display: inline;">For each incoming frame received on an interface, the switch stores in its table (1) the MAC address in the frame’s <i>source address field</i>, (2) the interface from which the frame arrived, and</p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 13pt;text-align: left;">(3) the current time. In this manner the switch records in its table the LAN segment on which the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">sender resides. If every host in the LAN eventually sends a frame, then every host will eventually get recorded in the table.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The switch deletes an address in the table if no frames are received with that address as the source address after some period of time (the <span class="s20">aging time</span>). In this manner, if a PC is replaced by</p></li></ol></li></ol></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">another PC (with a different adapter), the MAC address of the original PC will eventually be purged from the switch table.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark545" class="s124">Let’s walk through the self-learning property for the uppermost switch in </a><a href="#bookmark545" class="a">Figure 6.15</a> <a href="#bookmark555" class="s124">and its corresponding switch table in </a><a href="#bookmark555" class="a">Figure 6.2</a>2<span class="p">. Suppose at time 9:39 a frame with source address 01-12-23- 34-45-56 arrives from interface 2. Suppose that this address is not in the switch table. Then the switch</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark556" class="s124">adds a new entry to the table, as shown in </a><a href="#bookmark556" class="a">Figure 6.2</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Continuing with this same example, suppose that the aging time for this switch is 60 minutes, and no frames with source address 62-FE-F7-11-89-A3 arrive to the switch between 9:32 and 10:32. Then at</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">time 10:32, the switch removes this address from its table.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="182" alt="image" src="计算机网络自顶向下7th-en/Image_659.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark556">Figure 6.23 Switch learns about the location of an adapter with address 01-12-23-34-45-56</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Switches are <span class="s20">plug-and-play devices </span>because they require no intervention from a network administrator or user. A network administrator wanting to install a switch need do nothing more than connect the LAN segments to the switch interfaces. The administrator need not configure the switch tables at the time of installation or when a host is removed from one of the LAN segments. Switches are also full-duplex, meaning any switch interface can send and receive at the same time.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Properties of Link-Layer Switching</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having described the basic operation of a link-layer switch, let’s now consider their features and properties. We can identify several advantages of using switches, rather than broadcast links such as buses or hub-based star topologies:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_660.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Elimination of collisions. <span class="p">In a LAN built from switches (and without hubs), there is no wasted bandwidth due to collisions! The switches buffer frames and never transmit more than one frame on a segment at any one time. As with a router, the maximum aggregate throughput of a switch is the</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">sum of all the switch interface rates. Thus, switches provide a significant performance improvement over LANs with broadcast links.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_661.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Heterogeneous links. <span class="p">Because a switch isolates one link from another, the different links in the LAN can operate at different speeds and can run over different media. For example, the uppermost</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark545" class="s124">switch in </a><a href="#bookmark545" class="a">Figure 6.15</a> <span class="p">might have three1 Gbps 1000BASE-T copper links, two 100 Mbps 100BASE- FX fiber links, and one 100BASE-T copper link. Thus, a switch is ideal for mixing legacy equipment with new equipment.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_662.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Management. <span class="p">In addition to providing enhanced security (see sidebar on Focus on Security), a switch also eases network management. For example, if an adapter malfunctions and continually sends Ethernet frames (called a jabbering adapter), a switch can detect the problem and internally</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: justify;">disconnect the malfunctioning adapter. With this feature, the network administrator need not get out of bed and drive back to work in order to correct the problem. Similarly, a cable cut disconnects only that host that was using the cut cable to connect to the switch. In the days of coaxial cable, many a</p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">network manager spent hours “walking the line” (or more accurately, “crawling the floor”) to find the cable break that brought down the entire network. Switches also gather statistics on bandwidth usage, collision rates, and traffic types, and make this information available to the network manager. This information can be used to debug and correct problems, and to plan how the LAN should evolve in the future. Researchers are exploring adding yet more management functionality into</p><p class="s20" style="padding-top: 2pt;padding-left: 27pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">Ethernet LANs in prototype deployments </a><a href="#bookmark848" class="a">[Casado </a>2007<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Koponen 2011</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="557" alt="image" src="计算机网络自顶向下7th-en/Image_663.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">FOCUS ON SECURITY</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">SNIFFING A SWITCHED LAN: SWITCH POISONING</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark547" class="s124">When a host is connected to a switch, it typically only receives frames that are intended for it. For example, consider a switched LAN in </a><a href="#bookmark547" class="a">Figure 6.1</a><span class="s20">7</span>. When host A sends a frame to host B, and there is an entry for host B in the switch table, then the switch will forward the frame <i>only </i>to</p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 11pt;text-align: left;">host B. If host C happens to be running a sniffer, host C will not be able to sniff this A-to-B</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;">frame. Thus, in a switched-LAN environment (in contrast to a broadcast link environment such as 802.11 LANs or hub–based Ethernet LANs), it is more difficult for an attacker to sniff frames. <i>However</i>, because the switch broadcasts frames that have destination addresses that are not in</p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the switch table, the sniffer at C can still sniff some frames that are not intended for C.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Furthermore, a sniffer will be able sniff all Ethernet broadcast frames with broadcast destination address FF–FF–FF–FF–FF–FF. A well-known attack against a switch, called <span class="s20">switch poisoning</span>, is to send tons of packets to the switch with many different bogus source MAC addresses, thereby filling the switch table with bogus entries and leaving no room for the MAC addresses of the legitimate hosts. This causes the switch to broadcast most frames, which can then be picked</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">up by the sniffer </a><a href="#bookmark848" class="a">[Skoudis 2006</a>]<span class="p">. As this attack is rather involved even for a sophisticated attacker, switches are significantly less vulnerable to sniffing than are hubs and wireless LANs.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Switches Versus Routers</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark368" class="s124">As we learned in </a><a href="#bookmark368" class="a">Chapter </a>4<span class="p">, routers are store-and-forward packet switches that forward packets using network-layer addresses. Although a switch is also a store-and-forward packet switch, it is fundamentally different from a router in that it forwards packets using MAC addresses. Whereas a router</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">is a layer-3 packet switch, a switch is a layer-2 packet switch. Recall, however, that we learned in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark433" class="a">Section 4.4</a> <span class="p">that modern switches using the “match plus action” operation can be used to forward a layer-2 frame based on the frame&#39;s destination MAC address, as well as a layer-3 datagram using the datagram&#39;s destination IP address. Indeed, we saw that switches using the OpenFlow standard can</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">perform generalized packet forwarding based on any of eleven different frame, datagram, and transport- layer header fields.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark545" class="s124">Even though switches and routers are fundamentally different, network administrators must often choose between them when installing an interconnection device. For example, for the network in </a><a href="#bookmark545" class="a">Figure 6.1</a>5<span class="p">, the network administrator could just as easily have used a router instead of a switch to connect the</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">department LANs, servers, and internet gateway router. Indeed, a router would permit interdepartmental</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">communication without creating collisions. Given that both switches and routers are candidates for interconnection devices, what are the pros and cons of the two approaches?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="665" height="253" alt="image" src="计算机网络自顶向下7th-en/Image_664.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark557">Figure 6.24 Packet processing in switches, routers, and hosts</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark557" class="s124">First consider the pros and cons of switches. As mentioned above, switches are plug-and-play, a property that is cherished by all the overworked network administrators of the world. Switches can also have relatively high filtering and forwarding rates—as shown in </a><a href="#bookmark557" class="a">Figure 6.2</a>4<span class="p">, switches have to process</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">frames only up through layer 2, whereas routers have to process datagrams up through layer 3. On the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">other hand, to prevent the cycling of broadcast frames, the active topology of a switched network is restricted to a spanning tree. Also, a large switched network would require large ARP tables in the hosts and routers and would generate substantial ARP traffic and processing. Furthermore, switches are susceptible to broadcast storms—if one host goes haywire and transmits an endless stream of Ethernet broadcast frames, the switches will forward all of these frames, causing the entire network to collapse.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">Now consider the pros and cons of routers. Because network addressing is often hierarchical (and not flat, as is MAC addressing), packets do not normally cycle through routers even when the network has redundant paths. (However, packets can cycle when router tables are misconfigured; but as we learned</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark368" class="s124">in </a><a href="#bookmark368" class="a">Chapter </a>4<span class="p">, IP uses a special datagram header field to limit the cycling.) Thus, packets are not restricted to a spanning tree and can use the best path between source and destination. Because routers do not have the spanning tree restriction, they have allowed the Internet to be built with a rich</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">topology that includes, for example, multiple active links between Europe and North America. Another feature of routers is that they provide firewall protection against layer-2 broadcast storms. Perhaps the most significant drawback of routers, though, is that they are not plug-and-play—they and the hosts that connect to them need their IP addresses to be configured. Also, routers often have a larger per-packet processing time than switches, because they have to process up through the layer-3 fields. Finally, there</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark558">are two different ways to pronounce the word </a><i>router</i><a href="#bookmark848" class="s124">, either as “rootor” or as “rowter,” and people waste a lot of time arguing over the proper pronunciation </a><a href="#bookmark848" class="a">[Perlman </a><span class="s20">1999]</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark559" class="s124">Given that both switches and routers have their pros and cons (as summarized in </a><a href="#bookmark559" class="a">Table 6.</a>1<span class="p">), when should an institutional network (for example, a university campus</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><h2 style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark559">Table 6.1 Comparison of the typical features of popular interconnection devices</a></h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Hubs</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Routers</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Switches</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Traffic isolation</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">No</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Yes</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Yes</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Plug and play</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Yes</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">No</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Yes</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Optimal routing</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">No</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Yes</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">No</p></td></tr></table><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">network or a corporate campus network) use switches, and when should it use routers? Typically, small networks consisting of a few hundred hosts have a few LAN segments. Switches suffice for these small networks, as they localize traffic and increase aggregate throughput without requiring any configuration of IP addresses. But larger networks consisting of thousands of hosts typically include routers within the network (in addition to switches). The routers provide a more robust isolation of traffic, control broadcast storms, and use more “intelligent” routes among the hosts in the network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">For more discussion of the pros and cons of switched versus routed networks, as well as a discussion of how switched LAN technology can be extended to accommodate two orders of magnitude more hosts than today’s Ethernets, see </a><a href="#bookmark848" class="a">[Meyers </a>2004<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Kim 2008</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Virtual Local Area Networks (VLANs)</p></li></ol></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark545" class="s124">In our earlier discussion of </a><a href="#bookmark545" class="a">Figure 6.1</a>5<span class="p">, we noted that modern institutional LANs are often configured hierarchically, with each workgroup (department) having its own switched LAN connected to the switched LANs of other groups via a switch hierarchy. While such a configuration works well in an ideal</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">world, the real world is often far from ideal. Three drawbacks can be identified in the configuration in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark545" class="a">Figure 6.1</a>5<span class="p">:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_665.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">Lack of traffic isolation. <span class="p">Although the hierarchy localizes group traffic to within a single switch, broadcast traffic (e.g., frames carrying ARP and DHCP messages or frames whose destination has not yet been learned by a self-learning switch) must still traverse the entire institutional network.</span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">Limiting the scope of such broadcast traffic would improve LAN performance. Perhaps more importantly, it also may be desirable to limit LAN broadcast traffic for security/privacy reasons. For example, if one group contains the company’s executive management team and another group contains disgruntled employees running Wireshark packet sniffers, the network manager may well prefer that the executives’ traffic never even reaches employee hosts. This type of isolation could be</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark545" class="s124">provided by replacing the center switch in </a><a href="#bookmark545" class="a">Figure 6.15</a> <span class="p">with a router. We’ll see shortly that this isolation also can be achieved via a switched (layer 2) solution.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_666.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">Inefficient use of switches. <span class="p">If instead of three groups, the institution had 10 groups, then 10 first- level switches would be required. If each group were small, say less than 10 people, then a single 96-port switch would likely be large enough to accommodate everyone, but this single switch would</span></p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">not provide traffic isolation.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_667.png"/></span></p><p class="s28" style="padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">Managing users. <a href="#bookmark545" class="s124">If an employee moves between groups, the physical cabling must be changed to connect the employee to a different switch in </a><a href="#bookmark545" class="a">Figure 6.1</a><span style=" color: #1E79B8;">5</span><span class="p">. Employees belonging to two groups make the problem even harder.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;">Fortunately, each of these difficulties can be handled by a switch that supports <span class="s20">virtual local area </span><span class="s23">networks</span><span class="s20"> (VLANs)</span>. As the name suggests, a switch that supports VLANs allows multiple <i>virtual </i>local area networks to be defined over a single <i>physical </i>local area network infrastructure. Hosts within a VLAN communicate with each other as if they (and no other hosts) were connected to the switch. In a</p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark560" class="s124">port-based VLAN, the switch’s ports (interfaces) are divided into groups by the network manager. Each group constitutes a VLAN, with the ports in each VLAN forming a broadcast domain (i.e., broadcast traffic from one port can only reach other ports in the group). </a><a href="#bookmark560" class="a">Figure 6.25</a> <span class="p">shows a single switch with 16</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">ports. Ports 2 to 8 belong to the EE VLAN, while ports 9 to 15 belong to the CS VLAN (ports 1 and 16</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">are unassigned). This VLAN solves all of the difficulties noted above—EE and CS VLAN frames are</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark545" class="s124">isolated from each other, the two switches in </a><a href="#bookmark545" class="a">Figure 6.15</a> <span class="p">have been replaced by a single switch, and if the user at switch port 8 joins the CS Department, the network operator simply reconfigures the VLAN software so that port 8 is now associated with the CS VLAN. One can easily imagine how the VLAN</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">switch is configured and operates—the network manager declares a port to belong</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="441" height="277" alt="image" src="计算机网络自顶向下7th-en/Image_668.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Figure 6.25 A single switch with two configured VLANs</h2><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark560">to a given VLAN (with undeclared ports belonging to a default VLAN) using switch management software, a table of port-to-VLAN mappings is maintained within the switch; and switch hardware only delivers frames between ports belonging to the same VLAN.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark560" class="s124">But by completely isolating the two VLANs, we have introduced a new difficulty! How can traffic from the EE Department be sent to the CS Department? One way to handle this would be to connect a VLAN switch port (e.g., port 1 in </a><a href="#bookmark560" class="a">Figure 6.2</a>5<span class="p">) to an external router and configure that port to belong both the</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">EE and CS VLANs. In this case, even though the EE and CS departments share the same physical</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">switch, the logical configuration would look as if the EE and CS departments had separate switches connected via a router. An IP datagram going from the EE to the CS department would first cross the EE VLAN to reach the router and then be forwarded by the router back over the CS VLAN to the CS host. Fortunately, switch vendors make such configurations easy for the network manager by building a</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">single device that contains both a VLAN switch <i>and </i>a router, so a separate external router is not needed. A homework problem at the end of the chapter explores this scenario in more detail.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark545" class="s124">Returning again to </a><a href="#bookmark545" class="a">Figure 6.1</a>5<span class="p">, let’s now suppose that rather than having a separate Computer Engineering department, some EE and CS faculty are housed in a separate building, where (of course!)</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark563" class="s124">they need network access, and (of course!) they’d like to be part of their department’s VLAN. </a><a href="#bookmark563" class="a">Figure</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark563" class="a">6.26</a> <span class="p">shows a second 8-port switch, where the switch ports have been defined as belonging to the EE or the CS VLAN, as needed. But how should these two switches be interconnected? One easy solution would be to define a port belonging to the CS VLAN on each switch (similarly for the EE VLAN) and to</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark563" class="s124">connect these ports to each other, as shown in </a><a href="#bookmark563" class="a">Figure 6.26(a</a><span class="s20">)</span>. This solution doesn’t scale, however, since <i>N </i>VLANS would require <i>N </i>ports on each switch simply to interconnect the two switches.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><span class="p">A more scalable approach to interconnecting VLAN switches is known as </span>VLAN trunking<a href="#bookmark563" class="s124">. In the VLAN trunking approach shown in </a><a href="#bookmark563" class="a">Figure 6.26</a>(b)<span class="p">, a special port on each switch (port 16 on the left switch and</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">port 1 on the right switch) is configured as a trunk port to interconnect the two VLAN switches. The trunk port belongs to all VLANs, and frames sent to any VLAN are forwarded over the trunk link to the other switch. But this raises yet another question: How does a switch know that a frame arriving on a trunk port belongs to a particular VLAN? The IEEE has defined an extended Ethernet frame format, 802.1Q,</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark564" class="s124">for frames crossing a VLAN trunk. As shown in </a><a href="#bookmark564" class="a">Figure 6.2</a>7<span class="p">, the 802.1Q frame consists of the standard Ethernet frame with a four-byte </span>VLAN tag <span class="p">added into the header that carries the identity of the VLAN to which the frame belongs. The VLAN tag is added into a frame by the switch at the sending side of a</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">VLAN trunk, parsed, and removed by the switch at the receiving side of the trunk. The VLAN tag itself consists of a 2-byte Tag Protocol Identifier (TPID) field (with a fixed hexadecimal value of 81-00), a 2- byte Tag Control Information field that contains a 12-bit VLAN identifier field, and a 3-bit priority field that is similar in intent to the IP datagram TOS field.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="655" height="160" alt="image" src="计算机网络自顶向下7th-en/Image_669.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark561">Figure 6.26 Connecting two VLAN switches with two VLANs: (a) two cables (b) trunked</a><a name="bookmark562">&zwnj;</a><a name="bookmark563">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="750" height="257" alt="image" src="计算机网络自顶向下7th-en/Image_670.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="771" height="224" alt="image" src="计算机网络自顶向下7th-en/Image_671.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark564">Figure 6.27 Original Ethernet frame (top), 802.1Q-tagged Ethernet VLAN frame (below)</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this discussion, we’ve only briefly touched on VLANs and have focused on port-based VLANs. We should also mention that VLANs can be defined in several other ways. In MAC-based VLANs, the network manager specifies the set of MAC addresses that belong to each VLAN; whenever a device attaches to a port, the port is connected into the appropriate VLAN based on the MAC address of the device. VLANs can also be defined based on network-layer protocols (e.g., IPv4, IPv6, or Appletalk) and other criteria. It is also possible for VLANs to be extended across IP routers, allowing islands of LANs to</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark842" class="s124">be connected together to form a single VLAN that could span the globe </a><a href="#bookmark842" class="a">[Yu 2011</a>]<a href="#bookmark848" class="s124">. See the 802.1Q standard </a><a href="#bookmark848" class="a">[IEEE 802.1q 2005]</a> <span class="p">for more details.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s18" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark565">6.5 Link Virtualization: A Network as a Link Layer</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">Because this chapter concerns link-layer protocols, and given that we’re now nearing the chapter’s end, let’s reflect on how our understanding of the term <i>link </i>has evolved. We began this chapter by viewing</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">the link as a physical wire connecting two communicating hosts. In studying multiple access protocols, we saw that multiple hosts could be connected by a shared wire and that the “wire” connecting the hosts could be radio spectra or other media. This led us to consider the link a bit more abstractly as a channel,</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark545" class="s124">rather than as a wire. In our study of Ethernet LANs (</a><a href="#bookmark545" class="a">Figure 6.1</a>5<span class="p">) we saw that the interconnecting media could actually be a rather complex switched infrastructure. Throughout this evolution, however, the hosts themselves maintained the view that the interconnecting medium was simply a link-layer</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark547" class="s124">channel connecting two or more hosts. We saw, for example, that an Ethernet host can be blissfully unaware of whether it is connected to other LAN hosts by a single short LAN segment (</a><a href="#bookmark547" class="a">Figure 6.1</a>7<a href="#bookmark545" class="s124">) or by a geographically dispersed switched LAN (</a><a href="#bookmark545" class="a">Figure 6.1</a>5<a href="#bookmark563" class="s124">) or by a VLAN (</a><a href="#bookmark563" class="a">Figure 6.2</a>6<span class="p">).</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the case of a dialup modem connection between two hosts, the link connecting the two hosts is actually the telephone network—a logically separate, global telecommunications network with its own switches, links, and protocol stacks for data transfer and signaling. From the Internet link-layer point of view, however, the dial-up connection through the telephone network is viewed as a simple “wire.” In this sense, the Internet virtualizes the telephone network, viewing the telephone network as a link-layer technology providing link-layer connectivity between two Internet hosts. You may recall from our</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark138" class="s124">discussion of overlay networks in </a><a href="#bookmark138" class="a">Chapter 2</a> <span class="p">that an overlay network similarly views the Internet as a means for providing connectivity between overlay nodes, seeking to overlay the Internet in the same way that the Internet overlays the telephone network.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section, we’ll consider Multiprotocol Label Switching (MPLS) networks. Unlike the circuit-switched telephone network, MPLS is a packet-switched, virtual-circuit network in its own right. It has its own packet formats and forwarding behaviors. Thus, from a pedagogical viewpoint, a discussion of MPLS fits well into a study of either the network layer or the link layer. From an Internet viewpoint, however, we can consider MPLS, like the telephone network and switched-Ethernets, as a link-layer technology that serves to interconnect IP devices. Thus, we’ll consider MPLS in our discussion of the link layer. Frame- relay and ATM networks can also be used to interconnect IP devices, though they represent a slightly</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">older (but still deployed) technology and will not be covered here; see the very readable book </a><a href="#bookmark848" class="a">[Goralski 1999]</a> <a href="#bookmark848" class="s124">for details. Our treatment of MPLS will be necessarily brief, as entire books could be (and have been) written on these networks. We recommend </a><a href="#bookmark848" class="a">[Davie 2000]</a> <span class="p">for details on MPLS. We’ll focus here</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">primarily on how MPLS servers interconnect to IP devices, although we’ll dive a bit deeper into the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">underlying technologies as well.</p><p class="s19" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">6.5.1 Multiprotocol Label Switching (MPLS)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Multiprotocol Label Switching (MPLS) evolved from a number of industry efforts in the mid-to-late 1990s to improve the forwarding speed of IP routers by adopting a key concept from the world of virtual-circuit networks: a fixed-length label. The goal was not to abandon the destination-based IP datagram- forwarding infrastructure for one based on fixed-length labels and virtual circuits, but to augment it by selectively labeling datagrams and allowing routers to forward datagrams based on fixed-length labels (rather than destination IP addresses) when possible. Importantly, these techniques work hand-in-hand</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">with IP, using IP addressing and routing. The IETF unified these efforts in the MPLS protocol </a><a href="#bookmark848" class="a">[RFC </a>3031<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">RFC 3032</a>]<span class="p">, effectively blending VC techniques into a routed datagram network.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark566" class="s124">Let’s begin our study of MPLS by considering the format of a link-layer frame that is handled by an MPLS-capable router. </a><a href="#bookmark566" class="a">Figure 6.28</a> <span class="p">shows that a link-layer frame transmitted between MPLS-capable</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">devices has a small MPLS header added between the layer-2 (e.g., Ethernet) header and layer-3 (i.e., IP) header. RFC 3032 defines the format of the MPLS header for such links; headers are defined for ATM and frame-relayed networks as well in other RFCs. Among the fields in the MPLS</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="670" height="143" alt="image" src="计算机网络自顶向下7th-en/Image_672.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark566">Figure 6.28 MPLS header: Located between link- and network-layer headers</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">header are the label, 3 bits reserved for experimental use, a single S bit, which is used to indicate the end of a series of “stacked” MPLS headers (an advanced topic that we’ll not cover here), and a time-to- live field.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark566" class="s124">It’s immediately evident from </a><a href="#bookmark566" class="a">Figure 6.28</a> <span class="p">that an MPLS-enhanced frame can only be sent between routers that are both MPLS capable (since a non-MPLS-capable router would be quite confused when it found an MPLS header where it had expected to find the IP header!). An MPLS-capable router is often</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">referred to as a <b>label-switched router</b>, since it forwards an MPLS frame by looking up the MPLS label in its forwarding table and then immediately passing the datagram to the appropriate output interface.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">Thus, the MPLS-capable router need <i>not </i>extract the destination IP address and perform a lookup of the longest prefix match in the forwarding table. But how does a router know if its neighbor is indeed MPLS capable, and how does a router know what label to associate with the given IP destination? To answer</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">these questions, we’ll need to take a look at the interaction among a group of MPLS-capable routers.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark567" class="s124">In the example in </a><a href="#bookmark567" class="a">Figure 6.2</a>9<span class="p">, routers R1 through R4 are MPLS capable. R5 and R6 are standard IP routers. R1 has advertised to R2 and R3 that it (R1) can route to destination A, and that a received frame with MPLS label 6 will be forwarded to destination A. Router R3 has advertised to router R4 that it</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">can route to destinations A and D, and that incoming frames with MPLS labels 10 and 12, respectively, will be switched toward those destinations. Router R2 has also advertised to router R4 that it (R2) can reach destination A, and that a received frame with MPLS label 8 will be switched toward A. Note that router R4 is now in the interesting position of having</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="405" alt="image" src="计算机网络自顶向下7th-en/Image_673.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark567">Figure 6.29 MPLS-enhanced forwarding</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark567" class="s124">two MPLS paths to reach A: via interface 0 with outbound MPLS label 10, and via interface 1 with an MPLS label of 8. The broad picture painted in </a><a href="#bookmark567" class="a">Figure 6.29</a> <span class="p">is that IP devices R5, R6, A, and D are</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;">connected together via an MPLS infrastructure (MPLS-capable routers R1, R2, R3, and R4) in much the same way that a switched LAN or an ATM network can connect together IP devices. And like a switched LAN or ATM network, the MPLS-capable routers R1 through R4 do so <i>without ever touching the IP</i></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">header of a packet<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">In our discussion above, we’ve not specified the specific protocol used to distribute labels among the MPLS-capable routers, as the details of this signaling are well beyond the scope of this book. We note, however, that the IETF working group on MPLS has specified in </a><a href="#bookmark848" class="a">[RFC 3468]</a> <span class="p">that an extension of the</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark848" class="s124">RSVP protocol, known as RSVP-TE </a><a href="#bookmark848" class="a">[RFC </a>3209]<span class="p">, will be the focus of its efforts for MPLS signaling.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We’ve also not discussed how MPLS actually computes the paths for packets among MPLS capable routers, nor how it gathers link-state information (e.g., amount of link bandwidth unreserved by MPLS) to</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;"><a name="bookmark568">use in these path computations. Existing link-state routing algorithms (e.g., OSPF) have been extended to flood this information to MPLS-capable routers. Interestingly, the actual path computation algorithms are not standardized, and are currently vendor-specific.</a><a name="bookmark569">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Thus far, the emphasis of our discussion of MPLS has been on the fact that MPLS performs switching based on labels, without needing to consider the IP address of a packet. The true advantages of MPLS and the reason for current interest in MPLS, however, lie not in the potential increases in switching speeds, but rather in the new traffic management capabilities that MPLS enables. As noted above, R4</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">has <i>two </i><a href="#bookmark444" class="s124">MPLS paths to A. If forwarding were performed up at the IP layer on the basis of IP address, the IP routing protocols we studied in </a><a href="#bookmark444" class="a">Chapter 5</a><span class="s20"> </span>would specify only a single, least-cost path to A. Thus, MPLS provides the ability to forward packets along routes that would not be possible using standard IP</p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;"><span class="p">routing protocols. This is one simple form of </span><span class="s23">traffic</span> engineering <a href="#bookmark848" class="s124">using MPLS </a><a href="#bookmark848" class="a">[RFC </a>3346<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 327</a>2<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC </a>2702<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Xiao 2000</a>]<span class="p">, in which a network operator can override normal IP routing and force some of the traffic headed toward a given destination along one path, and other traffic destined toward the same destination along another path (whether for policy, performance, or some other reason).</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">It is also possible to use MPLS for many other purposes as well. It can be used to perform fast restoration of MPLS forwarding paths, e.g., to reroute traffic over a precomputed failover path in response to link failure </a><a href="#bookmark848" class="a">[Kar </a>2000<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Huang 200</a>2<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 3469</a>]<span class="p">. Finally, we note that MPLS can, and has,</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">been used to implement so-called <span class="s20">virtual private networks </span>(VPNs). In implementing a VPN for a</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark848" class="s124">customer, an ISP uses its MPLS-enabled network to connect together the customer’s various networks. MPLS can be used to isolate both the resources and addressing used by the customer’s VPN from that of other users crossing the ISP’s network; see </a><a href="#bookmark848" class="a">[DeClercq 2002]</a> <span class="p">for details.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Our discussion of MPLS has been brief, and we encourage you to consult the references we’ve mentioned. We note that with so many possible uses for MPLS, it appears that it is rapidly becoming the Swiss Army knife of Internet traffic engineering!</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l267"><ol id="l268"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark570">Data Center Networking</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In recent years, Internet companies such as Google, Microsoft, Facebook, and Amazon (as well as their counterparts in Asia and Europe) have built massive data centers, each housing tens to hundreds</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">of thousands of hosts, and concurrently supporting many distinct cloud applications (e.g., search, e-mail, social networking, and e-commerce). Each data center has its own <span class="s20">data center network </span>that interconnects its hosts with each other and interconnects the data center with the Internet. In this section, we provide a brief introduction to data center networking for cloud applications.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The cost of a large data center is huge, exceeding $12 million per month for a 100,000 host data center</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="a">[Greenberg </a>2009a]<span class="p">. Of these costs, about 45 percent can be attributed to the hosts themselves (which need to be replaced every 3–4 years); 25 percent to infrastructure, including transformers, uninterruptable power supplies (UPS) systems, generators for long-term outages, and cooling systems;</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">15 percent for electric utility costs for the power draw; and 15 percent for networking, including network gear (switches, routers and load balancers), external links, and transit traffic costs. (In these percentages, costs for equipment are amortized so that a common cost metric is applied for one-time purchases and ongoing expenses such as power.) While networking is not the largest cost, networking</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">innovation is the key to reducing overall cost and maximizing performance </a><a href="#bookmark848" class="a">[Greenberg </a>2009a]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The worker bees in a data center are the hosts: They serve content (e.g., Web pages and videos), store e-mails and documents, and collectively perform massively distributed computations (e.g., distributed index computations for search engines). The hosts in data centers, called <span class="s20">blades </span>and resembling pizza boxes, are generally commodity hosts that include CPU, memory, and disk storage. The hosts are stacked in racks, with each rack typically having 20 to 40 blades. At the top of each rack there is a switch, aptly named the <span class="s20">Top of Rack (TOR) switch</span>, that interconnects the hosts in the rack with each other and with other switches in the data center. Specifically, each host in the rack has a network interface card that connects to its TOR switch, and each TOR switch has additional ports that can be connected to other switches. Today hosts typically have 40 Gbps Ethernet connections to their TOR</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">switches </a><a href="#bookmark848" class="a">[Greenberg </a>2015]<span class="p">. Each host is also assigned its own data-center-internal IP address.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The data center network supports two types of traffic: traffic flowing between external clients and internal hosts and traffic flowing between internal hosts. To handle flows between external clients and internal hosts, the data center network includes one or more <span class="s20">border routers</span>, connecting the data center network to the public Internet. The data center network therefore interconnects the racks with each other</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark571" class="s124">and connects the racks to the border routers. </a><a href="#bookmark571" class="a">Figure 6.30</a> <span class="p">shows an example of a data center network. </span>Data center network design<span class="p">, the art of designing the interconnection network and protocols that connect the racks with each other and with the border routers, has become an important branch of</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">computer networking research in recent years </a><a href="#bookmark848" class="a">[Al-Fares </a>2008<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Greenberg 2009</a>a<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Greenberg 2009</a>b<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Mysore </a>2009<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Guo 200</a>9<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Wang 2010</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="787" height="479" alt="image" src="计算机网络自顶向下7th-en/Image_674.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark571">Figure 6.30 A data center network with a hierarchical topology</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Load Balancing</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A cloud data center, such as a Google or Microsoft data center, provides many applications concurrently, such as search, e-mail, and video applications. To support requests from external clients, each application is associated with a publicly visible IP address to which clients send their requests and from which they receive responses. Inside the data center, the external requests are first directed to a <span class="s20">load balancer </span>whose job it is to distribute requests to the hosts, balancing the load across the hosts as a function of their current load. A large data center will often have several load balancers, each one devoted to a set of specific cloud applications. Such a load balancer is sometimes referred to as a “layer-4 switch” since it makes decisions based on the destination port number (layer 4) as well as destination IP address in the packet. Upon receiving a request for a particular application, the load balancer forwards it to one of the hosts that handles the application. (A host may then invoke the services of other hosts to help process the request.) When the host finishes processing the request, it sends its response back to the load balancer, which in turn relays the response back to the external client. The load balancer not only balances the work load across hosts, but also provides a NAT-like</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">function, translating the public external IP address to the internal IP address of the appropriate host, and</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">then translating back for packets traveling in the reverse direction back to the clients. This prevents clients from contacting hosts directly, which has the security benefit of hiding the internal network structure and preventing clients from directly interacting with the hosts.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Hierarchical Architecture</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;"><span class="p">For a small data center housing only a few thousand hosts, a simple network consisting of a border router, a load balancer, and a few tens of racks all interconnected by a single Ethernet switch could possibly suffice. But to scale to tens to hundreds of thousands of hosts, a data center often employs a </span><span class="s23">hierarchy</span> of routers and switches<a href="#bookmark571" class="s124">, such as the topology shown in </a><a href="#bookmark571" class="a">Figure 6.3</a>0<a href="#bookmark571" class="s124">. At the top of the hierarchy, the border router connects to access routers (only two are shown in </a><a href="#bookmark571" class="a">Figure 6.3</a>0<span class="p">, but there</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">can be many more). Below each access router there are three tiers of switches. Each access router</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">connects to a top-tier switch, and each top-tier switch connects to multiple second-tier switches and a load balancer. Each second-tier switch in turn connects to multiple racks via the racks’ TOR switches (third-tier switches). All links typically use Ethernet for their link-layer and physical-layer protocols, with a mix of copper and fiber cabling. With such a hierarchical design, it is possible to scale a data center to hundreds of thousands of hosts.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark571" class="s124">Because it is critical for a cloud application provider to continually provide applications with high availability, data centers also include redundant network equipment and redundant links in their designs (not shown in </a><a href="#bookmark571" class="a">Figure 6.3</a>0<span class="p">). For example, each TOR switch can connect to two tier-2 switches, and each</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark848" class="s124">access router, tier-1 switch, and tier-2 switch can be duplicated and integrated into the design </a><a href="#bookmark848" class="a">[Cisco</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">2012<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Greenberg 2009b</a>]<a href="#bookmark571" class="s124">. In the hierarchical design in </a><a href="#bookmark571" class="a">Figure 6.3</a>0<span class="p">, observe that the hosts below each access router form a single subnet. In order to localize ARP broadcast traffic, each of these subnets is</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">further partitioned into smaller VLAN subnets, each comprising a few hundred hosts </a><a href="#bookmark848" class="a">[Greenberg </a>2009a]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">Although the conventional hierarchical architecture just described solves the problem of scale, it suffers from </span><a href="#bookmark848" style=" color: #333; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt;">limited host-to-host capacity </a><a href="#bookmark848" class="a">[Greenberg 2009b</a>]<a href="#bookmark571" class="s124">. To understand this limitation, consider again </a><a href="#bookmark571" class="a">Figure 6.3</a>0<span class="p">, and suppose each host connects to its TOR switch with a 1 Gbps link, whereas the links</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">between switches are 10 Gbps Ethernet links. Two hosts in the same rack can always communicate at a</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">full 1 Gbps, limited only by the rate of the hosts’ network interface cards. However, if there are many</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">simultaneous flows in the data center network, the maximum rate between two hosts in <i>different </i>racks can be much less. To gain insight into this issue, consider a traffic pattern consisting of 40 simultaneous flows between 40 pairs of hosts in different racks. Specifically, suppose each of 10 hosts in rack 1 in</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark571" class="a">Figure 6.30</a> <span class="p">sends a flow to a corresponding host in rack 5. Similarly, there are ten simultaneous flows between pairs of hosts in racks 2 and 6, ten simultaneous flows between racks 3 and 7, and ten simultaneous flows between racks 4 and 8. If each flow evenly shares a link’s capacity with other flows</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">traversing that link, then the 40 flows crossing the 10 Gbps A-to-B link (as well as the 10 Gbps B-to-C link) will each only receive 10 Gbps/40=250 Mbps, which is significantly less than the 1 Gbps network</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">interface card rate. The problem becomes even more acute for flows between hosts that need to travel higher up the hierarchy. One possible solution to this limitation is to deploy higher-rate switches and routers. But this would significantly increase the cost of the data center, because switches and routers with high port speeds are very expensive.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">Supporting high-bandwidth host-to-host communication is important because a key requirement in data centers is flexibility in placement of computation and services </a><a href="#bookmark848" class="a">[Greenberg 2009</a>b<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Farrington 2010</a>]<span class="p">.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">For example, a large-scale Internet search engine may run on thousands of hosts spread across multiple racks with significant bandwidth requirements between all pairs of hosts. Similarly, a cloud computing service such as EC2 may wish to place the multiple virtual machines comprising a customer’s service on the physical hosts with the most capacity irrespective of their location in the data center. If these physical hosts are spread across multiple racks, network bottlenecks as described above may result in poor performance.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Trends in Data Center Networking</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In order to reduce the cost of data centers, and at the same time improve their delay and throughput performance, Internet cloud giants such as Google, Facebook, Amazon, and Microsoft are continually deploying new data center network designs. Although these designs are proprietary, many important trends can nevertheless be identified.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 144%;text-align: left;"><span class="p">One such trend is to deploy new interconnection architectures and network protocols that overcome the drawbacks of the traditional hierarchical designs. One such approach is to replace the hierarchy of switches and routers with a </span><span class="s23">fully</span><a href="#bookmark848" class="a"> connected topology [Facebook 201</a>4<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Al-Fares </a>2008<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Greenberg 2009</a>b<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Guo 2009</a>]<a href="#bookmark572" class="s124">, such as the topology shown in </a><a href="#bookmark572" class="a">Figure 6.3</a>1<span class="p">. In this design, each tier-1 switch</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">connects to all of the tier-2 switches so that (1) host-to-host traffic never has to rise above the switch</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">tiers, and (2) with <i>n </i>tier-1 switches, between any two tier-2 switches there are <i>n </i>disjoint paths. Such a design can significantly improve the host-to-host capacity. To see this, consider again our example of 40</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark572" class="s124">flows. The topology in </a><a href="#bookmark572" class="a">Figure 6.31</a> <span class="p">can handle such a flow pattern since there are four distinct paths between the first tier-2 switch and the second tier-2 switch, together providing an aggregate capacity of 40 Gbps between the first two tier-2 switches. Such a design not only alleviates the host-to-host</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">capacity limitation, but also creates a more flexible computation and service environment in which communication between any two racks not connected to the same switch is logically equivalent, irrespective of their locations in the data center.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark839" class="s124">Another major trend is to employ shipping container–based modular data centers (MDCs) </a><a href="#bookmark839" class="a">[YouTube </a>2009<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Waldrop 2007</a>]<span class="p">. In an MDC, a factory builds, within a</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="785" height="260" alt="image" src="计算机网络自顶向下7th-en/Image_675.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark572">Figure 6.31 Highly interconnected data network topology</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">standard 12-meter shipping container, a “mini data center” and ships the container to the data center location. Each container has up to a few thousand hosts, stacked in tens of racks, which are packed closely together. At the data center location, multiple containers are interconnected with each other and also with the Internet. Once a prefabricated container is deployed at a data center, it is often difficult to service. Thus, each container is designed for graceful performance degradation: as components (servers and switches) fail over time, the container continues to operate but with degraded performance. When many components have failed and performance has dropped below a threshold, the entire container is removed and replaced with a fresh one.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">Building a data center out of containers creates new networking challenges. With an MDC, there are two types of networks: the container-internal networks within each of the containers and the core network connecting each container </a><a href="#bookmark848" class="a">[Guo 200</a>9<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Farrington 2010</a>]<span class="p">. Within each container, at the scale of up to a</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">few thousand hosts, it is possible to build a fully connected network (as described above) using</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">inexpensive commodity Gigabit Ethernet switches. However, the design of the core network, interconnecting hundreds to thousands of containers while providing high host-to-host bandwidth across containers for typical workloads, remains a challenging problem. A hybrid electrical/optical switch</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">architecture for interconnecting the containers is proposed in </a><a href="#bookmark848" class="a">[Farrington 2010</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">When using highly interconnected topologies, one of the major issues is designing routing algorithms among the switches. One possibility </a><a href="#bookmark848" class="a">[Greenberg 2009b]</a> <a href="#bookmark848" class="s124">is to use a form of random routing. Another possibility </a><a href="#bookmark848" class="a">[Guo 2009]</a> <span class="p">is to deploy multiple network interface cards in each host, connect each host to</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">multiple low-cost commodity switches, and allow the hosts themselves to intelligently route traffic among</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the switches. Variations and extensions of these approaches are currently being deployed in contemporary data centers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Another important trend is that large cloud providers are increasingly building or customizing just about everything that is in their data centers, including network adapters, switches routers, TORs, software,</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark848" class="s124" name="bookmark573">and networking protocols </a><a href="#bookmark848" class="a">[Greenberg </a>2015<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Singh 2015</a>]<span class="p">. Another trend, pioneered by Amazon, is to improve reliability with “availability zones,” which essentially replicate distinct data centers in different nearby buildings. By having the buildings nearby (a few kilometers apart), transactional data can be</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">synchronized across the data centers in the same availability zone while providing fault tolerance</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="a">[Amazon </a>2014]<span class="p">. Many more innovations in data center design are likely to continue to come; interested readers are encouraged to see the recent papers and videos on data center network design.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark574">Retrospective: A Day in the Life of a Web Page Request</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark10" class="s124">Now that we’ve covered the link layer in this chapter, and the network, transport and application layers in earlier chapters, our journey down the protocol stack is complete! In the very beginning of this book (</a><a href="#bookmark10" class="a">Section 1.</a>1<span class="p">), we wrote “much of this book is concerned with computer network protocols,” and in the</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">first five chapters, we’ve certainly seen that this is indeed the case! Before heading into the topical</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">chapters in second part of this book, we’d like to wrap up our journey down the protocol stack by taking an integrated, holistic view of the protocols we’ve learned about so far. One way then to take this “big picture” view is to identify the many (many!) protocols that are involved in satisfying even the simplest</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark576" class="s124">request: downloading a Web page. </a><a href="#bookmark576" class="a">Figure 6.32</a> <a href="http://www.google.com/" class="s124" target="_blank">illustrates our setting: a student, Bob, connects a laptop to his school’s Ethernet switch and downloads a Web page (say the home page of </a>www.google.com<span class="p">). As we now know, there’s a </span><span class="s17">lot </span><span class="p">going on “under the hood” to satisfy this seemingly simple request. A</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Wireshark lab at the end of this chapter examines trace files containing a number of the packets</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">involved in similar scenarios in more detail.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l269"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Getting Started: DHCP, UDP, IP, and Ethernet</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark576" class="s124">Let’s suppose that Bob boots up his laptop and then connects it to an Ethernet cable connected to the school’s Ethernet switch, which in turn is connected to the school’s router, as shown in </a><a href="#bookmark576" class="a">Figure 6.3</a>2<span class="p">. The</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">school’s router is connected to an ISP, in this example, comcast.net. In this example, comcast.net is providing the DNS service for the school; thus, the DNS server resides in the Comcast network rather than the school network. We’ll assume that the DHCP server is running within the router, as is often the case.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark575">When Bob first connects his laptop to the network, he can’t do anything (e.g., download a Web page) without an IP address. Thus, the first network-related</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="670" height="467" alt="image" src="计算机网络自顶向下7th-en/Image_676.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark576">Figure 6.32 A day in the life of a Web page request: Network setting and actions</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">action taken by Bob’s laptop is to run the DHCP protocol to obtain an IP address, as well as other information, from the local DHCP server:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l270"><li style="padding-left: 47pt;text-indent: -18pt;line-height: 126%;text-align: left;"><p class="s20" style="display: inline;"><span class="p">The operating system on Bob’s laptop creates a </span><span class="s23">DHCP</span> request message <a href="#bookmark382" class="s124">(</a><a href="#bookmark382" class="a">Section 4.3.</a>3<span class="p">) and puts this message within a </span><span class="s23">UDP</span> segment <a href="#bookmark271" class="s124">(</a><a href="#bookmark271" class="a">Section 3.</a>3<span class="p">) with destination port 67 (DHCP server) and source port 68 (DHCP client). The UDP segment is then placed within an </span>IP datagram</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark430" class="s124">(</a><a href="#bookmark430" class="a">Section 4.3.</a>1<span class="p">) with a broadcast IP destination address (255.255.255.255) and a source IP address of 0.0.0.0, since Bob’s laptop doesn’t yet have an IP address.</span></p></li><li style="padding-top: 2pt;padding-left: 47pt;text-indent: -18pt;line-height: 126%;text-align: left;"><p class="s20" style="display: inline;"><span class="p">The IP datagram containing the DHCP request message is then placed within an </span><span class="s23">Ethernet</span> frame <a href="#bookmark554" class="s124">(</a><a href="#bookmark554" class="a">Section 6.4.</a>2<span class="p">). The Ethernet frame has a destination MAC addresses of FF:FF:FF:FF:FF:FF so that the frame will be broadcast to all devices connected to the switch</span></p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">(hopefully including a DHCP server); the frame’s source MAC address is that of Bob’s laptop, 00:16:D3:23:68:8A.</p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The broadcast Ethernet frame containing the DHCP request is the first frame sent by Bob’s laptop to the Ethernet switch. The switch broadcasts the incoming frame on all outgoing ports,</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">including the port connected to the router.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The router receives the broadcast Ethernet frame containing the DHCP request on its interface with MAC address 00:22:6B:45:1F:1B and the IP datagram is extracted from the Ethernet frame.</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">The datagram’s broadcast IP destination address indicates that this IP datagram should be processed by upper layer protocols at this node, so the datagram’s payload (a UDP segment) is</p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 126%;text-align: left;"><a name="bookmark577"><span class="p">thus </span></a><span class="s23">demultiplexed</span> <a href="#bookmark266" class="s124">(</a><a href="#bookmark266" class="a">Section 3.</a>2<span class="p">) up to UDP, and the DHCP request message is extracted from the UDP segment. The DHCP server now has the DHCP request message.</span></p></li><li style="padding-top: 3pt;padding-left: 47pt;text-indent: -18pt;line-height: 126%;text-align: left;"><p class="s20" style="display: inline;"><span class="p">Let’s suppose that the DHCP server running within the router can allocate IP addresses in the </span><span class="s23">CIDR</span> <a href="#bookmark431" class="s124">(</a><a href="#bookmark431" class="a">Section 4.3.</a>3<span class="p">) block 68.85.2.0/24. In this example, all IP addresses used within the school are thus within Comcast’s address block. Let’s suppose the DHCP server allocates</span></p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">address 68.85.2.101 to Bob’s laptop. The DHCP server creates a <span class="s20">DHCP ACK message</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark431" class="s124">(</a><a href="#bookmark431" class="a">Section 4.3.</a>3<span class="p">) containing this IP address, as well as the IP address of the DNS server (68.87.71.226), the IP address for the default gateway router (68.85.2.1), and the subnet block (68.85.2.0/24) (equivalently, the “network mask”). The DHCP message is put inside a UDP</span></p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">segment, which is put inside an IP datagram, which is put inside an Ethernet frame. The Ethernet frame has a source MAC address of the router’s interface to the home network (00:22:6B:45:1F:1B) and a destination MAC address of Bob’s laptop (00:16:D3:23:68:8A).</p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The Ethernet frame containing the DHCP ACK is sent (unicast) by the router to the switch.</p><p class="s20" style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 136%;text-align: left;"><span class="p">Because the switch is </span><span class="s23">self-learning</span> <a href="#bookmark558" class="s124">(</a><a href="#bookmark558" class="a">Section 6.4.</a>3<span class="p">) and previously received an Ethernet frame (containing the DHCP request) from Bob’s laptop, the switch knows to forward a frame addressed to 00:16:D3:23:68:8A only to the output port leading to Bob’s laptop.</span></p></li><li style="padding-top: 2pt;padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Bob’s laptop receives the Ethernet frame containing the DHCP ACK, extracts the IP datagram from the Ethernet frame, extracts the UDP segment from the IP datagram, and extracts the</p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">DHCP ACK message from the UDP segment. Bob’s DHCP client then records its IP address and the IP address of its DNS server. It also installs the address of the default gateway into its </span>IP <span class="s23">forwarding</span> table <a href="#bookmark374" class="s124">(</a><a href="#bookmark374" class="a">Section 4.</a>1<span class="p">). Bob’s laptop will send all datagrams with destination address</span></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 11pt;text-align: left;">outside of its subnet 68.85.2.0/24 to the default gateway. At this point, Bob’s laptop has</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">initialized its networking components and is ready to begin processing the Web page fetch.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark368" class="s124">(Note that only the last two DHCP steps of the four presented in </a><a href="#bookmark368" class="a">Chapter 4</a> <span class="p">are actually necessary.)</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Still Getting Started: DNS and ARP</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;"><a href="http://www.google.com/" class="s124" target="_blank">When Bob types the URL for </a><a href="http://www.google.com/" class="a" target="_blank">www.google.com</a> <span class="p">into his Web browser, he begins the long chain of events that will eventually result in Google’s home page being displayed by his Web browser. Bob’s Web browser begins the process by creating a </span><span class="s23">TCP</span> socket <a href="#bookmark239" class="s124">(</a><a href="#bookmark239" class="a">Section 2.</a>7<span class="p">) that will be used to send the</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 15pt;text-align: left;"><span class="s23">HTTP</span> request <a href="#bookmark176" class="s124">(</a><a href="#bookmark176" class="a">Section 2.</a>2<a href="http://www.google.com/" class="s124" target="_blank">) to </a><a href="http://www.google.com/" class="a" target="_blank">www.google.co</a>m<span class="p">. In order to create the socket, Bob’s laptop will need</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 126%;text-align: left;"><a href="http://www.google.com/" class="s124" target="_blank">to know the IP address of </a>www.google.com<a href="#bookmark216" class="s124">. We learned in </a><a href="#bookmark216" class="a">Section 2.</a>5<span class="p">, that the </span><span class="s23">DNS</span> protocol <span class="p">is used to provide this name-to-IP-address translation service.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l271"><li style="padding-left: 47pt;text-indent: -18pt;line-height: 138%;text-align: left;"><p class="s20" style="display: inline;"><span class="p">The operating system on Bob’s laptop thus creates a </span><span class="s23">DNS</span> query message <a href="http://www.google.com/" class="s124" target="_blank">(Section 2.5.3), putting the string “</a>www.google.com<span class="p">” in the question section of the DNS message. This DNS message is then placed within a UDP segment with a destination port of 53 (DNS server). The UDP segment is then placed within an IP datagram with an IP destination address of</span></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark578">68.87.71.226 (the address of the DNS server returned in the DHCP ACK in step 5) and a source IP address of 68.85.2.101.</a></p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Bob’s laptop then places the datagram containing the DNS query message in an Ethernet frame.</p><p class="s20" style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">This frame will be sent (addressed, at the link layer) to the gateway router in Bob’s school’s network. However, even though Bob’s laptop knows the IP address of the school’s gateway router (68.85.2.1) via the DHCP ACK message in step 5 above, it doesn’t know the gateway router’s MAC address. In order to obtain the MAC address of the gateway router, Bob’s laptop will need to use the </span><span class="s23">ARP</span> protocol <a href="#bookmark551" class="s124">(</a><a href="#bookmark551" class="a">Section 6.4.</a>1<span class="p">).</span></p></li><li style="padding-left: 47pt;text-indent: -27pt;line-height: 14pt;text-align: left;"><p style="display: inline;">Bob’s laptop creates an <span class="s23">ARP</span><span class="s20"> query </span>message with a target IP address of 68.85.2.1 (the default</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">gateway), places the ARP message within an Ethernet frame with a broadcast destination address (FF:FF:FF:FF:FF:FF) and sends the Ethernet frame to the switch, which delivers the frame to all connected devices, including the gateway router.</p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -27pt;line-height: 125%;text-align: left;"><p style="display: inline;">The gateway router receives the frame containing the ARP query message on the interface to the school network, and finds that the target IP address of 68.85.2.1 in the ARP message</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">matches the IP address of its interface. The gateway router thus prepares an <span class="s20">ARP reply</span>, indicating that its MAC address of 00:22:6B:45:1F:1B corresponds to IP address 68.85.2.1. It places the ARP reply message in an Ethernet frame, with a destination address of 00:16:D3:23:68:8A (Bob’s laptop) and sends the frame to the switch, which delivers the frame to Bob’s laptop.</p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -27pt;line-height: 125%;text-align: left;"><p style="display: inline;">Bob’s laptop receives the frame containing the ARP reply message and extracts the MAC address of the gateway router (00:22:6B:45:1F:1B) from the ARP reply message.</p></li><li style="padding-top: 3pt;padding-left: 47pt;text-indent: -27pt;line-height: 125%;text-align: left;"><p style="display: inline;">Bob’s laptop can now (<i>finally!</i>) address the Ethernet frame containing the DNS query to the gateway router’s MAC address. Note that the IP datagram in this frame has an IP destination</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">address of 68.87.71.226 (the DNS server), while the frame has a destination address of 00:22:6B:45:1F:1B (the gateway router). Bob’s laptop sends this frame to the switch, which delivers the frame to the gateway router.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Still Getting Started: Intra-Domain Routing to the DNS Server</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l272"><li style="padding-left: 47pt;text-indent: -27pt;text-align: left;"><p style="display: inline;">The gateway router receives the frame and extracts the IP datagram containing the DNS query.</p><p class="s20" style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark576" class="s124">The router looks up the destination address of this datagram (68.87.71.226) and determines from its forwarding table that the datagram should be sent to the leftmost router in the Comcast network in </a><a href="#bookmark576" class="a">Figure 6.3</a>2<span class="p">. The IP datagram is placed inside a link-layer frame appropriate for the</span></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 11pt;text-align: left;">link connecting the school’s router to the leftmost Comcast router and the frame is sent over this</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">link.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 47pt;text-indent: -27pt;line-height: 125%;text-align: left;"><p style="display: inline;">The leftmost router in the Comcast network receives the frame, extracts the IP datagram, examines the datagram’s destination address (68.87.71.226) and determines the outgoing</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">interface on which to forward the datagram toward the DNS server from its forwarding table, which has been filled in by Comcast’s intra-domain protocol (such as <span class="s20">RIP</span>, <span class="s20">OSPF </span>or <span class="s20">IS-IS</span>,</p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: justify;"><a name="bookmark579"><span class="p">Section 5.3) as well as the </span></a><span class="s23">Internet’s</span> inter-domain protocol<span class="p">, </span><span class="s23">BGP</span> <a href="#bookmark480" class="s124">(</a><a href="#bookmark480" class="a">Section 5.</a>4<span class="p">).</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 47pt;text-indent: -27pt;line-height: 136%;text-align: left;"><p class="s20" style="display: inline;"><a href="http://www.google.com/" class="s124" target="_blank">Eventually the IP datagram containing the DNS query arrives at the DNS server. The DNS server extracts the DNS query message, looks up the name </a><a href="http://www.google.com/" class="a" target="_blank">www.google.com</a> <a href="#bookmark216" class="s124">in its DNS database (</a><a href="#bookmark216" class="a">Section 2.</a>5<span class="p">), and finds the </span><span class="s23">DNS</span> resource record <a href="http://www.google.com/" class="s124" target="_blank">that contains the IP address (64.233.169.105) for </a>www.google.com<span class="p">. (assuming that it is currently cached in the DNS server). Recall that this cached data originated in the </span><span class="s23">authoritative</span> DNS server <span class="p">(Section 2.5.2) for googlecom. The DNS server forms a </span>DNS reply message <span class="p">containing this hostname-to-IP- address mapping, and places the DNS reply message in a UDP segment, and the segment</span></p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: justify;">within an IP datagram addressed to Bob’s laptop (68.85.2.101). This datagram will be forwarded back through the Comcast network to the school’s router and from there, via the Ethernet switch to Bob’s laptop.</p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -27pt;text-align: left;"><p class="s20" style="display: inline;"><a href="http://www.google.com/" class="s124" target="_blank">Bob’s laptop extracts the IP address of the server </a><a href="http://www.google.com/" class="a" target="_blank">www.google.com</a> <span class="p">from the DNS message.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 47pt;text-indent: 0pt;text-align: justify;">Finally<span class="p">, after a </span>lot <a href="http://www.google.com/" class="s124" target="_blank">of work, Bob’s laptop is now ready to contact the </a><a href="http://www.google.com/" class="a" target="_blank">www.google.com</a><span class="s20"> </span><span class="p">server!</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: center;"><p class="s19" style="display: inline;">Web Client-Server Interaction: TCP and HTTP</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l273"><li style="padding-left: 47pt;text-indent: -26pt;line-height: 131%;text-align: left;"><p class="s20" style="display: inline;"><a href="http://www.google.com/" class="s124" target="_blank">Now that Bob’s laptop has the IP address of </a>www.google.com<span class="p">, it can create the </span><span class="s23">TCP</span> socket <a href="#bookmark239" class="s124">(</a><a href="#bookmark239" class="a">Section 2.</a>7<span class="p">) that will be used to send the </span><span class="s23">HTTP</span> GET <a href="#bookmark168" class="s124">message (</a><a href="#bookmark168" class="a">Section 2.2.</a>3<a href="http://www.google.com/" class="s124" target="_blank">) to </a>www.google.com<span class="p">. When Bob creates the TCP socket, the TCP in Bob’s laptop must first perform a </span><span class="s23">three-way</span> handshake <a href="#bookmark330" class="s124">(</a><a href="#bookmark330" class="a">Section 3.5.</a>6<a href="http://www.google.com/" class="s124" target="_blank">) with the TCP in </a><a href="http://www.google.com/" class="a" target="_blank">www.google.co</a>m<span class="p">. Bob’s laptop thus first creates a </span>TCP SYN <span class="p">segment with destination port 80 (for HTTP), places the</span></p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;text-align: justify;">TCP segment inside an IP datagram with a destination IP address of 64.233.169.105</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="http://www.google.com/" class="s124" target="_blank">(</a>www.google.com<span class="p">), places the datagram inside a frame with a destination MAC address of 00:22:6B:45:1F:1B (the gateway router) and sends the frame to the switch.</span></p></li><li style="padding-top: 3pt;padding-left: 47pt;text-indent: -27pt;line-height: 138%;text-align: left;"><p class="s20" style="display: inline;"><a href="http://www.google.com/" class="s124" target="_blank">The routers in the school network, Comcast’s network, and Google’s network forward the datagram containing the TCP SYN toward </a>www.google.com<span class="p">, using the forwarding table in each router, as in steps 14–16 above. Recall that the router forwarding table entries governing forwarding of packets over the inter-domain link between the Comcast and Google networks are</span></p><p class="s20" style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: justify;"><span class="p">determined by the </span><span class="s23">BGP</span> <a href="#bookmark444" class="s124">protocol (</a><a href="#bookmark444" class="a">Chapter </a>5<span class="p">).</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 47pt;text-indent: -27pt;line-height: 125%;text-align: left;"><p class="s20" style="display: inline;"><a href="http://www.google.com/" class="s124" target="_blank">Eventually, the datagram containing the TCP SYN arrives at </a>www.google.com<span class="p">. The TCP SYN message is extracted from the datagram and demultiplexed to the welcome socket associated</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark239" class="s124">with port 80. A connection socket (</a><a href="#bookmark239" class="a">Section 2.</a>7<a href="#bookmark330" class="s124">) is created for the TCP connection between the Google HTTP server and Bob’s laptop. A TCP SYNACK (</a><a href="#bookmark330" class="a">Section 3.5.</a>6<span class="p">) segment is generated, placed inside a datagram addressed to Bob’s laptop, and finally placed inside a link-layer frame</span></p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: justify;"><a href="http://www.google.com/" class="s124" target="_blank">appropriate for the link connecting </a><a href="http://www.google.com/" class="a" target="_blank">www.google.com</a> <span class="p">to its first-hop router.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 47pt;text-indent: -27pt;line-height: 125%;text-align: left;"><p style="display: inline;">The datagram containing the TCP SYNACK segment is forwarded through the Google, Comcast, and school networks, eventually arriving at the Ethernet card in Bob’s laptop. The</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">datagram is demultiplexed within the operating system to the TCP socket created in step 18, which enters the connected state.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -27pt;line-height: 138%;text-align: left;"><p class="s20" style="display: inline;"><a name="bookmark580"><span class="p">With the socket on Bob’s laptop now (</span></a><span class="s17">finally!</span><a href="http://www.google.com/" class="s124" target="_blank">) ready to send bytes to </a>www.google.com<a href="#bookmark168" class="s124">, Bob’s browser creates the HTTP GET message (</a><a href="#bookmark168" class="a">Section 2.2.</a>3<span class="p">) containing the URL to be fetched. The HTTP GET message is then written into the socket, with the GET message becoming the payload of a TCP segment. The TCP segment is placed in a datagram and sent and delivered to</span><a name="bookmark581">&zwnj;</a></p><p class="s20" style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;"><a href="http://www.google.com/" class="a" target="_blank">www.google.com</a> <span class="p">as in steps 18–20 above.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -27pt;line-height: 126%;text-align: left;"><p class="s20" style="display: inline;"><a href="http://www.google.com/" class="s124" target="_blank">The HTTP server at </a><a href="http://www.google.com/" class="a" target="_blank">www.google.com</a> <span class="p">reads the HTTP GET message from the TCP socket,  creates an </span><span class="s23">HTTP</span> response <a href="#bookmark176" class="s124">message (</a><a href="#bookmark176" class="a">Section 2.</a>2<span class="p">), places the requested Web page content in the body of the HTTP response message, and sends the message into the TCP socket.</span></p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -27pt;line-height: 125%;text-align: left;"><p style="display: inline;">The datagram containing the HTTP reply message is forwarded through the Google, Comcast, and school networks, and arrives at Bob’s laptop. Bob’s Web browser program reads the HTTP</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 161%;text-align: left;">response from the socket, extracts the html for the Web page from the body of the HTTP response, and finally (<i>finally!</i>) displays the Web page!</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark15" class="s124">Our scenario above has covered a lot of networking ground! If you’ve understood most or all of the above example, then you’ve also covered a lot of ground since you first read </a><a href="#bookmark15" class="a">Section 1.</a>1<span class="p">, where we</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">wrote “much of this book is concerned with computer network protocols” and you may have wondered what a protocol actually was! As detailed as the above example might seem, we’ve omitted a number of possible additional protocols (e.g., NAT running in the school’s gateway router, wireless access to the school’s network, security protocols for accessing the school network or encrypting segments or datagrams, network management protocols), and considerations (Web caching, the DNS hierarchy) that one would encounter in the public Internet. We’ll cover a number of these topics and more in the  second part of this book.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Lastly, we note that our example above was an integrated and holistic, but also very “nuts and bolts,” view of many of the protocols that we’ve studied in the first part of this book. The example focused more on the “how” than the “why.” For a broader, more reflective view on the design of network protocols in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">general, see </a><a href="#bookmark848" class="a">[Clark </a>1988<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">RFC 5218</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l274"><ol id="l275"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark582">Summary</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this chapter, we’ve examined the link layer—its services, the principles underlying its operation, and a number of important specific protocols that use these principles in implementing link-layer services.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We saw that the basic service of the link layer is to move a network-layer datagram from one node  (host, switch, router, WiFi access point) to an adjacent node. We saw that all link-layer protocols operate by encapsulating a network-layer datagram within a link-layer frame before transmitting the frame over the link to the adjacent node. Beyond this common framing function, however, we learned that different link-layer protocols provide very different link access, delivery, and transmission services. These differences are due in part to the wide variety of link types over which link-layer protocols must operate. A simple point-to-point link has a single sender and receiver communicating over a single “wire.” A multiple access link is shared among many senders and receivers; consequently, the link-layer protocol for a multiple access channel has a protocol (its multiple access protocol) for coordinating link access. In the case of MPLS, the “link” connecting two adjacent nodes (for example, two IP routers that are adjacent in an IP sense—that they are next-hop IP routers toward some destination) may actually be a</p><p class="s17" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">network <span class="p">in and of itself. In one sense, the idea of a network being considered as a link should not seem odd. A telephone link connecting a home modem/computer to a remote modem/router, for example, is</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">actually a path through a sophisticated and complex telephone <i>network.</i></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Among the principles underlying link-layer communication, we examined error-detection and -correction techniques, multiple access protocols, link-layer addressing, virtualization (VLANs), and the construction of extended switched LANs and data center networks. Much of the focus today at the link layer is on these switched networks. In the case of error detection/correction, we examined how it is possible to add additional bits to a frame’s header in order to detect, and in some cases correct, bit-flip errors that might occur when the frame is transmitted over the link. We covered simple parity and checksumming schemes, as well as the more robust cyclic redundancy check. We then moved on to the topic of multiple access protocols. We identified and studied three broad approaches for coordinating access to a broadcast channel: channel partitioning approaches (TDM, FDM), random access approaches (the ALOHA protocols and CSMA protocols), and taking-turns approaches (polling and token passing). We studied the cable access network and found that it uses many of these multiple access methods. We saw that a consequence of having multiple nodes share a single broadcast channel was the need to provide node addresses at the link layer. We learned that link-layer addresses were quite different from network-layer addresses and that, in the case of the Internet, a special protocol (ARP—the Address Resolution Protocol) is used to translate between these two forms of addressing and studied the hugely successful Ethernet protocol in detail. We then examined how nodes sharing a broadcast channel form</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a name="bookmark583">a LAN and how multiple LANs can be connected together to form larger LANs—all </a><i>without </i>the intervention of network-layer routing to interconnect these local nodes. We also learned how multiple virtual LANs can be created on a single physical LAN infrastructure.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">We ended our study of the link layer by focusing on how MPLS networks provide link-layer services when they interconnect IP routers and an overview of the network designs for today’s massive data centers. We wrapped up this chapter (and indeed the first five chapters) by identifying the many</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">protocols that are needed to fetch a simple Web page. Having covered the link layer, <i>our journey down the protocol stack is now ove</i>r! Certainly, the physical layer lies below the link layer, but the details of the physical layer are probably best left for another course (for example, in communication theory, rather</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">than computer networking). We have, however, touched upon several aspects of the physical layer in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark5" class="s124">this chapter and in </a><a href="#bookmark5" class="a">Chapter 1</a> <a href="#bookmark37" class="s124">(our discussion of physical media in </a><a href="#bookmark37" class="a">Section 1.</a>2<span class="p">). We’ll consider the physical layer again when we study wireless link characteristics in the next chapter.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although our journey down the protocol stack is over, our study of computer networking is not yet at an end. In the following three chapters we cover wireless networking, network security, and multimedia networking. These four topics do not fit conveniently into any one layer; indeed, each topic crosscuts many layers. Understanding these topics (billed as advanced topics in some networking texts) thus requires a firm foundation in all layers of the protocol stack—a foundation that our study of the link layer has now completed!</p><p class="s18" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark584">Homework Problems and Questions</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Chapter 6 Review Questions</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTIONS 6.1–6.2</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark516" class="s124">R1. Consider the transportation analogy in </a><a href="#bookmark516" class="a">Section 6.1.1</a> <span class="p">. If the passenger is analagous to a datagram, what is analogous to the link layer frame?</span></p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R2. If all the links in the Internet were to provide reliable delivery service, would the TCP reliable delivery service be redundant? Why or why not?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R3. What are some of the possible services that a link-layer protocol can offer to the network layer? Which of these link-layer services have corresponding services in IP? In TCP?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 6.3</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 143%;text-align: justify;">R4. Suppose two nodes start to transmit at the same time a packet of length <i>L </i>over a broadcast channel of rate <i>R</i>. Denote the propagation delay between the two nodes as <i>d</i><span class="s22">prop</span>. Will there be a collision if dprop&lt;L/R? Why or why not?</p><p class="s20" style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark542" class="s124">R5. In </a><a href="#bookmark542" class="a">Section 6.3</a> <span class="p">, we listed four desirable characteristics of a broadcast channel. Which of these characteristics does slotted ALOHA have? Which of these characteristics does token passing have?</span></p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 126%;text-align: left;">R6. In CSMA/CD, after the fifth collision, what is the probability that a node chooses <span class="s27">K=</span>4? The result K=4 corresponds to a delay of how many seconds on a 10 Mbps Ethernet?</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">R7. Describe polling and token-passing protocols using the analogy of cocktail party interactions. R8. Why would the token-ring protocol be inefficient if a LAN had a very large perimeter?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 6.4</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R9. How big is the MAC address space? The IPv4 address space? The IPv6 address space? R10. Suppose nodes A, B, and C each attach to the same broadcast LAN (through their adapters). If A sends thousands of IP datagrams to B with each encapsulating frame addressed</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">to the MAC address of B, will C’s adapter process these frames? If so, will C’s adapter pass the IP datagrams in these frames to the network layer C? How would your answers change if A sends frames with the MAC broadcast address?</p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R11. Why is an ARP query sent within a broadcast frame? Why is an ARP response sent within</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">a frame with a specific destination MAC address?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark550" class="s124">R12. For the network in </a><a href="#bookmark550" class="a">Figure 6.19</a> <span class="p">, the router has two ARP modules, each with its own ARP table. Is it possible that the same MAC address appears in both tables?</span></p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R13. Compare the frame structures for 10BASE-T, 100BASE-T, and Gigabit Ethernet. How do they differ?</p><p class="s20" style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;"><a href="#bookmark545" class="s124">R14. Consider </a><a href="#bookmark545" class="a">Figure 6.15</a> <span class="p">. How many subnetworks are there, in the addressing sense of</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;text-align: left;"><a href="#bookmark433" class="a">Section 4.3</a> <span class="p">?</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R15. What is the maximum number of VLANs that can be configured on a switch supporting the 802.1Q protocol? Why?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R16. Suppose that <i>N </i>switches supporting <i>K </i>VLAN groups are to be connected via a trunking protocol. How many ports are needed to connect the switches? Justify your answer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Problems</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;">P1. Suppose the information content of a packet is the bit pattern 1110 0110 1001 1101 and an even parity scheme is being used. What would the value of the field containing the parity bits be for the case of a two-dimensional parity scheme? Your answer should be such that a minimum-</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">length checksum field is used.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark524" class="s124">P2. Show (give an example other than the one in </a><a href="#bookmark524" class="a">Figure 6.5</a> <span class="p">) that two-dimensional parity checks can correct and detect a single bit error. Show (give an example of) a double-bit error that can  be detected but not corrected.</span></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">P3. Suppose the information portion of a packet (<i>D </i><a href="#bookmark521" class="s124">in </a><a href="#bookmark521" class="a">Figure 6.3</a><span class="s20"> </span>) contains 10 bytes consisting of the 8-bit unsigned binary ASCII representation of string “Networking.” Compute the Internet checksum for this data.</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">P4. Consider the previous problem, but instead suppose these 10 bytes contain</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l276"><li style="padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">the binary representation of the numbers 1 through 10.</p></li><li style="padding-top: 4pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">the ASCII representation of the letters B through K (uppercase).</p></li><li style="padding-top: 4pt;padding-left: 90pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">the ASCII representation of the letters b through k (lowercase).</p></li></ol></li></ol></ol><p style="padding-top: 4pt;padding-left: 90pt;text-indent: 0pt;text-align: left;">Compute the Internet checksum for this data.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 126%;text-align: left;">P5. Consider the 5-bit generator, <span class="s27">G=</span>10011, and suppose that D has the value 1010101010. What is the value of R?</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">P6. Consider the previous problem, but suppose that <i>D </i>has the value</p><p style="text-indent: 0pt;line-height: 2pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:97pt;margin-left:69.75pt" cellspacing="0"><tr><td><p class="s137" style="padding-top: 3pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">a.</p></td><td><p class="s122" style="padding-top: 4pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">1001010101.</p></td></tr><tr><td><p class="s137" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">b.</p></td><td><p class="s122" style="padding-top: 3pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">0101101010.</p></td></tr><tr><td><p class="s137" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">c.</p></td><td><p class="s122" style="padding-top: 3pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">1010100000.</p></td></tr></table><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 139%;text-align: left;">P7. In this problem, we explore some of the properties of the CRC. For the generator <span class="s27">G</span><a href="#bookmark528" class="s124">(=1001) given in </a><a href="#bookmark528" class="a">Section 6.2.3</a><span class="s20"> </span>, answer the following questions.</p><ol id="l277"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Why can it detect any single bit error in data D?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Can the above G detect any odd number of bit errors? Why?</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark542" class="s124">P8. In </a><a href="#bookmark542" class="a">Section 6.3</a> <span class="p">, we provided an outline of the derivation of the efficiency of slotted ALOHA. In this problem we’ll complete the derivation.</span></p><ol id="l278"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 126%;text-align: left;"><p style="display: inline;">Recall that when there are <i>N </i>active nodes, the efficiency of slotted ALOHA is <span class="s27">N</span>p(1−p)N−1. Find the value of <i>p </i>that maximizes this expression.</p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Using the value of <i>p </i>found in (a), find the efficiency of slotted ALOHA by letting <i>N</i></p></li></ol><p style="padding-top: 4pt;text-indent: 0pt;text-align: center;">approach infinity. <i>Hint</i>: <span class="s27">(</span>1−1/N)N approaches 1/<i>e </i>as <i>N </i>approaches infinity.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P9. Show that the maximum efficiency of pure ALOHA is 1/(2<i>e</i>). <i>Note</i>: This problem is easy if you have completed the problem above!</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P 10. Consider two nodes, A and B, that use the slotted ALOHA protocol to contend for a channel. Suppose node A has more data to transmit than node B, and node A’s retransmission</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">probability <i>p</i><span class="s31">A  </span>is greater than node B’s retransmission probability, <i>p</i><span class="s31">B</span>.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l279"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Provide a formula for node A’s average throughput. What is the total efficiency of the protocol with these two nodes?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 137%;text-align: left;"><p style="display: inline;">If <span class="s27">p</span>A=2pB, is node A’s average throughput twice as large as that of node B? Why or why not? If not, how can you choose <i>p</i><span class="s31">A </span>and <i>p</i><span class="s31">B </span>to make that happen?</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 134%;text-align: left;"><p style="display: inline;">In general, suppose there are <i>N </i>nodes, among which node A has retransmission probability <i>2p </i>and all other nodes have retransmission probability <i>p. </i>Provide expressions to compute the average throughputs of node A and of any other node.</p></li></ol><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P11. Suppose four active nodes—nodes A, B, C and D—are competing for access to a channel using slotted ALOHA. Assume each node has an infinite number of packets to send. Each node</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">attempts to transmit in each slot with probability <i>p</i>. The first slot is numbered slot 1, the second slot is numbered slot 2, and so on.</p><ol id="l280"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the probability that node A succeeds for the first time in slot 5?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the probability that some node (either A, B, C or D) succeeds in slot 4?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the probability that the first success occurs in slot 3?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the efficiency of this four-node system?</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">P12. Graph the efficiency of slotted ALOHA and pure ALOHA as a function of <i>p </i>for the following values of <i>N</i>:</p><ol id="l281"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 15pt;text-align: left;"><p style="display: inline;">N=15<span class="s49">.</span></p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">N=25<span class="s49">.</span></p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">N=35<span class="s49">.</span></p></li></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P13. Consider a broadcast channel with <i>N </i>nodes and a transmission rate of <i>R </i>bps. Suppose the broadcast channel uses polling (with an additional polling node) for multiple access. Suppose the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 154%;text-align: left;">amount of time from when a node completes transmission until the subsequent node is permitted to transmit (that is, the polling delay) is <i>d</i><span class="s22">poll</span>. Suppose that within a polling round, a given node is allowed to transmit at most <i>Q </i><a href="#bookmark585" class="s124">bits. What is the maximum throughput of the broadcast channel? P14. Consider three LANs interconnected by two routers, as shown in </a><a href="#bookmark585" class="a">Figure 6.33</a><span class="s20"> </span>.</p><ol id="l282"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 14pt;text-align: left;"><p style="display: inline;">Assign IP addresses to all of the interfaces. For Subnet 1 use addresses of the form</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">192.168.1.xxx; for Subnet 2 uses addresses of the form 192.168.2.xxx; and for Subnet 3 use addresses of the form 192.168.3.xxx.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Assign MAC addresses to all of the adapters.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 139%;text-align: left;"><p style="display: inline;"><a href="#bookmark551" class="s124">Consider sending an IP datagram from Host E to Host B. Suppose all of the ARP tables are up to date. Enumerate all the steps, as done for the single-router example in </a><a href="#bookmark551" class="a">Section</a></p><p class="s20" style="padding-top: 1pt;padding-left: 48pt;text-indent: 0pt;text-align: left;"><a href="#bookmark551" class="a">6.4.1</a> <span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Repeat (c), now assuming that the ARP table in the sending host is empty (and the other tables are up to date).</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark585" class="s124">P15. Consider </a><a href="#bookmark585" class="a">Figure 6.33</a> <span class="p">. Now we replace the router between subnets 1 and 2 with a switch S1, and label the router between subnets 2 and 3 as R1.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="530" height="423" alt="image" src="计算机网络自顶向下7th-en/Image_677.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark585">Figure 6.33 Three subnets, interconnected by routers</a></h2><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l283"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Consider sending an IP datagram from Host E to Host F. Will Host E ask router R1 to help forward the datagram? Why? In the Ethernet frame containing the IP datagram,</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">what are the source and destination IP and MAC addresses?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose E would like to send an IP datagram to B, and assume that E’s ARP cache does not contain B’s MAC address. Will E perform an ARP query to find B’s MAC</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">address? Why? In the Ethernet frame (containing the IP datagram destined to B) that is delivered to router R1, what are the source and destination IP and MAC addresses?</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose Host A would like to send an IP datagram to Host B, and neither A’s ARP cache contains B’s MAC address nor does B’s ARP cache contain A’s MAC address. Further</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">suppose that the switch S1’s forwarding table contains entries for Host B and router R1 only. Thus, A will broadcast an ARP request message. What actions will switch S1 perform once it receives the ARP request message? Will router R1 also receive this ARP request message? If so, will R1 forward the message to Subnet 3? Once Host B receives this ARP request message, it will send back to Host A an ARP response message. But will it send an ARP query message to ask for A’s MAC address? Why? What will switch S1 do once it receives an ARP response message from Host B?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 129%;text-align: left;">P16. Consider the previous problem, but suppose now that the router between subnets 2 and 3 is replaced by a switch. Answer questions (a)–(c) in the previous problem in this new context. P17. Recall that with the CSMA/CD protocol, the adapter waits <span class="s27">K</span><span class="s29">⋅</span>512 bit times after a collision, where <i>K </i>is drawn randomly. For <span class="s27">K=</span>100, how long does the adapter wait until returning to Step 2 for a 10 Mbps broadcast channel? For a 100 Mbps broadcast channel?</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P18. Suppose nodes A and B are on the same 10 Mbps broadcast channel, and the propagation delay between the two nodes is 325 bit times. Suppose CSMA/CD and Ethernet packets are used for this broadcast channel. Suppose node A begins transmitting a frame and, before it</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 147%;text-align: left;">finishes, node B begins transmitting a frame. Can A finish transmitting before it detects that B has transmitted? Why or why not? If the answer is yes, then A incorrectly believes that its frame was successfully transmitted without a collision. <i>Hint</i>: Suppose at time <span class="s27">t=</span>0 bits, A begins</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">transmitting a frame. In the worst case, A transmits a minimum-sized frame of 512+64 bit times.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">So A would finish transmitting the frame at t=512+64 bit times. Thus, the answer is no, if B’s signal reaches A before bit time t=512+64 bits. In the worst case, when does B’s signal reach A? P19. Suppose nodes A and B are on the same 10 Mbps broadcast channel, and the propagation</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">delay between the two nodes is 245 bit times. Suppose A and B send Ethernet frames at the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">same time, the frames collide, and then A and B choose different values of <i>K </i>in the CSMA/CD algorithm. Assuming no other nodes are active, can the retransmissions from A and B collide? For our purposes, it suffices to work out the following example. Suppose A and B begin</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">transmission at t=0 bit times. They both detect collisions at t=245 t bit times. Suppose KA=0 and KB=1. At what time does B schedule its retransmission? At what time does A begin transmission? (<i>Note</i>: The nodes must wait for an idle channel after returning to Step 2—see</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">protocol.) At what time does A’s signal reach B? Does B refrain from transmitting at its</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">scheduled time?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P20. In this problem, you will derive the efficiency of a CSMA/CD-like multiple access protocol. In this protocol, time is slotted and all adapters are synchronized to the slots. Unlike slotted ALOHA, however, the length of a slot (in seconds) is much less than a frame time (the time to</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">transmit a frame). Let <i>S </i>be the length of a slot. Suppose all frames are of constant length</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 127%;text-align: justify;"><span class="s27">L</span>=kRS, where <i>R </i>is the transmission rate of the channel and <i>k </i>is a large integer. Suppose there are <i>N </i>nodes, each with an infinite number of frames to send. We also assume that <span class="s27">d</span>prop&lt;S, so that all nodes can detect a collision before the end of a slot time. The protocol is as follows:</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_678.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">If, for a given slot, no node has possession of the channel, all nodes contend for the channel; in particular, each node transmits in the slot with probability <i>p</i>. If exactly one node transmits in the slot, that node takes possession of the channel for the subsequent k−1 slots and</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">transmits its entire frame.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="12" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_679.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">If some node has possession of the channel, all other nodes refrain from transmitting until the node that possesses the channel has finished transmitting its frame. Once this node has transmitted its frame, all nodes contend for the channel.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 137%;text-align: left;">Note that the channel alternates between two states: the productive state, which lasts exactly <i>k </i>slots, and the nonproductive state, which lasts for a random number of slots. Clearly, the channel efficiency is the ratio of <span class="s27">k</span>/(k+x), where <i>x </i>is the expected number of consecutive</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: justify;">unproductive slots.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l284"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">For fixed <i>N </i>and <i>p</i>, determine the efficiency of this protocol.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">For fixed <i>N</i>, determine the <i>p </i>that maximizes the efficiency.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Using the <i>p </i>(which is a function of <i>N</i>) found in (b), determine the efficiency as <i>N</i></p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">approaches infinity.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Show that this efficiency approaches 1 as the frame length becomes large.</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark585" class="s124">P21. Consider </a><a href="#bookmark585" class="a">Figure 6.33</a> <span class="p">in problem P14. Provide MAC addresses and IP addresses for the interfaces at Host A, both routers, and Host F. Suppose Host A sends a datagram to Host F. Give the source and destination MAC addresses in the frame encapsulating this IP datagram as</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">the frame is transmitted <i>(i) </i>from A to the left router, <i>(ii) </i>from the left router to the right router, <i>(iii) </i>from the right router to F. Also give the source and destination IP addresses in the IP datagram encapsulated within the frame at each of these points in time.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark585" class="s124">P22. Suppose now that the leftmost router in </a><a href="#bookmark585" class="a">Figure 6.33</a> <span class="p">is replaced by a switch. Hosts A, B, C, and D and the right router are all star-connected into this switch. Give the source and destination</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">MAC addresses in the frame encapsulating this IP datagram as the frame is transmitted <i>(i) </i>from A to the switch, <i>(ii) </i>from the switch to the right router, <i>(iii) </i>from the right router to F. Also give the source and destination IP addresses in the IP datagram encapsulated within the frame at each</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">of these points in time.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark545" class="s124">P23. Consider </a><a href="#bookmark545" class="a">Figure 6.15</a> <span class="p">. Suppose that all links are 100 Mbps. What is the maximum total aggregate throughput that can be achieved among the 9 hosts and 2 servers in this network? You can assume that any host or server can send to any other host or server. Why?</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark545" class="s124">P24. Suppose the three departmental switches in </a><a href="#bookmark545" class="a">Figure 6.15</a> <span class="p">are replaced by hubs. All links are 100 Mbps. Now answer the questions posed in problem P23.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P25. Suppose that <i>all </i><a href="#bookmark545" class="s124">the switches in </a><a href="#bookmark545" class="a">Figure 6.15</a><span class="s20"> </span>are replaced by hubs. All links are 100 Mbps. Now answer the questions posed in problem P23.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">P26. Let’s consider the operation of a learning switch in the context of a network in which 6 nodes labeled A through F are star connected into an Ethernet switch. Suppose that <i>(i) </i>B sends a frame to E, <i>(ii) </i>E replies with a frame to B, <i>(iii) </i>A sends a frame to B, <i>(iv) </i>B replies with a frame</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;"><a name="bookmark586">to A. The switch table is initially empty. Show the state of the switch table before and after each</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">of these events. For each of these events, identify the link(s) on which the transmitted frame will be forwarded, and briefly justify your answers.</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P27. In this problem, we explore the use of small packets for Voice-over-IP applications. One of the drawbacks of a small packet size is that a large fraction of link bandwidth is consumed by</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">overhead bytes. To this end, suppose that the packet consists of <i>P </i>bytes and 5 bytes of header.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l285"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Consider sending a digitally encoded voice source directly. Suppose the source is encoded at a constant rate of 128 kbps. Assume each packet is entirely filled before the</p><p style="padding-top: 3pt;text-indent: 0pt;text-align: center;">source sends the packet into the network. The time required to fill a packet is the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;"><span class="s23">packetization</span><span class="s20"> delay</span>. In terms of <i>L</i>, determine the packetization delay in milliseconds.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Packetization delays greater than 20 msec can cause a noticeable and unpleasant echo.</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">Determine the packetization delay for L=1,500 bytes (roughly corresponding to a maximum-sized Ethernet packet) and for L=50 (corresponding to an ATM packet).</p></li><li style="padding-left: 48pt;text-indent: -17pt;line-height: 124%;text-align: left;"><p style="display: inline;">Calculate the store-and-forward delay at a single switch for a link rate of <span class="s27">R</span>=622 Mbps for L=1,500 bytes, and for L=50 bytes.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Comment on the advantages of using a small packet size.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark560" class="s124">P28. Consider the single switch VLAN in </a><a href="#bookmark560" class="a">Figure 6.25</a> <span class="p">, and assume an external router is connected to switch port 1. Assign IP addresses to the EE and CS hosts and router interface. Trace the steps taken at both the network layer and the link layer to transfer an IP datagram</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">from an EE host to a CS host (<i>Hint: </i><a href="#bookmark550" class="s124">Reread the discussion of </a><a href="#bookmark550" class="a">Figure 6.19</a><span class="s20"> </span>in the text).</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark567" class="s124">P29. Consider the MPLS network shown in </a><a href="#bookmark567" class="a">Figure 6.29</a> <span class="p">, and suppose that routers R5 and R6 are now MPLS enabled. Suppose that we want to perform traffic engineering so that packets from R6 destined for A are switched to A via R6-R4-R3-R1, and packets from R5 destined for A</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">are switched via R5-R4-R2-R1. Show the MPLS tables in R5 and R6, as well as the modified table in R4, that would make this possible.</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P30. Consider again the same scenario as in the previous problem, but suppose that packets from R6 destined for D are switched via R6-R4-R3, while packets from R5 destined to D are switched via R4-R2-R1-R3. Show the MPLS tables in all routers that would make this possible.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P31. In this problem, you will put together much of what you have learned about Internet protocols. Suppose you walk into a room, connect to Ethernet, and want to download a Web page. What are all the protocol steps that take place, starting from powering on your PC to</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">getting the Web page? Assume there is nothing in our DNS or browser caches when you power</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">on your PC. (<i>Hint: </i>The steps include the use of Ethernet, DHCP, ARP, DNS, TCP, and HTTP protocols.) Explicitly indicate in your steps how you obtain the IP and MAC addresses of a gateway router.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark571" class="s124">P32. Consider the data center network with hierarchical topology in </a><a href="#bookmark571" class="a">Figure 6.30</a> <span class="p">. Suppose now</span></p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">there are 80 pairs of flows, with ten flows between the first and ninth rack, ten flows between the second and tenth rack, and so on. Further suppose that all links in the network are 10 Gbps, except for the links between hosts and TOR switches, which are 1 Gbps.</p><ol id="l286"><li style="padding-top: 1pt;padding-left: 91pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Each flow has the same data rate; determine the maximum rate of a flow.</p></li><li style="padding-top: 4pt;padding-left: 91pt;text-indent: -18pt;line-height: 139%;text-align: left;"><p class="s20" style="display: inline;"><a href="#bookmark572" class="s124">For the same traffic pattern, determine the maximum rate of a flow for the highly interconnected topology in </a><a href="#bookmark572" class="a">Figure 6.31</a> <span class="p">.</span></p></li><li style="padding-left: 91pt;text-indent: -18pt;line-height: 16pt;text-align: left;"><p style="display: inline;">Now suppose there is a similar traffic pattern, but involving 20 hosts on each rack and</p></li></ol></li></ol><p style="padding-top: 4pt;padding-left: 91pt;text-indent: 0pt;text-align: left;">160 pairs of flows. Determine the maximum flow rates for the two topologies.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 48pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark571" class="s124">P33. Consider the hierarchical network in </a><a href="#bookmark571" class="a">Figure 6.30</a> <span class="p">and suppose that the data center needs to support e-mail and video distribution among other applications. Suppose four racks of servers are reserved for e-mail and four racks are reserved for video. For each of the applications, all</span></p><p style="padding-top: 1pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">four racks must lie below a single tier-2 switch since the tier-2 to tier-1 links do not have sufficient bandwidth to support the intra-application traffic. For the e-mail application, suppose that for 99.9 percent of the time only three racks are used, and that the video application has identical usage patterns.</p><ol id="l287"><li style="padding-top: 1pt;padding-left: 91pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">For what fraction of time does the e-mail application need to use a fourth rack? How about for the video application?</p></li><li style="padding-top: 3pt;padding-left: 91pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Assuming e-mail usage and video usage are independent, for what fraction of time do (equivalently, what is the probability that) both applications need their fourth rack?</p></li><li style="padding-top: 3pt;padding-left: 91pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose that it is acceptable for an application to have a shortage of servers for 0.001 percent of time or less (causing rare periods of performance degradation for users).</p></li></ol><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 91pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark572" class="s124">Discuss how the topology in </a><a href="#bookmark572" class="a">Figure 6.31</a> <span class="p">can be used so that only seven racks are collectively assigned to the two applications (assuming that the topology can support all the traffic).</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark587">Wireshark Labs</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources/" class="s124" target="_blank">At the Companion website for this textbook, </a><a href="http://www.pearsonhighered.com/cs-resources/" class="a" target="_blank">http://www.pearsonhighered.com/cs-resources/</a><a href="http://www.pearsonhighered.com/cs-resources/" class="s124" target="_blank">,</a> you’ll find a Wireshark lab that examines the operation of the IEEE 802.3 protocol and the Wireshark frame format. A second Wireshark lab examines packet traces taken in a home network scenario.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="237" alt="image" src="计算机网络自顶向下7th-en/Image_680.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">AN INTERVIEW WITH…</p><p class="s28" style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Simon S. Lam</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Simon S. Lam is Professor and Regents Chair in Computer Sciences at the University of Texas at Austin. From 1971 to 1974, he was with the ARPA Network Measurement Center at UCLA, where he worked on satellite and radio packet switching. He led a research group that invented secure sockets and prototyped, in 1993, the first secure sockets layer named Secure Network Programming, which won the 2004 ACM Software System Award. His research interests are in design and analysis of network protocols and security services. He received his BSEE from</p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_681.png"/></span></p><p style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Washington State University and his MS and PhD from UCLA. He was elected to the National Academy of Engineering in 2007.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><span><img width="140" height="180" alt="image" src="计算机网络自顶向下7th-en/Image_682.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Why did you decide to specialize in networking?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">When I arrived at UCLA as a new graduate student in Fall 1969, my intention was to study control theory. Then I took the queuing theory classes of Leonard Kleinrock and was very impressed by him. For a while, I was working on adaptive control of queuing systems as a possible thesis topic. In early 1972, Larry Roberts initiated the ARPAnet Satellite System project (later called Packet Satellite). Professor Kleinrock asked me to join the project. The first thing we did was to introduce a simple, yet realistic, backoff algorithm to the slotted ALOHA protocol. Shortly thereafter, I found many interesting research problems, such as ALOHA’s instability problem and need for adaptive backoff, which would form the core of my thesis.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">You were active in the early days of the Internet in the 1970s, beginning with your student days</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">at UCLA. What was it like then? Did people have any inkling of what the Internet would become?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">The atmosphere was really no different from other system-building projects I have seen in industry and academia. The initially stated goal of the ARPAnet was fairly modest, that is, to provide access to expensive computers from remote locations so that many more scientists could use them. However, with the startup of the Packet Satellite project in 1972 and the Packet Radio project in 1973, ARPA’s goal had expanded substantially. By 1973, ARPA was building three different packet networks at the same time, and it became necessary for Vint Cerf and Bob Kahn to develop an interconnection strategy.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Back then, all of these progressive developments in networking were viewed (I believe) as logical rather than magical. No one could have envisioned the scale of the Internet and power of personal computers today. It was a decade before appearance of the first PCs. To put things in perspective, most students submitted their computer programs as decks of punched cards for batch processing. Only some students had direct access to computers, which were typically housed in a restricted area. Modems were slow and still a rarity. As a graduate student, I had only a phone on my desk, and I used pencil and paper to do most of my work.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_683.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Where do you see the field of networking and the Internet heading in the future?</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 23pt;text-align: left;">In the past, the simplicity of the Internet’s IP protocol was its greatest strength in vanquishing competition and becoming the <i>de facto </i>standard for internetworking. Unlike competitors, such as</p><p style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">X.25 in the 1980s and ATM in the 1990s, IP can run on top of any link-layer networking technology, because it offers only a best-effort datagram service. Thus, any packet network can connect to the Internet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Today, IP’s greatest strength is actually a shortcoming. IP is like a straitjacket that confines the Internet’s development to specific directions. In recent years, many researchers have redirected their efforts to the application layer only. There is also a great deal of research on wireless ad hoc networks, sensor networks, and satellite networks. These networks can be viewed either as stand-alone systems or link-layer systems, which can flourish because they are outside of the IP straitjacket.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Many people are excited about the possibility of P2P systems as a platform for novel Internet applications. However, P2P systems are highly inefficient in their use of Internet resources. A concern of mine is whether the transmission and switching capacity of the Internet core will continue to increase faster than the traffic demand on the Internet as it grows to interconnect all kinds of devices and support future P2P-enabled applications. Without substantial overprovisioning of capacity, ensuring network stability in the presence of malicious attacks and congestion will continue to be a significant challenge.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">The Internet’s phenomenal growth also requires the allocation of new IP addresses at a rapid rate to network operators and enterprises worldwide. At the current rate, the pool of unallocated IPv4 addresses would be depleted in a few years. When that happens, large contiguous blocks of address space can only be allocated from the IPv6 address space. Since adoption of IPv6 is off to a slow start, due to lack of incentives for early adopters, IPv4 and IPv6 will most likely co- exist on the Internet for many years to come. Successful migration from an IPv4-dominant Internet to an IPv6-dominant Internet will require a substantial global effort.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What is the most challenging part of your job?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;">The most challenging part of my job as a professor is teaching and motivating <i>every </i>student in my class, and <i>every </i>doctoral student under my supervision, rather than just the high achievers. The very bright and motivated may require a little guidance but not much else. I often learn more</p><p style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">from these students than they learn from me. Educating and motivating the underachievers present a major challenge.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What impacts do you foresee technology having on learning in the future?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 145%;text-align: left;">Eventually, almost all human knowledge will be accessible through the Internet, which will be the most powerful tool for learning. This vast knowledge base will have the potential of leveling the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="189" alt="image" src="计算机网络自顶向下7th-en/Image_684.png"/></span></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark588">playing field for students all over the world. For example, motivated students in any country will be able to access the best-class Web sites, multimedia lectures, and teaching materials. Already, it was said that the IEEE and ACM digital libraries have accelerated the development of computer science researchers in China. In time, the Internet will transcend all geographic barriers to learning.</a><a name="bookmark589">&zwnj;</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="783" height="2" alt="image" src="计算机网络自顶向下7th-en/Image_685.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s16" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark590">Chapter </a><span class="h1">7 </span>Wireless and Mobile Networks</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="1" alt="image" src="计算机网络自顶向下7th-en/Image_686.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the telephony world, the past 20 years have arguably been the golden years of cellular telephony. The number of worldwide mobile cellular subscribers increased from 34 million in 1993 to nearly 7.0 billion subscribers by 2014, with the number of cellular subscribers now surpassing the number of wired telephone lines. There are now a larger number of mobile phone subscriptions than there are people on our planet. The many advantages of cell phones are evident to all—anywhere, anytime, untethered access to the global telephone network via a highly portable lightweight device. More recently, laptops, smartphones, and tablets are wirelessly connected to the Internet via a cellular or WiFi network. And increasingly, devices such as gaming consoles, thermostats, home security systems, home appliances, watches, eye glasses, cars, traffic control systems and more are being wirelessly connected to the Internet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">From a networking standpoint, the challenges posed by networking these wireless and mobile devices, particularly at the link layer and the network layer, are so different from traditional wired computer networks that an individual chapter devoted to the study of wireless and mobile networks (i.e., <i>this</i></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">chapter) is appropriate.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">We’ll begin this chapter with a discussion of mobile users, wireless links, and networks, and their relationship to the larger (typically wired) networks to which they connect. We’ll draw a distinction between the challenges posed by the <i>wireless </i>nature of the communication links in such networks,</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">and by the <i>mobility </i>that these wireless links enable. Making this important distinction—between wireless</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">and mobility—will allow us to better isolate, identify, and master the key concepts in each area. Note that there are indeed many networked environments in which the network nodes are wireless but not mobile (e.g., wireless home or office networks with stationary workstations and large displays), and that there are limited forms of mobility that do not require wireless links (e.g., a worker who uses a wired laptop at home, shuts down the laptop, drives to work, and attaches the laptop to the company’s wired network). Of course, many of the most exciting networked environments are those in which users are</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">both wireless <i>and </i>mobile—for example, a scenario in which a mobile user (say in the back seat of car) maintains a Voice-over-IP call and multiple ongoing TCP connections while racing down the autobahn at 160 kilometers per hour, soon in an autonomous vehicle. It is here, at the intersection of wireless and</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">mobility, that we’ll find the most interesting technical challenges!</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark591">We’ll begin by illustrating the setting in which we’ll consider wireless communication and mobility—a network in which wireless (and possibly mobile) users are connected into the larger network infrastructure by a wireless link at the network’s edge. We’ll then consider the characteristics of this</a></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark603" class="s124">wireless link in </a><a href="#bookmark603" class="a">Section 7.</a>2<a href="#bookmark603" class="s124">. We include a brief introduction to code division multiple access (CDMA), a shared-medium access protocol that is often used in wireless networks, in </a><a href="#bookmark603" class="a">Section 7.</a>2<a href="#bookmark624" class="s124">. In </a><a href="#bookmark624" class="a">Section 7.</a>3<span class="p">, we’ll examine the link-level aspects of the IEEE 802.11 (WiFi) wireless LAN standard in some depth;</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark635" class="s124">we’ll also say a few words about Bluetooth and other wireless personal area networks. In </a><a href="#bookmark635" class="a">Section 7.</a>4<span class="p">, we’ll provide an overview of cellular Internet access, including 3G and emerging 4G cellular</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark645" class="s124">technologies that provide both voice and high-speed Internet access. In </a><a href="#bookmark645" class="a">Section 7.</a>5<span class="p">, we’ll turn our attention to mobility, focusing on the problems of locating a mobile user, routing to the mobile user, and “handing off” the mobile user who dynamically moves from one point of attachment to the network to</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">another. We’ll examine how these mobility services are implemented in the mobile IP standard in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark650" class="s124">enterprise 802.11 networks, and in LTE cellular networks in </a><a href="#bookmark650" class="a">Sections 7.6</a> <a href="#bookmark658" class="s124">and </a><a href="#bookmark658" class="a">7.</a>7<span class="p">, respectively. Finally, we’ll consider the impact of wireless links and mobility on transport-layer protocols and networked</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark662" class="s124">applications in </a><a href="#bookmark662" class="a">Section 7.</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l288"><ol id="l289"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark592">Introduction</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark593" class="a">Figure 7.1</a> <span class="p">shows the setting in which we’ll consider the topics of wireless data communication and mobility. We’ll begin by keeping our discussion general enough to cover a wide range of networks, including both wireless LANs such as IEEE 802.11 and cellular networks such as a 4G network; we’ll</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">drill down into a more detailed discussion of specific wireless architectures in later sections. We can identify the following elements in a wireless network:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_687.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>Wireless hosts. </b>As in the case of wired networks, hosts are the end-system devices that run applications. A <span class="s20">wireless host </span>might be a laptop, tablet, smartphone, or desktop computer. The hosts themselves may or may not be mobile.</p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="673" height="562" alt="image" src="计算机网络自顶向下7th-en/Image_688.png"/></span></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><h2 style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark593">Figure 7.1 Elements of a wireless network</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_689.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><b>Wireless links. </b>A host connects to a base station (defined below) or to another wireless host through a <span class="s20">wireless communication link</span>. Different wireless link technologies have different</p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark594" class="s124">transmission rates and can transmit over different distances. </a><a href="#bookmark594" class="a">Figure 7.2</a> <span class="p">shows two key characteristics (coverage area and link rate) of the more popular wireless network standards. (The figure is only meant to provide a rough idea of these characteristics. For example, some of these</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">types of networks are only now being deployed, and some link rates can increase or decrease beyond the values shown depending on distance, channel conditions, and the number of users in the wireless network.) We’ll cover these standards later in the first half of this chapter; we’ll also consider other wireless link characteristics (such as their bit error rates and the causes of bit errors)</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark603" class="s124">in </a><a href="#bookmark603" class="a">Section 7.</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark593" class="s124">In </a><a href="#bookmark593" class="a">Figure 7.</a><span class="s20">1</span>, wireless links connect wireless hosts located at the edge of the network into the larger network infrastructure. We hasten to add that wireless links are also sometimes used <i>within </i>a network to connect routers, switches, and</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="618" height="426" alt="image" src="计算机网络自顶向下7th-en/Image_690.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark594">Figure 7.2 Link characteristics of selected wireless network standards</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">other network equipment. However, our focus in this chapter will be on the use of wireless communication at the network edge, as it is here that many of the most exciting technical challenges, and most of the growth, are occurring.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_691.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 136%;text-align: left;"><b>Base station. </b>The <span class="s23">base</span><span class="s20"> station </span>is a key part of the wireless network infrastructure. Unlike the wireless host and wireless link, a base station has no obvious counterpart in a wired network. A base station is responsible for sending and receiving data (e.g., packets) to and from a wireless host that</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">is associated with that base station. A base station will often be responsible for coordinating the transmission of multiple wireless hosts with which it is associated. When we say a wireless host is</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">“associated” with a base station, we mean that (1) the host is within the wireless communication distance of the base station, and (2) the host uses that base station to relay data between it (the host) and the larger network. <span class="s20">Cell towers </span>in cellular networks and <span class="s20">access points </span>in 802.11 wireless LANs are examples of base stations.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark593" class="s124">In </a><a href="#bookmark593" class="a">Figure 7.</a>1<span class="p">, the base station is connected to the larger network (e.g., the Internet, corporate or home network, or telephone network), thus functioning as a link-layer relay between the wireless host and the rest of the world with which the host communicates.</span></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="823" alt="image" src="计算机网络自顶向下7th-en/Image_692.png"/></span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">Hosts associated with a base station are often referred to as operating in <span class="s20">infrastructure mode</span>, since all traditional network services (e.g., address assignment and routing) are provided by the network to which a host is connected via</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">CASE HISTORY</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">PUBLIC WIFI ACCESS: COMING SOON TO A LAMP POST NEAR YOU?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">WiFi hotspots—public locations where users can find 802.11 wireless access—are becoming increasingly common in hotels, airports, and cafés around the world. Most college campuses offer ubiquitous wireless access, and it’s hard to find a hotel that doesn’t offer wireless Internet access.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Over the past decade a number of cities have designed, deployed, and operated municipal WiFi networks. The vision of providing ubiquitous WiFi access to the community as a public service (much like streetlights)—helping to bridge the digital divide by providing Internet access to all citizens and to promote economic development—is compelling. Many cities around the world, including Philadelphia, Toronto, Hong Kong, Minneapolis, London, and Auckland, have plans to provide ubiquitous wireless within the city, or have already done so to varying degrees. The goal in Philadelphia was to “turn Philadelphia into the nation’s largest WiFi hotspot and help to improve education, bridge the digital divide, enhance neighborhood development, and reduce the costs of government.” The ambitious program— an agreement between the city, Wireless Philadelphia (a nonprofit entity), and the Internet Service Provider Earthlink—built an operational network of 802.11b hotspots on streetlamp pole arms and traffic control devices that covered 80 percent of the city. But financial and operational concerns caused the network to be sold to a group of private investors in 2008, who later sold the network back to the city in 2010. Other cities, such as Minneapolis, Toronto, Hong Kong, and Auckland, have had success with smaller-scale efforts.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark624" class="s124">The fact that 802.11 networks operate in the unlicensed spectrum (and hence can be deployed without purchasing expensive spectrum use rights) would seem to make them financially attractive. However, 802.11 access points (see </a><a href="#bookmark624" class="a">Section 7.</a>3<span class="p">) have much shorter</span></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark635" class="s124">ranges than 4G cellular base stations (see </a><a href="#bookmark635" class="a">Section 7.</a>4<span class="p">), requiring a larger number of</span></p><p style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">deployed endpoints to cover the same geographic region. Cellular data networks providing Internet access, on the other hand, operate in the licensed spectrum. Cellular providers pay</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="86" alt="image" src="计算机网络自顶向下7th-en/Image_693.png"/></span></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">billions of dollars for spectrum access rights for their networks, making cellular data networks a business rather than municipal undertaking.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">the base station. In <span class="s20">ad hoc networks</span>, wireless hosts have no such infrastructure with which to connect. In the absence of such infrastructure, the hosts themselves must provide for services such as routing, address assignment, DNS-like name translation, and more.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">When a mobile host moves beyond the range of one base station and into the range of another, it will change its point of attachment into the larger network (i.e., change the base station with which it is associated)—a process referred to as <span class="s20">handoff</span>. Such mobility raises many challenging questions. If a host can move, how does one find the mobile host’s current location in the network so that data can be forwarded to that mobile host? How is addressing performed, given that a host can be in one</p><p style="padding-top: 2pt;padding-left: 25pt;text-indent: 0pt;line-height: 138%;text-align: left;">of many possible locations? If the host moves <i>during </i>a TCP connection or phone call, how is data routed so that the connection continues uninterrupted? These and many (many!) other questions make wireless and mobile networking an area of exciting networking research.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_694.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Network infrastructure. <span class="p">This is the larger network with which a wireless host may wish to communicate.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having discussed the “pieces” of a wireless network, we note that these pieces can be combined in many different ways to form different types of wireless networks. You may find a taxonomy of these types of wireless networks useful as you read on in this chapter, or read/learn more about wireless networks beyond this book. At the highest level we can classify wireless networks according to two</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">criteria: <i>(i) </i>whether a packet in the wireless network crosses exactly <i>one wireless hop or multiple wireless hops</i>, and <i>(ii) </i>whether there is <i>infrastructure </i>such as a base station in the network:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_695.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Single-hop, infrastructure-based. <span class="p">These networks have a base station that is connected to a larger wired network (e.g., the Internet). Furthermore, all communication is between this base station and a wireless host over a single wireless hop. The 802.11 networks you use in the classroom, café,</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_696.png"/></span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;">or library; and the 4G LTE data networks that we will learn about shortly all fall in this category. The vast majority of our daily interactions are with single-hop, infrastructure-based wireless networks. <b>Single-hop, infrastructure-less. </b>In these networks, there is no base station that is connected to a</p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 11pt;text-align: left;">wireless network. However, as we will see, one of the nodes in this single-hop network may</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">coordinate the transmissions of the other nodes. Bluetooth networks (that connect small wireless</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark625" class="s124">devices such as keyboards, speakers, and headsets, and which we will study in </a><a href="#bookmark625" class="a">Section 7.3.</a>6<span class="p">) and</span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">802.11 networks in ad hoc mode are single-hop, infrastructure-less networks.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_697.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Multi-hop, infrastructure-based. <span class="p">In these networks, a base station is present that is wired to the larger network. However, some wireless nodes may have to relay their communication through other wireless nodes in order to communicate via the base station. Some wireless sensor networks and</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">so-called <span class="s20">wireless mesh networks </span>fall in this category.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_698.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Multi-hop, infrastructure-less. <span class="p">There is no base station in these networks, and nodes may have to relay messages among several other nodes in order to reach a destination. Nodes may also be</span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark595">mobile, with connectivity changing among nodes—a class of networks known as </a><span class="s20">mobile ad hoc networks (MANETs)</span>. If the mobile nodes are vehicles, the network is a <span class="s20">vehicular ad hoc network (VANET)</span>. As you might imagine, the development of protocols for such networks is challenging and is the subject of much ongoing research.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this chapter, we’ll mostly confine ourselves to single-hop networks, and then mostly to infrastructure- based networks.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now dig deeper into the technical challenges that arise in wireless and mobile networks. We’ll begin by first considering the individual wireless link, deferring our discussion of mobility until later in this chapter.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark596">Wireless Links and Network Characteristics</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark561" class="s124">Let’s begin by considering a simple wired network, say a home network, with a wired Ethernet switch (see </a><a href="#bookmark561" class="a">Section 6.</a>4<span class="p">) interconnecting the hosts. If we replace the wired Ethernet with a wireless 802.11</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">network, a wireless network interface would replace the host’s wired Ethernet interface, and an access point would replace the Ethernet switch, but virtually no changes would be needed at the network layer or above. This suggests that we focus our attention on the link layer when looking for important differences between wired and wireless networks. Indeed, we can find a number of important differences between a wired link and a wireless link:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_699.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>Decreasing signal strength. </b>Electromagnetic radiation attenuates as it passes through matter (e.g., a radio signal passing through a wall). Even in free space, the signal will disperse, resulting in decreased signal strength (sometimes referred to as <span class="s20">path loss</span>) as the distance between sender and</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">receiver increases.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_700.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Interference from other sources. <span class="p">Radio sources transmitting in the same frequency band will interfere with each other. For example, 2.4 GHz wireless phones and 802.11b wireless LANs transmit in the same frequency band. Thus, the 802.11b wireless LAN user talking on a 2.4 GHz</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">wireless phone can expect that neither the network nor the phone will perform particularly well. In addition to interference from transmitting sources, electromagnetic noise within the environment (e.g., a nearby motor, a microwave) can result in interference.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_701.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 136%;text-align: left;">Multipath propagation. <span class="s23">Multipath</span><span style=" color: #1E79B8;"> propagation </span><span class="p">occurs when portions of the electromagnetic wave reflect off objects and the ground, taking paths of different lengths between a sender and receiver. This results in the blurring of the received signal at the receiver. Moving objects between the sender</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">and receiver can cause multipath propagation to change over time.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">For a detailed discussion of wireless channel characteristics, models, and measurements, see</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="a">[Anderson 1995</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The discussion above suggests that bit errors will be more common in wireless links than in wired links. For this reason, it is perhaps not surprising that wireless link protocols (such as the 802.11 protocol we’ll examine in the following section) employ not only powerful CRC error detection codes, but also link-level reliable-data-transfer protocols that retransmit corrupted frames.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having considered the impairments that can occur on a wireless channel, let’s next turn our attention to the host receiving the wireless signal. This host receives an electromagnetic signal that is a combination of a degraded form of the original signal transmitted by the sender (degraded due to the attenuation and multipath propagation effects that we discussed above, among others) and background noise in the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">environment. The <span class="s20">signal-to-noise ratio (SNR) </span>is a relative measure of the strength of the received signal (i.e., the information being transmitted) and this noise. The SNR is typically measured in units of decibels (dB), a unit of measure that some think is used by electrical engineers primarily to confuse computer scientists. The SNR, measured in dB, is twenty times the ratio of the base-10 logarithm of the amplitude of the received signal to the amplitude of the noise. For our purposes here, we need only know that a larger SNR makes it easier for the receiver to extract the transmitted signal from the background noise.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark597" class="a">Figure 7.3</a> <a href="#bookmark848" class="s124">(adapted from </a><a href="#bookmark848" class="a">[Holland 2001</a>]<span class="p">) shows the bit error rate (BER)—roughly speaking, the probability that a transmitted bit is received in error at the receiver—versus the SNR for three different modulation techniques for encoding information for transmission on an idealized wireless channel. The</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">theory of modulation and coding, as well as signal extraction and BER, is well beyond the scope of</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="350" height="337" alt="image" src="计算机网络自顶向下7th-en/Image_702.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark597">Figure 7.3 Bit error rate, transmission rate, and SNR</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="248" height="250" alt="image" src="计算机网络自顶向下7th-en/Image_703.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark598">Figure 7.4 Hidden terminal problem caused by obstacle (a) and fading (b)</a></h2><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="255" height="267" alt="image" src="计算机网络自顶向下7th-en/Image_704.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">this text (see </a><a href="#bookmark848" class="a">[Schwartz 1980]</a> <a href="#bookmark597" class="s124">for a discussion of these topics). Nonetheless, </a><a href="#bookmark597" class="a">Figure 7.3</a> <span class="p">illustrates several physical-layer characteristics that are important in understanding higher-layer wireless communication protocols:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_705.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">For a given modulation scheme, the higher the SNR, the lower the BER. <span class="p">Since a sender can increase the SNR by increasing its transmission power, a sender can decrease the probability that a frame is received in error by increasing its transmission power. Note, however, that there is arguably</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 135%;text-align: left;">little practical gain in increasing the power beyond a certain threshold, say to decrease the BER from <span class="s27">1</span>0−12 to <span class="s27">1</span>0−13. There are also <i>disadvantages </i>associated with increasing the transmission power: More energy must be expended by the sender (an important concern for battery-powered mobile</p><p class="s20" style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark598" class="s124">users), and the sender’s transmissions are more likely to interfere with the transmissions of another sender (see </a><a href="#bookmark598" class="a">Figure </a>7.4(b)<span class="p">).</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_706.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 12pt;text-align: left;">For a given SNR, a modulation technique with a higher bit transmission rate (whether in error</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">or not) will have a higher BER. <a href="#bookmark597" class="s124">For example, in </a><a href="#bookmark597" class="a">Figure 7.</a><span style=" color: #1E79B8;">3</span><span class="p">, with an SNR of 10 dB, BPSK modulation with a transmission rate of 1 Mbps has a BER of less than 10−7, while with QAM16 modulation with a transmission rate of 4 Mbps, the BER is 10−1, far too high to be practically useful.</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">However, with an SNR of 20 dB, QAM16 modulation has a transmission rate of 4 Mbps and a BER of 10−7, while BPSK modulation has a transmission rate of only 1 Mbps and a BER that is so low as to be (literally) “off the charts.” If one can tolerate a BER of 10−7, the higher transmission rate offered by QAM16 would make it the preferred modulation technique in this situation. These considerations give rise to the final characteristic, described next.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_707.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 25pt;text-indent: 0pt;line-height: 138%;text-align: left;">Dynamic selection of the physical-layer modulation technique can be used to adapt the modulation technique to channel conditions. <span class="p">The SNR (and hence the BER) may change as a result of mobility or due to changes in the environment. Adaptive modulation and coding are used in</span></p><p style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;text-align: left;">cellular data systems and in the 802.11 WiFi and 4G cellular data networks that we’ll study in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 25pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark624" class="a">Sections 7.3</a> <a href="#bookmark635" class="s124">and </a><a href="#bookmark635" class="a">7.</a>4<span class="p">. This allows, for example, the selection of a modulation technique that provides the highest transmission rate possible subject to a constraint on the BER, for given channel characteristics.</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark598" class="s124">A higher and time-varying bit error rate is not the only difference between a wired and wireless link. Recall that in the case of wired broadcast links, all nodes receive the transmissions from all other nodes. In the case of wireless links, the situation is not as simple, as shown in </a><a href="#bookmark598" class="a">Figure 7.</a>4<span class="p">. Suppose that Station</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">A is transmitting to Station B. Suppose also that Station C is transmitting to Station B. With the so-called</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">hidden terminal problem<a href="#bookmark598" class="s124">, physical obstructions in the environment (for example, a mountain or a building) may prevent A and C from hearing each other’s transmissions, even though A’s and C’s transmissions are indeed interfering at the destination, B. This is shown in </a><a href="#bookmark598" class="a">Figure 7.4(a</a>)<span class="p">. A second</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">scenario that results in undetectable collisions at the receiver results from the <span class="s20">fading </span>of a signal’s</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark598" class="s124">strength as it propagates through the wireless medium. </a><a href="#bookmark598" class="a">Figure 7.4(b)</a> <span class="p">illustrates the case where A and C are placed such that their signals are not strong enough to detect each other’s transmissions, yet their</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;">signals <i>are </i><a href="#bookmark624" class="s124">strong enough to interfere with each other at station B. As we’ll see in </a><a href="#bookmark624" class="a">Section 7.</a><span class="s20">3</span>, the hidden terminal problem and fading make multiple access in a wireless network considerably more complex than in a wired network.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">7.2.1 CDMA</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark513" class="s124">Recall from </a><a href="#bookmark513" class="a">Chapter 6</a> <a href="#bookmark513" class="s124">that when hosts communicate over a shared medium, a protocol is needed so that the signals sent by multiple senders do not interfere at the receivers. In </a><a href="#bookmark513" class="a">Chapter 6</a> <span class="p">we described three classes of medium access protocols: channel partitioning, random access, and taking turns. Code</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">division multiple access (CDMA) belongs to the family of channel partitioning protocols. It is prevalent in wireless LAN and cellular technologies. Because CDMA is so important in the wireless world, we’ll take a quick look at CDMA now, before getting into specific wireless access technologies in the subsequent sections.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><span class="p">In a CDMA protocol, each bit being sent is encoded by multiplying the bit by a signal (the code) that changes at a much faster rate (known as the </span>chipping rate<a href="#bookmark600" class="s124">) than the original sequence of data bits. </a><a href="#bookmark600" class="a">Figure 7.5</a> <span class="p">shows a simple, idealized CDMA encoding/decoding scenario. Suppose that the rate at</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">which original data bits reach the CDMA encoder defines the unit of time; that is, each original data bit to</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 142%;text-align: left;"><a name="bookmark599">be transmitted requires a one-bit slot time. Let </a><i>d</i><span class="s31">i </span>be the value of the data bit for the <i>i</i>th bit slot. For mathematical convenience, we represent a data bit with a 0 value as −1. Each bit slot is further subdivided into <i>M </i><a href="#bookmark600" class="s124">mini-slots; in </a><a href="#bookmark600" class="a">Figure 7.</a><span class="s20">5</span>, <span class="s27">M</span>=8,</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="782" height="683" alt="image" src="计算机网络自顶向下7th-en/Image_708.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark600">Figure 7.5 A simple CDMA example: Sender encoding, receiver decoding</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 129%;text-align: left;">although in practice <i>M </i>is much larger. The CDMA code used by the sender consists of a sequence of <i>M </i>values, <span class="s27">cm</span>, m=1,…, M, each taking <span class="s27">a</span>+1 or <span class="s27">−</span><a href="#bookmark600" class="s124">1 value. In the example in </a><a href="#bookmark600" class="a">Figure 7.</a><span class="s20">5</span>, the <i>M</i>-bit CDMA code being used by the sender is (1,1,1,−1,1,−1,−1,−1).</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 156%;text-align: left;">To illustrate how CDMA works, let us focus on the <i>i</i>th data bit, <i>d</i><span class="s31">i</span>. For the <i>m</i>th mini-slot of the bit- transmission time of <i>d</i><span class="s31">i</span>, the output of the CDMA encoder, <i>Z</i><span class="s31">i,m</span>, is the value of <i>d</i><span class="s31">i </span>multiplied by the <i>m</i>th bit in the assigned CDMA code, <i>c</i><span class="s31">m</span>:</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark601">Zi,m=di</a><span class="s29">⋅</span>cm                                                                                                                                                <span class="s27">(7.1)</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 156%;text-align: left;">In a simple world, with no interfering senders, the receiver would receive the encoded bits, <i>Z</i><span class="s31">i,m</span>, and recover the original data bit, <i>d</i><span class="s31">i</span>, by computing:</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark602">di=1M∑m=1MZi,m</a><span class="s29">⋅</span>cm                                                                                                                              <span class="s27">(7.2)</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark600" class="s124">The reader might want to work through the details of the example in </a><a href="#bookmark600" class="a">Figure 7.5</a> <a href="#bookmark602" class="s124">to see that the original data bits are indeed correctly recovered at the receiver using </a><a href="#bookmark602" class="a">Equation 7.</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The world is far from ideal, however, and as noted above, CDMA must work in the presence of interfering senders that are encoding and transmitting their data using a different assigned code. But how can a CDMA receiver recover a sender’s original data bits when those data bits are being tangled with bits being transmitted by other senders? CDMA works under the assumption that the interfering transmitted bit signals are additive. This means, for example, that if three senders send a 1 value, and a fourth sender sends a −1 value during the same mini-slot, then the received signal at all receivers during that mini-slot is a 2 (since <span class="s27">1</span>+1+1−1=2). In the presence of multiple senders, sender <i>s </i>computes its</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 14pt;text-align: left;">encoded transmissions, <span class="s27">Z</span><a href="#bookmark601" class="s124">i,ms, in exactly the same manner as in </a><a href="#bookmark601" class="a">Equation 7.</a><span class="s20">1</span>. The value received at a</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">receiver during the <i>m</i>th mini-slot of the <i>i</i>th bit slot, however, is now the <i>sum </i>of the transmitted bits from all <i>N </i>senders during that mini-slot:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Zi,m*=∑s=1NZi,ms</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark602" class="s124">Amazingly, if the senders’ codes are chosen carefully, each receiver can recover the data sent by a given sender out of the aggregate signal simply by using the sender’s code in exactly the same manner as in </a><a href="#bookmark602" class="a">Equation 7.</a>2<span class="p">:</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">di=1M∑m=1MZi,m*<span class="s29">⋅</span>cm                                                                                                                            <span class="s27">(7.3)</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;"><a href="#bookmark605" class="s124">as shown in </a><a href="#bookmark605" class="a">Figure 7.</a><span class="s20">6</span>, for a two-sender CDMA example. The <i>M</i>-bit CDMA code being used by the upper sender is (1,1,1,−1,1,−1,−1,−1), while the CDMA code being used by the lower sender is <span class="s27">(</span><a href="#bookmark605" class="s124">1,−1,1,1,1,−1,1,1). </a><a href="#bookmark605" class="a">Figure 7.6</a><span class="s20"> </span>illustrates a receiver recovering the original data bits from the upper</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">sender. Note that the receiver is able to extract the data from sender 1 in spite of the interfering</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">transmission from sender 2.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark513" class="s124">Recall our cocktail analogy from </a><a href="#bookmark513" class="a">Chapter </a>6<span class="p">. A CDMA protocol is similar to having partygoers speaking in multiple languages; in such circumstances humans are actually quite good at locking into the conversation in the language they understand, while filtering out the remaining conversations. We see</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">here that CDMA is a partitioning protocol in that it partitions the codespace (as opposed to time or frequency) and assigns each node a dedicated piece of the codespace.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Our discussion here of CDMA is necessarily brief; in practice a number of difficult issues must be addressed. First, in order for the CDMA receivers to be able</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="836" alt="image" src="计算机网络自顶向下7th-en/Image_709.png"/></span></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark603">Figure 7.6 A two-sender CDMA example</a><a name="bookmark604">&zwnj;</a><a name="bookmark605">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">to extract a particular sender’s signal, the CDMA codes must be carefully chosen. Second, our discussion has assumed that the received signal strengths from various senders are the same; in reality this can be difficult to achieve. There is a considerable body of literature addressing these and other</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">issues related to CDMA; see </a><a href="#bookmark848" class="a">[Pickholtz 198</a>2<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Viterbi 1995]</a> <span class="p">for details.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s18" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark606">7.3 WiFi: 802.11 Wireless LANs</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Pervasive in the workplace, the home, educational institutions, cafés, airports, and street corners, wireless LANs are now one of the most important access network technologies in the Internet today. Although many technologies and standards for wireless LANs were developed in the 1990s, one particular class of standards has clearly emerged as the winner: the <span class="s20">IEEE 802.11 wireless LAN</span>, also known as <span class="s20">WiFi</span>. In this section, we’ll take a close look at 802.11 wireless LANs, examining its frame structure, its medium access protocol, and its internetworking of 802.11 LANs with wired Ethernet LANs.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark607" class="s124">There are several 802.11 standards for wireless LAN technology in the IEEE 802.11 (“WiFi”) family, as summarized in </a><a href="#bookmark607" class="a">Table 7.</a>1<span class="p">. The different 802.11 standards all share some common characteristics. They</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">all use the same medium access protocol, CSMA/CA, which we’ll discuss shortly. All three use the same frame structure for their link-layer frames as well. All three standards have the ability to reduce their transmission rate in order to reach out over greater distances. And, importantly, 802.11 products are also all backwards compatible, meaning, for example, that a mobile capable only of 802.11g may still interact with a newer 802.11ac base station.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark559" class="s124">However, as shown in </a><a href="#bookmark559" class="a">Table 7.</a>1<span class="p">, the standards have some major differences at the physical layer.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">802.11 devices operate in two difference frequency ranges: 2.4–2.485 GHz (referred to as the 2.4 GHz range) and 5.1 – 5.8 GHz (referred to as the 5 GHz range). The 2.4 GHz range is an unlicensed frequency band, where 802.11 devices may compete for frequency spectrum with 2.4 GHz phones and microwave ovens. At 5 GHz, 802.11 LANs have a shorter transmission distance for a given power level</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark848" class="s124">and suffer more from multipath propagation. The two most recent standards, 802.11n </a><a href="#bookmark848" class="a">[IEEE 802.11n 2012]</a> <a href="#bookmark848" class="s124">and 802.11ac </a><a href="#bookmark848" class="a">[IEEE 802.11ac </a>2013<span class="p">; Cisco 802.11ac 2015] uses multiple input multiple-output (MIMO) antennas; i.e., two or more antennas on the sending side and two or more antennas on the</span></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">receiving side that are transmitting/receiving different signals </a><a href="#bookmark848" class="a">[Diggavi 2004</a>]<span class="p">. 802.11ac base</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><h2 style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Table 7.1 Summary of IEEE 802.11 standards</h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Standard</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Frequency Range</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Data Rate</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">802.11b</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2.4 GHz</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">up to 11 Mbps</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">802.11a</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">5 GHz</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">up to 54 Mbps</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">802.11g</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2.4 GHz</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">up to 54 Mbps</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/></tr></table><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p class="s122" style="padding-left: 8pt;text-indent: 0pt;line-height: 14pt;text-align: left;"><a name="bookmark607">802.11n</a></p></td><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p class="s122" style="padding-left: 8pt;text-indent: 0pt;line-height: 14pt;text-align: left;">2.5 GHz and 5 GHz</p></td><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p class="s122" style="padding-left: 8pt;text-indent: 0pt;line-height: 14pt;text-align: left;">up to 450 Mbps</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">802.11ac</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">5 GHz</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">up to 1300 Mbps</p></td></tr></table><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark607" class="s124">stations may transmit to multiple stations simultaneously, and use “smart” antennas to adaptively beamform to target transmissions in the direction of a receiver. This decreases interference and increases the distance reached at a given data rate. The data rates shown in </a><a href="#bookmark607" class="a">Table 7.1</a> <span class="p">are for an</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">idealized environment, e.g., a receiver placed 1 meter away from the base station, with no interference</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">—a scenario that we’re unlikely to experience in practice! So as the saying goes, YMMV: Your Mileage (or in this case your wireless data rate) May Vary.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l290"><ol id="l291"><ol id="l292"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The 802.11 Architecture</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark608" class="a">Figure 7.7</a> <span class="p">illustrates the principal components of the 802.11 wireless LAN architecture. The fundamental building block of the 802.11 architecture is the </span>basic service set (BSS)<span class="p">. A BSS contains one or more wireless stations and a central </span>base station<span class="p">, known as an </span>access point (AP) <span class="p">in 802.11</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark608" class="s124">parlance. </a><a href="#bookmark608" class="a">Figure 7.7</a> <span class="p">shows the AP in each of two BSSs connecting to an interconnection device (such as a switch or router), which in turn leads to the Internet. In a typical home network, there is one AP and one router (typically integrated together as one unit) that connects the BSS to the Internet.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">As with Ethernet devices, each 802.11 wireless station has a 6-byte MAC address that is stored in the firmware of the station’s adapter (that is, 802.11 network interface card). Each AP also has a MAC address for its wireless interface. As with Ethernet, these MAC addresses are administered by IEEE and are (in theory) globally unique.</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="536" height="404" alt="image" src="计算机网络自顶向下7th-en/Image_710.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark608">Figure 7.7 IEEE 802.11 LAN architecture</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="264" height="287" alt="image" src="计算机网络自顶向下7th-en/Image_711.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark609">Figure 7.8 An IEEE 802.11 ad hoc network</a></h2><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 126%;text-align: left;"><a href="#bookmark595" class="s124">As noted in </a><a href="#bookmark595" class="a">Section 7.</a>1<span class="p">, wireless LANs that deploy APs are often referred to as </span><span class="s23">infrastructure</span> wireless LANs<span class="p">, with the “infrastructure” being the APs along with the wired Ethernet infrastructure that</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark609" class="s124">interconnects the APs and a router. </a><a href="#bookmark609" class="a">Figure 7.8</a> <span class="p">shows that IEEE 802.11 stations can also group themselves together to form an ad hoc network—a network with no central control and with no connections to the “outside world.” Here, the network is formed “on the fly,” by mobile devices that</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">have found themselves in proximity to each other, that have a need to communicate, and that find no preexisting network infrastructure in their location. An ad hoc network might be formed when people with</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">laptops get together (for example, in a conference room, a train, or a car) and want to exchange data in the absence of a centralized AP. There has been tremendous interest in ad hoc networking, as communicating portable devices continue to proliferate. In this section, though, we’ll focus our attention on infrastructure wireless LANs.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Channels and Association</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">In 802.11, each wireless station needs to associate with an AP before it can send or receive network- layer data. Although all of the 802.11 standards use association, we’ll discuss this topic specifically in the context of IEEE 802.11b/g.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">When a network administrator installs an AP, the administrator assigns a one- or two-word <span class="s20">Service Set Identifier (SSID) </span>to the access point. (When you choose Wi-Fi under Setting on your iPhone, for example, a list is displayed showing the SSID of each AP in range.) The administrator must also assign a channel number to the AP. To understand channel numbers, recall that 802.11 operates in the frequency range of 2.4 GHz to 2.4835 GHz. Within this 85 MHz band, 802.11 defines 11 partially overlapping channels. Any two channels are non-overlapping if and only if they are separated by four or more channels. In particular, the set of channels 1, 6, and 11 is the only set of three non-overlapping channels. This means that an administrator could create a wireless LAN with an aggregate maximum transmission rate of 33 Mbps by installing three 802.11b APs at the same physical location, assigning channels 1, 6, and 11 to the APs, and interconnecting each of the APs with a switch.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now that we have a basic understanding of 802.11 channels, let’s describe an interesting (and not completely uncommon) situation—that of a WiFi jungle. A <span class="s20">WiFi jungle </span>is any physical location where a wireless station receives a sufficiently strong signal from two or more APs. For example, in many cafés in New York City, a wireless station can pick up a signal from numerous nearby APs. One of the APs might be managed by the café, while the other APs might be in residential apartments near the café. Each of these APs would likely be located in a different IP subnet and would have been independently assigned a channel.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now suppose you enter such a WiFi jungle with your phone, tablet, or laptop, seeking wireless Internet access and a blueberry muffin. Suppose there are five APs in the WiFi jungle. To gain Internet access, your wireless device needs to join exactly one of the subnets and hence needs to <span class="s20">associate </span>with exactly one of the APs. Associating means the wireless device creates a virtual wire between itself and the AP. Specifically, only the associated AP will send data frames (that is, frames containing data, such as a datagram) to your wireless device, and your wireless device will send data frames into the Internet only through the associated AP. But how does your wireless device associate with a particular AP? And more fundamentally, how does your wireless device know which APs, if any, are out there in the jungle?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The 802.11 standard requires that an AP periodically send <span class="s20">beacon frames</span>, each of which includes the</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">AP’s SSID and MAC address. Your wireless device, knowing that APs are sending out beacon frames, scans the 11 channels, seeking beacon frames from any APs that may be out there (some of which may be transmitting on the same channel—it’s a jungle out there!). Having learned about available APs from the beacon frames, you (or your wireless device) select one of the APs for association.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The 802.11 standard does not specify an algorithm for selecting which of the available APs to associate with; that algorithm is left up to the designers of the 802.11 firmware and software in your wireless device. Typically, the device chooses the AP whose beacon frame is received with the highest signal</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark597" class="s124">strength. While a high signal strength is good (see, e.g., </a><a href="#bookmark597" class="a">Figure 7.</a>3<span class="p">), signal strength is not the only AP characteristic that will determine the performance a device receives. In particular, it’s possible that the selected AP may have a strong signal, but may be overloaded with other affiliated devices (that will</span></p><p class="s20" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">need to share the wireless bandwidth at that AP), while an unloaded AP is not selected due to a slightly weaker signal. A number of alternative ways of choosing APs have thus recently been proposed [Vasudevan 2005; </a><a href="#bookmark848" class="a">Nicholson 200</a>6<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Sundaresan 2006</a>]<span class="p">. For an interesting and down-to-earth</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark848" class="s124">discussion of how signal strength is measured, see </a><a href="#bookmark848" class="a">[Bardwell 2004</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="794" height="413" alt="image" src="计算机网络自顶向下7th-en/Image_712.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;"><a name="bookmark610">Figure 7.9 Active and passive scanning for access points</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 139%;text-align: justify;"><span class="p">The process of scanning channels and listening for beacon frames is known as </span>passive scanning <a href="#bookmark610" class="s124">(see </a><a href="#bookmark610" class="a">Figure 7.9</a>a<span class="p">). A wireless device can also perform </span><span class="s23">active</span> scanning<a href="#bookmark610" class="s124">, by broadcasting a probe frame that will be received by all APs within the wireless device’s range, as shown in </a><a href="#bookmark610" class="a">Figure </a>7.9b<span class="p">. APs respond to the probe request frame with a probe response frame. The wireless device can then choose the AP with</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;">which to associate from among the responding APs.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark611">After selecting the AP with which to associate, the wireless device sends an association request frame to the AP, and the AP responds with an association response frame. Note that this second request/response handshake is needed with active scanning, since an AP responding to the initial probe request frame doesn’t know which of the (possibly many) responding APs the device will choose to associate with, in much the same way that a DHCP client can choose from among multiple DHCP</a></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark409" class="s124">servers (see </a><a href="#bookmark409" class="a">Figure 4.2</a>1<a href="#bookmark416" class="s124">). Once associated with an AP, the device will want to join the subnet (in the IP addressing sense of </a><a href="#bookmark416" class="a">Section 4.3.</a>3<a href="#bookmark409" class="s124">) to which the AP belongs. Thus, the device will typically send a DHCP discovery message (see </a><a href="#bookmark409" class="a">Figure 4.2</a>1<span class="p">) into the subnet via the AP in order to obtain an IP address</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">on the subnet. Once the address is obtained, the rest of the world then views that device simply as</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">another host with an IP address in that subnet.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In order to create an association with a particular AP, the wireless device may be required to authenticate itself to the AP. 802.11 wireless LANs provide a number of alternatives for authentication and access. One approach, used by many companies, is to permit access to a wireless network based on a device’s MAC address. A second approach, used by many Internet cafés, employs usernames and passwords. In both cases, the AP typically communicates with an authentication server, relaying information between the wireless device and the authentication server using a protocol such as RADIUS</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="a">[RFC 2865]</a> <a href="#bookmark848" class="s124">or DIAMETER </a><a href="#bookmark848" class="a">[RFC 3588</a>]<span class="p">. Separating the authentication server from the AP allows one authentication server to serve many APs, centralizing the (often sensitive) decisions of authentication</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark671" class="s124">and access within the single server, and keeping AP costs and complexity low. We’ll see in </a><a href="#bookmark671" class="a">Chapter </a>8 <span class="p">that the new IEEE 802.11i protocol defining security aspects of the 802.11 protocol family takes precisely this approach.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The 802.11 MAC Protocol</p></li></ol></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Once a wireless device is associated with an AP, it can start sending and receiving data frames to and from the access point. But because multiple wireless devices, or the AP itself may want to transmit data frames at the same time over the same channel, a multiple access protocol is needed to coordinate the transmissions. In the following, we&#39;ll refer to the devices or the AP as wireless “stations” that share the</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark513" class="s124">multiple access channel. As discussed in </a><a href="#bookmark513" class="a">Chapter 6</a> <a href="#bookmark604" class="s124">and </a><a href="#bookmark604" class="a">Section 7.2.</a>1<span class="p">, broadly speaking there are three classes of multiple access protocols: channel partitioning (including CDMA), random access, and taking turns. Inspired by the huge success of Ethernet and its random access protocol, the designers of</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">802.11 chose a random access protocol for 802.11 wireless LANs. This random access protocol is referred to as <span class="s20">CSMA with collision avoidance</span>, or more succinctly as <span class="s20">CSMA/CA</span>. As with Ethernet’s CSMA/CD, the “CSMA” in CSMA/CA stands for “carrier sense multiple access,” meaning that each station senses the channel before transmitting, and refrains from transmitting when the channel is sensed busy. Although both Ethernet and 802.11 use carrier-sensing random access, the two MAC protocols have important differences. First, instead of using collision detection, 802.11 uses collision- avoidance techniques. Second, because of the relatively high bit error rates of wireless channels,</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">802.11 (unlike Ethernet) uses a link-layer acknowledgment/retransmission (ARQ) scheme. We’ll describe 802.11’s collision-avoidance and link-layer acknowledgment schemes below.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark539" class="s124">Recall from </a><a href="#bookmark539" class="a">Sections 6.3.2</a> <a href="#bookmark554" class="s124">and </a><a href="#bookmark554" class="a">6.4.2</a> <span class="p">that with Ethernet’s collision-detection algorithm, an Ethernet station listens to the channel as it transmits. If, while transmitting, it detects that another station is also transmitting, it aborts its transmission and tries to transmit again after waiting a small, random amount of</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">time. Unlike the 802.3 Ethernet protocol, the 802.11 MAC protocol does <i>not </i>implement collision detection. There are two important reasons for this:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_713.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">The ability to detect collisions requires the ability to send (the station’s own signal) and receive (to determine whether another station is also transmitting) at the same time. Because the strength of the received signal is typically very small compared to the strength of the transmitted signal at the</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">802.11 adapter, it is costly to build hardware that can detect a collision.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_714.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">More importantly, even if the adapter could transmit and listen at the same time (and presumably abort transmission when it senses a busy channel), the adapter would still not be able to detect all</p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark603" class="s124">collisions, due to the hidden terminal problem and fading, as discussed in </a><a href="#bookmark603" class="a">Section 7.</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Because 802.11wireless LANs do not use collision detection, once a station begins to transmit a frame,</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">it transmits the frame in its entirety<span class="p">; that is, once a station gets started, there is no turning back. As one might expect, transmitting entire frames (particularly long frames) when collisions are prevalent can significantly degrade a multiple access protocol’s performance. In order to reduce the likelihood of</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">collisions, 802.11 employs several collision-avoidance techniques, which we’ll shortly discuss.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 147%;text-align: left;"><span class="p">Before considering collision avoidance, however, we’ll first need to examine 802.11’s </span>link-layer <span class="s23">acknowledgment</span> <a href="#bookmark603" class="s124">scheme. Recall from </a><a href="#bookmark603" class="a">Section 7.2</a> <span class="p">that when a station in a wireless LAN sends a</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">frame, the frame may not reach the destination station intact for a variety of reasons. To deal with this</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">non-negligible chance of failure, the 802.11 MAC protocol uses link-layer acknowledgments. As shown</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark612" class="s124">in </a><a href="#bookmark612" class="a">Figure 7.1</a>0<span class="p">, when the destination station receives a frame that passes the CRC, it waits a short period of time known as the </span>Short Inter-frame Spacing (SIFS) <span class="p">and then sends back</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="346" height="548" alt="image" src="计算机网络自顶向下7th-en/Image_715.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark612">Figure 7.10 802.11 uses link-layer acknowledgments</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">an acknowledgment frame. If the transmitting station does not receive an acknowledgment within a given amount of time, it assumes that an error has occurred and retransmits the frame, using the CSMA/CA protocol to access the channel. If an acknowledgment is not received after some fixed number of retransmissions, the transmitting station gives up and discards the frame.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Having discussed how 802.11 uses link-layer acknowledgments, we’re now in a position to describe the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l293"><ol id="l294"><li style="padding-left: 47pt;text-indent: -42pt;text-align: left;"><p style="display: inline;">CSMA/CA protocol. Suppose that a station (wireless device or an AP) has a frame to transmit.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><ol id="l295"><li style="padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If initially the station senses the channel idle, it transmits its frame after a short period of time <span class="s49">known</span> as the <span class="s20">Distributed Inter-frame Space (DIFS)</span><span class="s49">;</span><a href="#bookmark612" class="s124"> see </a><a href="#bookmark612" class="a">Figure 7.1</a><span class="s20">0</span>.</p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -18pt;line-height: 134%;text-align: left;"><p class="s20" style="display: inline;"><a href="#bookmark539" class="s124">Otherwise, the station chooses a random backoff value using binary exponential backoff (as we encountered in </a><a href="#bookmark539" class="a">Section 6.3.</a>2<span class="p">) and counts down this value after DIFS when the channel is sensed idle. While the channel is sensed busy, the counter value remains frozen.</span></p></li><li style="padding-top: 2pt;padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">When the counter reaches zero (note that this can only occur while the channel is sensed idle), the station transmits the entire frame and then waits for an acknowledgment.</p></li><li style="padding-top: 3pt;padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If an acknowledgment is received, the transmitting station knows that its frame has been correctly received at the destination station. If the station has another frame to send, it begins</p></li></ol></li></ol></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">the CSMA/CA protocol at step 2. If the acknowledgment isn’t received, the transmitting station reenters the backoff phase in step 2, with the random value chosen from a larger interval.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark539" class="s124">Recall that under Ethernet’s CSMA/CD, multiple access protocol (</a><a href="#bookmark539" class="a">Section 6.3.</a>2<span class="p">), a station begins transmitting as soon as the channel is sensed idle. With CSMA/CA, however, the station refrains from transmitting while counting down, even when it senses the channel to be idle. Why do CSMA/CD and</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">CDMA/CA take such different approaches here?</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To answer this question, let’s consider a scenario in which two stations each have a data frame to transmit, but neither station transmits immediately because each senses that a third station is already transmitting. With Ethernet’s CSMA/CD, the two stations would each transmit as soon as they detect that the third station has finished transmitting. This would cause a collision, which isn’t a serious issue in CSMA/CD, since both stations would abort their transmissions and thus avoid the useless transmissions of the remainders of their frames. In 802.11, however, the situation is quite different. Because 802.11 does not detect a collision and abort transmission, a frame suffering a collision will be transmitted in its entirety. The goal in 802.11 is thus to avoid collisions whenever possible. In 802.11, if the two stations sense the channel busy, they both immediately enter random backoff, hopefully choosing different backoff values. If these values are indeed different, once the channel becomes idle, one of the two stations will begin transmitting before the other, and (if the two stations are not hidden from each other) the “losing station” will hear the “winning station’s” signal, freeze its counter, and refrain from transmitting until the winning station has completed its transmission. In this manner, a costly collision is avoided. Of course, collisions can still occur with 802.11 in this scenario: The two stations could be hidden from each other, or the two stations could choose random backoff values that are close enough that the transmission from the station starting first have yet to reach the second station. Recall that we</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark537" class="s124">encountered this problem earlier in our discussion of random access algorithms in the context of </a><a href="#bookmark537" class="a">Figure 6.1</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Dealing with Hidden Terminals: RTS and CTS</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark613" class="s124">The 802.11 MAC protocol also includes a nifty (but optional) reservation scheme that helps avoid collisions even in the presence of hidden terminals. Let’s investigate this scheme in the context of </a><a href="#bookmark613" class="a">Figure 7.1</a>1<span class="p">, which shows two wireless stations and one access point. Both of the wireless stations are</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">within range of the AP (whose coverage is shown as a shaded circle) and both have associated with</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">the AP. However, due to fading, the signal ranges of wireless stations are limited to the interiors of the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark613" class="s124">shaded circles shown in </a><a href="#bookmark613" class="a">Figure 7.1</a>1<span class="p">. Thus, each of the wireless stations is hidden from the other, although neither is hidden from the AP.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now consider why hidden terminals can be problematic. Suppose Station H1 is transmitting a frame and halfway through H1’s transmission, Station H2 wants to send a frame to the AP. H2, not hearing the transmission from H1, will first wait a DIFS interval and then transmit the frame, resulting in</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">a collision. The channel will therefore be wasted during the entire period of H1’s transmission as well as during H2’s transmission.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 147%;text-align: left;">In order to avoid this problem, the IEEE 802.11 protocol allows a station to use a short <span class="s20">Request to </span><span class="s23">Send</span><span class="s20"> (RTS) </span>control frame and a short <span class="s23">Clear</span><span class="s20"> to Send (CTS) </span>control frame to <i>reserve </i>access to the</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">channel. When a sender wants to send a DATA</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="536" height="306" alt="image" src="计算机网络自顶向下7th-en/Image_716.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark613">Figure 7.11 Hidden terminal example: H1 is hidden from H2, and vice versa</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">frame, it can first send an RTS frame to the AP, indicating the total time required to transmit the DATA frame and the acknowledgment (ACK) frame. When the AP receives the RTS frame, it responds by broadcasting a CTS frame. This CTS frame serves two purposes: It gives the sender explicit permission to send and also instructs the other stations not to send for the reserved duration.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark614" class="s124">Thus, in </a><a href="#bookmark614" class="a">Figure 7.1</a>2<span class="p">, before transmitting a DATA frame, H1 first broadcasts an RTS frame, which is heard by all stations in its circle, including the AP. The AP then responds</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="564" height="780" alt="image" src="计算机网络自顶向下7th-en/Image_717.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark614">Figure 7.12 Collision avoidance using the RTS and CTS frames</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark614" class="s124">with a CTS frame, which is heard by all stations within its range, including H1 and H2. Station H2, having heard the CTS, refrains from transmitting for the time specified in the CTS frame. The RTS, CTS, DATA, and ACK frames are shown in </a><a href="#bookmark614" class="a">Figure 7.1</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The use of the RTS and CTS frames can improve performance in two important ways:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_718.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">The hidden station problem is mitigated, since a long DATA frame is transmitted only after the channel has been reserved.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_719.png"/></span></p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">Because the RTS and CTS frames are short, a collision involving an RTS or CTS frame will last only</p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark615">for the duration of the short RTS or CTS frame. Once the RTS and CTS frames are correctly transmitted, the following DATA and ACK frames should be transmitted without collisions.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">You are encouraged to check out the 802.11 applet in the textbook’s Web site. This interactive applet illustrates the CSMA/CA protocol, including the RTS/CTS exchange sequence.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although the RTS/CTS exchange can help reduce collisions, it also introduces delay and consumes channel resources. For this reason, the RTS/CTS exchange is only used (if at all) to reserve the channel for the transmission of a long DATA frame. In practice, each wireless station can set an RTS threshold such that the RTS/CTS sequence is used only when the frame is longer than the threshold. For many wireless stations, the default RTS threshold value is larger than the maximum frame length, so the RTS/CTS sequence is skipped for all DATA frames sent.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Using 802.11 as a Point-to-Point Link</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Our discussion so far has focused on the use of 802.11 in a multiple access setting. We should mention that if two nodes each have a directional antenna, they can point their directional antennas at each other and run the 802.11 protocol over what is essentially a point-to-point link. Given the low cost of commodity 802.11 hardware, the use of directional antennas and an increased transmission power allow 802.11 to be used as an inexpensive means of providing wireless point-to-point connections over</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">tens of kilometers distance. </a><a href="#bookmark848" class="a">[Raman 2007]</a> <span class="p">describes one of the first such multi-hop wireless networks, operating in the rural Ganges plains in India using point-to-point 802.11 links.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l296"><ol id="l297"><ol id="l298"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The IEEE 802.11 Frame</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark617" class="s124">Although the 802.11 frame shares many similarities with an Ethernet frame, it also contains a number of fields that are specific to its use for wireless links. The 802.11 frame is shown in </a><a href="#bookmark617" class="a">Figure 7.1</a><span class="s20">3</span>. The numbers above each of the fields in the frame represent the lengths of the fields in <i>bytes</i>; the numbers</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">above each of the subfields in the frame control field represent the lengths of the subfields in <i>bits</i>. Let’s</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark616">now examine the fields in the frame as well as some of the more important subfields in the frame’s control field.</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="767" height="225" alt="image" src="计算机网络自顶向下7th-en/Image_720.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark617">Figure 7.13 The 802.11 frame</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Payload and CRC Fields</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">At the heart of the frame is the payload, which typically consists of an IP datagram or an ARP packet. Although the field is permitted to be as long as 2,312 bytes, it is typically fewer than 1,500 bytes, holding an IP datagram or an ARP packet. As with an Ethernet frame, an 802.11 frame includes a 32-bit cyclic redundancy check (CRC) so that the receiver can detect bit errors in the received frame. As we’ve seen, bit errors are much more common in wireless LANs than in wired LANs, so the CRC is even more useful here.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Address Fields</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Perhaps the most striking difference in the 802.11 frame is that it has <i>four </i>address fields, each of which can hold a 6-byte MAC address. But why four address fields? Doesn’t a source MAC field and destination MAC field suffice, as they do for Ethernet? It turns out that three address fields are needed</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">for internetworking purposes—specifically, for moving the network-layer datagram from a wireless station through an AP to a router interface. The fourth address field is used when APs forward frames to each other in ad hoc mode. Since we are only considering infrastructure networks here, let’s focus our attention on the first three address fields. The 802.11 standard defines these fields as follows:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_721.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Address 2 is the MAC address of the station that transmits the frame. Thus, if a wireless station transmits the frame, that station’s MAC address is inserted in the address 2 field. Similarly, if an AP transmits the frame, the AP’s MAC address is inserted in the address 2 field.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_722.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Address 1 is the MAC address of the wireless station that is to receive the frame. Thus if a mobile wireless station transmits the frame, address 1 contains the MAC address of the destination AP. Similarly, if an AP transmits the frame, address 1 contains the MAC address of the destination</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">wireless station.</p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="539" height="405" alt="image" src="计算机网络自顶向下7th-en/Image_723.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark618">Figure 7.14 The use of address fields in 802.11 frames: Sending frames between H1 and R1</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_724.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;">To understand address 3, recall that the BSS (consisting of the AP and wireless stations) is part of a subnet, and that this subnet connects to other subnets via some router interface. Address 3 contains the MAC address of this router interface.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">To gain further insight into the purpose of address 3, let’s walk through an internetworking example in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark618" class="s124">the context of </a><a href="#bookmark618" class="a">Figure 7.1</a>4<span class="p">. In this figure, there are two APs, each of which is responsible for a number of wireless stations. Each of the APs has a direct connection to a router, which in turn connects to the global Internet. We should keep in mind that an AP is a link-layer device, and thus neither “speaks” IP</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">nor understands IP addresses. Consider now moving a datagram from the router interface R1 to the wireless Station H1. The router is not aware that there is an AP between it and H1; from the router’s perspective, H1 is just a host in one of the subnets to which it (the router) is connected.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_725.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;">The router, which knows the IP address of H1 (from the destination address of the datagram), uses ARP to determine the MAC address of H1, just as in an ordinary Ethernet LAN. After obtaining H1’s MAC address, router interface R1 encapsulates the datagram within an Ethernet frame. The source</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">address field of this frame contains R1’s MAC address, and the destination address field contains H1’s MAC address.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_726.png"/></span></p><p style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">When the Ethernet frame arrives at the AP, the AP converts the 802.3 Ethernet frame to an 802.11 frame before transmitting the frame into the wireless channel. The AP fills in address 1 and address 2 with H1’s MAC address and its own MAC address, respectively, as described above. For address</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">3, the AP inserts the MAC address of R1. In this manner, H1 can determine (from address 3) the MAC address of the router interface that sent the datagram into the subnet.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark619">Now consider what happens when the wireless station H1 responds by moving a datagram from H1 to R1.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_727.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">H1 creates an 802.11 frame, filling the fields for address 1 and address 2 with the AP’s MAC address and H1’s MAC address, respectively, as described above. For address 3, H1 inserts R1’s MAC address.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_728.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;">When the AP receives the 802.11 frame, it converts the frame to an Ethernet frame. The source address field for this frame is H1’s MAC address, and the destination address field is R1’s MAC address. Thus, address 3 allows the AP to determine the appropriate destination MAC address</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">when constructing the Ethernet frame.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">In summary, address 3 plays a crucial role for internetworking the BSS with a wired LAN.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Sequence Number, Duration, and Frame Control Fields</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark281" class="s124">Recall that in 802.11, whenever a station correctly receives a frame from another station, it sends back an acknowledgment. Because acknowledgments can get lost, the sending station may send multiple copies of a given frame. As we saw in our discussion of the rdt2.1 protocol (</a><a href="#bookmark281" class="a">Section 3.4.</a>1<span class="p">), the use of</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">sequence numbers allows the receiver to distinguish between a newly transmitted frame and the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark254" class="s124">retransmission of a previous frame. The sequence number field in the 802.11 frame thus serves exactly the same purpose here at the link layer as it did in the transport layer in </a><a href="#bookmark254" class="a">Chapter </a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Recall that the 802.11 protocol allows a transmitting station to reserve the channel for a period of time that includes the time to transmit its data frame and the time to transmit an acknowledgment. This duration value is included in the frame’s duration field (both for data frames and for the RTS and CTS frames).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark617" class="s124">As shown in </a><a href="#bookmark617" class="a">Figure 7.1</a>3<span class="p">, the frame control field includes many subfields. We’ll say just a few words about some of the more important subfields; for a more complete discussion, you are encouraged to</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">consult the 802.11 specification </a><a href="#bookmark848" class="a">[Held 200</a><span class="s20">1</span><a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Crow 199</a><span class="s20">7</span><a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">IEEE 802.11 </a><span class="s20">1999]</span>. The <i>type </i>and <i>subtype </i>fields are used to distinguish the association, RTS, CTS, ACK, and data frames. The <i>to </i>and <i>from </i>fields are used to define the meanings of the different address fields. (These meanings change depending on</p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark671" class="s124">whether ad hoc or infrastructure modes are used and, in the case of infrastructure mode, whether a wireless station or an AP is sending the frame.) Finally the WEP field indicates whether encryption is being used or not (WEP is discussed in </a><a href="#bookmark671" class="a">Chapter </a>8<span class="p">).</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Mobility in the Same IP Subnet</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In order to increase the physical range of a wireless LAN, companies and universities will often deploy multiple BSSs within the same IP subnet. This naturally raises the issue of mobility among the BSSs— how do wireless stations seamlessly move from one BSS to another while maintaining ongoing TCP sessions? As we’ll see in this subsection, mobility can be handled in a relatively straightforward manner when the BSSs are part of the subnet. When stations move between subnets, more sophisticated</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark645" class="s124">mobility management protocols will be needed, such as those we’ll study in </a><a href="#bookmark645" class="a">Sections 7.5</a> <a href="#bookmark650" class="s124">and </a><a href="#bookmark650" class="a">7.</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark620" class="s124">Let’s now look at a specific example of mobility between BSSs in the same subnet. </a><a href="#bookmark620" class="a">Figure 7.15</a> <span class="p">shows two interconnected BSSs with a host, H1, moving from BSS1 to BSS2. Because in this example the</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">interconnection device that connects the two BSSs is <i>not </i>a router, all of the stations in the two BSSs, including the APs, belong to the same IP subnet. Thus, when H1 moves from BSS1 to BSS2, it may keep its IP address and all of its ongoing TCP connections. If the interconnection device were a router,</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">then H1 would have to obtain a new IP address in the subnet in which it was moving. This address</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark650" class="s124">change would disrupt (and eventually terminate) any on-going TCP connections at H1. In </a><a href="#bookmark650" class="a">Section 7.</a>6<span class="p">, we’ll see how a network-layer mobility protocol, such as mobile IP, can be used to avoid this problem.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">But what specifically happens when H1 moves from BSS1 to BSS2? As H1 wanders away from AP1, H1 detects a weakening signal from AP1 and starts to scan for a stronger signal. H1 receives beacon frames from AP2 (which in many corporate and university settings will have the same SSID as AP1). H1 then disassociates with AP1 and associates with AP2, while keeping its IP address and maintaining its ongoing TCP sessions.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark620" class="s124">This addresses the handoff problem from the host and AP viewpoint. But what about the switch in </a><a href="#bookmark620" class="a">Figure 7.1</a>5<a href="#bookmark513" class="s124">? How does it know that the host has moved from one AP to another? As you may recall from </a><a href="#bookmark513" class="a">Chapter </a>6<span class="p">, switches are “self-learning” and automatically build their forwarding tables. This self-</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">learning feature nicely handles</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="396" height="268" alt="image" src="计算机网络自顶向下7th-en/Image_729.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark620">Figure 7.15 Mobility in the same subnet</a></h2><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark621">occasional moves (for example, when an employee gets transferred from one department to another); however, switches were not designed to support highly mobile users who want to maintain TCP connections while moving between BSSs. To appreciate the problem here, recall that before the move, the switch has an entry in its forwarding table that pairs H1’s MAC address with the outgoing switch interface through which H1 can be reached. If H1 is initially in BSS1, then a datagram destined to H1 will be directed to H1 via AP1. Once H1 associates with BSS2, however, its frames should be directed to AP2. One solution (a bit of a hack, really) is for AP2 to send a broadcast Ethernet frame with H1’s source address to the switch just after the new association. When the switch receives the frame, it updates its forwarding table, allowing H1 to be reached via AP2. The 802.11f standards group is developing an inter-AP protocol to handle these and related issues.</a></p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark562" class="s124">Our discussion above has focused on mobility with the same LAN subnet. Recall that VLANs, which we studied in </a><a href="#bookmark562" class="a">Section 6.4.</a>4<span class="p">, can be used to connect together islands of LANs into a large virtual LAN that</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark842" class="s124">can span a large geographical region. Mobility among base stations within such a VLAN can be handled in exactly the same manner as above </a><a href="#bookmark842" class="a">[Yu 2011</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Advanced Features in 802.11</p></li></ol></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">We’ll wrap up our coverage of 802.11 with a short discussion of two advanced capabilities found in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">802.11 networks. As we’ll see, these capabilities are <i>not </i>completely specified in the 802.11 standard, but rather are made possible by mechanisms specified in the standard. This allows different vendors to implement these capabilities using their own (proprietary) approaches, presumably giving them an edge</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">over the competition.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">802.11 Rate Adaptation</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark597" class="s124">We saw earlier in </a><a href="#bookmark597" class="a">Figure 7.3</a> <span class="p">that different modulation techniques (with the different transmission rates that they provide) are appropriate for different SNR scenarios. Consider for example a mobile 802.11 user who is initially 20 meters away from the base station, with a high signal-to-noise ratio. Given the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">high SNR, the user can communicate with the base station using a physical-layer modulation technique that provides high transmission rates while maintaining a low BER. This is one happy user! Suppose now that the user becomes mobile, walking away from the base station, with the SNR falling as the distance from the base station increases. In this case, if the modulation technique used in the 802.11 protocol operating between the base station and the user does not change, the BER will become unacceptably high as the SNR decreases, and eventually no transmitted frames will be received correctly.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">For this reason, some 802.11 implementations have a rate adaptation capability that adaptively selects the underlying physical-layer modulation technique to use based on current or recent channel</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark622">characteristics. If a node sends two frames in a row without receiving an acknowledgment (an implicit indication of bit errors on the channel), the transmission rate falls back to the next lower rate. If 10 frames in a row are acknowledged, or if a timer that tracks the time since the last fallback expires, the transmission rate increases to the next higher rate. This rate adaptation mechanism shares the same “probing” philosophy as TCP’s congestion-control mechanism—when conditions are good (reflected by ACK receipts), the transmission rate is increased until something “bad” happens (the lack of ACK receipts); when something “bad” happens, the transmission rate is reduced. 802.11 rate adaptation and TCP congestion control are thus similar to the young child who is constantly pushing his/her parents for more and more (say candy for a young child, later curfew hours for the teenager) until the parents finally say “Enough!” and the child backs off (only to try again later after conditions have hopefully improved!). A number of other schemes have also been proposed to improve on this basic automatic rate-</a></p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">adjustment scheme </a><a href="#bookmark848" class="a">[Kamerman </a>1997<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Holland 200</a>1<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Lacage 2004</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Power Management</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Power is a precious resource in mobile devices, and thus the 802.11 standard provides power- management capabilities that allow 802.11 nodes to minimize the amount of time that their sense, transmit, and receive functions and other circuitry need to be “on.” 802.11 power management operates as follows. A node is able to explicitly alternate between sleep and wake states (not unlike a sleepy student in a classroom!). A node indicates to the access point that it will be going to sleep by setting the power-management bit in the header of an 802.11 frame to 1. A timer in the node is then set to wake up the node just before the AP is scheduled to send its beacon frame (recall that an AP typically sends a beacon frame every 100 msec). Since the AP knows from the set power-transmission bit that the node is going to sleep, it (the AP) knows that it should not send any frames to that node, and will buffer any frames destined for the sleeping host for later transmission.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">A node will wake up just before the AP sends a beacon frame, and quickly enter the fully active state (unlike the sleepy student, this wakeup requires only 250 microseconds </a><a href="#bookmark848" class="a">[Kamerman </a>1997]<span class="p">!). The</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">beacon frames sent out by the AP contain a list of nodes whose frames have been buffered at the AP. If there are no buffered frames for the node, it can go back to sleep. Otherwise, the node can explicitly request that the buffered frames be sent by sending a polling message to the AP. With an inter-beacon time of 100 msec, a wakeup time of 250 microseconds, and a similarly small time to receive a beacon frame and check to ensure that there are no buffered frames, a node that has no frames to send or receive can be asleep 99% of the time, resulting in a significant energy savings.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">7.3.6 Personal Area Networks: Bluetooth and Zigbee</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark594" class="s124">As illustrated in </a><a href="#bookmark594" class="a">Figure 7.</a>2<span class="p">, the IEEE 802.11 WiFi standard is aimed at communication among devices separated by up to 100 meters (except when 802.11 is used in a point-to-point configuration with a</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">directional antenna). Two other wireless protocols in the IEEE 802 family are Bluetooth and Zigbee (defined in the IEEE 802.15.1 and IEEE 802.15.4 standards </a><a href="#bookmark848" class="a">[IEEE 802.15 </a>2012]<span class="p">).</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Bluetooth</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">An IEEE 802.15.1 network operates over a short range, at low power, and at low cost. It is essentially a low-power, short-range, low-rate “cable replacement” technology for interconnecting a computer with its wireless keyboard, mouse or other peripheral device; cellular phones, speakers, headphones, and many other devices, whereas 802.11 is a higher-power, medium-range, higher-rate “access” technology. For this reason, 802.15.1 networks are sometimes referred to as wireless personal area networks (WPANs). The link and physical layers of 802.15.1 are based on the earlier <span class="s20">Bluetooth </span>specification for personal</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">area networks </a><a href="#bookmark848" class="a">[Held 200</a>1<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Bisdikian 2001</a>]<span class="p">. 802.15.1 networks operate in the 2.4 GHz unlicensed radio band in a TDM manner, with time slots of 625 microseconds. During each time slot, a sender transmits on one of 79 channels, with the channel changing in a known but pseudo-random manner from slot to</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">slot. This form of channel hopping, known as <span class="s20">frequency-hopping spread spectrum (FHSS)</span>, spreads transmissions in time over the frequency spectrum. 802.15.1 can provide data rates up to 4 Mbps.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 147%;text-align: left;"><span class="p">802.15.1 networks are ad hoc networks: No network infrastructure (e.g., an access point) is needed to interconnect 802.15.1 devices. Thus, 802.15.1 devices must organize themselves. 802.15.1 devices are first organized into a </span><span class="s23">piconet</span> <a href="#bookmark623" class="s124">of up to eight active devices, as shown in </a><a href="#bookmark623" class="a">Figure 7.1</a>6<span class="p">. One of these</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">devices is designated as the master, with the remaining devices acting as slaves. The master node truly</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">rules the piconet—its clock determines time in the piconet, it can transmit in each odd-numbered slot, and a</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="491" height="336" alt="image" src="计算机网络自顶向下7th-en/Image_730.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark623">Figure 7.16 A Bluetooth piconet</a></h2><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">slave can transmit only after the master has communicated with it in the previous slot and even then the slave can only transmit to the master. In addition to the slave devices, there can also be up to 255 parked devices in the network. These devices cannot communicate until their status has been changed from parked to active by the master node.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">For more information about WPANs, the interested reader should consult the Bluetooth references</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="a">[Held 200</a>1<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">Bisdikian 2001]</a> <a href="#bookmark848" class="s124">or the official IEEE 802.15 Web site </a><a href="#bookmark848" class="a">[IEEE 802.15 </a>2012]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Zigbee</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">A second personal area network standardized by the IEEE is the 802.15.4 standard </a><a href="#bookmark848" class="a">[IEEE 802.15 </a>2012] <span class="p">known as Zigbee. While Bluetooth networks provide a “cable replacement” data rate of over a Megabit per second, Zigbee is targeted at lower-powered, lower-data-rate, lower-duty-cycle applications than</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Bluetooth. While we may tend to think that “bigger and faster is better,” not all network applications need high bandwidth and the consequent higher costs (both economic and power costs). For example, home temperature and light sensors, security devices, and wall-mounted switches are all very simple, low- power, low-duty-cycle, low-cost devices. Zigbee is thus well-suited for these devices. Zigbee defines channel rates of 20, 40, 100, and 250 Kbps, depending on the channel frequency.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Nodes in a Zigbee network come in two flavors. So-called “reduced-function devices” operate as slave devices under the control of a single “full-function device,” much as Bluetooth slave devices. A full- function device can operate as a master device as in Bluetooth by controlling multiple slave devices, and multiple full-function devices can additionally be configured into a mesh network in which full- function devices route frames amongst themselves. Zigbee shares many protocol mechanisms that we’ve already encountered in other link-layer protocols: beacon frames and link-layer acknowledgments (similar to 802.11), carrier-sense random access protocols with binary exponential backoff (similar to</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">802.11 and Ethernet), and fixed, guaranteed allocation of time slots (similar to DOCSIS).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark626" class="s124">Zigbee networks can be configured in many different ways. Let’s consider the simple case of a single full-function device controlling multiple reduced-function devices in a time-slotted manner using beacon frames. </a><a href="#bookmark626" class="a">Figure 7.17</a> <span class="p">shows the case</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="221" alt="image" src="计算机网络自顶向下7th-en/Image_731.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark624">Figure 7.17 Zigbee 802.15.4 super-frame structure</a><a name="bookmark625">&zwnj;</a><a name="bookmark626">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark627">where the Zigbee network divides time into recurring super frames, each of which begins with a beacon frame. Each beacon frame divides the super frame into an active period (during which devices may transmit) and an inactive period (during which all devices, including the controller, can sleep and thus conserve power). The active period consists of 16 time slots, some of which are used by devices in a CSMA/CA random access manner, and some of which are allocated by the controller to specific devices, thus providing guaranteed channel access for those devices. More details about Zigbee</a></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">networks can be found at </a><a href="#bookmark848" class="a">[Baronti 200</a>7<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">IEEE 802.15.4 </a>2012]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s18" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark628">7.4 Cellular Internet Access</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the previous section we examined how an Internet host can access the Internet when inside a WiFi hotspot—that is, when it is within the vicinity of an 802.11 access point. But most WiFi hotspots have a small coverage area of between 10 and 100 meters in diameter. What do we do then when we have a desperate need for wireless Internet access and we cannot access a WiFi hotspot?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Given that cellular telephony is now ubiquitous in many areas throughout the world, a natural strategy is to extend cellular networks so that they support not only voice telephony but wireless Internet access as well. Ideally, this Internet access would be at a reasonably high speed and would provide for seamless mobility, allowing users to maintain their TCP sessions while traveling, for example, on a bus or a train. With sufficiently high upstream and downstream bit rates, the user could even maintain video- conferencing sessions while roaming about. This scenario is not that far-fetched. Data rates of several megabits per second are becoming available as broadband data services such as those we will cover here become more widely deployed.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark658" class="s124">In this section, we provide a brief overview of current and emerging cellular Internet access technologies. Our focus here will be on both the wireless first hop as well as the network that connects the wireless first hop into the larger telephone network and/or the Internet; in </a><a href="#bookmark658" class="a">Section 7.7</a> <span class="p">we’ll consider</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">how calls are routed to a user moving between base stations. Our brief discussion will necessarily</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">provide only a simplified and high-level description of cellular technologies. Modern cellular communications, of course, has great breadth and depth, with many universities offering several courses on the topic. Readers seeking a deeper understanding are encouraged to see </a><a href="#bookmark848" class="a">[Goodman</a></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">1997<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Kaaranen </a>2001<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Lin 200</a>1<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Korhonen 200</a>3<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Schiller 200</a>3<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Palat 200</a>9<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Scourias 201</a>2<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Turner</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">2012<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Akyildiz 2010</a>]<a href="#bookmark848" class="s124">, as well as the particularly excellent and exhaustive references </a><a href="#bookmark848" class="a">[Mouly 199</a>2<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Sauter </a>2014]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">7.4.1 An Overview of Cellular Network Architecture</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;"><span class="p">In our description of cellular network architecture in this section, we’ll adopt the terminology of the </span>Global System for Mobile Communications (<span class="s138">GSM</span>) <span class="p">standards. (For history buffs, the GSM acronym was originally derived from </span>Groupe Spécial Mobile<span class="p">, until the more anglicized name was adopted, preserving the original acronym letters.) In the 1980s, Europeans recognized the need for a pan-European digital</span></p><p class="s20" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">cellular telephony system that would replace the numerous incompatible analog cellular telephony systems, leading to the GSM standard </a><a href="#bookmark848" class="a">[Mouly 1992</a>]<span class="p">. Europeans deployed GSM technology with great</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">success in the early 1990s, and since then GSM has grown to be the 800-pound gorilla of the cellular telephone world, with more than 80% of all cellular subscribers worldwide using GSM.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="879" alt="image" src="计算机网络自顶向下7th-en/Image_732.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">CASE HISTORY</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">4G Cellular Mobile Versus Wireless LANs</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Many cellular mobile phone operators are deploying 4G cellular mobile systems. In some countries (e.g., Korea and Japan), 4G LTE coverage is higher than 90%—nearly ubiquitous. In 2015, average download rates over deployed LTE systems range from 10Mbps in the US and India to close to 40 Mbps in New Zealand. These 4G systems are being deployed in licensed radio-frequency bands, with some operators paying considerable sums to governments for spectrum-use licenses. 4G systems allow users to access the Internet from remote outdoor locations while on the move, in a manner similar to today’s cellular phone-only access. In many cases, a user may have simultaneous access to both wireless LANs and 4G. With the capacity of 4G systems being both more constrained and more expensive, many mobile devices default to the use of WiFi rather than 4G, when both are avilable. The question of whether wireless edge network access will be primarily over wireless LANs or cellular systems remains an open question:</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_733.png"/></span></p><p style="padding-left: 49pt;text-indent: 0pt;line-height: 138%;text-align: justify;">The emerging wireless LAN infrastructure may become nearly ubiquitous. IEEE 802.11 wireless LANs, operating at 54 Mbps and higher, are enjoying widespread deployment. Essentially all laptops, tablets and smartphones are factory-equipped with 802.11 LAN</p><p style="padding-top: 1pt;padding-left: 49pt;text-indent: 0pt;line-height: 146%;text-align: left;">capabilities. Furthermore, emerging Internet appliances—such as wireless cameras and picture frames—also have low-powered wireless LAN capabilities.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_734.png"/></span></p><p style="padding-top: 2pt;padding-left: 49pt;text-indent: 0pt;line-height: 138%;text-align: left;">Wireless LAN base stations can also handle mobile phone appliances. Many phones are already capable of connecting to the cellular phone network or to an IP network either natively or using a Skype-like Voice-over-IP service, thus bypassing the operator’s cellular</p><p style="padding-top: 1pt;padding-left: 49pt;text-indent: 0pt;text-align: left;">voice and 4G data services.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Of course, many other experts believe that 4G not only will be a major success, but will also dramatically revolutionize the way we work and live. Most likely, both WiFi and 4G will both become prevalent wireless technologies, with roaming wireless devices automatically selecting the access technology that provides the best service at their current physical location.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">When people talk about cellular technology, they often classify the technology as belonging to one of several “generations.” The earliest generations were designed primarily for voice traffic. First generation (1G) systems were analog FDMA systems designed exclusively for voice-only communication. These 1G systems are almost extinct now, having been replaced by digital 2G systems. The original 2G systems were also designed for voice, but later extended (2.5G) to support data (i.e., Internet) as well as voice service. 3G systems also support voice and data, but with an emphasis on data capabilities and</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">higher-speed radio access links. The 4G systems being deployed today are based on LTE technology, feature an all-IP core network, and provide integrated voice and data at multi-Megabit speeds.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Cellular Network Architecture, 2G: Voice Connections to the Telephone Network</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 132%;text-align: left;">The term <i>cellular </i>refers to the fact that the region covered by a cellular network is partitioned into a number of geographic coverage areas, known as <span class="s23">cell</span><span class="s20">s</span><a href="#bookmark629" class="s124">, shown as hexagons on the left side of </a><a href="#bookmark629" class="a">Figure</a></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark629" class="a">7.1</a>8<a href="#bookmark611" class="s124">. As with the 802.11WiFi standard we studied in </a><a href="#bookmark611" class="a">Section 7.3.</a>1<span class="p">, GSM has its own particular nomenclature. Each cell</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="783" height="464" alt="image" src="计算机网络自顶向下7th-en/Image_735.png"/></span></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark629">Figure 7.18 Components of the GSM 2G cellular network architecture</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">contains a <span class="s20">base transceiver station (BTS) </span>that transmits signals to and receives signals from the mobile stations in its cell. The coverage area of a cell depends on many factors, including the transmitting power of the BTS, the transmitting power of the user devices, obstructing buildings in the</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark629" class="s124">cell, and the height of base station antennas. Although </a><a href="#bookmark629" class="a">Figure 7.18</a> <span class="p">shows each cell containing one base transceiver station residing in the middle of the cell, many systems today place the BTS at corners where three cells intersect, so that a single BTS with directional antennas can service three cells.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark5" class="s124">The GSM standard for 2G cellular systems uses combined FDM/TDM (radio) for the air interface. Recall from </a><a href="#bookmark5" class="a">Chapter 1</a> <a href="#bookmark5" class="s124">that, with pure FDM, the channel is partitioned into a number of frequency bands with each band devoted to a call. Also recall from </a><a href="#bookmark5" class="a">Chapter 1</a> <span class="p">that, with pure TDM, time is partitioned into</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark630">frames with each frame further partitioned into slots and each call being assigned the use of a particular slot in the revolving frame. In combined FDM/TDM systems, the channel is partitioned into a number of frequency sub-bands; within each sub-band, time is partitioned into frames and slots. Thus, for a</a></p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">combined FDM/TDM system, if the channel is partitioned into <i>F </i>sub-bands and time is partitioned into <i>T</i></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">slots, then the channel will be able to support <i>F.T </i><a href="#bookmark543" class="s124">simultaneous calls. Recall that we saw in </a><a href="#bookmark543" class="a">Section</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark543" class="a">6.3.4</a> <span class="p">that cable access networks also use a combined FDM/TDM approach. GSM systems consist of 200-kHz frequency bands with each band supporting eight TDM calls. GSM encodes speech at 13 kbps and 12.2 kbps.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">A GSM network’s <span class="s20">base station controller (BSC) </span>will typically service several tens of base transceiver stations. The role of the BSC is to allocate BTS radio channels to mobile subscribers, perform <span class="s20">paging </span>(finding the cell in which a mobile user is resident), and perform handoff of mobile users—a topic we’ll</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark659" class="s124">cover shortly in </a><a href="#bookmark659" class="a">Section 7.7.</a>2<span class="p">. The base station controller and its controlled base transceiver stations collectively constitute a GSM </span>base station subsystem (BSS)<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 136%;text-align: left;"><a href="#bookmark658" class="s124">As we’ll see in </a><a href="#bookmark658" class="a">Section 7.</a>7<span class="p">, the </span><span class="s23">mobile</span> switching center (MSC) <span class="p">plays the central role in user authorization and accounting (e.g., determining whether a mobile device is allowed to connect to the cellular network), call establishment and teardown, and handoff. A single MSC will typically contain up to</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">five BSCs, resulting in approximately 200K subscribers per MSC. A cellular provider’s network will have a number of MSCs, with special MSCs known as gateway MSCs connecting the provider’s cellular network to the larger public telephone network.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l299"><ol id="l300"><ol id="l301"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">3G Cellular Data Networks: Extending the Internet to Cellular Subscribers</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark630" class="s124">Our discussion in </a><a href="#bookmark630" class="a">Section 7.4.1</a> <span class="p">focused on connecting cellular voice users to the public telephone network. But, of course, when we’re on the go, we’d also like to read e-mail, access the Web, get location-dependent services (e.g., maps and restaurant recommendations) and perhaps even watch</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">streaming video. To do this, our smartphone will need to run a full TCP/IP protocol stack (including the physical link, network, transport, and application layers) and connect into the Internet via the cellular data network. The topic of cellular data networks is a rather bewildering collection of competing and ever-evolving standards as one generation (and half-generation) succeeds the former and introduces new technologies and services with new acronyms. To make matters worse, there’s no single official body that sets requirements for 2.5G, 3G, 3.5G, or 4G technologies, making it hard to sort out the differences among competing standards. In our discussion below, we’ll focus on the UMTS (Universal Mobile Telecommunications Service) 3G and 4G standards developed by the 3rd Generation</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">Partnership project (3GPP) </a><a href="#bookmark848" class="a">[3GPP 2016</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark631" class="s124">Let’s first take a top-down look at 3G cellular data network architecture shown in </a><a href="#bookmark631" class="a">Figure 7.1</a>9<span class="p">.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="786" height="685" alt="image" src="计算机网络自顶向下7th-en/Image_736.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark631">Figure 7.19 3G system architecture</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">3G Core Network</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark629" class="s124">The 3G core cellular data network connects radio access networks to the public Internet. The core network interoperates with components of the existing cellular voice network (in particular, the MSC) that we previously encountered in </a><a href="#bookmark629" class="a">Figure 7.1</a>8<span class="p">. Given the considerable amount of existing infrastructure</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">(and profitable services!) in the existing cellular voice network, the approach taken by the designers of</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">3G data services is clear: <i>leave the existing core GSM cellular voice network untouched, adding additional cellular data functionality in parallel to the existing cellular voice network</i>. The alternative— integrating new data services directly into the core of the existing cellular voice network—would have</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark433" class="s124">raised the same challenges encountered in </a><a href="#bookmark433" class="a">Section 4.</a>3<span class="p">, where we discussed integrating new (IPv6) and legacy (IPv4) technologies in the Internet.</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark632">There are two types of nodes in the 3G core network: </a><span class="s20">Serving GPRS Support Nodes (SGSNs) </span>and <span class="s20">Gateway GPRS Support Nodes (GGSNs)</span>. (GPRS stands for Generalized Packet Radio Service, an early cellular data service in 2G networks; here we discuss the evolved version of GPRS in 3G networks). An SGSN is responsible for delivering datagrams to/from the mobile nodes in the radio access network to which the SGSN is attached. The SGSN interacts with the cellular voice network’s MSC for that area, providing user authorization and handoff, maintaining location (cell) information about active mobile nodes, and performing datagram forwarding between mobile nodes in the radio access network and a GGSN. The GGSN acts as a gateway, connecting multiple SGSNs into the larger Internet. A GGSN is thus the last piece of 3G infrastructure that a datagram originating at a mobile node encounters before entering the larger Internet. To the outside world, the GGSN looks like any other gateway router; the mobility of the 3G nodes within the GGSN’s network is hidden from the outside  world behind the GGSN.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">3G Radio Access Network: The Wireless Edge</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The 3G <span class="s20">radio access network </span>is the wireless first-hop network that we see as a 3G user. The <span class="s20">Radio Network Controller (RNC) </span>typically controls several cell base transceiver stations similar to the base stations that we encountered in 2G systems (but officially known in 3G UMTS parlance as a “Node Bs”—a rather non-descriptive name!). Each cell’s wireless link operates between the mobile nodes and a base transceiver station, just as in 2G networks. The RNC connects to both the circuit-switched cellular voice network via an MSC, and to the packet-switched Internet via an SGSN. Thus, while 3G cellular voice and cellular data services use different core networks, they share a common first/last-hop radio access network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">A significant change in 3G UMTS over 2G networks is that rather than using GSM’s FDMA/TDMA scheme, UMTS uses a CDMA technique known as Direct Sequence Wideband CDMA (DS-WCDMA) </a><a href="#bookmark848" class="a">[Dahlman 1998]</a> <span class="p">within TDMA slots; TDMA slots, in turn, are available on multiple frequencies—an</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark513" class="s124">interesting use of all three dedicated channel-sharing approaches that we earlier identified in </a><a href="#bookmark513" class="a">Chapter 6</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark543" class="s124">and similar to the approach taken in wired cable access networks (see </a><a href="#bookmark543" class="a">Section 6.3.</a>4<span class="p">). This change requires a new 3G cellular wireless-access network operating in parallel with the 2G BSS radio network</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark631" class="s124">shown in </a><a href="#bookmark631" class="a">Figure 7.1</a>9<span class="p">. The data service associated with the WCDMA specification is known as HSPA (High Speed Packet Access) and promises downlink data rates of up to 14 Mbps. Details regarding 3G</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">networks can be found at the 3rd Generation Partnership Project (3GPP) Web site </a><a href="#bookmark848" class="a">[3GPP 2016</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">On to 4G: LTE</p></li></ol></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">Fourth generation (4G) cellular systems are becoming widely deployed. In 2015, more than 50 countries had 4G coverage exceeding 50%. The 4G Long-Term Evolution (LTE) standard </a><a href="#bookmark848" class="a">[Sauter 2014]</a> <span class="p">put</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">forward by the 3GPP has two important innovations over 3G systems an all-IP core network and an</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">enhanced radio access network, as discussed below.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">4G System Architecture: An All-IP Core Network</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark633" class="a">Figure 7.20</a> <span class="p">shows the overall 4G network architecture, which (unfortunately) introduces yet another (rather impenetrable) new vocabulary and set of acronyms for</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="404" alt="image" src="计算机网络自顶向下7th-en/Image_737.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark633">Figure 7.20 4G network architecture</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">network components. But let’s not get lost in these acronyms! There are two important high-level observations about the 4G architecture:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_738.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">A unified, all-IP network architecture. <a href="#bookmark631" class="s124">Unlike the 3G network shown in </a><a href="#bookmark631" class="a">Figure 7.1</a><span style=" color: #1E79B8;">9</span><span class="p">, which has separate network components and paths for voice and data traffic, the 4G architecture shown in</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark633" class="a">Figure 7.20</a> <span class="p">is “all-IP”—both voice and data are carried in IP datagrams to/from the wireless device (the User Equipment, UE in 4G parlance) to the gateway to the packet gateway (P-GW) that connects the 4G edge network to the rest of the network. With 4G, the last vestiges of cellular</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">networks’ roots in the telephony have disappeared, giving way to universal IP service!</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_739.png"/></span></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><span style=" color: #333;">A clear separation of the 4G data plane and 4G control plane. </span><a href="#bookmark368" class="s124">Mirroring our distinction between the data and control planes for IP’s network layer in </a><a href="#bookmark368" class="a">Chapters 4</a> <a href="#bookmark444" class="s124">and </a><a href="#bookmark444" class="a">5</a> <span class="p">respectively, the 4G network architecture also clearly separates the data and control planes. We’ll discuss their functionality</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">below.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_740.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">A clear separation between the radio access network, and the all-IP-core network. <span class="p">IP datagrams carrying user data are forwarded between the user (UE) and the gateway (P-GW in</span></p><p class="s20" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark633" class="a">Figure 7.2</a>0<span class="p">) over a 4G-internal IP network to the external Internet. Control packets are exchanged over this same internal network among the 4G’s control services components, whose roles are described below.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">The principal components of the 4G architecture are as follows.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_741.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">The <span class="s23">eNodeB</span><span class="s20"> </span>is the logical descendant of the 2G base station and the 3G Radio Network Controller</p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">(a.k.a Node B) and again plays a central role here. Its data-plane role is to forward datagrams between UE (over the LTE radio access network) and the P-GW.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 27pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark433" class="s124">UE datagrams are encapsulated at the eNodeB and tunneled to the P-GW through the 4G network’s all-IP enhanced packet core (EPC). This tunneling between the eNodeB and P-GW is similar the tunneling we saw in </a><a href="#bookmark433" class="a">Section 4.3</a> <span class="p">of IPv6 datagrams between two IPv6 endpoints through a network</span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 11pt;text-align: left;">of IPv4 routers. These tunnels may have associated quality of service (QoS) guarantees. For</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 27pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">example, a 4G network may guarantee that voice traffic experiences no more than a 100 msec delay between UE and P-GW, and has a packet loss rate of less than 1%; TCP traffic might have a guarantee of 300 msec and a packet loss rate of less than .0001% </a><a href="#bookmark848" class="a">[Palat </a>2009]<span class="p">. We’ll cover QoS in</span></p><p class="s20" style="padding-left: 27pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark775" class="a">Chapter </a>9<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the control plane, the eNodeB handles registration and mobility signaling traffic on behalf of the UE.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_742.png"/></span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 136%;text-align: left;">The <span class="s23">Packet</span><span class="s20"> Data Network Gateway (P-GW) </span>allocates IP addresses to the UEs and performs QoS enforcement. As a tunnel endpoint it also performs datagram encapsulation/decapsulation when forwarding a datagram to/from a UE.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_743.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">The Serving Gateway (S-GW) is the data-plane mobility anchor point—all UE traffic will pass through the S-GW. The S-GW also performs charging/billing functions and lawful traffic interception.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_744.png"/></span></p><p style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 126%;text-align: left;">The <span class="s23">Mobility</span><span class="s20"> Management Entity (MME) </span>performs connection and mobility management on behalf of the UEs resident in the cell it controls. It receives UE subscription information from the HHS. We</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark658" class="s124">cover mobility in cellular networks in detail in </a><a href="#bookmark658" class="a">Section 7.</a>7<span class="p">.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_745.png"/></span></p><p class="s20" style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 135%;text-align: left;"><span class="s23">The</span> Home Subscriber Server (HSS) <a href="#bookmark658" class="s124">contains UE information including roaming access capabilities, quality of service profiles, and authentication information. As we’ll see in </a><a href="#bookmark658" class="a">Section 7.</a>7<span class="p">, the HSS obtains this information from the UE’s home cellular provider.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">Very readable introductions to 4G network architecture and its EPC are </a><a href="#bookmark848" class="a">[Motorola 200</a>7<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Palat 200</a>9<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Sauter </a>2014]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">LTE Radio Access Network</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">LTE uses a combination of frequency division multiplexing and time division multiplexing on the downstream channel, known as orthogonal frequency division multiplexing (OFDM) </a><a href="#bookmark848" class="a">[Rohde 200</a>8<span class="p">;</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Ericsson 2011]. (The term “orthogonal” comes from the fact the signals being sent on different frequency</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark634" class="s124">channels are created so that they interfere very little with each other, even when channel frequencies are tightly spaced). In LTE, each active mobile node is allocated one or more 0.5 ms time slots in one or more of the channel frequencies. </a><a href="#bookmark634" class="a">Figure 7.21</a> <span class="p">shows an allocation of eight time slots over four</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">frequencies. By being allocated increasingly more time slots (whether on the same frequency or on</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">different frequencies), a mobile node is able to achieve increasingly higher transmission rates. Slot (re)allocation among mobile</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="534" height="378" alt="image" src="计算机网络自顶向下7th-en/Image_746.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark634">Figure 7.21 Twenty 0.5 ms slots organized into 10 ms frames at each frequency. An eight-slot allocation is shown shaded.</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark597" class="s124">nodes can be performed as often as once every millisecond. Different modulation schemes can also be used to change the transmission rate; see our earlier discussion of </a><a href="#bookmark597" class="a">Figure 7.3</a> <span class="p">and dynamic selection of</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">modulation schemes in WiFi networks.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The particular allocation of time slots to mobile nodes is not mandated by the LTE standard. Instead, the decision of which mobile nodes will be allowed to transmit in a given time slot on a given frequency is determined by the scheduling algorithms provided by the LTE equipment vendor and/or the network</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">operator. With opportunistic scheduling </a><a href="#bookmark848" class="a">[Bender </a>2000<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Kolding 200</a>3<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Kulkarni 2005</a>]<span class="p">, matching the physical-layer protocol to the channel conditions between the sender and receiver and choosing the receivers to which packets will be sent based on channel conditions allow the radio network controller to</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">make best use of the wireless medium. In addition, user priorities and contracted levels of service (e.g., silver, gold, or platinum) can be used in scheduling downstream packet transmissions. In addition to the LTE capabilities described above, LTE-Advanced allows for downstream bandwidths of hundreds of</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">Mbps by allocating aggregated channels to a mobile node </a><a href="#bookmark848" class="a">[Akyildiz 2010</a>]<span class="p">.</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark635">An additional 4G wireless technology—WiMAX (World Interoperability for Microwave Access)—is a family of IEEE 802.16 standards that differ significantly from LTE. WiMAX has not yet been able to enjoy the widespread deployment of LTE. A detailed discussion of WiMAX can be found on this book’s Web site.</a><a name="bookmark636">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l302"><ol id="l303"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark637">Mobility Management: Principles</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having covered the <i>wireless </i>nature of the communication links in a wireless network, it’s now time to turn our attention to the <i>mobility </i>that these wireless links enable. In the broadest sense, a mobile node is one that changes its point of attachment into the network over time. Because the term <i>mobility </i>has taken</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">on many meanings in both the computer and telephony worlds, it will serve us well first to consider</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">several dimensions of mobility in some detail.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_747.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">From the network layer’s standpoint, how mobile is a user? <span class="p">A physically mobile user will present a very different set of challenges to the network layer, depending on how he or she moves between</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: justify;"><a href="#bookmark638" class="s124">points of attachment to the network. At one end of the spectrum in </a><a href="#bookmark638" class="a">Figure 7.2</a>2<a href="#bookmark621" class="s124">, a user may carry a laptop with a wireless network interface card around in a building. As we saw in </a><a href="#bookmark621" class="a">Section 7.3.</a>4<span class="p">, this user is </span><span class="s17">not </span><span class="p">mobile from a network-layer perspective. Moreover, if the user associates with the same</span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 12pt;text-align: left;">access point regardless of location, the user is not even mobile from the perspective of the link layer.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">At the other end of the spectrum, consider the user zooming along the autobahn in a BMW or Tesla at 150 kilometers per hour, passing through multiple wireless access networks and wanting to maintain an uninterrupted TCP connection to a remote application throughout the trip. This user is</p><p class="s17" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">definitely <span class="p">mobile! In between</span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="670" height="196" alt="image" src="计算机网络自顶向下7th-en/Image_748.png"/></span></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><h2 style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark638">Figure 7.22 Various degrees of mobility, from the network layer’s point of view</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: justify;">these extremes is a user who takes a laptop from one location (e.g., office or dormitory) into another (e.g., coffeeshop, classroom) and wants to connect into the-network in the new location. This user is also mobile (although less so than the BMW driver!) but does not need to maintain an ongoing</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark638" class="s124">connection while moving between points of attachment to the network. </a><a href="#bookmark638" class="a">Figure 7.22</a> <span class="p">illustrates this spectrum of user mobility from the network layer’s perspective.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_749.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">How important is it for the mobile node’s address to always remain the same? <span class="p">With mobile telephony, your phone number—essentially the network-layer address of your phone—remains the same as you travel from one provider’s mobile phone network to another. Must a laptop similarly</span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">maintain the same IP address while moving between IP networks?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">The answer to this question will depend strongly on the applications being run. For the BMW or Tesla driver who wants to maintain an uninterrupted TCP connection to a remote application while zipping along the autobahn, it would be convenient to maintain the same IP address. Recall from</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark254" class="a">Chapter 3</a> <span class="p">that an Internet application needs to know the IP address and port number of the remote entity with which it is communicating. If a mobile entity is able to maintain its IP address as it moves, mobility becomes invisible from the application standpoint. There is great value to this transparency</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">—an application need not be concerned with a potentially changing IP address, and the same application code serves mobile and nonmobile connections alike. We’ll see in the following section that mobile IP provides this transparency, allowing a mobile node to maintain its permanent IP address while moving among networks.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">On the other hand, a less glamorous mobile user might simply want to turn off an office laptop, bring that laptop home, power up, and work from home. If the laptop functions primarily as a client in client-server applications (e.g., send/read e-mail, browse the Web, Telnet to a remote host) from home, the particular IP address used by the laptop is not that important. In particular, one could get by fine with an address that is temporarily allocated to the laptop by the ISP serving the home. We</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark423" class="s124">saw in </a><a href="#bookmark423" class="a">Section 4.3</a> <span class="p">that DHCP already provides this functionality.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_750.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a name="bookmark639">What supporting wired infrastructure is available? </a><span class="p">In all of our scenarios above, we’ve implicitly assumed that there is a fixed infrastructure to which the mobile user can connect—for example, the home’s ISP network, the wireless access network in the office, or the wireless access networks</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">lining the autobahn. What if no such infrastructure exists? If two users are within communication proximity of each other, can they establish a network connection in the absence of any other network-layer infrastructure? Ad hoc networking provides precisely these capabilities. This rapidly developing area is at the cutting edge of mobile networking research and is beyond the scope of this</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">book. </a><a href="#bookmark848" class="a">[Perkins 2000]</a> <span class="p">and the IETF Mobile Ad Hoc Network (manet) working group Web pages [manet 2016] provide thorough treatments of the subject.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In order to illustrate the issues involved in allowing a mobile user to maintain ongoing connections while moving between networks, let’s consider a human analogy. A twenty-something adult moving out of the family home becomes mobile, living in a series of dormitories and/or apartments, and often changing addresses. If an old friend wants to get in touch, how can that friend find the address of her mobile friend? One common way is to contact the family, since a mobile adult will often register his or her current address with the family (if for no other reason than so that the parents can send money to help pay the rent!). The family home, with its permanent address, becomes that one place that others can go as a first step in communicating with the mobile adult. Later communication from the friend may be either indirect (for example, with mail being sent first to the parents’ home and then forwarded to the mobile adult) or direct (for example, with the friend using the address obtained from the parents to send mail directly to her mobile friend).</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;"><span class="p">In a network setting, the permanent home of a mobile node (such as a laptop or smartphone) is known as the </span>home network<span class="p">, and the entity within the home network that performs the mobility management functions discussed below on behalf of the mobile node is known as the </span>home agent<span class="p">. The network in which the mobile node is currently residing is known as the </span>foreign (or visited) network<span class="p">, and the entity within the foreign network that helps the mobile node with the mobility management functions discussed below is known as a </span>foreign agent<span class="p">. For mobile professionals, their home network might likely be their company network, while the visited network might be the network of a colleague they are visiting. A </span><span class="s23">correspondent</span> <a href="#bookmark640" class="s124">is the entity wishing to communicate with the mobile node. </a><a href="#bookmark640" class="a">Figure 7.23</a> <a href="#bookmark640" class="s124">illustrates these concepts, as well as addressing concepts considered below. In </a><a href="#bookmark640" class="a">Figure 7.2</a>3<span class="p">, note that agents are shown</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">as being collocated with routers (e.g., as processes running on routers), but alternatively they could be</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">executing on other hosts or servers in the network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l304"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Addressing</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We noted above that in order for user mobility to be transparent to network applications, it is desirable for a mobile node to keep its address as it moves from one network</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="799" height="558" alt="image" src="计算机网络自顶向下7th-en/Image_751.png"/></span></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark640">Figure 7.23 Initial elements of a mobile network architecture</a></h2><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">to another. When a mobile node is resident in a foreign network, all traffic addressed to the node’s permanent address now needs to be routed to the foreign network. How can this be done? One option is for the foreign network to advertise to all other networks that the mobile node is resident in its network. This could be via the usual exchange of intradomain and interdomain routing information and would require few changes to the existing routing infrastructure. The foreign network could simply advertise to its neighbors that it has a highly specific route to the mobile node’s permanent address (that is, essentially inform other networks that it has the correct path for routing datagrams to the mobile node’s</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark423" class="s124">permanent address; see </a><a href="#bookmark423" class="a">Section 4.</a>3<span class="p">). These neighbors would then propagate this routing information throughout the network as part of the normal procedure of updating routing information and forwarding tables. When the mobile node leaves one foreign network and joins another, the new foreign network</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">would advertise a new, highly specific route to the mobile node, and the old foreign network would withdraw its routing information regarding the mobile node.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">This solves two problems at once, and it does so without making significant changes to the network- layer infrastructure. Other networks know the location of the mobile node, and it is easy to route datagrams to the mobile node, since the forwarding tables will direct datagrams to the foreign network. A significant drawback, however, is that of scalability. If mobility management were to be the responsibility of network routers, the routers would have to maintain forwarding table entries for potentially millions of mobile nodes, and update these entries as nodes move. Some additional drawbacks are explored in the problems at the end of this chapter.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">An alternative approach (and one that has been adopted in practice) is to push mobility functionality from the network core to the network edge—a recurring theme in our study of Internet architecture. A natural way to do this is via the mobile node’s home network. In much the same way that parents of the mobile twenty-something track their child’s location, the home agent in the mobile node’s home network can track the foreign network in which the mobile node resides. A protocol between the mobile node (or a foreign agent representing the mobile node) and the home agent will certainly be needed to update the mobile node’s location.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Let’s now consider the foreign agent in more detail. The conceptually simplest approach, shown in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark640" class="a">Figure 7.2</a>3<span class="p">, is to locate foreign agents at the edge routers in the foreign network. One role of the foreign agent is to create a so-called </span>care-of address (COA) <span class="p">for the mobile node, with the network portion of the COA matching that of the foreign network. There are thus two addresses associated with</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">a mobile node, its </span>permanent address <span class="p">(analogous to our mobile youth’s family’s home address) and its COA, sometimes known as a </span>foreign address <a href="#bookmark640" class="s124">(analogous to the address of the house in which our mobile youth is currently residing). In the example in </a><a href="#bookmark640" class="a">Figure 7.2</a>3<span class="p">, the permanent address of the mobile</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">node is 128.119.40.186. When visiting network 79.129.13/24, the mobile node has a COA of</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">79.129.13.2. A second role of the foreign agent is to inform the home agent that the mobile node is resident in its (the foreign agent’s) network and has the given COA. We’ll see shortly that the COA will</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark641">be used to “reroute” datagrams to the mobile node via its foreign agent.</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although we have separated the functionality of the mobile node and the foreign agent, it is worth noting that the mobile node can also assume the responsibilities of the foreign agent. For example, the mobile node could obtain a COA in the foreign network (for example, using a protocol such as DHCP) and itself inform the home agent of its COA.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Routing to a Mobile Node</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We have now seen how a mobile node obtains a COA and how the home agent can be informed of that address. But having the home agent know the COA solves only part of the problem. How should datagrams be addressed and forwarded to the mobile node? Since only the home agent (and not network-wide routers) knows the location of the mobile node, it will no longer suffice to simply address a datagram to the mobile node’s permanent address and send it into the network-layer infrastructure. Something more must be done. Two approaches can be identified, which we will refer to as indirect and direct routing.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Indirect Routing to a Mobile Node</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s first consider a correspondent that wants to send a datagram to a mobile node. In the <span class="s20">indirect routing </span>approach, the correspondent simply addresses the datagram to the mobile node’s permanent address and sends the datagram into the network, blissfully unaware of whether the mobile node is resident in its home network or is visiting a foreign network; mobility is thus completely transparent to the correspondent. Such datagrams are first routed, as usual, to the mobile node’s home network. This</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark642" class="s124">is illustrated in step 1 in </a><a href="#bookmark642" class="a">Figure 7.2</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now turn our attention to the home agent. In addition to being responsible for interacting with a foreign agent to track the mobile node’s COA, the home agent has another very important function. Its second job is to be on the lookout for arriving datagrams addressed to nodes whose home network is that of the home agent but that are currently resident in a foreign network. The home agent intercepts these datagrams and then forwards them to a mobile node in a two-step process. The datagram is first</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark642" class="s124">forwarded to the foreign agent, using the mobile node’s COA (step 2 in </a><a href="#bookmark642" class="a">Figure 7.2</a>4<a href="#bookmark642" class="s124">), and then forwarded from the foreign agent to the mobile node (step 3 in </a><a href="#bookmark642" class="a">Figure 7.2</a>4<span class="p">).</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="798" height="559" alt="image" src="计算机网络自顶向下7th-en/Image_752.png"/></span></p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark642">Figure 7.24 Indirect routing to a mobile node</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">It is instructive to consider this rerouting in more detail. The home agent will need to address the datagram using the mobile node’s COA, so that the network layer will route the datagram to the foreign network. On the other hand, it is desirable to leave the correspondent’s datagram intact, since the application receiving the datagram should be unaware that the datagram was forwarded via the home agent. Both goals can be satisfied by having the home agent <span class="s20">encapsulate </span>the correspondent’s original complete datagram within a new (larger) datagram. This larger datagram is addressed and delivered to the mobile node’s COA. The foreign agent, who “owns” the COA, will receive and decapsulate the datagram—that is, remove the correspondent’s original datagram from within the larger encapsulating</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark642" class="s124">datagram and forward (step 3 in </a><a href="#bookmark642" class="a">Figure 7.2</a>4<a href="#bookmark643" class="s124">) the original datagram to the mobile node. </a><a href="#bookmark643" class="a">Figure </a>7.25 <span class="p">shows a correspondent’s original datagram being sent to the home network, an encapsulated datagram being sent to the foreign agent, and the original datagram being delivered to the mobile node. The sharp</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark423" class="s124">reader will note that the encapsulation/decapsulation described here is identical to the notion of tunneling, discussed in </a><a href="#bookmark423" class="a">Section 4.3</a> <span class="p">in the context of IP multicast and IPv6.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">Let’s next consider how a mobile node sends datagrams to a correspondent. This is quite simple, as the mobile node can address its datagram <i>directly </i>to the correspondent (using its own permanent address</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">as the source address, and the</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="789" height="458" alt="image" src="计算机网络自顶向下7th-en/Image_753.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark643">Figure 7.25 Encapsulation and decapsulation</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark642" class="s124">correspondent’s address as the destination address). Since the mobile node knows the correspondent’s address, there is no need to route the datagram back through the home agent. This is shown as step 4 in </a><a href="#bookmark642" class="a">Figure 7.2</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s summarize our discussion of indirect routing by listing the new network-layer functionality required to support mobility.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_754.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">A mobile-node–to–foreign-agent protocol. <span class="p">The mobile node will register with the foreign agent when attaching to the foreign network. Similarly, a mobile node will deregister with the foreign agent when it leaves the foreign network.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_755.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">A foreign-agent–to–home-agent registration protocol. <span class="p">The foreign agent will register the mobile node’s COA with the home agent. A foreign agent need not explicitly deregister a COA when a mobile node leaves its network, because the subsequent registration of a new COA, when the</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">mobile node moves to a new network, will take care of this.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_756.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">A home-agent datagram encapsulation protocol. <span class="p">Encapsulation and forwarding of the correspondent’s original datagram within a datagram addressed to the COA.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_757.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">A foreign-agent decapsulation protocol. <span class="p">Extraction of the correspondent’s original datagram from the encapsulating datagram, and the forwarding of the original datagram to the mobile node.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">The previous discussion provides all the pieces—foreign agents, the home agent, and indirect</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">forwarding—needed for a mobile node to maintain an ongoing connection while moving among networks. As an example of how these pieces fit together, assume the mobile node is attached to foreign network A, has registered a COA in network A with its home agent, and is receiving datagrams that are being indirectly routed through its home agent. The mobile node now moves to foreign network B and registers with the foreign agent in network B, which informs the home agent of the mobile node’s new COA. From this point on, the home agent will reroute datagrams to foreign network B. As far as a correspondent is concerned, mobility is transparent—datagrams are routed via the same home agent both before and after the move. As far as the home agent is concerned, there is no disruption in the flow of datagrams—arriving datagrams are first forwarded to foreign network A; after the change in COA, datagrams are forwarded to foreign network B. But will the mobile node see an interrupted flow of datagrams as it moves between networks? As long as the time between the mobile node’s disconnection from network A (at which point it can no longer receive datagrams via A) and its attachment to network B (at which point it will register a new COA with its home agent) is small, few</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark254" class="s124">datagrams will be lost. Recall from </a><a href="#bookmark254" class="a">Chapter 3</a> <span class="p">that end-to-end connections can suffer datagram loss due to network congestion. Hence occasional datagram loss within a connection when a node moves between networks is by no means a catastrophic problem. If loss-free communication is required, upper-</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">layer mechanisms will recover from datagram loss, whether such loss results from network congestion or from user mobility.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">An indirect routing approach is used in the mobile IP standard </a><a href="#bookmark848" class="a">[RFC </a>5944]<a href="#bookmark650" class="s124">, as discussed in </a><a href="#bookmark650" class="a">Section 7.</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Direct Routing to a Mobile Node</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark642" class="s124">The indirect routing approach illustrated in </a><a href="#bookmark642" class="a">Figure 7.24</a> <span class="p">suffers from an inefficiency known as the </span>triangle routing problem<span class="p">—datagrams addressed to the mobile node must be routed first to the home agent and then to the foreign network, even when a much more efficient route exists between the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">correspondent and the mobile node. In the worst case, imagine a mobile user who is visiting the foreign network of a colleague. The two are sitting side by side and exchanging data over the network. Datagrams from the correspondent (in this case the colleague of the visitor) are routed to the mobile user’s home agent and then back again to the foreign network!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Direct routing <span class="p">overcomes the inefficiency of triangle routing, but does so at the cost of additional complexity. In the direct routing approach, a </span>correspondent agent <span class="p">in the correspondent’s network first learns the COA of the mobile node. This can be done by having the correspondent agent query the home agent, assuming that (as in the case of indirect routing) the mobile node has an up-to-date value for its COA registered with its home agent. It is also possible for the correspondent itself to perform the function of the correspondent agent, just as a mobile node could perform the function of the foreign</span></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark644" class="s124">agent. This is shown as steps 1 and 2 in </a><a href="#bookmark644" class="a">Figure 7.2</a>6<span class="p">. The correspondent agent then tunnels datagrams directly to the mobile node’s COA, in a manner analogous to the tunneling performed by the home</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark644" class="s124">agent, steps 3 and 4 in </a><a href="#bookmark644" class="a">Figure 7.2</a>6<span class="p">.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">While direct routing overcomes the triangle routing problem, it introduces two important additional challenges:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_758.png"/></span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 140%;text-align: left;"><span class="p">A </span><span class="s23">mobile-user</span> location protocol <a href="#bookmark644" class="s124">is needed for the correspondent agent to query the home agent to obtain the mobile node’s COA (steps 1 and 2 in </a><a href="#bookmark644" class="a">Figure 7.2</a>6<span class="p">).</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_759.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">When the mobile node moves from one foreign network to another, how will data now be forwarded to the new foreign network? In the case of indirect routing, this problem was easily solved by updating the COA maintained by the home agent. However, with direct routing, the home agent is</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: justify;">queried for the COA by the correspondent agent only once, at the beginning of the session. Thus, updating the COA at the home agent, while necessary, will not be enough to solve the problem of routing data to the mobile node’s new foreign network.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">One solution would be to create a new protocol to notify the correspondent of the changing COA. An alternate solution, and one that we’ll see adopted in practice</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="801" height="605" alt="image" src="计算机网络自顶向下7th-en/Image_760.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark644">Figure 7.26 Direct routing to a mobile user</a></h2><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark647" class="s124" name="bookmark645">in GSM networks, works as follows. Suppose data is currently being forwarded to the mobile node in the foreign network where the mobile node was located when the session first started (step 1 in </a><a href="#bookmark647" class="a">Figure 7.2</a>7<span class="p">). We’ll identify the foreign agent in that foreign network where the mobile node was first found as</span><a name="bookmark646">&zwnj;</a></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">the <span class="s23">anchor</span><span class="s20"> foreign agent</span><a href="#bookmark647" class="s124">. When the mobile node moves to a new foreign network (step 2 in </a><a href="#bookmark647" class="a">Figure</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark647" class="a">7.2</a>7<span class="p">), the mobile node registers with the new foreign agent (step 3), and the new foreign agent provides the anchor foreign agent with the mobile node’s new COA (step 4). When the anchor foreign agent receives an encapsulated datagram for a departed mobile node, it can then re-encapsulate the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">datagram and forward it to the mobile node (step 5) using the new COA. If the mobile node later moves yet again to a new foreign network, the foreign agent in that new visited network would then contact the anchor foreign agent in order to set up forwarding to this new foreign network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="787" height="446" alt="image" src="计算机网络自顶向下7th-en/Image_761.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark647">Figure 7.27 Mobile transfer between networks with direct routing</a></h2><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l305"><ol id="l306"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark648">Mobile IP</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The Internet architecture and protocols for supporting mobility, collectively known as mobile IP, are defined primarily in RFC 5944 for IPv4. Mobile IP is a flexible standard, supporting many different modes of operation (for example, operation with or without a foreign agent), multiple ways for agents and mobile nodes to discover each other, use of single or multiple COAs, and multiple forms of encapsulation. As such, mobile IP is a complex standard, and would require an entire book to describe</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">in detail; indeed one such book is </a><a href="#bookmark848" class="a">[Perkins </a>1998b]<span class="p">. Our modest goal here is to provide an overview of the most important aspects of mobile IP and to illustrate its use in a few common-case scenarios.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark848" class="s124">The mobile IP architecture contains many of the elements we have considered above, including the concepts of home agents, foreign agents, care-of addresses, and encapsulation/decapsulation. The current standard </a><a href="#bookmark848" class="a">[RFC 5944]</a> <span class="p">specifies the use of indirect routing to the mobile node.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The mobile IP standard consists of three main pieces:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_762.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Agent discovery. <span class="p">Mobile IP defines the protocols used by a home or foreign agent to advertise its services to mobile nodes, and protocols for mobile nodes to solicit the services of a foreign or home agent.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_763.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Registration with the home agent. <span class="p">Mobile IP defines the protocols used by the mobile node and/or foreign agent to register and deregister COAs with a mobile node’s home agent.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_764.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Indirect routing of datagrams. <span class="p">The standard also defines the manner in which datagrams are forwarded to mobile nodes by a home agent, including rules for forwarding datagrams, rules for</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">handling error conditions, and several forms of encapsulation </a><a href="#bookmark848" class="a">[RFC </a>2003<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">RFC 2004</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Security considerations are prominent throughout the mobile IP standard. For example, authentication of a mobile node is clearly needed to ensure that a malicious user does not register a bogus care-of address with a home agent, which could cause all datagrams addressed to an IP address to be redirected to the malicious user. Mobile IP achieves security using many of the mechanisms that we will</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark671" class="s124">examine in </a><a href="#bookmark671" class="a">Chapter </a>8<span class="p">, so we will not address security considerations in our discussion below.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Agent Discovery</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A mobile IP node arriving to a new network, whether attaching to a foreign network or returning to its home network, must learn the identity of the corresponding foreign or home agent. Indeed it is the discovery of a new foreign agent, with a new network address, that allows the network layer in a mobile</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">node to learn that it has moved into a new foreign network. This process is known as <span class="s20">agent discovery</span>. Agent discovery can be accomplished in one of two ways: via agent advertisement or via agent solicitation.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><span class="p">With </span>agent advertisement<a href="#bookmark848" class="s124">, a foreign or home agent advertises its services using an extension to the existing router discovery protocol </a><a href="#bookmark848" class="a">[RFC </a>1256]<span class="p">. The agent periodically broadcasts an ICMP message</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">with a type field of 9 (router discovery) on all links to which it is connected. The router discovery message contains the IP address of the router (that is, the agent), thus allowing a mobile node to learn the agent’s IP address. The router discovery message also contains a mobility agent advertisement extension that contains additional information needed by the mobile node. Among the more important fields in the extension are the following:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_765.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_766.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_767.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;"><b>Home agent bit (H). </b>Indicates that the agent is a home agent for the network in which it resides. <b>Foreign agent bit (F). </b>Indicates that the agent is a foreign agent for the network in which it resides. <b>Registration required bit (R). </b>Indicates that a mobile user in this network <i>must </i>register with a</p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 12pt;text-align: left;">foreign agent. In particular, a mobile user cannot obtain a care-of address in the foreign network (for</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="611" height="440" alt="image" src="计算机网络自顶向下7th-en/Image_768.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">example, using DHCP) and assume the functionality of the foreign agent for itself, without registering with the foreign agent.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark649">Figure 7.28 ICMP router discovery message with mobility agent advertisement extension</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_769.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">M, G encapsulation bits. <span class="p">Indicate whether a form of encapsulation other than IP-in-IP encapsulation will be used.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_770.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">Care-of address (COA) fields. <span class="p">A list of one or more care-of addresses provided by the foreign</span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">agent. In our example below, the COA will be associated with the foreign agent, who will receive datagrams sent to the COA and then forward them to the appropriate mobile node. The mobile user will select one of these addresses as its COA when registering with its home agent.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark649" class="a">Figure 7.28</a> <span class="p">illustrates some of the key fields in the agent advertisement message.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">With <span class="s20">agent solicitation</span>, a mobile node wanting to learn about agents without waiting to receive an agent advertisement can broadcast an agent solicitation message, which is simply an ICMP message with type value 10. An agent receiving the solicitation will unicast an agent advertisement directly to the mobile node, which can then proceed as if it had received an unsolicited advertisement.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Registration with the Home Agent</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Once a mobile IP node has received a COA, that address must be registered with the home agent. This can be done either via the foreign agent (who then registers the COA with the home agent) or directly by the mobile IP node itself. We consider the former case below. Four steps are involved.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l307"><li style="padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Following the receipt of a foreign agent advertisement, a mobile node sends a mobile IP registration message to the foreign agent. The registration message is carried within a UDP</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">datagram and sent to port 434. The registration message carries a COA advertised by the foreign agent, the address of the home agent (HA), the permanent address of the mobile node (MA), the requested lifetime of the registration, and a 64-bit registration identification. The requested registration lifetime is the number of seconds that the registration is to be valid. If the registration is not renewed at the home agent within the specified lifetime, the registration will become invalid. The registration identifier acts like a sequence number and serves to match a received registration reply with a registration request, as discussed below.</p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The foreign agent receives the registration message and records the mobile node’s permanent IP address. The foreign agent now knows that it should be looking for datagrams containing an</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">encapsulated datagram whose destination address matches the permanent address of the mobile node. The foreign agent then sends a mobile IP registration message (again, within a UDP datagram) to port 434 of the home agent. The message contains the COA, HA, MA, encapsulation format requested, requested registration lifetime, and registration identification.</p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The home agent receives the registration request and checks for authenticity and correctness.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">The home agent binds the mobile node’s permanent IP address with the COA; in the future, datagrams arriving at the home agent and addressed to the mobile node will now be encapsulated and tunneled to the COA. The home agent sends a mobile IP registration reply containing the HA, MA, actual registration lifetime, and the registration identification of the request that is being satisfied with this reply.</p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The foreign agent receives the registration reply and then forwards it to the mobile node.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">At this point, registration is complete, and the mobile node can receive datagrams sent to its permanent</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark651" class="s124">address. </a><a href="#bookmark651" class="a">Figure 7.29</a> <span class="p">illustrates these steps. Note that the home agent specifies a lifetime that is smaller than the lifetime requested by the mobile node.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A foreign agent need not explicitly deregister a COA when a mobile node leaves its network. This will occur automatically, when the mobile node moves to a new network (whether another foreign network or its home network) and registers a new COA.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">The mobile IP standard allows many additional scenarios and capabilities in addition to those described previously. The interested reader should consult </a><a href="#bookmark848" class="a">[Perkins </a>1998b<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 5944</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="674" height="823" alt="image" src="计算机网络自顶向下7th-en/Image_771.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark650">Figure 7.29 Agent advertisement and mobile IP registration</a><a name="bookmark651">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li></ol></li><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark652">Managing Mobility in Cellular Networks</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark635" class="s124">Having examined how mobility is managed in IP networks, let’s now turn our attention to networks with an even longer history of supporting mobility—cellular telephony networks. Whereas we focused on the first-hop wireless link in cellular networks in </a><a href="#bookmark635" class="a">Section 7.</a>4<span class="p">, we’ll focus here on mobility, using the GSM</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark848" class="s124">cellular network </a><a href="#bookmark848" class="a">[Goodman 199</a>7<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Mouly 199</a>2<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Scourias 201</a>2<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Kaaranen </a>2001<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Korhonen 200</a>3<span class="p">;</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="a">Turner 2012]</a> <span class="p">as our case study, since it is a mature and widely deployed technology. Mobility in 3G and 4G networks is similar in principle to that used in GSM. As in the case of mobile IP, we’ll see that a</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark645" class="s124">number of the fundamental principles we identified in </a><a href="#bookmark645" class="a">Section 7.5</a> <span class="p">are embodied in GSM’s network architecture.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark646" class="s124">Like mobile IP, GSM adopts an indirect routing approach (see </a><a href="#bookmark646" class="a">Section 7.5.</a>2<span class="p">), first routing the correspondent’s call to the mobile user’s home network and from there to the visited network. In GSM terminology, the mobile users’s home network is referred to as the mobile user’s </span>home public land</p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">mobile network (home PLMN)<span class="p">. Since the PLMN acronym is a bit of a mouthful, and mindful of our quest to avoid an alphabet soup of acronyms, we’ll refer to the GSM home PLMN simply as the </span>home network<span class="p">. The home network is the cellular provider with which the mobile user has a subscription (i.e., the provider that bills the user for monthly cellular service). The visited PLMN, which we’ll refer to simply as the </span>visited network<span class="p">, is the network in which the mobile user is currently residing.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">As in the case of mobile IP, the responsibilities of the home and visited networks are quite different.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_772.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 136%;text-align: left;">The home network maintains a database known as the <span class="s23">home</span><span class="s20"> location register (HLR)</span>, which contains the permanent cell phone number and subscriber profile information for each of its subscribers. Importantly, the HLR also contains information about the current locations of these</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">subscribers. That is, if a mobile user is currently roaming in another provider’s cellular network, the HLR contains enough information to obtain (via a process we’ll describe shortly) an address in the visited network to which a call to the mobile user should be routed. As we’ll see, a special switch in the home network, known as the <span class="s20">Gateway Mobile services Switching Center (GMSC) </span>is contacted by a correspondent when a call is placed to a mobile user. Again, in our quest to avoid an alphabet soup of acronyms, we’ll refer to the GMSC here by a more descriptive term, <span class="s20">home MSC</span>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_773.png"/></span></p><p style="padding-left: 25pt;text-indent: 0pt;line-height: 139%;text-align: left;">The visited network maintains a database known as the <span class="s23">visitor</span><span class="s20"> location register (VLR)</span>. The VLR contains an entry for each mobile user that is <i>currently </i>in the portion of the network served by the VLR. VLR entries thus come and go as mobile users enter and leave the network. A VLR is usually co-located with the mobile switching center (MSC) that coordinates the setup of a call to and from</p><p style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;text-align: left;">the visited network.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In practice, a provider’s cellular network will serve as a home network for its subscribers and as a visited network for mobile users whose subscription is with a different cellular provider.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="559" height="482" alt="image" src="计算机网络自顶向下7th-en/Image_774.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark653">Figure 7.30 Placing a call to a mobile user: Indirect routing</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l308"><ol id="l309"><ol id="l310"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Routing Calls to a Mobile User</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">We’re now in a position to describe how a call is placed to a mobile GSM user in a visited network. We’ll consider a simple example below; more complex scenarios are described in </a><a href="#bookmark848" class="a">[Mouly 1992</a>]<a href="#bookmark653" class="s124">. The steps, as illustrated in </a><a href="#bookmark653" class="a">Figure 7.3</a>0<span class="p">, are as follows:</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><ol id="l311"><li style="padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The correspondent dials the mobile user’s phone number. This number itself does not refer to a particular telephone line or location (after all, the phone number is fixed and the user is mobile!).</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">The leading digits in the number are sufficient to globally identify the mobile’s home network. The call is routed from the correspondent through the PSTN to the home MSC in the mobile’s home network. This is the first leg of the call.</p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The home MSC receives the call and interrogates the HLR to determine the location of the mobile user. In the simplest case, the HLR returns the <span class="s20">mobile station roaming number</span></p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">(MSRN)<span class="p">, which we will refer to as the </span>roaming number<span class="p">. Note that this number is different from the mobile’s permanent phone number, which is associated with the mobile’s home network. The</span></p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark654">roaming number is ephemeral: It is temporarily assigned to a mobile when it enters a visited network. The roaming number serves a role similar to that of the care-of address in mobile IP and, like the COA, is invisible to the correspondent and the mobile. If HLR does not have the roaming number, it returns the address of the VLR in the visited network. In this case (not shown</a></p><p class="s20" style="padding-top: 2pt;padding-left: 48pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark653" class="s124">in </a><a href="#bookmark653" class="a">Figure 7.3</a>0<span class="p">), the home MSC will need to query the VLR to obtain the roaming number of the mobile node. But how does the HLR get the roaming number or the VLR address in the first place? What happens to these values when the mobile user moves to another visited network?</span></p><p style="padding-top: 1pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">We’ll consider these important questions shortly.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Given the roaming number, the home MSC sets up the second leg of the call through the network to the MSC in the visited network. The call is completed, being routed from the</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">correspondent to the home MSC, and from there to the visited MSC, and from there to the base station serving the mobile user.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">An unresolved question in step 2 is how the HLR obtains information about the location of the mobile user. When a mobile telephone is switched on or enters a part of a visited network that is covered by a new VLR, the mobile must register with the visited network. This is done through the exchange of signaling messages between the mobile and the VLR. The visited VLR, in turn, sends a location update request message to the mobile’s HLR. This message informs the HLR of either the roaming number at which the mobile can be contacted, or the address of the VLR (which can then later be queried to obtain the mobile number). As part of this exchange, the VLR also obtains subscriber information from the HLR about the mobile and determines what services (if any) should be accorded the mobile user by the visited network.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Handoffs in GSM</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><span class="p">A </span>handoff <a href="#bookmark655" class="s124">occurs when a mobile station changes its association from one base station to another during a call. As shown in </a><a href="#bookmark655" class="a">Figure 7.3</a>1<span class="p">, a mobile’s call is initially (before handoff) routed to the mobile through</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">one base station (which we’ll refer to as the old base station), and after handoff is routed to the mobile through another base</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="375" height="252" alt="image" src="计算机网络自顶向下7th-en/Image_775.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark655">Figure 7.31 Handoff scenario between base stations with a common MSC</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">station (which we’ll refer to as the new base station). Note that a handoff between base stations results not only in the mobile transmitting/receiving to/from a new base station, but also in the rerouting of the ongoing call from a switching point within the network to the new base station. Let’s initially assume that the old and new base stations share the same MSC, and that the rerouting occurs at this MSC.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">There may be several reasons for handoff to occur, including (1) the signal between the current base station and the mobile may have deteriorated to such an extent that the call is in danger of being dropped, and (2) a cell may have become overloaded, handling a large number of calls. This congestion may be alleviated by handing off mobiles to less congested nearby cells.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">While it is associated with a base station, a mobile periodically measures the strength of a beacon signal from its current base station as well as beacon signals from nearby base stations that it can “hear.” These measurements are reported once or twice a second to the mobile’s current base station. Handoff in GSM is initiated by the old base station based on these measurements, the current loads of mobiles</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">in nearby cells, and other factors </a><a href="#bookmark848" class="a">[Mouly 1992</a>]<span class="p">. The GSM standard does not specify the specific algorithm to be used by a base station to determine whether or not to perform handoff.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark656" class="a">Figure 7.32</a> <span class="p">illustrates the steps involved when a base station does decide to hand off a mobile user:</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><ol id="l312"><li style="padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The old base station (BS) informs the visited MSC that a handoff is to be performed and the BS (or possible set of BSs) to which the mobile is to be handed off.</p></li><li style="padding-top: 3pt;padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The visited MSC initiates path setup to the new BS, allocating the resources needed to carry the rerouted call, and signaling the new BS that a handoff is about to occur.</p></li><li style="padding-top: 3pt;padding-left: 47pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The new BS allocates and activates a radio channel for use by the mobile.</p></li><li style="padding-top: 4pt;padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The new BS signals back to the visited MSC and the old BS that the visited-MSC-to-new-BS path has been established and that the mobile should be</p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;text-align: left;"><span><img width="382" height="268" alt="image" src="计算机网络自顶向下7th-en/Image_776.png"/></span></p><h2 style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;"><a name="bookmark656">Figure 7.32 Steps in accomplishing a handoff between base stations with a common MSC</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">informed of the impending handoff. The new BS provides all of the information that the mobile will need to associate with the new BS.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The mobile is informed that it should perform a handoff. Note that up until this point, the mobile has been blissfully unaware that the network has been laying the groundwork (e.g., allocating a</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">channel in the new BS and allocating a path from the visited MSC to the new BS) for a handoff.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The mobile and the new BS exchange one or more messages to fully activate the new channel in the new BS.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The mobile sends a handoff complete message to the new BS, which is forwarded up to the visited MSC. The visited MSC then reroutes the ongoing call to the mobile via the new BS.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The resources allocated along the path to the old BS are then released.</p></li></ol></li></ol></ol></ol><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">Let’s conclude our discussion of handoff by considering what happens when the mobile moves to a BS that is associated with a <i>different </i>MSC than the old BS, and what happens when this inter-MSC handoff</p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;"><a href="#bookmark657" class="s124">occurs more than once. As shown in </a><a href="#bookmark657" class="a">Figure 7.3</a>3<span class="p">, GSM defines the notion of an </span><span class="s23">anchor</span> MSC<span class="p">. The</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">anchor MSC is the MSC visited by the mobile when a call first begins; the anchor MSC thus remains unchanged during the call. Throughout the call’s duration and regardless of the number of inter-MSC</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="358" height="424" alt="image" src="计算机网络自顶向下7th-en/Image_777.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark657">Figure 7.33 Rerouting via the anchor MSC</a></h2><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="358" height="424" alt="image" src="计算机网络自顶向下7th-en/Image_778.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Table 7.2 Commonalities between mobile IP and GSM mobility</h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">GSM element</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Comment on GSM element</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;padding-right: 17pt;text-indent: 0pt;line-height: 146%;text-align: left;">Mobile IP</p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">element</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Home system</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 15pt;text-indent: 0pt;line-height: 146%;text-align: left;">Network to which the mobile user&#39;s permanent phone number belongs.</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 10pt;text-indent: 0pt;line-height: 146%;text-align: left;">Home network</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 14pt;text-indent: 0pt;line-height: 146%;text-align: left;">Gateway mobile switching center or simply home MSC, Home location register (HLR)</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 12pt;text-indent: 0pt;line-height: 146%;text-align: left;">Home MSC: point of contact to obtain routable address of mobile user. HLR: database in home system containing permanent phone number, profile information, current location of mobile user, subscription information.</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 20pt;text-indent: 0pt;line-height: 146%;text-align: left;">Home agent</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Visited system</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 54pt;text-indent: 0pt;line-height: 146%;text-align: left;">Network other than home system where mobile user is currently residing.</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;line-height: 146%;text-align: left;">Visited network</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 12pt;text-indent: 0pt;line-height: 146%;text-align: left;">Visited mobile services switching center, Visitor location register (VLR)</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 10pt;text-indent: 0pt;line-height: 146%;text-align: left;">Visited MSC: responsible for setting up calls to/from mobile nodes in cells associated with MSC. VLR: temporary database entry in visited system, containing subscription information for each visiting mobile user.</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 11pt;text-indent: 0pt;line-height: 146%;text-align: left;">Foreign agent</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/></tr></table><p style="text-indent: 0pt;text-align: left;"><span><img width="787" height="95" alt="image" src="计算机网络自顶向下7th-en/Image_779.png"/></span></p><p style="padding-top: 3pt;padding-left: 15pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark658">Mobile station roaming number (MSRN) or simply roaming number</a><a name="bookmark659">&zwnj;</a><a name="bookmark660">&zwnj;</a></p><p style="padding-top: 3pt;padding-left: 15pt;text-indent: 0pt;line-height: 146%;text-align: left;">Routable address for telephone call segment between home MSC and visited MSC, visible to neither the mobile nor the correspondent.</p><p style="padding-top: 3pt;padding-left: 15pt;text-indent: 0pt;line-height: 146%;text-align: left;">Care-of address</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">transfers performed by the mobile, the call is routed from the home MSC to the anchor MSC, and then from the anchor MSC to the visited MSC where the mobile is currently located. When a mobile moves from the coverage area of one MSC to another, the ongoing call is rerouted from the anchor MSC to the new visited MSC containing the new base station. Thus, at all times there are at most three MSCs (the</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark657" class="s124">home MSC, the anchor MSC, and the visited MSC) between the correspondent and the mobile. </a><a href="#bookmark657" class="a">Figure</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark657" class="a">7.33</a> <span class="p">illustrates the routing of a call among the MSCs visited by a mobile user.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Rather than maintaining a single MSC hop from the anchor MSC to the current MSC, an alternative approach would have been to simply chain the MSCs visited by the mobile, having an old MSC forward the ongoing call to the new MSC each time the mobile moves to a new MSC. Such MSC chaining can in fact occur in IS-41 cellular networks, with an optional path minimization step to remove MSCs between</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">the anchor MSC and the current visited MSC </a><a href="#bookmark848" class="a">[Lin 2001</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark660" class="s124">Let’s wrap up our discussion of GSM mobility management with a comparison of mobility management in GSM and Mobile IP. The comparison in </a><a href="#bookmark660" class="a">Table 7.2</a> <span class="p">indicates that although IP and cellular networks are</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">fundamentally different in many ways, they share a surprising number of common functional elements and overall approaches in handling mobility.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l313"><ol id="l314"><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark661">Wireless and Mobility: Impact on Higher-Layer Protocols</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this chapter, we’ve seen that wireless networks differ significantly from their wired counterparts at both the link layer (as a result of wireless channel characteristics such as fading, multipath, and hidden terminals) and at the network layer (as a result of mobile users who change their points of attachment to the network). But are there important differences at the transport and application layers? It’s tempting to think that these differences will be minor, since the network layer provides the same best-effort delivery service model to upper layers in both wired and wireless networks. Similarly, if protocols such as TCP or UDP are used to provide transport-layer services to applications in both wired and wireless networks, then the application layer should remain unchanged as well. In one sense our intuition is right—TCP and UDP can (and do) operate in networks with wireless links. On the other hand, transport protocols in general, and TCP in particular, can sometimes have very different performance in wired and wireless networks, and it is here, in terms of performance, that differences are manifested. Let’s see why.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Recall that TCP retransmits a segment that is either lost or corrupted on the path between sender and receiver. In the case of mobile users, loss can result from either network congestion (router buffer overflow) or from handoff (e.g., from delays in rerouting segments to a mobile’s new point of attachment to the network). In all cases, TCP’s receiver-to-sender ACK indicates only that a segment was not received intact; the sender is unaware of whether the segment was lost due to congestion, during handoff, or due to detected bit errors. In all cases, the sender’s response is the same—to retransmit the</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">segment. TCP’s congestion-control response is <i>also </i><a href="#bookmark355" class="s124">the same in all cases—TCP decreases its congestion window, as discussed in </a><a href="#bookmark355" class="a">Section 3.</a><span class="s20">7</span>. By unconditionally decreasing its congestion window, TCP implicitly assumes that segment loss results from congestion rather than corruption or handoff. We</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark603" class="s124">saw in </a><a href="#bookmark603" class="a">Section 7.2</a> <span class="p">that bit errors are much more common in wireless networks than in wired networks. When such bit errors occur or when handoff loss occurs, there’s really no reason for the TCP sender to decrease its congestion window (and thus decrease its sending rate). Indeed, it may well be the case</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">that router buffers are empty and packets are flowing along the end-to-end path unimpeded by congestion.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Researchers realized in the early to mid 1990s that given high bit error rates on wireless links and the possibility of handoff loss, TCP’s congestion-control response could be problematic in a wireless setting. Three broad classes of approaches are possible for dealing with this problem:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_780.png"/></span></p><p class="s20" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span style=" color: #333;">Local recovery. </span><a href="#bookmark624" class="s124">Local recovery protocols recover from bit errors when and where (e.g., at the wireless link) they occur, e.g., the 802.11 ARQ protocol we studied in </a><a href="#bookmark624" class="a">Section 7.</a>3<a href="#bookmark848" class="s124">, or more sophisticated approaches that use both ARQ and FEC </a><a href="#bookmark848" class="a">[Ayanoglu 1995</a>]<span class="p">.</span></p><p class="s28" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a name="bookmark662">TCP sender awareness of wireless links. </a><span class="p">In the local recovery approaches, the TCP sender is blissfully unaware that its segments are traversing a wireless link. An alternative approach is for the TCP sender and receiver to be aware of the existence of a wireless link, to distinguish between</span></p><p class="s20" style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">congestive losses occurring in the wired network and corruption/loss occurring at the wireless link, and to invoke congestion control only in response to congestive wired-network losses. </a><a href="#bookmark848" class="a">[Balakrishnan 1997]</a> <span class="p">investigates various types of TCP, assuming that end systems can make this</span></p><p class="s20" style="padding-left: 27pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark848" class="s124">distinction. </a><a href="#bookmark848" class="a">[Liu 2003]</a> <span class="p">investigates techniques for distinguishing between losses on the wired and</span></p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">wireless segments of an end-to-end path.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_781.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Split-connection approaches. <a href="#bookmark848" class="s124">In a split-connection approach </a><a href="#bookmark848" class="a">[Bakre </a><span style=" color: #1E79B8;">1995]</span><span class="p">, the end-to-end connection between the mobile user and the other end point is broken into two transport-layer connections: one from the mobile host to the wireless access point, and one from the wireless</span></p><p class="s20" style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">access point to the other communication end point (which we’ll assume here is a wired host). The end-to-end connection is thus formed by the concatenation of a wireless part and a wired part. The transport layer over the wireless segment can be a standard TCP connection </a><a href="#bookmark848" class="a">[Bakre </a>1995]<span class="p">, or a</span></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark848" class="s124">specially tailored error recovery protocol on top of UDP. </a><a href="#bookmark848" class="a">[Yavatkar 1994]</a> <span class="p">investigates the use of a</span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">transport-layer selective repeat protocol over the wireless connection. Measurements reported in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="a">[Wei 2006]</a> <span class="p">indicate that split TCP connections are widely used in cellular data networks, and that significant improvements can indeed be made through the use of split TCP connections.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Our treatment of TCP over wireless links has been necessarily brief here. In-depth surveys of TCP</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">challenges and solutions in wireless networks can be found in </a><a href="#bookmark848" class="a">[Hanabali 200</a>5<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Leung 2006</a>]<span class="p">. We encourage you to consult the references for details of this ongoing area of research.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark594" class="s124">Having considered transport-layer protocols, let us next consider the effect of wireless and mobility on application-layer protocols. Here, an important consideration is that wireless links often have relatively low bandwidths, as we saw in </a><a href="#bookmark594" class="a">Figure 7.</a>2<span class="p">. As a result, applications that operate over wireless links,</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">particularly over cellular wireless links, must treat bandwidth as a scarce commodity. For example, a</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Web server serving content to a Web browser executing on a 4G phone will likely not be able to provide the same image-rich content that it gives to a browser operating over a wired connection. Although wireless links do provide challenges at the application layer, the mobility they enable also makes</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">possible a rich set of location-aware and context-aware applications </a><a href="#bookmark848" class="a">[Chen 200</a>0<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Baldauf 2007</a>]<span class="p">. More generally, wireless and mobile networks will play a key role in realizing the ubiquitous computing</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">environments of the future </a><a href="#bookmark848" class="a">[Weiser </a>1991]<span class="p">. It’s fair to say that we’ve only seen the tip of the iceberg when it comes to the impact of wireless and mobile networks on networked applications and their protocols!</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark663">Summary</a><a name="bookmark664">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Wireless and mobile networks have revolutionized telephony and are having an increasingly profound impact in the world of computer networks as well. With their anytime, anywhere, untethered access into the global network infrastructure, they are not only making network access more ubiquitous, they are also enabling an exciting new set of location-dependent services. Given the growing importance of wireless and mobile networks, this chapter has focused on the principles, common link technologies, and network architectures for supporting wireless and mobile communication.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">We began this chapter with an introduction to wireless and mobile networks, drawing an important distinction between the challenges posed by the <i>wireless </i>nature of the communication links in such networks, and by the <i>mobility </i>that these wireless links enable. This allowed us to better isolate, identify,</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">and master the key concepts in each area. We focused first on wireless communication, considering the</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark603" class="s124">characteristics of a wireless link in </a><a href="#bookmark603" class="a">Section 7.</a>2<a href="#bookmark624" class="s124">. In </a><a href="#bookmark624" class="a">Sections 7.3</a> <a href="#bookmark635" class="s124">and </a><a href="#bookmark635" class="a">7.</a>4<span class="p">, we examined the link-level aspects of the IEEE 802.11 (WiFi) wireless LAN standard, two IEEE 802.15 personal area networks (Bluetooth and Zigbee), and 3G and 4G cellular Internet access. We then turned our attention to the</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark645" class="s124">issue of mobility. In </a><a href="#bookmark645" class="a">Section 7.</a>5<span class="p">, we identified several forms of mobility, with points along this spectrum posing different challenges and admitting different solutions. We considered the problems of locating and routing to a mobile user, as well as approaches for handing off the mobile user who dynamically</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">moves from one point of attachment to the network to another. We examined how these issues were</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark650" class="s124">addressed in the mobile IP standard and in GSM, in </a><a href="#bookmark650" class="a">Sections 7.6</a> <a href="#bookmark658" class="s124">and </a><a href="#bookmark658" class="a">7.</a>7<span class="p">, respectively. Finally, we considered the impact of wireless links and mobility on transport-layer protocols and networked</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark662" class="s124">applications in </a><a href="#bookmark662" class="a">Section 7.</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although we have devoted an entire chapter to the study of wireless and mobile networks, an entire book (or more) would be required to fully explore this exciting and rapidly expanding field. We encourage you to delve more deeply into this field by consulting the many references provided in this chapter.</p><p class="s18" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark665">Homework Problems and Questions</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Chapter 7 Review Questions</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Section 7.1</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R1. What does it mean for a wireless network to be operating in “infrastructure mode”? If the network is not in infrastructure mode, what mode of operation is it in, and what is the difference between that mode of operation and infrastructure mode?</p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark595" class="s124">R2. What are the four types of wireless networks identified in our taxonomy in </a><a href="#bookmark595" class="a">Section 7.1</a> <span class="p">? Which of these types of wireless networks have you used?</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Section 7.2</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R3. What are the differences between the following types of wireless channel impairments: path loss, multipath propagation, interference from other sources?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R4. As a mobile node gets farther and farther away from a base station, what are two actions that a base station could take to ensure that the loss probability of a transmitted frame does not increase?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Sections 7.3 and 7.4</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R5. Describe the role of the beacon frames in 802.11.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R6. True or false: Before an 802.11 station transmits a data frame, it must first send an RTS frame and receive a corresponding CTS frame.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">R7. Why are acknowledgments used in 802.11 but not in wired Ethernet? R8. True or false: Ethernet and 802.11 use the same frame structure. R9. Describe how the RTS threshold works.</p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R10. Suppose the IEEE 802.11 RTS and CTS frames were as long as the standard DATA and ACK frames. Would there be any advantage to using the CTS and RTS frames? Why or why not?</p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark621" class="s124">R11. </a><a href="#bookmark621" class="a">Section 7.3.4</a> <span class="p">discusses 802.11 mobility, in which a wireless station moves from one BSS to another within the same subnet. When the APs are interconnected with a switch, an AP may need to send a frame with a spoofed MAC address to get the switch to forward the frame</span></p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">properly. Why?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R12. What are the differences between a master device in a Bluetooth network and a base station in an 802.11 network?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R13. What is meant by a super frame in the 802.15.4 Zigbee standard?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">R14. What is the role of the “core network” in the 3G cellular data architecture?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R15. What is the role of the RNC in the 3G cellular data network architecture? What role does the RNC play in the cellular voice network?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R16. What is the role of the eNodeB, MME, P-GW, and S-GW in 4G architecture?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">R17. What are three important differences between the 3G and 4G cellular architectures?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Sections 7.5 and 7.6</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R18. If a node has a wireless connection to the Internet, does that node have to be mobile? Explain. Suppose that a user with a laptop walks around her house with her laptop, and always accesses the Internet through the same access point. Is this user mobile from a network</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">standpoint? Explain.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R19. What is the difference between a permanent address and a care-of address? Who assigns a care-of address?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R20. Consider a TCP connection going over Mobile IP. True or false: The TCP connection phase between the correspondent and the mobile host goes through the mobile’s home network, but the data transfer phase is directly between the correspondent and the mobile host,</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">bypassing the home network.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Section 7.7</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R21. What are the purposes of the HLR and VLR in GSM networks? What elements of mobile IP are similar to the HLR and VLR?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R22. What is the role of the anchor MSC in GSM networks?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Section 7.8</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R23. What are three approaches that can be taken to avoid having a single wireless link degrade the performance of an end-to-end transport-layer TCP connection?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Problems</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark600" class="s124">P1. Consider the single-sender CDMA example in </a><a href="#bookmark600" class="a">Figure 7.5</a> <span class="p">. What would be the sender’s output (for the 2 data bits shown) if the sender’s CDMA code were (1,−1,1,−1,1,−1,1,−1)?</span></p><p class="s20" style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 129%;text-align: left;"><a href="#bookmark605" class="s124">P2. Consider sender 2 in </a><a href="#bookmark605" class="a">Figure 7.6</a> <span class="p">. What is the sender’s output to the channel (before it is added to the signal from sender 1), Zi,m2?</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark605" class="s124">P3. Suppose that the receiver in </a><a href="#bookmark605" class="a">Figure 7.6</a> <span class="p">wanted to receive the data being sent by sender 2. Show (by calculation) that the receiver is indeed able to recover sender 2’s data from the aggregate channel signal by using sender 2’s code.</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P4. For the two-sender, two-receiver example, give an example of two CDMA codes containing 1 and 21 values that do not allow the two receivers to extract the original transmitted bits from the two CDMA senders.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P5. Suppose there are two ISPs providing WiFi access in a particular café, with each ISP operating its own AP and having its own IP address block.</p><ol id="l315"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Further suppose that by accident, each ISP has configured its AP to operate over channel 11. Will the 802.11 protocol completely break down in this situation? Discuss</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">what happens when two stations, each associated with a different ISP, attempt to transmit at the same time.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Now suppose that one AP operates over channel 1 and the other over channel 11. How do your answers change?</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P6. In step 4 of the CSMA/CA protocol, a station that successfully transmits a frame begins the CSMA/CA protocol for a second frame at step 2, rather than at step 1. What rationale might the designers of CSMA/CA have had in mind by having such a station not transmit the second frame</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">immediately (if the channel is sensed idle)?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P7. Suppose an 802.11b station is configured to always reserve the channel with the RTS/CTS sequence. Suppose this station suddenly wants to transmit 1,000 bytes of data, and all other stations are idle at this time. As a function of SIFS and DIFS, and ignoring propagation delay</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">and assuming no bit errors, calculate the time required to transmit the frame and receive the acknowledgment.</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark666" class="s124">P8. Consider the scenario shown in </a><a href="#bookmark666" class="a">Figure 7.34</a> <span class="p">, in which there are four wireless nodes, A, B, C, and D. The radio coverage of the four nodes is shown via the shaded ovals; all nodes share the same frequency. When A transmits, it</span></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="673" height="179" alt="image" src="计算机网络自顶向下7th-en/Image_782.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark666">Figure 7.34 Scenario for problem P8</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">can only be heard/received by B; when B transmits, both A and C can hear/receive from B; when C transmits, both B and D can hear/receive from C; when D transmits, only C can hear/receive</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">from D.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Suppose now that each node has an infinite supply of messages that it wants to send to each of the other nodes. If a message’s destination is not an immediate neighbor, then the message must be relayed. For example, if A wants to send to D, a message from A must first be sent to B, which then sends the message to C, which then sends the message to D. Time is slotted, with a message transmission time taking exactly one time slot, e.g., as in slotted Aloha. During a slot, a</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">node can do one of the following: (<i>i</i>) send a message, (<i>ii</i>) receive a message (if exactly one message is being sent to it), (<i>iii</i>) remain silent. As always, if a node hears two or more simultaneous transmissions, a collision occurs and none of the transmitted messages are</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">received successfully. You can assume here that there are no bit-level errors, and thus if exactly one message is sent, it will be received correctly by those within the transmission radius of the sender.</p><ol id="l316"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose now that an omniscient controller (i.e., a controller that knows the state of every node in the network) can command each node to do whatever it (the omniscient</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">controller) wishes, i.e., to send a message, to receive a message, or to remain silent. Given this omniscient controller, what is the maximum rate at which a data message can be transferred from C to A, given that there are no other messages between any other source/destination pairs?</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose now that A sends messages to B, and D sends messages to C. What is the combined maximum rate at which data messages can flow from A to B and from D to C?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose now that A sends messages to B, and C sends messages to D. What is the combined maximum rate at which data messages can flow from A to B and from C to D?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose now that the wireless links are replaced by wired links. Repeat questions (a) through (c) again in this wired scenario.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Now suppose we are again in the wireless scenario, and that for every data message sent from source to destination, the destination will send an ACK message back to the</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">source (e.g., as in TCP). Also suppose that each ACK message takes up one slot. Repeat questions (a)–(c) above for this scenario.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P9. Describe the format of the 802.15.1 Bluetooth frame. You will have to do some reading outside of the text to find this information. Is there anything in the frame format that inherently limits the number of active nodes in an 802.15.1 network to eight active nodes? Explain.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark634" class="s124">P10. Consider the following idealized LTE scenario. The downstream channel (see </a><a href="#bookmark634" class="a">Figure 7.21</a> <span class="p">) is slotted in time, across F frequencies. There are four nodes, A, B, C, and D, reachable from the base station at rates of 10 Mbps, 5 Mbps, 2.5 Mbps, and 1 Mbps, respectively, on the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">downstream channel. These rates assume that the base station utilizes all time slots available on all F frequencies to send to just one station. The base station has an infinite amount of data to send to each of the nodes, and can send to any one of these four nodes using any of the F frequencies during any time slot in the downstream sub-frame.</p><ol id="l317"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the maximum rate at which the base station can send to the nodes, assuming it</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">can send to any node it chooses during each time slot? Is your solution fair? Explain and define what you mean by “fair.”</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If there is a fairness requirement that each node must receive an equal amount of data during each one second interval, what is the average transmission rate by the base</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">station (to all nodes) during the downstream sub-frame? Explain how you arrived at your answer.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose that the fairness criterion is that any node can receive at most twice as much data as any other node during the sub-frame. What is the average transmission rate by</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">the base station (to all nodes) during the sub-frame? Explain how you arrived at your answer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark645" class="s124">P11. In </a><a href="#bookmark645" class="a">Section 7.5</a> <span class="p">, one proposed solution that allowed mobile users to maintain their IP addresses as they moved among foreign networks was to have a foreign network advertise a highly specific route to the mobile user and use the existing routing infrastructure to propagate</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">this information throughout the network. We identified scalability as one concern. Suppose that when a mobile user moves from one network to another, the new foreign network advertises a specific route to the mobile user, and the old foreign network withdraws its route. Consider how routing information propagates in a distance-vector algorithm (particularly for the case of interdomain routing among networks that span the globe).</p><ol id="l318"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Will other routers be able to route datagrams immediately to the new foreign network as soon as the foreign network begins advertising its route?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Is it possible for different routers to believe that different foreign networks contain the mobile user?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Discuss the timescale over which other routers in the network will eventually learn the path to the mobile users.</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark640" class="s124">P12. Suppose the correspondent in </a><a href="#bookmark640" class="a">Figure 7.23</a> <span class="p">were mobile. Sketch the additional network- layer infrastructure that would be needed to route the datagram from the original mobile user to the (now mobile) correspondent. Show the structure of the datagram(s) between the original</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark642" class="s124">mobile user and the (now mobile) correspondent, as in </a><a href="#bookmark642" class="a">Figure 7.24</a> <span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P13. In mobile IP, what effect will mobility have on end-to-end delays of datagrams between the source and destination?</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark659" class="s124">P14. Consider the chaining example discussed at the end of </a><a href="#bookmark659" class="a">Section 7.7.2</a> <span class="p">. Suppose a mobile user visits foreign networks A, B, and C, and that a correspondent begins a connection to the mobile user when it is resident in foreign network A. List the sequence of messages between</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">foreign agents, and between foreign agents and the home agent as the mobile user moves from network A to network B to network C. Next, suppose chaining is not performed, and the correspondent (as well as the home agent) must be explicitly notified of the changes in the mobile user’s care-of address. List the sequence of messages that would need to be exchanged in this second scenario.</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 130%;text-align: left;">P15. Consider two mobile nodes in a foreign network having a foreign agent. Is it possible for the two mobile nodes to use the same care-of address in mobile IP? Explain your answer.</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;line-height: 138%;text-align: left;">P16. In our discussion of how the VLR updated the HLR with information about the mobile’s current location, what are the advantages and disadvantages of providing the MSRN as opposed to the address of the VLR to the HLR?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark667">Wireshark Lab</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources" class="s124" target="_blank">At the Web site for this textbook, </a><a href="http://www.pearsonhighered.com/cs-resources" class="a" target="_blank">www.pearsonhighered.com/</a>cs-resources<span class="p">, you’ll find a Wireshark lab for this chapter that captures and studies the 802.11 frames exchanged between a wireless laptop and an access point.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="800" alt="image" src="计算机网络自顶向下7th-en/Image_783.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">AN INTERVIEW WITH…</p><p class="s28" style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Deborah Estrin</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s139" style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">Deborah Estrin is a Professor of Computer Science at Cornell Tech in New York City and a Professor of Public Health at Weill Cornell Medical College. She is founder of the </span>Health Tech<span class="s28"> </span>Hub <span class="p">at Cornell Tech and co-founder of the non-profit startup </span>Open mHealth<span class="p">. She received her</span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Ph.D. (1985) in Computer Science from M.I.T. and her B.S. (1980) from UC Berkeley. Estrin’s</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="http://cens.ucla.edu/" class="s124" target="_blank">early research focused on the design of network protocols, including multicast and inter-domain routing. In 2002 Estrin founded the NSF-funded Science and Technology Center at UCLA, Center for Embedded Networked Sensing (CENS </a><a href="http://cens.ucla.edu/" class="a" target="_blank">http://</a>cens.ucla.edu<span class="p">.). CENS launched new</span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 11pt;text-align: left;">areas of multi-disciplinary computer systems research from sensor networks for environmental</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">monitoring, to participatory sensing for citizen science. Her current focus is on mobile health and small data, leveraging the pervasiveness of mobile devices and digital interactions for health and life management, as described in her 2013 TEDMED talk. Professor Estrin is an elected member of the American Academy of Arts and Sciences (2007) and the National Academy of  Engineering (2009). She is a fellow of the IEEE, ACM, and AAAS. She was selected as the first ACM-W Athena Lecturer (2006), awarded the Anita Borg Institute’s Women of Vision Award for</p><p style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Innovation (2007), inducted into the WITI hall of fame (2008) and awarded <i>Doctor Honoris Causa </i>from EPFL (2008) and Uppsala University (2011).</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><span><img width="192" height="269" alt="image" src="计算机网络自顶向下7th-en/Image_784.gif"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_785.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Please describe a few of the most exciting projects you have worked on during your career.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What were the biggest challenges?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the mid-90s at USC and ISI, I had the great fortune to work with the likes of Steve Deering, Mark Handley, and Van Jacobson on the design of multicast routing protocols (in particular, PIM). I tried to carry many of the architectural design lessons from multicast into the design of ecological monitoring arrays, where for the first time I really began to take applications and multidisciplinary research seriously. That interest in jointly innovating in the social and technological space is what interests me so much about my latest area of research, mobile health. The challenges in these projects were as diverse as the problem domains, but what they all had in common was the need to keep our eyes open to whether we had the problem  definition right as we iterated between design and deployment, prototype and pilot. None of them were problems that could be solved analytically, with simulation or even in constructed  laboratory experiments. They all challenged our ability to retain clean architectures in the presence of messy problems and contexts, and they all called for extensive collaboration.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What changes and innovations do you see happening in wireless networks and mobility in the</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">future?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">In a prior edition of this interview I said that I have never put much faith into predicting the future, but I did go on to speculate that we might see the end of feature phones (i.e., those that are not programmable and are used only for voice and text messaging) as smart phones become more and more powerful and the primary point of Internet access for many—and now not so many years later that is clearly the case. I also predicted that we would see the continued proliferation of embedded SIMs by which all sorts of devices have the ability to communicate via the cellular network at low data rates. While that has occurred, we see many devices and “Internet of Things” that use embedded WiFi and other lower power, shorter range, forms of connectivity to local hubs. I did not anticipate at that time the emergence of a large consumer wearables market. By the time the next edition is published I expect broad proliferation of personal applications that leverage data from IoT and other digital traces.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Where do you see the future of networking and the Internet?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Again I think its useful to look both back and forward. Previously I observed that the efforts in named data and software-defined networking would emerge to create a more manageable, evolvable, and richer infrastructure and more generally represent moving the role of architecture higher up in the stack. In the beginnings of the Internet, architecture was layer 4 and below, with</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="745" alt="image" src="计算机网络自顶向下7th-en/Image_786.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark668">applications being more siloed/monolithic, sitting on top. Now data and analytics dominate transport. The adoption of SDN (which I’m really happy to see is featured in this 7th edition of this book) has been well beyond what I ever anticipated. However, looking up the stack, our dominant applications increasingly live in walled gardens, whether mobile apps or large consumer platforms such as Facebook. As Data Science and Big Data techniques develop, they might help to lure these applications out of their silos because of the value in connecting with other apps and platforms.</a><a name="bookmark669">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What people inspired you professionally?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">There are three people who come to mind. First, Dave Clark, the secret sauce and under-sung hero of the Internet community. I was lucky to be around in the early days to see him act as the “organizing principle” of the IAB and Internet governance; the priest of rough consensus and running code. Second, Scott Shenker, for his intellectual brilliance, integrity, and persistence. I strive for, but rarely attain, his clarity in defining problems and solutions. He is always the first person I e-mail for advice on matters large and small. Third, my sister Judy Estrin, who had the creativity and courage to spend her career bringing ideas and concepts to market. Without the Judys of the world the Internet technologies would never have transformed our lives.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What are your recommendations for students who want careers in computer science and</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">networking?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">First, build a strong foundation in your academic work, balanced with any and every real-world work experience you can get. As you look for a working environment, seek opportunities in problem areas you really care about and with smart teams that you can learn from.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="783" height="2" alt="image" src="计算机网络自顶向下7th-en/Image_787.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s16" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark670">Chapter </a><span class="h1">8 </span>Security in Computer Networks</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="1" alt="image" src="计算机网络自顶向下7th-en/Image_788.png"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark101" class="s124">Way back in </a><a href="#bookmark101" class="a">Section 1.6</a> <span class="p">we described some of the more prevalent and damaging classes of Internet attacks, including malware attacks, denial of service, sniffing, source masquerading, and message modification and deletion. Although we have since learned a tremendous amount about computer</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">networks, we still haven’t examined how to secure networks from those attacks. Equipped with our newly acquired expertise in computer networking and Internet protocols, we’ll now study in-depth secure communication and, in particular, how computer networks can be defended from those nasty bad guys.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let us introduce Alice and Bob, two people who want to communicate and wish to do so “securely.” This being a networking text, we should remark that Alice and Bob could be two routers that want to exchange routing tables securely, a client and server that want to establish a secure transport connection, or two e-mail applications that want to exchange secure e-mail—all case studies that we will consider later in this chapter. Alice and Bob are well-known fixtures in the security community, perhaps because their names are more fun than a generic entity named “A” that wants to communicate securely with a generic entity named “B.” Love affairs, wartime communication, and business transactions are the commonly cited human needs for secure communications; preferring the first to the latter two, we’re happy to use Alice and Bob as our sender and receiver, and imagine them in this first scenario.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We said that Alice and Bob want to communicate and wish to do so “securely,” but what precisely does this mean? As we will see, security (like love) is a many-splendored thing; that is, there are many facets to security. Certainly, Alice and Bob would like for the contents of their communication to remain secret from an eavesdropper. They probably would also like to make sure that when they are communicating, they are indeed communicating with each other, and that if their communication is tampered with by an eavesdropper, that this tampering is detected. In the first part of this chapter, we’ll cover the fundamental cryptography techniques that allow for encrypting communication, authenticating the party with whom one is communicating, and ensuring message integrity.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the second part of this chapter, we’ll examine how the fundamental cryptography principles can be used to create secure networking protocols. Once again taking a top-down approach, we’ll examine secure protocols in each of the (top four) layers, beginning with the application layer. We’ll examine how to secure e-mail, how to secure a TCP connection, how to provide blanket security at the network layer, and how to secure a wireless LAN. In the third part of this chapter we’ll consider operational security,</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark671">which is about protecting organizational networks from attacks. In particular, we’ll take a careful look at how firewalls and intrusion detection systems can enhance the security of an organizational network.</a></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l319"><ol id="l320"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark672">What Is Network Security?</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Let’s begin our study of network security by returning to our lovers, Alice and Bob, who want to communicate “securely.” What precisely does this mean? Certainly, Alice wants only Bob to be able to understand a message that she has sent, even though they <i>are </i>communicating over an insecure</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">medium where an intruder (Trudy, the intruder) may intercept whatever is transmitted from Alice to Bob.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Bob also wants to be sure that the message he receives from Alice was indeed sent by Alice, and Alice wants to make sure that the person with whom she is communicating is indeed Bob. Alice and Bob also want to make sure that the contents of their messages have not been altered in transit. They also want to be assured that they can communicate in the first place (i.e., that no one denies them access to the resources needed to communicate). Given these considerations, we can identify the following desirable properties of <span class="s20">secure communication</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_789.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>Confidentiality. </b>Only the sender and intended receiver should be able to understand the contents of the transmitted message. Because eavesdroppers may intercept the message, this necessarily requires that the message be somehow <span class="s20">encrypted </span>so that an intercepted message cannot be</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: justify;">understood by an interceptor. This aspect of confidentiality is probably the most commonly perceived meaning of the term <i>secure communication</i><a href="#bookmark685" class="s124">. We’ll study cryptographic techniques for encrypting and decrypting data in </a><a href="#bookmark685" class="a">Section 8.</a><span class="s20">2</span>.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_790.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 13pt;text-align: left;">Message integrity. <span class="p">Alice and Bob want to ensure that the content of their communication is not</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark699" class="s124">altered, either maliciously or by accident, in transit. Extensions to the checksumming techniques that we encountered in reliable transport and data link protocols can be used to provide such message integrity. We will study message integrity in </a><a href="#bookmark699" class="a">Section 8.</a>3<span class="p">.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_791.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 13pt;text-align: left;">End-point authentication. <span class="p">Both the sender and receiver should be able to confirm the identity of the</span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">other party involved in the communication—to confirm that the other party is indeed who or what they claim to be. Face-to-face human communication solves this problem easily by visual recognition. When communicating entities exchange messages over a medium where they cannot see the other party, authentication is not so simple. When a user wants to access an inbox, how does the mail server verify that the user is the person he or she claims to be? We study end-point</p><p class="s20" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark711" class="s124">authentication in </a><a href="#bookmark711" class="a">Section 8.</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_792.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Operational security. <span class="p">Almost all organizations (companies, universities, and so on) today have networks that are attached to the public Internet. These networks therefore can potentially be compromised. Attackers can attempt to deposit worms into the hosts in the network, obtain</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">corporate secrets, map the internal network configurations, and launch DoS attacks. We’ll see in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark765" class="a">Section 8.9</a> <span class="p">that operational devices such as firewalls and intrusion detection systems are used to counter attacks against an organization’s network. A firewall sits between the organization’s network and the public network, controlling packet access to and from the network. An intrusion detection</span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">system performs “deep packet inspection,” alerting the network administrators about suspicious activity.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark673" class="s124">Having established what we mean by network security, let’s next consider exactly what information an intruder may have access to, and what actions can be taken by the intruder. </a><a href="#bookmark673" class="a">Figure 8.1</a> <span class="p">illustrates the</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">scenario. Alice, the sender, wants to send data to Bob, the receiver. In order to exchange data securely, while meeting the requirements of confidentiality, end-point authentication, and message integrity, Alice and Bob will exchange control messages and data messages (in much the same way that TCP senders and receivers exchange control segments and data segments).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="652" height="253" alt="image" src="计算机网络自顶向下7th-en/Image_793.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark673">Figure 8.1 Sender, receiver, and intruder (Alice, Bob, and Trudy)</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark101" class="s124">All or some of these messages will typically be encrypted. As discussed in </a><a href="#bookmark101" class="a">Section 1.</a>6<span class="p">, an intruder can potentially perform</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_794.png"/></span></p><p class="s17" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">eavesdropping<span class="p">—sniffing and recording control and data messages on the channel.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_795.png"/></span></p><p class="s17" style="padding-left: 26pt;text-indent: 0pt;text-align: left;">modification, insertion<span class="p">, or </span>deletion <span class="p">of messages or message content.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">As we’ll see, unless appropriate countermeasures are taken, these capabilities allow an intruder to mount a wide variety of security attacks: snooping on communication (possibly stealing passwords and data), impersonating another entity, hijacking an ongoing session, denying service to legitimate network users by overloading system resources, and so on. A summary of reported attacks is maintained at the</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">CERT Coordination Center </a><a href="#bookmark848" class="a">[CERT </a>2016]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having established that there are indeed real threats loose in the Internet, what are the Internet equivalents of Alice and Bob, our friends who need to communicate securely? Certainly, Bob and Alice might be human users at two end systems, for example, a real Alice and a real Bob who really do want to exchange secure e-mail. They might also be participants in an electronic commerce transaction. For example, a real Bob might want to transfer his credit card number securely to a Web server to purchase</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark206" class="s124" name="bookmark674">an item online. Similarly, a real Alice might want to interact with her bank online. The parties needing secure communication might themselves also be part of the network infrastructure. Recall that the domain name system (DNS, see </a><a href="#bookmark206" class="a">Section 2.</a>4<span class="p">) or routing daemons that exchange routing information</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark444" class="s124">(see </a><a href="#bookmark444" class="a">Chapter </a>5<span class="p">) require secure communication between two parties. The same is true for network</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark444" class="s124">management applications, a topic we examined in </a><a href="#bookmark444" class="a">Chapter </a>5<a href="#bookmark206" class="s124">). An intruder that could actively interfere with DNS lookups (as discussed in </a><a href="#bookmark206" class="a">Section 2.</a>4<a href="#bookmark848" class="s124">), routing computations </a><a href="#bookmark848" class="a">[RFC </a>4272]<a href="#bookmark848" class="s124">, or network management functions </a><a href="#bookmark848" class="a">[RFC 3414]</a> <span class="p">could wreak havoc in the Internet.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having now established the framework, a few of the most important definitions, and the need for network security, let us next delve into cryptography. While the use of cryptography in providing confidentiality is self-evident, we’ll see shortly that it is also central to providing end-point authentication and message integrity—making cryptography a cornerstone of network security.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark675">Principles of Cryptography</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">Although cryptography has a long history dating back at least as far as Julius Caesar, modern cryptographic techniques, including many of those used in the Internet, are based on advances made in the past 30 years. Kahn’s book, <a href="#bookmark848" style=" color: #333; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt;">The Codebreakers </a><a href="#bookmark848" class="a">[Kahn 1967</a><span class="s20">]</span>, and Singh’s book, <i>The Code Book:</i></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark848" style=" color: #333; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt;">The Science of Secrecy from Ancient Egypt to Quantum Cryptography </a><a href="#bookmark848" class="a">[Singh 1999</a>]<span class="p">, provide a</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">fascinating look at the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="666" height="316" alt="image" src="计算机网络自顶向下7th-en/Image_796.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark676">Figure 8.2 Cryptographic components</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">long history of cryptography. A complete discussion of cryptography itself requires a complete book</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="a">[Kaufman </a>1995<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Schneier 1995]</a> <span class="p">and so we only touch on the essential aspects of cryptography, particularly as they are practiced on the Internet. We also note that while our focus in this section will be on the use of cryptography for confidentiality, we’ll see shortly that cryptographic techniques are</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">inextricably woven into authentication, message integrity, nonrepudiation, and more.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark676" class="s124">Cryptographic techniques allow a sender to disguise data so that an intruder can gain no information from the intercepted data. The receiver, of course, must be able to recover the original data from the disguised data. </a><a href="#bookmark676" class="a">Figure 8.2</a> <span class="p">illustrates some of the important terminology.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 147%;text-align: left;">Suppose now that Alice wants to send a message to Bob. Alice’s message in its original form (for example, “ <span class="s30">Bob, I love you. Alice </span>”) is known as <span class="s23">plaintext</span>, or <span class="s23">cleartext</span>. Alice encrypts her</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">plaintext message using an <span class="s20">encryption algorithm </span>so that the encrypted message, known as</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">ciphertext<span class="p">, looks unintelligible to any intruder. Interestingly, in many modern cryptographic systems,</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><span class="p">including those used in the Internet, the encryption technique itself is </span><span class="s17">known</span><a href="#bookmark848" class="s124">—published, standardized, and available to everyone (for example, </a><a href="#bookmark848" class="a">[RFC </a>1321<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 344</a>7<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 242</a>0<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">NIST 2001</a>]<span class="p">), even a potential intruder! Clearly, if everyone knows the method for encoding data, then there must be some</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">secret information that prevents an intruder from decrypting the transmitted data. This is where keys come in.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 148%;text-align: left;"><a href="#bookmark676" class="s124">In </a><a href="#bookmark676" class="a">Figure 8.</a><span class="s20">2</span>, Alice provides a <span class="s23">ke</span><span class="s20">y</span>, <i>K</i><span class="s31">A</span>, a string of numbers or characters, as input to the encryption algorithm. The encryption algorithm takes the key and the plaintext message, <i>m</i>, as input and produces ciphertext as output. The notation <i>K</i><span class="s31">A</span>(<i>m</i>) refers to the ciphertext form (encrypted using the key <i>K</i><span class="s31">A</span>) of the plaintext message, <i>m</i>. The actual encryption algorithm that uses key <i>K</i><span class="s31">A </span>will be evident from the context. Similarly, Bob will provide a key, <i>K</i><span class="s31">B</span>, to the <span class="s23">decryption</span><span class="s20"> algorithm </span>that takes the ciphertext and Bob’s</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">key as input and produces the original plaintext as output. That is, if Bob receives an encrypted</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 143%;text-align: left;">message <i>K</i><span class="s31">A</span>(<i>m</i>), he decrypts it by computing <span class="s27">KB</span>(KA(m))=m. In <span class="s23">symmetric</span><span class="s20"> key systems</span>, Alice’s and Bob’s keys are identical and are secret. In <span class="s20">public key systems</span>, a pair of keys is used. One of the keys is known to both Bob and Alice (indeed, it is known to the whole world). The other key is known only by either Bob or Alice (but not both). In the following two subsections, we consider symmetric key and public key systems in more detail.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l321"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Symmetric Key Cryptography</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">All cryptographic algorithms involve substituting one thing for another, for example, taking a piece of plaintext and then computing and substituting the appropriate ciphertext to create the encrypted message. Before studying a modern key-based cryptographic system, let us first get our feet wet by studying a very old, very simple symmetric key algorithm attributed to Julius Caesar, known as the <span class="s20">Caesar cipher </span>(a cipher is a method for encrypting data).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;">For English text, the Caesar cipher would work by taking each letter in the plaintext message and substituting the letter that is <i>k </i>letters later (allowing wraparound; that is, having the letter <i>z </i>followed by</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">the letter <i>a</i>) in the alphabet. For example if <span class="s27">k=</span>3, then the letter <i>a </i>in plaintext becomes <i>d </i>in ciphertext; <i>b</i></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">in plaintext becomes <i>e </i>in ciphertext, and so on. Here, the value of <i>k </i>serves as the key. As an example, the plaintext message “ <span class="s30">bob, i love you. Alice </span>” becomes “ <span class="s30">ere, l oryh brx. dolfh </span>” in ciphertext. While the ciphertext does indeed look like gibberish, it wouldn’t take long to break the code if</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">you knew that the Caesar cipher was being used, as there are only 25 possible key values.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">An improvement on the Caesar cipher is the <span class="s20">monoalphabetic cipher</span>, which also substitutes one letter of the alphabet with another letter of the alphabet. However, rather than substituting according to a regular pattern (for example, substitution with an offset of <i>k </i>for all letters), any letter can be substituted</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">for any other letter, as long as each letter has a unique substitute letter, and vice versa. The substitution</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark677" class="s124">rule in </a><a href="#bookmark677" class="a">Figure 8.3</a> <span class="p">shows one possible rule for encoding plaintext.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">The plaintext message “ <span class="s30">bob, i love you. Alice </span>” becomes <span class="s30">“nkn, s gktc wky. Mgsbc.”</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 148%;text-align: left;">Thus, as in the case of the Caesar cipher, this looks like gibberish. A monoalphabetic cipher would also appear to be better than the Caesar cipher in that there are 26! (on the order of 10<span class="s21">26</span>) possible pairings of letters rather than 25 possible pairings. A brute-force approach of trying all 10<span class="s21">26</span><span class="s22">  </span>possible pairings</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="671" height="70" alt="image" src="计算机网络自顶向下7th-en/Image_797.gif"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark677">Figure 8.3 A monoalphabetic cipher</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">would require far too much work to be a feasible way of breaking the encryption algorithm and decoding the message. However, by statistical analysis of the plaintext language, for example, knowing that the letters <i>e </i>and <i>t </i>are the most frequently occurring letters in typical English text (accounting for 13 percent</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">and 9 percent of letter occurrences), and knowing that particular two-and three-letter occurrences of</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;">letters appear quite often together (for example, “in,” “it,” “the,” “ion,” “ing,” and so forth) make it relatively easy to break this code. If the intruder has some knowledge about the possible contents of the message, then it is even easier to break the code. For example, if Trudy the intruder is Bob’s wife and suspects Bob of having an affair with Alice, then she might suspect that the names “bob” and “alice” appear in the text. If Trudy knew for certain that those two names appeared in the ciphertext and had a copy of the example ciphertext message above, then she could immediately determine seven of the 26 letter pairings, requiring 10<span class="s21">9</span><span class="s22">  </span>fewer possibilities to be checked by a brute-force method. Indeed, if Trudy suspected Bob of having an affair, she might well expect to find some other choice words in the message as well.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">When considering how easy it might be for Trudy to break Bob and Alice’s encryption scheme, one can distinguish three different scenarios, depending on what information the intruder has.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_798.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>Ciphertext-only attack. </b>In some cases, the intruder may have access only to the intercepted ciphertext, with no certain information about the contents of the plaintext message. We have seen how statistical analysis can help in a <span class="s20">ciphertext-only attack </span>on an encryption scheme.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_799.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">Known-plaintext attack. <span class="p">We saw above that if Trudy somehow knew for sure that “bob” and “alice” appeared in the ciphertext message, then she could have determined the (plaintext, ciphertext)</span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">pairings for the letters <i>a, l, i, c, e, b</i>, and <i>o</i>. Trudy might also have been fortunate enough to have recorded all of the ciphertext transmissions and then found Bob’s own decrypted version of one of the transmissions scribbled on a piece of paper. When an intruder knows some of the (plaintext,</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">ciphertext) pairings, we refer to this as a <span class="s20">known-plaintext attack </span>on the encryption scheme.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_800.png"/></span></p><p style="padding-left: 27pt;text-indent: 0pt;text-align: left;"><b>Chosen-plaintext attack. </b>In a <span class="s23">chosen-plaintext</span><span class="s20"> attack</span>, the intruder is able to choose the plaintext</p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 153%;text-align: left;">message and obtain its corresponding ciphertext form. For the simple encryption algorithms we’ve seen so far, if Trudy could get Alice to send the message, “ <span class="s30">The quick brown fox jumps over the lazy dog, </span>” she could completely break the encryption scheme. We’ll see shortly that for</p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 11pt;text-align: left;">more sophisticated encryption techniques, a chosen-plaintext attack does not necessarily mean that</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">the encryption technique can be broken.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Five hundred years ago, techniques improving on monoalphabetic encryption, known as <span class="s20">polyalphabetic encryption</span>, were invented. The idea behind polyalphabetic encryption is to use multiple monoalphabetic ciphers, with a specific</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="671" height="95" alt="image" src="计算机网络自顶向下7th-en/Image_801.gif"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark678">Figure 8.4 A polyalphabetic cipher using two Caesar ciphers</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark678" class="s124">monoalphabetic cipher to encode a letter in a specific position in the plaintext message. Thus, the same letter, appearing in different positions in the plaintext message, might be encoded differently. An example of a polyalphabetic encryption scheme is shown in </a><a href="#bookmark678" class="a">Figure 8.</a>4<span class="p">. It has two Caesar ciphers (with</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><span class="s27">k</span>=5 and <span class="s27">k</span>=19), shown as rows. We might choose to use these two Caesar ciphers, C<span class="s22">1 </span>and C<span class="s22">2</span>, in the</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 148%;text-align: left;">repeating pattern C<span class="s22">1</span>, C<span class="s22">2</span>, C<span class="s22">2</span>, C<span class="s22">1</span>, C<span class="s22">2</span>. That is, the first letter of plaintext is to be encoded using C<span class="s22">1</span>, the second and third using C<span class="s22">2</span>, the fourth using C<span class="s22">1</span>, and the fifth using C<span class="s22">2</span>. The pattern then repeats, with the sixth letter being encoded using C<span class="s22">1</span>, the seventh with C<span class="s22">2</span>, and so on. The plaintext message “ <span class="s30">bob, i love you. </span>” is thus encrypted “ <span class="s30">ghu, n etox dhz. </span>” Note that the first <i>b </i>in the plaintext message is encrypted using C<span class="s22">1</span>, while the second <i>b </i>is encrypted using C<span class="s22">2</span>. In this example, the encryption and decryption “key” is the knowledge of the two Caesar keys <span class="s27">(k</span>=5, k=19) and the pattern C<span class="s22">1</span>, C<span class="s22">2</span>, C<span class="s22">2</span>, C<span class="s22">1</span>, C<span class="s22">2</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Block Ciphers</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">Let us now move forward to modern times and examine how symmetric key encryption is done today. There are two broad classes of symmetric encryption techniques: </span>stream ciphers <span class="p">and </span>block ciphers<a href="#bookmark744" class="s124">. We’ll briefly examine stream ciphers in </a><a href="#bookmark744" class="a">Section 8.7</a> <span class="p">when we investigate security for wireless LANs. In</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">this section, we focus on block ciphers, which are used in many secure Internet protocols, including</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">PGP (for secure e-mail), SSL (for securing TCP connections), and IPsec (for securing the network-layer transport).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 126%;text-align: left;">In a block cipher, the message to be encrypted is processed in blocks of <i>k </i>bits. For example, if <span class="s27">k</span>=64, then the message is broken into 64-bit blocks, and each block is encrypted independently. To encode a</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">block, the cipher uses a one-to-one mapping to map the <i>k</i>-bit block of cleartext to a <i>k</i>-bit block of</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">ciphertext. Let’s look at an example. Suppose that k=3, so that the block cipher maps 3-bit inputs</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark679" class="s124">(cleartext) to 3-bit outputs (ciphertext). One possible mapping is given in </a><a href="#bookmark679" class="a">Table 8.</a>1<span class="p">. Notice that this is a one-to-one mapping; that is, there is a different output for each input. This block cipher breaks the message up into 3-bit blocks and encrypts each block according to the above mapping. You should</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">verify that the message 010110001111 gets encrypted into 101000111001.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark679" class="s124">Continuing with this 3-bit block example, note that the mapping in </a><a href="#bookmark679" class="a">Table 8.1</a> <span class="p">is just one mapping of many possible mappings. How many possible mappings are</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><h2 style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark679">Table 8.1 A specific 3-bit block cipher</a></h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">input</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">output</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">input</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">output</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">000</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">110</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">100</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">011</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">001</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">111</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">101</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">010</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">010</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">101</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">110</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">000</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">011</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">100</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">111</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">001</p></td></tr></table><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">there? To answer this question, observe that a mapping is nothing more than a permutation of all the possible inputs. There are 23(=8) possible inputs (listed under the input columns). These eight inputs can be permuted in 8!=40,320 different ways. Since each of these permutations specifies a mapping, there are 40,320 possible mappings. We can view each of these mappings as a key—if Alice and Bob both know the mapping (the key), they can encrypt and decrypt the messages sent between them.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">The brute-force attack for this cipher is to try to decrypt ciphtertext by using all mappings. With only 40,320 mappings (when k=3), this can quickly be accomplished on a desktop PC. To thwart brute-force attacks, block ciphers typically use much larger blocks, consisting of k=64 bits or even larger. Note that the number of possible mappings for a general <i>k</i>-block cipher is 2<span class="s121">k</span>!, which is astronomical for even moderate values of <i>k </i>(such as <span class="s27">k</span>=64).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Although full-table block ciphers, as just described, with moderate values of <i>k </i>can produce robust symmetric key encryption schemes, they are unfortunately difficult to implement. For k=64 and for a</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 143%;text-align: left;">given mapping, Alice and Bob would need to maintain a table with 2<span class="s21">64</span><span class="s22"> </span>input values, which is an infeasible task. Moreover, if Alice and Bob were to change keys, they would have to each regenerate the table. Thus, a full-table block cipher, providing predetermined mappings between all inputs and outputs (as in the example above), is simply out of the question.</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 135%;text-align: left;"><a href="#bookmark848" class="s124">Instead, block ciphers typically use functions that simulate randomly permuted tables. An example (adapted from </a><a href="#bookmark848" class="a">[Kaufman </a>1995]<span class="p">) of such a function for </span><span class="s27">k</span><a href="#bookmark680" class="s124">=64 bits is shown in </a><a href="#bookmark680" class="a">Figure 8.</a>5<span class="p">. The function first breaks a 64-bit block into 8 chunks, with each chunk consisting of 8 bits. Each 8-bit chunk is</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">processed by an 8-bit to 8-bit table, which is of manageable size. For example, the first chunk is processed by the table denoted by T<span class="s22">1</span>. Next, the 8 output chunks are reassembled into a 64-bit block.</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">The positions of the 64 bits in the block are then scrambled (permuted) to produce a 64-bit output. This</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">output is fed back to the 64-bit input, where another cycle begins. After <i>n </i>such cycles, the function provides a 64-bit block of ciphertext. The purpose of the rounds is to make each input bit affect most (if not all) of the final output bits. (If only one round were used, a given input bit would affect only 8 of the</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">64 output bits.) The key for this block cipher algorithm would be the eight permutation tables (assuming the scramble function is publicly known).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="670" height="376" alt="image" src="计算机网络自顶向下7th-en/Image_802.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark680">Figure 8.5 An example of a block cipher</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark680" class="s124">Today there are a number of popular block ciphers, including DES (standing for Data Encryption Standard), 3DES, and AES (standing for Advanced Encryption Standard). Each of these standards uses functions, rather than predetermined tables, along the lines of </a><a href="#bookmark680" class="a">Figure 8.5</a> <span class="p">(albeit more complicated and</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">specific to each cipher). Each of these algorithms also uses a string of bits for a key. For example, DES</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;">uses 64-bit blocks with a 56-bit key. AES uses 128-bit blocks and can operate with keys that are 128, 192, and 256 bits long. An algorithm’s key determines the specific “mini-table” mappings and permutations within the algorithm’s internals. The brute-force attack for each of these ciphers is to cycle through all the keys, applying the decryption algorithm with each key. Observe that with a key length of <i>n</i>, there are 2<span class="s121">n</span><span class="s31"> </span><a href="#bookmark848" class="s124">possible keys. NIST </a><a href="#bookmark848" class="a">[NIST 2001]</a><span class="s20"> </span>estimates that a machine that could crack 56-bit DES in one second (that is, try all 2<span class="s21">56</span><span class="s22"> </span>keys in one second) would take approximately 149 trillion years to crack a 128-bit AES key.</p><p class="s24" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Cipher-Block Chaining</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;">In computer networking applications, we typically need to encrypt long messages (or long streams of data). If we apply a block cipher as described by simply chopping up the message into <i>k</i>-bit blocks and</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">independently encrypting each block, a subtle but important problem occurs. To see this, observe that two or more of the cleartext blocks can be identical. For example, the cleartext in two or more blocks could be “HTTP/1.1”. For these identical blocks, a block cipher would, of course, produce the same ciphertext. An attacker could potentially guess the cleartext when it sees identical ciphertext blocks and may even be able to decrypt the entire message by identifying identical ciphtertext blocks and using</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">knowledge about the underlying protocol structure </a><a href="#bookmark848" class="a">[Kaufman </a>1995]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;">To address this problem, we can mix some randomness into the ciphertext so that identical plaintext blocks produce different ciphertext blocks. To explain this idea, let <i>m</i>(<i>i</i>) denote the <i>i</i>th plaintext block, <i>c</i>(<i>i</i>)</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">denote the <i>i</i>th ciphertext block, and <span class="s27">a</span><span class="s29">⊕</span>b denote the exclusive-or (XOR) of two bit strings, <i>a </i>and <i>b</i>.</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 126%;text-align: left;">(Recall that the 0<span class="s29">⊕</span>0=1<span class="s29">⊕</span>1=0 and 0<span class="s29">⊕</span>1=1<span class="s29">⊕</span>0=1, and the XOR of two bit strings is done on a bit-by-bit basis. So, for example, 10101010<span class="s29">⊕</span>11110000=01011010.) Also, denote the block-cipher encryption</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 126%;text-align: left;">algorithm with key <i>S </i>as <i>K</i><span class="s31">S</span>. The basic idea is as follows. The sender creates a random <i>k</i>-bit number <i>r</i>(<i>i</i>) for the <i>i</i>th block and calculates <span class="s27">c(</span>i)=KS(m(i)<span class="s29">⊕</span>r(i)). Note that a new <i>k</i>-bit random number is chosen for each block. The sender then sends <i>c</i>(1), <i>r</i>(1), <i>c</i>(2), <i>r</i>(2), <i>c</i>(3), <i>r</i>(3), and so on. Since the receiver receives <i>c(i) </i>and <i>r(i)</i>, it can recover each block of the plaintext by computing <span class="s27">m(</span>i)=KS(c(i))<span class="s29">⊕</span>r(i). It is important to</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 149%;text-align: left;">note that, although <i>r</i>(<i>i</i>) is sent in the clear and thus can be sniffed by Trudy, she cannot obtain the plaintext <i>m</i>(<i>i</i>), since she does not know the key <i>K</i><span class="s31">S</span>. Also note that if two plaintext blocks <i>m</i>(<i>i</i>) and <i>m</i>(<i>j</i>) are the same, the corresponding ciphertext blocks <i>c</i>(<i>i</i>) and <i>c</i>(<i>j</i>) will be different (as long as the random numbers <i>r</i>(<i>i</i>) and <i>r</i>(<i>j</i>) are different, which occurs with very high probability).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark679" class="s124">As an example, consider the 3-bit block cipher in </a><a href="#bookmark679" class="a">Table 8.</a>1<span class="p">. Suppose the plaintext is 010010010. If Alice encrypts this directly, without including the randomness, the resulting ciphertext becomes 101101101. If Trudy sniffs this ciphertext, because each of the three cipher blocks is the same, she can correctly</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">surmise that each of the three plaintext blocks are the same. Now suppose instead Alice generates the random blocks r(1)=001, r(2)=111, and r(3)=100 and uses the above technique to generate the ciphertext c(1)=100, c(2)=010, and c(3)=000. Note that the three ciphertext blocks are different even</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">though the plaintext blocks are the same. Alice then sends <i>c</i>(1), <i>r</i>(1), <i>c</i>(2), and <i>r</i>(2). You should verify that Bob can obtain the original plaintext using the shared key <i>K</i><span class="s31">S</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The astute reader will note that introducing randomness solves one problem but creates another: namely, Alice must transmit twice as many bits as before. Indeed, for each cipher bit, she must now also send a random bit, doubling the required bandwidth. In order to have our cake and eat it too, block ciphers typically use a technique called <span class="s20">Cipher Block Chaining (CBC)</span>. The basic idea is to send only</p><p class="s17" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">one random value along with the very first message, and then have the sender and receiver use the</p><p class="s17" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark681">computed coded blocks in place of the subsequent random number. </a><span class="p">Specifically, CBC operates as follows:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l322"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 133%;text-align: left;"><p style="display: inline;">Before encrypting the message (or the stream of data), the sender generates a random <i>k</i>-bit string, called the <span class="s23">Initialization</span><span class="s20"> Vector (IV)</span>. Denote this initialization vector by <i>c</i>(0). The sender sends the IV to the receiver <i>in cleartext</i>.</p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 17pt;text-align: left;"><p style="display: inline;">For the first block, the sender calculates <span class="s27">m(</span>1)<span class="s29">⊕</span>c(0), that is, calculates the exclusive-or of the first</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;line-height: 142%;text-align: left;">block of cleartext with the IV. It then runs the result through the block-cipher algorithm to get the corresponding ciphertext block; that is, c(1)=KS(m(1)<span class="s29">⊕</span>c(0)). The sender sends the encrypted block <i>c</i>(1) to the receiver.</p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 15pt;text-align: left;"><p style="display: inline;">For the <i>i</i>th block, the sender generates the <i>i</i>th ciphertext block from <span class="s27">c(</span>i)= KS(m(i)<span class="s29">⊕</span>c(i−1)).</p></li></ol><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">Let’s now examine some of the consequences of this approach. First, the receiver will still be able to recover the original message. Indeed, when the receiver receives <i>c</i>(<i>i</i>), it decrypts it with <i>K</i><span class="s31">S </span>to obtain</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">s(i)=m(i)<span class="s29">⊕</span>c(i−1); since the receiver also knows c(i−1), it then obtains the cleartext block from</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 137%;text-align: left;">m(i)=s(i)<span class="s29">⊕</span>c(i−1). Second, even if two cleartext blocks are identical, the corresponding ciphtertexts (almost always) will be different. Third, although the sender sends the IV in the clear, an intruder will still</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">not be able to decrypt the ciphertext blocks, since the intruder does not know the secret key, <i>S</i>. Finally, the sender only sends one overhead block (the IV), thereby negligibly increasing the bandwidth usage for long messages (consisting of hundreds of blocks).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 126%;text-align: justify;"><a href="#bookmark679" class="s124">As an example, let’s now determine the ciphertext for the 3-bit block cipher in </a><a href="#bookmark679" class="a">Table 8.1</a><span class="s20"> </span>with plaintext 010010010 and IV=c(0)=001. The sender first uses the IV to calculate c(1)=KS(m(1)<span class="s29">⊕</span>c(0))=100. The sender then calculates c(2)= KS(m(2)<span class="s29">⊕</span>c(1))=KS(010<span class="s29">⊕</span>100)=000, and C(3)=KS(m(3)<span class="s29">⊕</span>c(2))=KS(010<span class="s29">⊕ </span><span class="s27">00</span>0)=101. The reader should verify that the receiver, knowing the IV and <i>K</i><span class="s31">S </span>can recover the original</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">plaintext.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">CBC has an important consequence when designing secure network protocols: we’ll need to provide a mechanism within the protocol to distribute the IV from sender to receiver. We’ll see how this is done for several protocols later in this chapter.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Public Key Encryption</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">For more than 2,000 years (since the time of the Caesar cipher and up to the 1970s), encrypted communication required that the two communicating parties share a common secret—the symmetric key used for encryption and decryption. One difficulty with this approach is that the two parties must</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">somehow agree on the shared key; but to do so requires (presumably <i>secure</i>) communication! Perhaps the parties could first meet and agree on the key in person (for example, two of Caesar’s centurions might meet at the Roman baths) and thereafter communicate with encryption. In a networked world,</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">however, communicating parties may never meet and may never converse except over the network. Is it possible for two parties to communicate with encryption without having a shared secret key that is known in advance? In 1976, Diffie and Hellman </a><a href="#bookmark848" class="a">[Diffie 1976]</a> <span class="p">demonstrated an algorithm (known now as</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Diffie-Hellman Key Exchange) to do just that—a radically different and marvelously elegant approach</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">toward secure communication that has led to the development of today’s public key cryptography systems. We’ll see shortly that public key cryptography systems also have several wonderful properties that make them useful not only</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="670" height="309" alt="image" src="计算机网络自顶向下7th-en/Image_803.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark682">Figure 8.6 Public key cryptography</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">for encryption, but for authentication and digital signatures as well. Interestingly, it has recently come to light that ideas similar to those in </a><a href="#bookmark848" class="a">[Diffie 1976]</a> <a href="#bookmark848" class="s124">and </a><a href="#bookmark848" class="a">[RSA 1978]</a> <span class="p">had been independently developed in</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the early 1970s in a series of secret reports by researchers at the Communications-Electronics Security</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">Group in the United Kingdom </a><a href="#bookmark848" class="a">[Ellis 1987</a>]<span class="p">. As is often the case, great ideas can spring up</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">independently in many places; fortunately, public key advances took place not only in private, but also in the public view, as well.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark682" class="s124">The use of public key cryptography is conceptually quite simple. Suppose Alice wants to communicate with Bob. As shown in </a><a href="#bookmark682" class="a">Figure 8.</a>6<span class="p">, rather than Bob and Alice sharing a single secret key (as in the case</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">of symmetric key systems), Bob (the recipient of Alice’s messages) instead has two keys—a <span class="s20">public key</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 136%;text-align: left;">that is available to <i>everyone </i>in the world (including Trudy the intruder) and a <span class="s23">private</span><span class="s20"> key </span>that is known only to Bob. We will use the notation KB+ and KB− to refer to Bob’s public and private keys, respectively. In order to communicate with Bob, Alice first fetches Bob’s public key. Alice then encrypts</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">her message, <i>m</i>, to Bob using Bob’s public key and a known (for example, standardized) encryption algorithm; that is, Alice computes KB−(m). Bob receives Alice’s encrypted message and uses his private key and a known (for example, standardized) decryption algorithm to decrypt Alice’s encrypted</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">message. That is, Bob computes KB−(KB+(m)). We will see below that there are encryption/decryption</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">algorithms and techniques for choosing public and private keys such that KB−(KB+(m))=m; that is, applying Bob’s public key, <span class="s27">KB+</span>, to a message, <i>m </i>(to get <span class="s27">KB</span>−(m)), and then applying Bob’s private key, <span class="s27">KB</span>−, to the encrypted version of <i>m </i>(that is, computing <span class="s27">KB</span>−(KB+(m))) gives back <i>m. </i>This is a remarkable</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">result! In this manner, Alice can use Bob’s publicly available key to send a secret message to Bob</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">without either of them having to distribute any secret keys! We will see shortly that we can interchange the public key and private key encryption and get the same remarkable result––that is, KB−(B+(m))=KB+(KB−(m))=m.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The use of public key cryptography is thus conceptually simple. But two immediate worries may spring to mind. A first concern is that although an intruder intercepting Alice’s encrypted message will see only gibberish, the intruder knows both the key (Bob’s public key, which is available for all the world to see) and the algorithm that Alice used for encryption. Trudy can thus mount a chosen-plaintext attack, using the known standardized encryption algorithm and Bob’s publicly available encryption key to encode any message she chooses! Trudy might well try, for example, to encode messages, or parts of messages, that she suspects that Alice might send. Clearly, if public key cryptography is to work, key selection and encryption/decryption must be done in such a way that it is impossible (or at least so hard as to be nearly impossible) for an intruder to either determine Bob’s private key or somehow otherwise decrypt or guess Alice’s message to Bob. A second concern is that since Bob’s encryption key is public, anyone</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">can send an encrypted message to Bob, including Alice or someone <i>claiming </i>to be Alice. In the case of a single shared secret key, the fact that the sender knows the secret key implicitly identifies the sender to the receiver. In the case of public key cryptography, however, this is no longer the case since anyone</p><p class="s20" style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark699" class="s124">can send an encrypted message to Bob using Bob’s publicly available key. A digital signature, a topic we will study in </a><a href="#bookmark699" class="a">Section 8.</a>3<span class="p">, is needed to bind a sender to a message.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">RSA</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">While there may be many algorithms that address these concerns, the <span class="s20">RSA algorithm </span>(named after its founders, Ron Rivest, Adi Shamir, and Leonard Adleman) has become almost synonymous with public key cryptography. Let’s first see how RSA works and then examine why it works.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">RSA makes extensive use of arithmetic operations using modulo-<i>n </i>arithmetic. So let’s briefly review modular arithmetic. Recall that <i>x </i>mod <i>n </i>simply means the remainder of <i>x </i>when divided by <i>n</i>; so, for example, 19 mod 5=4. In modular arithmetic, one performs the usual operations of addition,</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">multiplication, and exponentiation. However, the result of each operation is replaced by the integer</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">remainder that is left when the result is divided by <i>n</i>. Adding and multiplying with modular arithmetic is facilitated with the following handy facts:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 133%;text-align: left;">[ (a mod n)+(b mod n)]mod n=(a+b)mod n[ (a mod n)−(b mod n)]mod n=(a−b)mod n[ (a mod n)<span class="s29">⋅</span>(b mod n)]mod n=(a<span class="s29">⋅</span>b)mod n</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 135%;text-align: left;">It follows from the third fact that (<i>a </i>mod <i>n</i>)<span class="s21">d</span><span class="s22"> </span><span class="s27">n</span>=ad mod <i>n</i>, which is an identity that we will soon find very useful.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark682" class="s124">Now suppose that Alice wants to send to Bob an RSA-encrypted message, as shown in </a><a href="#bookmark682" class="a">Figure 8.</a>6<span class="p">. In our discussion of RSA, let’s always keep in mind that a message is nothing but a bit pattern, and every bit pattern can be uniquely represented by an integer number (along with the length of the bit pattern).</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">For example, suppose a message is the bit pattern 1001; this message can be represented by the decimal integer 9. Thus, when encrypting a message with RSA, it is equivalent to encrypting the unique integer number that represents the message.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">There are two interrelated components of RSA:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_804.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_805.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">The choice of the public key and the private key The encryption and decryption algorithm</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">To generate the public and private RSA keys, Bob performs the following steps:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><ol id="l323"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Choose two large prime numbers, <i>p </i>and <i>q</i>. How large should <i>p </i>and <i>q </i>be? The larger the values, the more difficult it is to break RSA, but the longer it takes to perform the encoding and</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">decoding. RSA Laboratories recommends that the product of <i>p </i>and <i>q </i><a href="#bookmark848" class="s124">be on the order of 1,024 bits. For a discussion of how to find large prime numbers, see </a><a href="#bookmark848" class="a">[Caldwell 2012</a><span class="s20">]</span>.</p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 15pt;text-align: left;"><p class="s49" style="display: inline;">Compute<span class="p"> n=pq </span>and<span class="p"> z=(p−1)(q−1)</span>.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 134%;text-align: left;"><p style="display: inline;">Choose a number, <i>e</i>, less than <i>n</i>, that has no common factors (other than 1) with <i>z. </i>(In this case, <i>e </i>and <i>z </i>are said to be relatively prime.) The letter <i>e </i>is used since this value will be used in encryption.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 133%;text-align: justify;"><p style="display: inline;">Find a number, <i>d</i>, such that <span class="s27">e</span>d−1 is exactly divisible (that is, with no remainder) by <i>z</i>. The letter <i>d </i>is used because this value will be used in decryption. Put another way, given <i>e</i>, we choose <i>d </i>such that</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">ed modz=1</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The public key that Bob makes available to the world, <span class="s27">KB</span>+, is the pair of numbers (<i>n</i>, <i>e</i>); his private key, <span class="s27">KB</span>−, is the pair of numbers (<i>n</i>, <i>d</i>).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The encryption by Alice and the decryption by Bob are done as follows:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_806.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 142%;text-align: justify;">Suppose Alice wants to send Bob a bit pattern represented by the integer number <i>m </i>(with <span class="s27">m</span>&lt;n). To encode, Alice performs the exponentiation <i>m</i><span class="s121">e</span>, and then computes the integer remainder when <i>m</i><span class="s121">e</span><span class="s31"> </span>is divided by <i>n</i>. In other words, the encrypted value, <i>c</i>, of Alice’s plaintext message, <i>m</i>, is</p><p style="padding-left: 27pt;text-indent: 0pt;text-align: justify;">c=memod n</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_807.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">The bit pattern corresponding to this ciphertext <i>c </i>is sent to Bob. To decrypt the received ciphertext message, <i>c</i>, Bob computes m=cdmod n</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">which requires the use of his private key (<i>n</i>, <i>d</i>).</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark683">Table 8.2 Alice’s RSA encryption, </a><span class="s140">e</span>=5, <span class="s140">n=</span>35</h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Plaintext Letter</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s134" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">m<span class="s129">: numeric representation</span></p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s141" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">m<span class="s142">e</span></p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Ciphertext c=me mod <i>n</i></p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">l</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">12</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">248832</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">17</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">o</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">15</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">759375</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">15</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">v</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">22</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">5153632</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">22</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">e</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">5</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">3125</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">10</p></td></tr></table><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">As a simple example of RSA, suppose Bob chooses p=5 and q=7. (Admittedly, these values are far too small to be secure.) Then n=35 and z=24. Bob chooses e=5, since 5 and 24 have no common factors. Finally, Bob chooses d=29, since 5<span class="s29">⋅</span>29−1 (that is, ed−1) is exactly divisible by 24. Bob makes the two values, n=35 and e=5, public and keeps the value d=29 secret. Observing these two public</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">values, suppose Alice now wants to send the letters <i>l</i>, <i>o</i>, <i>v</i>, and <i>e </i>to Bob. Interpreting each letter as a number between 1 and 26 (with <i>a </i>being 1, and <i>z </i><a href="#bookmark683" class="s124">being 26), Alice and Bob perform the encryption and decryption shown in </a><a href="#bookmark683" class="a">Tables 8.2</a><span class="s20"> </span><a href="#bookmark684" class="s124">and </a><a href="#bookmark684" class="a">8.</a><span class="s20">3</span>, respectively. Note that in this example, we consider each of the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">four letters as a distinct message. A more realistic example would be to convert the four letters into their</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">8-bit ASCII representations and then encrypt the integer corresponding to the resulting 32-bit bit pattern. (Such a realistic example generates numbers that are much too long to print in a textbook!)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark683" class="s124">Given that the “toy” example in </a><a href="#bookmark683" class="a">Tables 8.2</a><span class="s20"> </span><a href="#bookmark684" class="s124">and </a><a href="#bookmark684" class="a">8.3</a><span class="s20"> </span>has already produced some extremely large numbers, and given that we saw earlier that <i>p </i>and <i>q </i>should each be several hundred bits long, several practical issues regarding RSA come to mind. How does one choose large prime numbers? How does</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">one then choose <i>e </i>and <i>d</i><a href="#bookmark848" class="s124">? How does one perform exponentiation with large numbers? A discussion of these important issues is beyond the scope of this book; see </a><a href="#bookmark848" class="a">[Kaufman 1995]</a><span class="s20"> </span>and the references therein for details.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Table 8.3 Bob’s RSA decryption, <span class="s140">d=</span>29, <span class="s140">n=</span>35</h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">Ciphertext <i>c</i></p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s141" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">c<span class="s143">d</span></p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s134" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">m <span class="s129">= </span>c<span class="s144">d</span><span class="s143"> </span><span class="s129">mod </span>n</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 9pt;text-indent: 0pt;text-align: left;">Plaintext Letter</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/></tr></table><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p class="s122" style="padding-left: 8pt;text-indent: 0pt;line-height: 14pt;text-align: left;"><a name="bookmark684">17</a></p></td><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p class="s122" style="padding-left: 8pt;text-indent: 0pt;line-height: 14pt;text-align: left;">4819685721067509150915091411825223071697</p></td><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p class="s122" style="padding-left: 8pt;text-indent: 0pt;line-height: 14pt;text-align: left;">12</p></td><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p class="s122" style="padding-left: 8pt;text-indent: 0pt;line-height: 14pt;text-align: left;">l</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">15</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">127834039403948858939111232757568359375</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">15</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">o</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">22</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">851643319086537701956194499721106030592</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">22</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">v</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">10</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">1000000000000000000000000000000</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">5</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">e</p></td></tr></table><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Session Keys</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">We note here that the exponentiation required by RSA is a rather time-consuming process. By contrast, DES is at least 100 times faster in software and between 1,000 and 10,000 times faster in hardware </a><a href="#bookmark848" class="a">[RSA Fast </a>2012]<span class="p">. As a result, RSA is often used in practice in combination with symmetric key</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">cryptography. For example, if Alice wants to send Bob a large amount of encrypted data, she could do</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 141%;text-align: left;">the following. First Alice chooses a key that will be used to encode the data itself; this key is referred to as a <span class="s23">session</span><span class="s20"> key</span>, and is denoted by <i>K</i><span class="s31">S</span>. Alice must inform Bob of the session key, since this is the shared symmetric key they will use with a symmetric key cipher (e.g., with DES or AES). Alice encrypts the session key using Bob’s public key, that is, computes <span class="s27">c</span>=(KS)e mod <i>n</i>. Bob receives the RSA-encrypted session key, <i>c</i>, and decrypts it to obtain the session key, <i>K</i><span class="s31">S</span>. Bob now knows the session key that Alice will use for her encrypted data transfer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Why Does RSA Work?</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">RSA encryption/decryption appears rather magical. Why should it be that by applying the encryption algorithm and then the decryption algorithm, one recovers the original message? In order to understand why RSA works, again denote <span class="s27">n</span>=pq, where <i>p </i>and <i>q </i>are the large prime numbers used in the RSA</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">algorithm.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Recall that, under RSA encryption, a message (uniquely represented by an integer), <i>m</i>, is exponentiated to the power <i>e </i>using modulo-<i>n </i>arithmetic, that is,</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">c=memod n</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 144%;text-align: left;">Decryption is performed by raising this value to the power <i>d</i>, again using modulo-<i>n </i>arithmetic. The result of an encryption step followed by a decryption step is thus (<i>m</i><span class="s121">e</span><span class="s31"> </span>mod <i>n</i>)<span class="s121">d</span><span class="s31"> </span>mod <i>n</i>. Let’s now see what we can say about this quantity. As mentioned earlier, one important property of modulo arithmetic is (<i>a </i>mod</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 15pt;text-align: left;"><i>n</i>)<span class="s121">d</span><span class="s31"> </span>mod <span class="s27">n</span>=ad mod <i>n </i>for any values <i>a</i>, <i>n</i>, and <i>d</i>. Thus, using <span class="s27">a</span>=me in this property, we have</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">(memod n)dmod n=medmod n</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 142%;text-align: left;"><a name="bookmark685">It therefore remains to show that medmod n=m. Although we’re trying to remove some of the magic about why RSA works, to establish this, we’ll need to use a rather magical result from number theory here. Specifically, we’ll need the result that says if </a><i>p </i>and <i>q </i>are prime, <span class="s27">n</span>=pq, and <span class="s27">z=</span>(p−1)(q−1), then <i>x</i><span class="s121">y</span><span class="s31"> </span>mod <i>n </i>is the same as <i>x</i><span class="s21">(</span><span class="s31">y </span><span class="s22">mod </span><span class="s31">z</span><span class="s22">) </span>mod <a href="#bookmark848" style=" color: #333; font-family:Arial, sans-serif; font-style: italic; font-weight: normal; text-decoration: none; font-size: 12.5pt;">n </a><a href="#bookmark848" class="a">[Kaufman </a><span class="s20">1995]</span>. Applying this result with <span class="s27">x</span>=m and <span class="s27">y</span>=ed we have<a name="bookmark686">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">medmod n=m(edmod z)mod n</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">But remember that we have chosen <i>e </i>and <i>d </i>such that <span class="s27">e</span>dmod z=1. This gives us</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">medmod n=m1mod n=m</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">which is exactly the result we are looking for! By first exponentiating to the power of <i>e </i>(that is, encrypting) and then exponentiating to the power of <i>d </i>(that is, decrypting), we obtain the original value,</p><p class="s17" style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">m. <span class="p">Even </span>more <span class="p">wonderful is the fact that if we first exponentiate to the power of </span>d <span class="p">and then exponentiate to the power of </span>e<span class="p">—that is, we reverse the order of encryption and decryption, performing the decryption operation first and then applying the encryption operation—we also obtain the original value, </span>m<span class="p">. This</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: justify;">wonderful result follows immediately from the modular arithmetic:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">(mdmod n)emod n=mdemod n=medmod n=(memod n)dmod n</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">The security of RSA relies on the fact that there are no known algorithms for quickly factoring a number, in this case the public value <i>n</i>, into the primes <i>p </i>and <i>q</i>. If one knew <i>p </i>and <i>q</i>, then given the public value <i>e</i>, one could easily compute the secret key, <i>d</i>. On the other hand, it is not known whether or not there</p><p class="s17" style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">exist <span class="p">fast algorithms for factoring a number, and in this sense, the security of RSA is not guaranteed.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Another popular public-key encryption algorithm is the Diffie-Hellman algorithm, which we will briefly explore in the homework problems. Diffie-Hellman is not as versatile as RSA in that it cannot be used to encrypt messages of arbitrary length; it can be used, however, to establish a symmetric session key, which is in turn used to encrypt messages.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li></ol></li></ol></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark687">Message Integrity and Digital Signatures</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the previous section we saw how encryption can be used to provide confidentiality to two communicating entities. In this section we turn to the equally important cryptography topic of providing <span class="s20">message integrity </span>(also known as message authentication). Along with message integrity, we will discuss two related topics in this section: digital signatures and end-point authentication.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">We define the message integrity problem using, once again, Alice and Bob. Suppose Bob receives a message (which may be encrypted or may be in plaintext) and he believes this message was sent by Alice. To authenticate this message, Bob needs to verify:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l324"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The message indeed originated from Alice.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The message was not tampered with on its way to Bob.</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark711" class="s124">We’ll see in </a><a href="#bookmark711" class="a">Sections 8.4</a> <a href="#bookmark744" class="s124">through </a><a href="#bookmark744" class="a">8.7</a> <span class="p">that this problem of message integrity is a critical concern in just about all secure networking protocols.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark444" class="s124">As a specific example, consider a computer network using a link-state routing algorithm (such as OSPF) for determining routes between each pair of routers in the network (see </a><a href="#bookmark444" class="a">Chapter </a>5<span class="p">). In a link-state</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">algorithm, each router needs to broadcast a link-state message to all other routers in the network. A router’s link-state message includes a list of its directly connected neighbors and the direct costs to these neighbors. Once a router receives link-state messages from all of the other routers, it can create a complete map of the network, run its least-cost routing algorithm, and configure its forwarding table. One relatively easy attack on the routing algorithm is for Trudy to distribute bogus link-state messages with incorrect link-state information. Thus the need for message integrity—when router B receives a link- state message from router A, router B should verify that router A actually created the message and, further, that no one tampered with the message in transit.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section, we describe a popular message integrity technique that is used by many secure networking protocols. But before doing so, we need to cover another important topic in cryptography— cryptographic hash functions.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l325"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Cryptographic Hash Functions</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark688" class="s124">As shown in </a><a href="#bookmark688" class="a">Figure 8.</a>7<span class="p">, a hash function takes an input, m, and computes a fixed-size string H(m)</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark254" class="s124">known as a hash. The Internet checksum (</a><a href="#bookmark254" class="a">Chapter </a>3<a href="#bookmark513" class="s124">) and CRCs (</a><a href="#bookmark513" class="a">Chapter </a>6<span class="p">) meet this definition. A</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">cryptographic hash function <span class="p">is required to have the following additional property:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_808.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">It is computationally infeasible to find any two different messages <i>x </i>and <i>y </i>such that <span class="s27">H</span>(x)=H(y).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Informally, this property means that it is computationally infeasible for an intruder to substitute one message for another message that is protected by the hash</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="665" height="313" alt="image" src="计算机网络自顶向下7th-en/Image_809.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark688">Figure 8.7 Hash functions</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="515" height="352" alt="image" src="计算机网络自顶向下7th-en/Image_810.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark689">Figure 8.8 Initial message and fraudulent message have the same checksum!</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">function. That is, if (<i>m</i>, <i>H</i>(<i>m</i>)) are the message and the hash of the message created by the sender, then</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark690">an intruder cannot forge the contents of another message, </a><i>y</i>, that has the same hash value as the original message.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s convince ourselves that a simple checksum, such as the Internet checksum, would make a poor cryptographic hash function. Rather than performing 1s complement arithmetic (as in the Internet checksum), let us compute a checksum by treating each character as a byte and adding the bytes together using 4-byte chunks at a time. Suppose Bob owes Alice $100.99 and sends an IOU to Alice</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">consisting of the text string “ <span class="s30">IOU100.99BOB. </span>” The ASCII representation (in hexadecimal notation) for these letters is <span class="s30">49 </span>, <span class="s30">4F </span>, <span class="s30">55 </span>, <span class="s30">31 </span>, <span class="s30">30 </span>, <span class="s30">30 </span>, <span class="s30">2E </span>, <span class="s30">39 </span>, <span class="s30">39 </span>, <span class="s30">42 </span>, <span class="s30">4F </span>, <span class="s30">42 </span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark689" class="a">Figure 8.8</a><span class="s20"> </span><a href="#bookmark689" class="s124">(top) shows that the 4-byte checksum for this message is B2 C1 D2 AC. A slightly different message (and a much more costly one for Bob) is shown in the bottom half of </a><a href="#bookmark689" class="a">Figure 8.</a><span class="s20">8</span>. The messages “ <span class="s30">IOU100.99BOB </span>” and “ <span class="s30">IOU900.19BOB </span>” have the <i>same </i>checksum. Thus, this simple</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">checksum algorithm violates the requirement above. Given the original data, it is simple to find another</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">set of data with the same checksum. Clearly, for security purposes, we are going to need a more powerful hash function than a checksum.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">The MD5 hash algorithm of Ron Rivest </a><a href="#bookmark848" class="a">[RFC 1321]</a> <span class="p">is in wide use today. It computes a 128-bit hash in a four-step process consisting of a padding step (adding a one followed by enough zeros so that the length of the message satisfies certain conditions), an append step (appending a 64-bit representation</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">of the message length before padding), an initialization of an accumulator, and a final looping step in which the message’s 16-word blocks are processed (mangled) in four rounds. For a description of MD5 (including a C source code implementation) see </a><a href="#bookmark848" class="a">[RFC </a>1321]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">The second major hash algorithm in use today is the Secure Hash Algorithm (SHA-1) </a><a href="#bookmark848" class="a">[FIPS 1995</a>]<a href="#bookmark848" class="s124">. This algorithm is based on principles similar to those used in the design of MD4 </a><a href="#bookmark848" class="a">[RFC </a>1320]<span class="p">, the predecessor to MD5. SHA-1, a US federal standard, is required for use whenever a cryptographic hash algorithm is</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">needed for federal applications. It produces a 160-bit message digest. The longer output length makes SHA-1 more secure.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Message Authentication Code</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now return to the problem of message integrity. Now that we understand hash functions, let’s take a first stab at how we might perform message integrity:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l326"><li style="padding-left: 47pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Alice creates message <i>m </i>and calculates the hash <i>H</i>(<i>m</i>) (for example with SHA-1).</p></li><li style="padding-top: 4pt;padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Alice then appends <i>H</i>(<i>m</i>) to the message <i>m</i>, creating an extended message (<i>m</i>, <i>H</i>(<i>m</i>)), and sends the extended message to Bob.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 124%;text-align: left;"><p style="display: inline;">Bob receives an extended message (<i>m</i>, <i>h</i>) and calculates <i>H</i>(<i>m</i>). If <span class="s27">H</span>(m)=h, Bob concludes that everything is fine.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">This approach is obviously flawed. Trudy can create a bogus message <i>m</i>´ in which she says she is Alice, calculate <i>H</i>(<i>m</i>´), and send Bob (<i>m</i>´, <i>H</i>(<i>m</i>´)). When Bob receives the message, everything checks out in step 3, so Bob doesn’t suspect any funny business.</p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">To perform message integrity, in addition to using cryptographic hash functions, Alice and Bob will need a shared secret <i>s</i>. This shared secret, which is nothing more than a string of bits, is called the</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">authentication key<span class="p">. Using this shared secret, message integrity can be performed as follows:</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><ol id="l327"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 124%;text-align: left;"><p style="display: inline;">Alice creates message <i>m</i>, concatenates <i>s </i>with <i>m </i>to create <span class="s27">m</span>+s, and calculates the hash <span class="s27">H</span>(m+s) (for example with SHA-1). H(m+s) is called the <span class="s20">message authentication code (MAC)</span>.</p></li><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;line-height: 123%;text-align: left;"><p style="display: inline;">Alice then appends the MAC to the message <i>m</i>, creating an extended message <span class="s27">(m</span>, H(m+s)), and sends the extended message to Bob.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 123%;text-align: left;"><p style="display: inline;">Bob receives an extended message (<i>m, h</i>) and knowing <i>s</i>, calculates the MAC <span class="s27">H</span>(m+s). If H(m+s)=h, Bob concludes that everything is fine.</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark691" class="s124">A summary of the procedure is shown in </a><a href="#bookmark691" class="a">Figure 8.</a>9<span class="p">. Readers should note that the MAC here (standing for “message authentication code”) is not the same MAC used in link-layer protocols (standing for “medium access control”)!</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">One nice feature of a MAC is that it does not require an encryption algorithm. Indeed, in many applications, including the link-state routing algorithm described earlier, communicating entities are only concerned with message integrity and are not concerned with message confidentiality. Using a MAC, the entities can authenticate</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="640" height="296" alt="image" src="计算机网络自顶向下7th-en/Image_811.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark691">Figure 8.9 Message authentication code (MAC)</a></h2><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark692">the messages they send to each other without having to integrate complex encryption algorithms into the integrity process.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">As you might expect, a number of different standards for MACs have been proposed over the years. The most popular standard today is </span>HMAC<a href="#bookmark848" class="s124">, which can be used either with MD5 or SHA-1. HMAC actually runs data and the authentication key through the hash function twice </a><a href="#bookmark848" class="a">[Kaufman </a>1995<span class="p">; RFC</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">2104].</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">There still remains an important issue. How do we distribute the shared authentication key to the communicating entities? For example, in the link-state routing algorithm, we would somehow need to distribute the secret authentication key to each of the routers in the autonomous system. (Note that the routers can all use the same authentication key.) A network administrator could actually accomplish this by physically visiting each of the routers. Or, if the network administrator is a lazy guy, and if each router has its own public key, the network administrator could distribute the authentication key to any one of the routers by encrypting it with the router’s public key and then sending the encrypted key over the network to the router.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Digital Signatures</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Think of the number of the times you’ve signed your name to a piece of paper during the last week. You sign checks, credit card receipts, legal documents, and letters. Your signature attests to the fact that you (as opposed to someone else) have acknowledged and/or agreed with the document’s contents. In a digital world, one often wants to indicate the owner or creator of a document, or to signify one’s agreement with a document’s content. A <span class="s20">digital signature </span>is a cryptographic technique for achieving these goals in a digital world.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Just as with handwritten signatures, digital signing should be done in a way that is verifiable and nonforgeable. That is, it must be possible to prove that a document signed by an individual was indeed signed by that individual (the signature must be verifiable) and that <i>only </i>that individual could have</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">signed the document (the signature cannot be forged).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s now consider how we might design a digital signature scheme. Observe that when Bob signs a message, Bob must put something on the message that is unique to him. Bob could consider attaching a MAC for the signature, where the MAC is created by appending his key (unique to him) to the message, and then taking the hash. But for Alice to verify the signature, she must also have a copy of the key, in which case the key would not be unique to Bob. Thus, MACs are not going to get the job done here.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Recall that with public-key cryptography, Bob has both a public and private key, with both of these keys being unique to Bob. Thus, public-key cryptography is an excellent candidate for providing digital signatures. Let us now examine how it is done.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">Suppose that Bob wants to digitally sign a document, <i>m</i><a href="#bookmark693" class="s124">. We can think of the document as a file or a message that Bob is going to sign and send. As shown in </a><a href="#bookmark693" class="a">Figure 8.1</a><span class="s20">0</span>, to sign this document, Bob simply uses his private key, KB−, to compute KB−(m). At first, it might seem odd that Bob is using his</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark685" class="s124">private key (which, as we saw in </a><a href="#bookmark685" class="a">Section 8.</a>2<span class="p">, was used to decrypt a message that had been encrypted with his public key) to sign a document. But recall that encryption and decryption are nothing more than</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">mathematical operations (exponentiation to the power of <i>e </i>or <i>d </i><a href="#bookmark685" class="s124">in RSA; see </a><a href="#bookmark685" class="a">Section 8.</a><span class="s20">2</span>) and recall that Bob’s goal is not to scramble or obscure the contents of the document, but rather to sign the document in a manner that is verifiable and nonforgeable. Bob’s digital signature of the document is KB−(m).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 144%;text-align: left;">Does the digital signature KB−(m) meet our requirements of being verifiable and nonforgeable? Suppose Alice has <i>m </i>and <span class="s27">KB</span>−(m). She wants to prove in court (being</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="670" height="321" alt="image" src="计算机网络自顶向下7th-en/Image_812.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark693">Figure 8.10 Creating a digital signature for a document</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;"><a name="bookmark694">litigious) that Bob had indeed signed the document and was the only person who could have possibly signed the document. Alice takes Bob’s public key, KB+, and applies it to the digital signature, KB−(m), associated with the document, </a><i>m</i>. That is, she computes <span class="s27">KB+</span>(KB−(m)), and voilà, with a dramatic flurry, she produces <i>m</i>, which exactly matches the original document! Alice then argues that only Bob could have signed the document, for the following reasons:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_813.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 126%;text-align: left;">Whoever signed the message must have used the private key, <span class="s27">KB</span>−, in computing the signature KB−(m), such that KB+(KB−(m))=m.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_814.png"/></span></p><p style="padding-top: 2pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">The only person who could have known the private key, <span class="s27">KB</span>−, is Bob. Recall from our discussion of</p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 136%;text-align: left;"><a href="#bookmark685" class="s124">RSA in </a><a href="#bookmark685" class="a">Section 8.2</a><span class="s20"> </span>that knowing the public key, <span class="s27">KB+</span>, is of no help in learning the private key, <span class="s27">KB</span>−. Therefore, the only person who could know KB− is the person who generated the pair of keys, (KB+, KB−), in the first place, Bob. (Note that this assumes, though, that Bob has not given KB− to anyone,</p><p style="padding-top: 1pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">nor has anyone stolen KB− from Bob.)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 127%;text-align: left;">It is also important to note that if the original document, <i>m</i>, is ever modified to some alternate form, <i>m</i>´, the signature that Bob created for <i>m </i>will not be valid for <i>m</i>´, since <span class="s27">KB+</span>(KB−(m)) does not equal <i>m</i>´. Thus we see that digital signatures also provide message integrity, allowing the receiver to verify that the</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">message was unaltered as well as the source of the message.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">One concern with signing data by encryption is that encryption and decryption are computationally expensive. Given the overheads of encryption and decryption, signing data via complete encryption/decryption can be overkill. A more efficient approach is to introduce hash functions into the</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;"><a href="#bookmark692" class="s124">digital signature. Recall from </a><a href="#bookmark692" class="a">Section 8.3.2</a><span class="s20"> </span>that a hash algorithm takes a message, <i>m</i>, of arbitrary length and computes a fixed-length “fingerprint” of the message, denoted by <i>H</i>(<i>m</i>). Using a hash function, Bob signs the hash of a message rather than the message itself, that is, Bob calculates <span class="s27">KB</span>−(H(m)). Since <i>H</i>(<i>m</i>) is generally much smaller than the original message <i>m</i>, the computational effort</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">required to create the digital signature is substantially reduced.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark695" class="s124">In the context of Bob sending a message to Alice, </a><a href="#bookmark695" class="a">Figure 8.11</a> <span class="p">provides a summary of the operational procedure of creating a digital signature. Bob puts his original long message through a hash function. He then digitally signs the resulting hash with his private key. The original message (in cleartext) along</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">with the digitally signed message digest (henceforth referred to as the digital signature) is then sent to</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark696" class="s124">Alice. </a><a href="#bookmark696" class="a">Figure 8.12</a> <span class="p">provides a summary of the operational procedure of the signature. Alice applies the sender’s public key to the message to obtain a hash result. Alice also applies the hash function to the cleartext message to obtain a second hash result. If the two hashes match, then Alice can be sure about</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">the integrity and author of the message.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before moving on, let’s briefly compare digital signatures with MACs, since they have parallels, but also have important subtle differences. Both digital signatures and</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="787" height="503" alt="image" src="计算机网络自顶向下7th-en/Image_815.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark695">Figure 8.11 Sending a digitally signed message</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">MACs start with a message (or a document). To create a MAC out of the message, we append an authentication key to the message, and then take the hash of the result. Note that neither public key nor symmetric key encryption is involved in creating the MAC. To create a digital signature, we first take the hash of the message and then encrypt the message with our private key (using public key cryptography). Thus, a digital signature is a “heavier” technique, since it requires an underlying Public</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark711" class="s124">Key Infrastructure (PKI) with certification authorities as described below. We’ll see in </a><a href="#bookmark711" class="a">Section 8.4</a> <span class="p">that PGP—a popular secure e-mail system—uses digital signatures for message integrity. We’ve seen</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark721" class="s124">already that OSPF uses MACs for message integrity. We’ll see in </a><a href="#bookmark721" class="a">Sections 8.5</a> <a href="#bookmark731" class="s124">and </a><a href="#bookmark731" class="a">8.6</a> <span class="p">that MACs are also used for popular transport-layer and network-layer security protocols.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Public Key Certification</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">An important application of digital signatures is <span class="s20">public key certification</span>, that is, certifying that a public key belongs to a specific entity. Public key certification is used in many popular secure networking protocols, including IPsec and SSL.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To gain insight into this problem, let’s consider an Internet-commerce version of the classic “pizza prank.” Alice is in the pizza delivery business and accepts orders</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="783" height="594" alt="image" src="计算机网络自顶向下7th-en/Image_816.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark696">Figure 8.12 Verifying a signed message</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">over the Internet. Bob, a pizza lover, sends Alice a plaintext message that includes his home address and the type of pizza he wants. In this message, Bob also includes a digital signature (that is, a signed hash of the original plaintext message) to prove to Alice that he is the true source of the message. To verify the signature, Alice obtains Bob’s public key (perhaps from a public key server or from the e-mail message) and checks the digital signature. In this manner she makes sure that Bob, rather than some adolescent prankster, placed the order.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark697" class="s124">This all sounds fine until clever Trudy comes along. As shown in </a><a href="#bookmark697" class="a">Figure 8.1</a>3<span class="p">, Trudy is indulging in a prank. She sends a message to Alice in which she says she is Bob, gives Bob’s home address, and orders a pizza. In this message she also includes her (Trudy’s) public key, although Alice naturally</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">assumes it is Bob’s public key. Trudy also attaches a digital signature, which was created with her own (Trudy’s) private key. After receiving the message, Alice applies Trudy’s public key (thinking that it is Bob’s) to the digital signature and concludes that the plaintext message was</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="789" height="522" alt="image" src="计算机网络自顶向下7th-en/Image_817.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark697">Figure 8.13 Trudy masquerades as Bob using public key cryptography</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">indeed created by Bob. Bob will be very surprised when the delivery person brings a pizza with pepperoni and anchovies to his home!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We see from this example that for public key cryptography to be useful, you need to be able to verify that you have the actual public key of the entity (person, router, browser, and so on) with whom you want to communicate. For example, when Alice wants to communicate with Bob using public key cryptography, she needs to verify that the public key that is supposed to be Bob’s is indeed Bob’s.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Binding a public key to a particular entity is typically done by a <span class="s20">Certification Authority (CA)</span>, whose job is to validate identities and issue certificates. A CA has the following roles:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l328"><li style="padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">A CA verifies that an entity (a person, a router, and so on) is who it says it is. There are no mandated procedures for how certification is done. When dealing with a CA, one must trust the</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">CA to have performed a suitably rigorous identity verification. For example, if Trudy were able to walk into the Fly-by-Night</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;"><span><img width="572" height="400" alt="image" src="计算机网络自顶向下7th-en/Image_818.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;"><a name="bookmark698">Figure 8.14 Bob has his public key certified by the CA</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">CA and simply announce “I am Alice” and receive certificates associated with the identity of Alice, then one shouldn’t put much faith in public keys certified by the Fly-by-Night CA. On the other hand, one might (or might not!) be more willing to trust a CA that is part of a federal or state program. You can trust the identity associated with a public key only to the extent to which you can trust a CA and its identity verification techniques. What a tangled web of trust we spin!</p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 124%;text-align: left;"><p style="display: inline;">Once the CA verifies the identity of the entity, the CA creates a <span class="s23">certificate</span><span class="s20"> </span>that binds the public key of the entity to the identity. The certificate contains the public key and globally unique</p><p class="s20" style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark698" class="s124">identifying information about the owner of the public key (for example, a human name or an IP address). The certificate is digitally signed by the CA. These steps are shown in </a><a href="#bookmark698" class="a">Figure 8.1</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let us now see how certificates can be used to combat pizza-ordering pranksters, like Trudy, and other undesirables. When Bob places his order he also sends his CA-signed certificate. Alice uses the CA’s public key to check the validity of Bob’s certificate and extract Bob’s public key.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">Both the International Telecommunication Union (ITU) and the IETF have developed standards for CAs. ITU X.509 </a><a href="#bookmark848" class="a">[ITU 2005a]</a> <a href="#bookmark848" class="s124">specifies an authentication service as well as a specific syntax for certificates. </a><a href="#bookmark848" class="a">[RFC 1422]</a> <span class="p">describes CA-based key management for use with secure Internet e-mail. It is compatible</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">with X.509 but goes beyond X.509 by establishing procedures and conventions for a key management</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark701" class="s124">architecture. </a><a href="#bookmark701" class="a">Table 8.4</a> <span class="p">describes some of the important fields in a certificate.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Table 8.4 Selected fields in an X.509 and RFC 1422 public key</h2><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="783" height="18" alt="image" src="计算机网络自顶向下7th-en/Image_819.png"/></span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;"><a name="bookmark699">Field Name</a><a name="bookmark700">&zwnj;</a><a name="bookmark701">&zwnj;</a></p></td><td style="border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Description</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Version</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Version number of X.509 specification</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 33pt;text-indent: 0pt;line-height: 146%;text-align: left;">Serial number</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">CA-issued unique identifier for a certificate</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Signature</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Specifies the algorithm used by CA to sign this certificate</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 42pt;text-indent: 0pt;line-height: 146%;text-align: left;">Issuer name</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" style=" color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 12.5pt;">Identity of CA issuing this certificate, in distinguished name (DN) </a><a href="#bookmark848" class="s145">[RFC 4514]</a><span style=" color: #1E79B8; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt;"> </span>format</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 36pt;text-indent: 0pt;line-height: 146%;text-align: left;">Validity period</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Start and end of period of validity for certificate</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 34pt;text-indent: 0pt;line-height: 146%;text-align: left;">Subject name</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Identity of entity whose public key is associated with this certificate, in DN format</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 20pt;text-indent: 0pt;line-height: 146%;text-align: left;">Subject public key</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">The subject’s public key as well indication of the public key algorithm (and algorithm parameters) to be used with this key</p></td></tr></table><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li></ol></li></ol></li><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark702">End-Point Authentication</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">End-point authentication <span class="p">is the process of one entity proving its identity to another entity over a computer network, for example, a user proving its identity to an e-mail server. As humans, we authenticate each other in many ways: We recognize each other’s faces when we meet, we recognize each other’s voices on the telephone, we are authenticated by the customs official who checks us against the picture on our passport.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section, we consider how one party can authenticate another party when the two are communicating over a network. We focus here on authenticating a “live” party, at the point in time when communication is actually occurring. A concrete example is a user authenticating him or herself to an e- mail server. This is a subtly different problem from proving that a message received at some point in the</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark699" class="s124">past did indeed come from that claimed sender, as studied in </a><a href="#bookmark699" class="a">Section 8.</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">When performing authentication over the network, the communicating parties cannot rely on biometric information, such as a visual appearance or a voiceprint. Indeed, we will see in our later case studies that it is often network elements such as routers and client/server processes that must authenticate each other. Here, authentication must be done solely on the basis of messages and data exchanged as part of an <span class="s23">authentication</span><span class="s20"> protocol</span>. Typically, an authentication protocol would run <i>before </i>the two</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">communicating parties run some other protocol (for example, a reliable data transfer protocol, a routing</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">information exchange protocol, or an e-mail protocol). The authentication protocol first establishes the identities of the parties to each other’s satisfaction; only after authentication do the parties get down to the work at hand.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark254" class="s124">As in the case of our development of a reliable data transfer (rdt) protocol in </a><a href="#bookmark254" class="a">Chapter </a>3<span class="p">, we will find it instructive here to develop various versions of an authentication protocol, which we will call </span>ap <span class="p">(authentication protocol), and poke holes in each version</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="650" height="291" alt="image" src="计算机网络自顶向下7th-en/Image_820.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark703">Figure 8.15 Protocol </a><i>ap1.0 </i>and a failure scenario</h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">as we proceed. (If you enjoy this stepwise evolution of a design, you might also enjoy </a><a href="#bookmark848" class="a">[Bryant </a>1988]<span class="p">, which recounts a fictitious narrative between designers of an open-network authentication system, and their discovery of the many subtle issues involved.)</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Let’s assume that Alice needs to authenticate herself to Bob.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l329"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark704">Authentication Protocol </a><i>ap1.0</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark703" class="s124">Perhaps the simplest authentication protocol we can imagine is one where Alice simply sends a message to Bob saying she is Alice. This protocol is shown in </a><a href="#bookmark703" class="a">Figure 8.1</a>5<span class="p">. The flaw here is obvious—</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">there is no way for Bob actually to know that the person sending the message “I am Alice” is indeed Alice. For example, Trudy (the intruder) could just as well send such a message.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Authentication Protocol <i>ap2.0</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">If Alice has a well-known network address (e.g., an IP address) from which she always communicates, Bob could attempt to authenticate Alice by verifying that the source address on the IP datagram carrying the authentication message matches Alice’s well-known address. In this case, Alice would be authenticated. This might stop a very network-naive intruder from impersonating Alice, but it wouldn’t stop the determined student studying this book, or many others!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">From our study of the network and data link layers, we know that it is not that hard (for example, if one had access to the operating system code and could build one’s own operating system kernel, as is the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark705">case with Linux and several other freely available operating systems) to create an IP datagram, put whatever IP source address we want (for example, Alice’s well-known IP address) into the IP datagram, and send the datagram over the link-layer protocol to the first-hop router. From then</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="656" height="282" alt="image" src="计算机网络自顶向下7th-en/Image_821.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark706">Figure 8.16 Protocol </a><i>ap2.0 </i>and a failure scenario</h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark706" class="s124">on, the incorrectly source-addressed datagram would be dutifully forwarded to Bob. This approach, shown in </a><a href="#bookmark706" class="a">Figure 8.1</a>6<a href="#bookmark848" class="s124">, is a form of IP spoofing. IP spoofing can be avoided if Trudy’s first-hop router is configured to forward only datagrams containing Trudy’s IP source address </a><a href="#bookmark848" class="a">[RFC </a>2827]<span class="p">. However, this</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">capability is not universally deployed or enforced. Bob would thus be foolish to assume that Trudy’s</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">network manager (who might be Trudy herself) had configured Trudy’s first-hop router to forward only appropriately addressed datagrams.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark707">Authentication Protocol </a><i>ap3.0</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">One classic approach to authentication is to use a secret password. The password is a shared secret between the authenticator and the person being authenticated. Gmail, Facebook, telnet, FTP, and many other services use password authentication. In protocol ap3.0, Alice thus sends her secret password to</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark710" class="s124">Bob, as shown in </a><a href="#bookmark710" class="a">Figure 8.1</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">Since passwords are so widely used, we might suspect that protocol <i>ap3.0 </i>is fairly secure. If so, we’d be wrong! The security flaw here is clear. If Trudy eavesdrops on Alice’s communication, then she can learn Alice’s password. Lest you think this is unlikely, consider the fact that when you Telnet to another</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">machine and log in, the login password is sent unencrypted to the Telnet server. Someone connected to the Telnet client or server’s LAN can possibly sniff (read and store) all packets transmitted on the LAN and thus steal the login password. In fact, this is a well-known approach for stealing passwords (see, for</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">example, </a><a href="#bookmark848" class="a">[Jimenez </a><span class="s20">1997]</span>). Such a threat is obviously very real, so <i>ap3.0 </i>clearly won’t do.</p></li><li style="padding-top: 2pt;padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark708">Authentication Protocol </a><i>ap3.1</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark709">Our next idea for fixing ap3.0 is naturally to encrypt the password. By encrypting the password, we can prevent Trudy from learning Alice’s password. If we assume</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="654" height="425" alt="image" src="计算机网络自顶向下7th-en/Image_822.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark710">Figure 8.17 Protocol </a><i>ap3.0 </i>and a failure scenario</h2><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 24pt;text-align: left;">that Alice and Bob share a symmetric secret key, KA−B, then Alice can encrypt the password and send her identification message, “ <span class="s30">I am Alice, </span>” and her encrypted password to Bob. Bob then decrypts the</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">password and, assuming the password is correct, authenticates Alice. Bob feels comfortable in authenticating Alice since Alice not only knows the password, but also knows the shared secret key value needed to encrypt the password. Let’s call this protocol ap3.1.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">While it is true that <i>ap3.1 </i>prevents Trudy from learning Alice’s password, the use of cryptography here does not solve the authentication problem. Bob is subject to a <span class="s20">playback attack</span>: Trudy need only eavesdrop on Alice’s communication, record the encrypted version of the password, and play back the</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">encrypted version of the password to Bob to pretend that she is Alice. The use of an encrypted password in <i>ap3.1 </i>doesn’t make the situation manifestly different from that of protocol <i>ap3.0 </i><a href="#bookmark710" class="s124">in </a><a href="#bookmark710" class="a">Figure 8.1</a><span class="s20">7</span>.</p></li><li style="padding-top: 3pt;padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Authentication Protocol <i>ap4.0</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark710" class="s124">The failure scenario in </a><a href="#bookmark710" class="a">Figure 8.17</a> <span class="p">resulted from the fact that Bob could not distinguish between the original authentication of Alice and the later playback of Alice’s original authentication. That is, Bob could not tell if Alice was live (that is, was currently really on the other end of the connection) or whether</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">the messages he was receiving were a recorded playback of a previous authentication of Alice. The</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">very (<i>very</i>) observant reader will recall that the three-way TCP handshake protocol needed to address the same problem—the server side of a TCP connection did not want to accept a connection if the received SYN segment was an old copy (retransmission) of a SYN segment from an earlier connection.</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">How did the TCP server side solve the problem of determining whether the client was really live? It chose an initial sequence number that had not been used in a very long time, sent that number to the client, and then waited for the client to respond with an ACK segment containing that number. We can adopt the same idea here for authentication purposes.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;">A <span class="s20">nonce </span>is a number that a protocol will use only once in a lifetime. That is, once a protocol uses a nonce, it will never use that number again. Our <i>ap4.0 </i>protocol uses a nonce as follows:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><ol id="l330"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Alice sends the message “ <span class="s30">I am Alice </span>” to Bob.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Bob chooses a nonce, R, and sends it to Alice.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 126%;text-align: justify;"><p style="display: inline;">Alice encrypts the nonce using Alice and Bob’s symmetric secret key, <span class="s27">KA</span>−B, and sends the encrypted nonce, <span class="s27">KA</span>−B (R), back to Bob. As in protocol <i>ap3.1</i>, it is the fact that Alice knows KA−B and uses it to encrypt a value that lets Bob know that the message he receives was</p><p style="padding-top: 2pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">generated by Alice. The nonce is used to ensure that Alice is live.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Bob decrypts the received message. If the decrypted nonce equals the nonce he sent Alice, then Alice is authenticated.</p></li></ol></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 132%;text-align: justify;">Protocol <i>ap4.0 </i><a href="#bookmark713" class="s124">is illustrated in </a><a href="#bookmark713" class="a">Figure 8.1</a><span class="s20">8</span>. By using the once-in-a-lifetime value, <i>R</i>, and then checking the returned value, <span class="s27">KA</span>−B (<i>R</i>), Bob can be sure that Alice is both who she says she is (since she knows the secret key value needed to encrypt <i>R) </i>and live (since she has encrypted the nonce, <i>R</i>, that Bob just created).</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">The use of a nonce and symmetric key cryptography forms the basis of <i>ap4.0</i>. A natural question is whether we can use a nonce and public key cryptography (rather than symmetric key cryptography) to solve the authentication problem. This issue is explored in the problems at the end of the chapter.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="247" height="237" alt="image" src="计算机网络自顶向下7th-en/Image_823.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark711">Figure 8.18 Protocol </a><i>ap4.0 </i>and a failure scenario<a name="bookmark712">&zwnj;</a><a name="bookmark713">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l331"><ol id="l332"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark714">Securing E-Mail</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In previous sections, we examined fundamental issues in network security, including symmetric key and public key cryptography, end-point authentication, key distribution, message integrity, and digital signatures. We are now going to examine how these tools are being used to provide security in the Internet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Interestingly, it is possible to provide security services in any of the top four layers of the Internet protocol stack. When security is provided for a specific application-layer protocol, the application using the protocol will enjoy one or more security services, such as confidentiality, authentication, or integrity. When security is provided for a transport-layer protocol, all applications that use that protocol enjoy the security services of the transport protocol. When security is provided at the network layer on a host-to- host basis, all transport-layer segments (and hence all application-layer data) enjoy the security services of the network layer. When security is provided on a link basis, then the data in all frames traveling over the link receive the security services of the link.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark721" class="s124">In </a><a href="#bookmark721" class="a">Sections 8.5</a> <a href="#bookmark751" class="s124">through </a><a href="#bookmark751" class="a">8.</a>8<span class="p">, we examine how security tools are being used in the application, transport, network, and link layers. Being consistent with the general structure of this book, we begin at the top of the protocol stack and discuss security at the application layer. Our approach is to use a specific</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">application, e-mail, as a case study for application-layer security. We then move down the protocol stack. We’ll examine the SSL protocol (which provides security at the transport layer), IPsec (which provides security at the network layer), and the security of the IEEE 802.11 wireless LAN protocol.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">You might be wondering why security functionality is being provided at more than one layer in the Internet. Wouldn’t it suffice simply to provide the security functionality at the network layer and be done with it? There are two answers to this question. First, although security at the network layer can offer “blanket coverage” by encrypting all the data in the datagrams (that is, all the transport-layer segments) and by authenticating all the source IP addresses, it can’t provide user-level security. For example, a commerce site cannot rely on IP-layer security to authenticate a customer who is purchasing goods at the commerce site. Thus, there is a need for security functionality at higher layers as well as blanket coverage at lower layers. Second, it is generally easier to deploy new Internet services, including security services, at the higher layers of the protocol stack. While waiting for security to be broadly deployed at the network layer, which is probably still many years in the future, many application developers “just do it” and introduce security functionality into their favorite applications. A classic example is Pretty Good Privacy (PGP), which provides secure e-mail (discussed later in this section). Requiring only client and server application code, PGP was one of the first security technologies to be broadly used in the Internet.</p><ol id="l333"><li style="padding-top: 3pt;padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark715">Secure E-Mail</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark685" class="s124">We now use the cryptographic principles of </a><a href="#bookmark685" class="a">Sections 8.2</a> <a href="#bookmark699" class="s124">through </a><a href="#bookmark699" class="a">8.3</a> <span class="p">to create a secure e-mail system. We create this high-level design in an incremental manner, at each step introducing new security services. When designing a secure e-mail system, let us keep in mind the racy example introduced in</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark674" class="a">Section 8.</a>1<span class="p">—the love affair between Alice and Bob. Imagine that Alice wants to send an e-mail message to Bob, and Trudy wants to intrude.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">Before plowing ahead and designing a secure e-mail system for Alice and Bob, we should consider which security features would be most desirable for them. First and foremost is <i>confidentiality. </i><a href="#bookmark674" class="s124">As discussed in </a><a href="#bookmark674" class="a">Section 8.</a><span class="s20">1</span>, neither Alice nor Bob wants Trudy to read Alice’s e-mail message. The</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">second feature that Alice and Bob would most likely want to see in the secure e-mail system is <i>sender</i></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><i>authentication</i>. In particular, when Bob receives the message “ <span class="s30">I don’t love you anymore. I never want to see you again. Formerly yours, Alice, </span>” he would naturally want to be sure that the message came from Alice and not from Trudy. Another feature that the two lovers would</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">appreciate is <i>message integrity</i>, that is, assurance that the message Alice sends is not modified while en route to Bob. Finally, the e-mail system should provide <i>receiver authentication</i>; that is, Alice wants to make sure that she is indeed sending the letter to Bob and not to someone else (for example, Trudy)</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">who is impersonating Bob.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark685" class="s124">So let’s begin by addressing the foremost concern, confidentiality. The most straightforward way to provide confidentiality is for Alice to encrypt the message with symmetric key technology (such as DES or AES) and for Bob to decrypt the message on receipt. As discussed in </a><a href="#bookmark685" class="a">Section 8.</a>2<span class="p">, if the symmetric</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">key is long enough, and if only Alice and Bob have the key, then it is extremely difficult for anyone else</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">(including Trudy) to read the message. Although this approach is straightforward, it has the fundamental</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark685" class="s124">difficulty that we discussed in </a><a href="#bookmark685" class="a">Section 8.</a>2<span class="p">—distributing a symmetric key so that only Alice and Bob have copies of it. So we naturally consider an alternative approach—public key cryptography (using, for example, RSA). In the public key approach, Bob makes his public key publicly available (e.g., in a public</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">key server or on his personal Web page), Alice encrypts her message with Bob’s public key, and she sends the encrypted message to Bob’s e-mail address. When Bob receives the message, he simply decrypts it with his private key. Assuming that Alice knows for sure that the public key is Bob’s public key, this approach is an excellent means to provide the desired confidentiality. One problem, however, is that public key encryption is relatively inefficient, particularly for long messages.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 143%;text-align: left;"><a href="#bookmark686" class="s124">To overcome the efficiency problem, let’s make use of a session key (discussed in </a><a href="#bookmark686" class="a">Section 8.2.</a><span class="s20">2</span>). In particular, Alice (1) selects a random symmetric session key, <i>K</i><span class="s31">S</span>, (2) encrypts her message, <i>m</i>, with the symmetric key, (3) encrypts the symmetric key with Bob’s public key, KB+, (4) concatenates the</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">encrypted message and the encrypted symmetric key to form a “package,” and (5) sends the package to Bob’s</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="647" height="254" alt="image" src="计算机网络自顶向下7th-en/Image_824.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark716">Figure 8.19 Alice used a symmetric session key, </a><i>K</i><span class="s148">S</span>, to send a secret e-mail to Bob</h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 137%;text-align: left;"><a href="#bookmark716" class="s124">e-mail address. The steps are illustrated in </a><a href="#bookmark716" class="a">Figure 8.1</a><span class="s20">9</span>. (In this and the subsequent figures, the circled “+” represents concatenation and the circled “−” represents deconcatenation.) When Bob receives the package, he (1) uses his private key, <span class="s27">KB</span>−, to obtain the symmetric key, <i>K</i><span class="s31">S</span>, and (2) uses the symmetric</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">key <i>K</i><span class="s31">S </span>to decrypt the message <i>m</i>.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having designed a secure e-mail system that provides confidentiality, let’s now design another system that provides both sender authentication and message integrity. We’ll suppose, for the moment, that Alice and Bob are no longer concerned with confidentiality (they want to share their feelings with everyone!), and are concerned only about sender authentication and message integrity. To accomplish</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark699" class="s124">this task, we use digital signatures and message digests, as described in </a><a href="#bookmark699" class="a">Section 8.</a>3<span class="p">. Specifically, Alice</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">(1) applies a hash function, <i>H </i>(for example, MD5), to her message, <i>m</i>, to obtain a message digest, (2) signs the result of the hash function with her private key, KA−, to create a digital signature, (3) concatenates the original (unencrypted) message with the signature to create a package, and (4) sends</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">the package to Bob’s e-mail address. When Bob receives the package, he (1) applies Alice’s public key, <span class="s27">KA</span>+, to the signed message digest and (2) compares the result of this operation with his own hash, <i>H</i><a href="#bookmark717" class="s124">, of the message. The steps are illustrated in </a><a href="#bookmark717" class="a">Figure 8.2</a><span class="s20">0</span><a href="#bookmark699" class="s124">. As discussed in </a><a href="#bookmark699" class="a">Section 8.</a><span class="s20">3</span>, if the two results are the same, Bob can be pretty confident that the message came from Alice and is unaltered.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;"><span class="p">Now let’s consider designing an e-mail system that provides confidentiality, sender authentication, </span><span class="s17">and </span><a href="#bookmark716" class="s124">message integrity. This can be done by combining the procedures in </a><a href="#bookmark716" class="a">Figures 8.19</a> <a href="#bookmark717" class="s124">and </a><a href="#bookmark717" class="a">8.2</a>0<a href="#bookmark717" class="s124">. Alice first creates a preliminary package, exactly as in </a><a href="#bookmark717" class="a">Figure 8.2</a>0<span class="p">, that consists of her original message along</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">with a digitally signed hash of the message. She then treats this preliminary package as a message in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark716" class="s124">itself and sends this new message through the sender steps in </a><a href="#bookmark716" class="a">Figure 8.1</a>9<a href="#bookmark718" class="s124">, creating a new package that is sent to Bob. The steps applied by Alice are shown in </a><a href="#bookmark718" class="a">Figure 8.2</a>1<span class="p">. When Bob receives the</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark716" class="s124">package, he first applies his side of </a><a href="#bookmark716" class="a">Figure 8.19</a> <span class="p">and then his</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="762" height="261" alt="image" src="计算机网络自顶向下7th-en/Image_825.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark717">Figure 8.20 Using hash functions and digital signatures to provide sender authentication and message integrity</a></h2><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark717" class="s124">side of </a><a href="#bookmark717" class="a">Figure 8.2</a>0<span class="p">. It should be clear that this design achieves the goal of providing confidentiality, sender authentication, and message integrity. Note that, in this scheme, Alice uses public key cryptography twice: once with her own private key and once with Bob’s public key. Similarly, Bob also</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">uses public key cryptography twice—once with his private key and once with Alice’s public key.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark718" class="s124">The secure e-mail design outlined in </a><a href="#bookmark718" class="a">Figure 8.21</a> <span class="p">probably provides satisfactory security for most e-mail users for most occasions. But there is still one important issue that remains to be addressed. The design</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark718" class="s124">in </a><a href="#bookmark718" class="a">Figure 8.21</a> <span class="p">requires Alice to obtain Bob’s public key, and requires Bob to obtain Alice’s public key. The distribution of these public keys is a nontrivial problem. For example, Trudy might masquerade as Bob and give Alice her own public key while saying that it is Bob’s public key,</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="625" height="272" alt="image" src="计算机网络自顶向下7th-en/Image_826.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark718">Figure 8.21 Alice uses symmetric key cyptography, public key cryptography, a hash function, and a digital signature to provide secrecy, sender authentication, and message integrity</a></h2><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark699" class="s124" name="bookmark719">enabling her to receive the message meant for Bob. As we learned in </a><a href="#bookmark699" class="a">Section 8.</a><span class="s20">3</span>, a popular approach for securely distributing public keys is to <i>certify </i>the public keys using a CA.<a name="bookmark720">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">PGP</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><span class="p">Written by Phil Zimmermann in 1991, </span>Pretty Good Privacy (PGP) <a href="#bookmark848" class="s124">is a nice example of an e-mail encryption scheme </a><a href="#bookmark848" class="a">[PGPI 2016</a>]<span class="p">. Versions of PGP are available in the public domain; for example, you</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">can find the PGP software for your favorite platform as well as lots of interesting reading at the International PGP Home Page </a><a href="#bookmark848" class="a">[PGPI 2016</a>]<a href="#bookmark718" class="s124">. The PGP design is, in essence, the same as the design shown in </a><a href="#bookmark718" class="a">Figure 8.2</a>1<span class="p">. Depending on the version, the PGP software uses MD5 or SHA for calculating</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the message digest; CAST, triple-DES, or IDEA for symmetric key encryption; and RSA for the public</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">key encryption.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">When PGP is installed, the software creates a public key pair for the user. The public key can be posted on the user’s Web site or placed in a public key server. The private key is protected by the use of a password. The password has to be entered every time the user accesses the private key. PGP gives the user the option of digitally signing the message, encrypting the message, or both digitally signing and</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark723" class="s124">encrypting. </a><a href="#bookmark723" class="a">Figure 8.22</a> <span class="p">shows a PGP signed message. This message appears after the MIME header. The encoded data in the message is KA−(H(m)), that is, the digitally signed message digest. As we discussed above, in order for Bob to verify the integrity of the message, he needs to have access to</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Alice’s public key.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark724" class="a">Figure 8.23</a> <span class="p">shows a secret PGP message. This message also appears after the MIME header. Of course, the plaintext message is not included within the secret e-mail message. When a sender (such</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark724" class="s124">as Alice) wants both confidentiality and integrity, PGP contains a message like that of </a><a href="#bookmark724" class="a">Figure 8.23</a> <a href="#bookmark723" class="s124">within the message of </a><a href="#bookmark723" class="a">Figure 8.2</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">PGP also provides a mechanism for public key certification, but the mechanism is quite different from the more conventional CA. PGP public keys are certified by</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="600" height="237" alt="image" src="计算机网络自顶向下7th-en/Image_827.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark721">Figure 8.22 A PGP signed message</a><a name="bookmark722">&zwnj;</a><a name="bookmark723">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="624" height="141" alt="image" src="计算机网络自顶向下7th-en/Image_828.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;"><a name="bookmark724">Figure 8.23 A secret PGP message</a><a name="bookmark725">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">a <i>web of trust. </i>Alice herself can certify any key/username pair when she believes the pair really belong together. In addition, PGP permits Alice to say that she trusts another user to vouch for the authenticity of more keys. Some PGP users sign each other’s keys by holding key-signing parties. Users physically</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: justify;">gather, exchange public keys, and certify each other’s keys by signing them with their private keys.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l334"><ol id="l335"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark726">Securing TCP Connections: SSL</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">In the previous section, we saw how cryptographic techniques can provide confidentiality, data integrity, and end-point authentication to a specific application, namely, e-mail. In this section, we’ll drop down a layer in the protocol stack and examine how cryptography can enhance TCP with security services, including confidentiality, data integrity, and end-point authentication. This enhanced version of TCP is commonly known as </span>Secure Sockets Layer (SSL)<span class="p">. A slightly modified version of SSL version 3, called </span><span class="s23">Transport</span> Layer Security (TLS)<a href="#bookmark848" class="s124">, has been standardized by the IETF </a><a href="#bookmark848" class="a">[RFC </a>4346]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">The SSL protocol was originally designed by Netscape, but the basic ideas behind securing TCP had predated Netscape’s work (for example, see Woo </a><a href="#bookmark848" class="a">[Woo 1994</a>]<span class="p">). Since its inception, SSL has enjoyed</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">broad deployment. SSL is supported by all popular Web browsers and Web servers, and it is used by Gmail and essentially all Internet commerce sites (including Amazon, eBay, and TaoBao). Hundreds of billions of dollars are spent over SSL every year. In fact, if you have ever purchased anything over the Internet with your credit card, the communication between your browser and the server for this purchase almost certainly went over SSL. (You can identify that SSL is being used by your browser when the URL begins with https: rather than http.)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To understand the need for SSL, let’s walk through a typical Internet commerce scenario. Bob is surfing the Web and arrives at the Alice Incorporated site, which is selling perfume. The Alice Incorporated site displays a form in which Bob is supposed to enter the type of perfume and quantity desired, his address, and his payment card number. Bob enters this information, clicks on Submit, and expects to receive (via ordinary postal mail) the purchased perfumes; he also expects to receive a charge for his order in his next payment card statement. This all sounds good, but if no security measures are taken, Bob could be in for a few surprises.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_829.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">If no confidentiality (encryption) is used, an intruder could intercept Bob’s order and obtain his payment card information. The intruder could then make purchases at Bob’s expense.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_830.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">If no data integrity is used, an intruder could modify Bob’s order, having him purchase ten times more bottles of perfume than desired.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_831.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Finally, if no server authentication is used, a server could display Alice Incorporated’s famous logo when in actuality the site maintained by Trudy, who is masquerading as Alice Incorporated. After receiving Bob’s order, Trudy could take Bob’s money and run. Or Trudy could carry out an identity</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">theft by collecting Bob’s name, address, and credit card number.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">SSL addresses these issues by enhancing TCP with confidentiality, data integrity, server authentication, and client authentication.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">SSL is often used to provide security to transactions that take place over HTTP. However, because SSL secures TCP, it can be employed by any application that runs over TCP. SSL provides a simple Application Programmer Interface (API) with sockets, which is similar and analogous to TCP’s API. When an application wants to employ SSL, the application includes SSL classes/libraries. As shown in</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark727" class="a">Figure 8.2</a>4<span class="p">, although SSL technically resides in the application layer, from the developer’s perspective it is a transport protocol that provides TCP’s services enhanced with security services.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l336"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The Big Picture</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">We begin by describing a simplified version of SSL, one that will allow us to get a big-picture understanding of the <i>why </i>and <i>how </i>of SSL. We will refer to this simplified</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="388" height="411" alt="image" src="计算机网络自顶向下7th-en/Image_832.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark727">Figure 8.24 Although SSL technically resides in the application layer, from the developer’s perspective it is a transport-layer protocol</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">version of SSL as “almost-SSL.” After describing almost-SSL, in the next subsection we’ll then describe the real SSL, filling in the details. Almost-SSL (and SSL) has three phases: <i>handshake</i>, <i>key derivation</i>, and <i>data transfer</i>. We now describe these three phases for a communication session between a client</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">(Bob) and a server (Alice), with Alice having a private/public key pair and a certificate that binds her</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">identity to her public key.</p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Handshake</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">During the handshake phase, Bob needs to (a) establish a TCP connection with Alice, (b) verify that Alice is <i>really </i><a href="#bookmark728" class="s124">Alice, and (c) send Alice a master secret key, which will be used by both Alice and Bob to generate all the symmetric keys they need for the SSL session. These three steps are shown in </a><a href="#bookmark728" class="a">Figure</a></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark728" class="a">8.2</a>5<span class="p">. Note that once the TCP connection is established, Bob sends Alice a hello message. Alice then</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark699" class="s124">responds with her certificate, which contains her public key. As discussed in </a><a href="#bookmark699" class="a">Section 8.</a>3<span class="p">, because the certificate has been certified by a CA, Bob knows for sure that the public key in the certificate belongs to Alice. Bob then generates a Master Secret (MS) (which will only be used for this SSL session), encrypts</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the MS with Alice’s public key to create the Encrypted Master Secret (EMS), and sends the EMS to Alice. Alice decrypts the EMS with her private key to get the MS. After this phase, both Bob and Alice (and no one else) know the master secret for this SSL session.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="622" height="395" alt="image" src="计算机网络自顶向下7th-en/Image_833.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark728">Figure 8.25 The almost-SSL handshake, beginning with a TCP connection</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Key Derivation</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In principle, the MS, now shared by Bob and Alice, could be used as the symmetric session key for all subsequent encryption and data integrity checking. It is, however, generally considered safer for Alice and Bob to each use different cryptographic keys, and also to use different keys for encryption and integrity checking. Thus, both Alice and Bob use the MS to generate four keys:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_834.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_835.png"/></span></p><p class="s27" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 125%;text-align: left;">EB=<span class="p"> session encryption key for data sent from Bob to Alice </span>M<span class="p">B= session MAC key for data sent from Bob to Alice</span></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">EA=</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_836.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 27pt;line-height: 132%;text-align: left;">session encryption key for data sent from Alice to Bob <span class="s27">M</span>A= session MAC key for data sent from Alice to Bob</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Alice and Bob each generate the four keys from the MS. This could be done by simply slicing the MS</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">into four keys. (But in <i>real </i>SSL it is a little more complicated, as we’ll see.) At the end of the key derivation phase, both Alice and Bob have all four keys. The two encryption keys will be used to encrypt data; the two MAC keys will be used to verify the integrity of the data.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Data Transfer</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 145%;text-align: left;">Now that Alice and Bob share the same four session keys (E<span class="s22">B</span>, M<span class="s22">B</span>, E<span class="s22">A</span>, and M<span class="s22">A</span>), they can start to send secured data to each other over the TCP connection. Since TCP is a byte-stream protocol, a natural approach would be for SSL to encrypt application data on the fly and then pass the encrypted data on the fly to TCP. But if we were to do this, where would we put the MAC for the integrity check? We certainly do not want to wait until the end of the TCP session to verify the integrity of all of Bob’s data that was sent over the entire session! To address this issue, SSL breaks the data stream into records, appends a MAC to each record for integrity checking, and then encrypts the record +MAC. To create the</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">MAC, Bob inputs the record data along with the key M<span class="s22">B </span><a href="#bookmark699" class="s124">into a hash function, as discussed in </a><a href="#bookmark699" class="a">Section</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><ol id="l337"><ol id="l338"><li style="padding-left: 6pt;text-indent: 0pt;line-height: 134%;text-align: left;"><p style="display: inline;">To encrypt the package record <span class="s27">+</span>MAC, Bob uses his session encryption key E<span class="s22">B</span>. This encrypted package is then passed to TCP for transport over the Internet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although this approach goes a long way, it still isn’t bullet-proof when it comes to providing data integrity for the entire message stream. In particular, suppose Trudy is a woman-in-the-middle and has the ability to insert, delete, and replace segments in the stream of TCP segments sent between Alice and Bob. Trudy, for example, could capture two segments sent by Bob, reverse the order of the segments, adjust the TCP sequence numbers (which are not encrypted), and then send the two reverse-ordered segments to Alice. Assuming that each TCP segment encapsulates exactly one record, let’s now take a look at how Alice would process these segments.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l339"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">TCP running in Alice would think everything is fine and pass the two records to the SSL sublayer.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">SSL in Alice would decrypt the two records.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">SSL in Alice would use the MAC in each record to verify the data integrity of the two records.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">SSL would then pass the decrypted byte streams of the two records to the application layer; but the complete byte stream received by Alice would not be in the correct order due to reversal of</p></li></ol></li></ol></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">the records!</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">You are encouraged to walk through similar scenarios for when Trudy removes segments or when Trudy replays segments.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark729">The solution to this problem, as you probably guessed, is to use sequence numbers. SSL does this as follows. Bob maintains a sequence number counter, which begins at zero and is incremented for each SSL record he sends. Bob doesn’t actually include a sequence number in the record itself, but when he calculates the MAC, he includes the sequence number in the MAC calculation. Thus, the MAC is now a</a></p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 144%;text-align: left;">hash of the data plus the MAC key M<span class="s22">B </span><i>plus the current sequence number</i>. Alice tracks Bob’s sequence numbers, allowing her to verify the data integrity of a record by including the appropriate sequence number in the MAC calculation. This use of SSL sequence numbers prevents Trudy from carrying out a woman-in-the-middle attack, such as reordering or replaying segments. (Why?)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SSL Record</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark730" class="s124">The SSL record (as well as the almost-SSL record) is shown in </a><a href="#bookmark730" class="a">Figure 8.2</a>6<span class="p">. The record consists of a type field, version field, length field, data field, and MAC field. Note that the first three fields are not encrypted. The type field indicates whether the record is a handshake message or a message that</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">contains application data. It is also used to close the SSL connection, as discussed below. SSL at the receiving end uses the length field to extract the SSL records out of the incoming TCP byte stream. The version field is self-explanatory.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">A More Complete Picture</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The previous subsection covered the almost-SSL protocol; it served to give us a basic understanding of the why and how of SSL. Now that we have a basic understanding of SSL, we can dig a little deeper and examine the essentials of the actual SSL protocol. In parallel to reading this description of the SSL protocol, you are encouraged to complete the Wireshark SSL lab, available at the textbook’s Web site.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="667" height="109" alt="image" src="计算机网络自顶向下7th-en/Image_837.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark730">Figure 8.26 Record format for SSL</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SSL Handshake</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">SSL does not mandate that Alice and Bob use a specific symmetric key algorithm, a specific public-key algorithm, or a specific MAC. Instead, SSL allows Alice and Bob to agree on the cryptographic algorithms at the beginning of the SSL session, during the handshake phase. Additionally, during the handshake phase, Alice and Bob send nonces to each other, which are used in the creation of the</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">session keys (E<span class="s22">B</span>, M<span class="s22">B</span>, E<span class="s22">A</span>, and M<span class="s22">A</span>). The steps of the real SSL handshake are as follows:</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><ol id="l340"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The client sends a list of cryptographic algorithms it supports, along with a client nonce.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">From the list, the server chooses a symmetric algorithm (for example, AES), a public key algorithm (for example, RSA with a specific key length), and a MAC algorithm. It sends back to</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">the client its choices, as well as a certificate and a server nonce.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The client verifies the certificate, extracts the server’s public key, generates a Pre-Master Secret (PMS), encrypts the PMS with the server’s public key, and sends the encrypted PMS to the</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">server.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Using the same key derivation function (as specified by the SSL standard), the client and server independently compute the Master Secret (MS) from the PMS and nonces. The MS is then</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">sliced up to generate the two encryption and two MAC keys. Furthermore, when the chosen symmetric cipher employs CBC (such as 3DES or AES), then two Initialization Vectors (IVs)— one for each side of the connection—are also obtained from the MS. Henceforth, all messages sent between client and server are encrypted and authenticated (with the MAC).</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The client sends a MAC of all the handshake messages.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The server sends a MAC of all the handshake messages.</p></li></ol></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The last two steps protect the handshake from tampering. To see this, observe that in step 1, the client typically offers a list of algorithms—some strong, some weak. This list of algorithms is sent in cleartext, since the encryption algorithms and keys have not yet been agreed upon. Trudy, as a woman-in-the- middle, could delete the stronger algorithms from the list, forcing the client to select a weak algorithm. To prevent such a tampering attack, in step 5 the client sends a MAC of the concatenation of all the handshake messages it sent and received. The server can compare this MAC with the MAC of the handshake messages it received and sent. If there is an inconsistency, the server can terminate the connection. Similarly, the server sends a MAC of the handshake messages it has seen, allowing the client to check for inconsistencies.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">You may be wondering why there are nonces in steps 1 and 2. Don’t sequence numbers suffice for preventing the segment replay attack? The answer is yes, but they don’t alone prevent the “connection replay attack.” Consider the following connection replay attack. Suppose Trudy sniffs all messages between Alice and Bob. The next day, Trudy masquerades as Bob and sends to Alice exactly the same sequence of messages that Bob sent to Alice on the previous day. If Alice doesn’t use nonces, she will respond with exactly the same sequence of messages she sent the previous day. Alice will not suspect any funny business, as each message she receives will pass the integrity check. If Alice is an e- commerce server, she will think that Bob is placing a second order (for exactly the same thing). On the other hand, by including a nonce in the protocol, Alice will send different nonces for each TCP session, causing the encryption keys to be different on the two days. Therefore, when Alice receives played-back SSL records from Trudy, the records will fail the integrity checks, and the bogus e-commerce transaction will not succeed. In summary, in SSL, nonces are used to defend against the “connection replay attack”</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark731">and sequence numbers are used to defend against replaying individual packets during an ongoing session.</a><a name="bookmark732">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Connection Closure</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">At some point, either Bob or Alice will want to end the SSL session. One approach would be to let Bob end the SSL session by simply terminating the underlying TCP connection—that is, by having Bob send a TCP FIN segment to Alice. But such a naive design sets the stage for the <i>truncation attack </i>whereby</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Trudy once again gets in the middle of an ongoing SSL session and ends the session early with a TCP</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">FIN. If Trudy were to do this, Alice would think she received all of Bob’s data when actuality she only received a portion of it. The solution to this problem is to indicate in the type field whether the record serves to terminate the SSL session. (Although the SSL type is sent in the clear, it is authenticated at the receiver using the record’s MAC.) By including such a field, if Alice were to receive a TCP FIN before receiving a closure SSL record, she would know that something funny was going on.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark685" class="s124">This completes our introduction to SSL. We’ve seen that it uses many of the cryptography principles discussed in </a><a href="#bookmark685" class="a">Sections 8.2</a> <a href="#bookmark699" class="s124">and </a><a href="#bookmark699" class="a">8.</a>3<a href="#bookmark848" class="s124">. Readers who want to explore SSL on yet a deeper level can read Rescorla’s highly readable book on SSL </a><a href="#bookmark848" class="a">[Rescorla </a>2001]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l341"><ol id="l342"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark733">Network-Layer Security: IPsec and Virtual Private Networks</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The IP security protocol, more commonly known as <span class="s20">IPsec</span>, provides security at the network layer. IPsec secures IP datagrams between any two network-layer entities, including hosts and routers. As we will soon describe, many institutions (corporations, government branches, non-profit organizations, and so on) use IPsec to create <span class="s20">virtual private networks (VPNs) </span>that run over the public Internet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Before getting into the specifics of IPsec, let’s step back and consider what it means to provide confidentiality at the network layer. With network-layer confidentiality between a pair of network entities (for example, between two routers, between two hosts, or between a router and a host), the sending entity encrypts the payloads of all the datagrams it sends to the receiving entity. The encrypted payload could be a TCP segment, a UDP segment, an ICMP message, and so on. If such a network-layer service were in place, all data sent from one entity to the other—including e-mail, Web pages, TCP handshake messages, and management messages (such as ICMP and SNMP)—would be hidden from any third party that might be sniffing the network. For this reason, network-layer security is said to provide “blanket coverage.”</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In addition to confidentiality, a network-layer security protocol could potentially provide other security services. For example, it could provide source authentication, so that the receiving entity can verify the source of the secured datagram. A network-layer security protocol could provide data integrity, so that the receiving entity can check for any tampering of the datagram that may have occurred while the datagram was in transit. A network-layer security service could also provide replay-attack prevention, meaning that Bob could detect any duplicate datagrams that an attacker might insert. We will soon see that IPsec indeed provides mechanisms for all these security services, that is, for confidentiality, source authentication, data integrity, and replay-attack prevention.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l343"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">IPsec and Virtual Private Networks (VPNs)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">An institution that extends over multiple geographical regions often desires its own IP network, so that its hosts and servers can send data to each other in a secure and confidential manner. To achieve this goal, the institution could actually deploy a stand-alone physical network—including routers, links, and a DNS infrastructure—that is completely separate from the public Internet. Such a disjoint network, dedicated to a particular institution, is called a <span class="s20">private network</span>. Not surprisingly, a private network can be very costly, as the institution needs to purchase, install, and maintain its own physical network infrastructure.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Instead of deploying and maintaining a private network, many institutions today create VPNs over the existing public Internet. With a VPN, the institution’s inter-office traffic is sent over the public Internet rather than over a physically independent network. But to provide confidentiality, the inter-office traffic is</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark734" class="s124">encrypted before it enters the public Internet. A simple example of a VPN is shown in </a><a href="#bookmark734" class="a">Figure 8.2</a>7<span class="p">. Here the institution consists of a headquarters, a branch office, and traveling salespersons that typically access the Internet from their hotel rooms. (There is only one salesperson shown in the figure.) In this</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">VPN, whenever two hosts within headquarters send IP datagrams to each other or whenever two hosts within the branch office want to communicate, they use good-old vanilla IPv4 (that is, without IPsec services). However, when two of the institution’s hosts</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="788" height="451" alt="image" src="计算机网络自顶向下7th-en/Image_838.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark734">Figure 8.27 Virtual private network (VPN)</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">communicate over a path that traverses the public Internet, the traffic is encrypted before it enters the Internet.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark734" class="s124">To get a feel for how a VPN works, let’s walk through a simple example in the context of </a><a href="#bookmark734" class="a">Figure 8.2</a>7<span class="p">. When a host in headquarters sends an IP datagram to a salesperson in a hotel, the gateway router in headquarters converts the vanilla IPv4 datagram into an IPsec datagram and then forwards this IPsec</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark734" class="s124">datagram into the Internet. This IPsec datagram actually has a traditional IPv4 header, so that the routers in the public Internet process the datagram as if it were an ordinary IPv4 datagram—to them, the datagram is a perfectly ordinary datagram. But, as shown </a><a href="#bookmark734" class="a">Figure 8.2</a>7<span class="p">, the payload of the IPsec</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">datagram includes an IPsec header, which is used for IPsec processing; furthermore, the payload of the</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;"><a name="bookmark735">IPsec datagram is encrypted. When the IPsec datagram arrives at the salesperson’s laptop, the OS in the laptop decrypts the payload (and provides other security services, such as verifying data integrity) and passes the unencrypted payload to the upper-layer protocol (for example, to TCP or UDP).</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We have just given a high-level overview of how an institution can employ IPsec to create a VPN. To see the forest through the trees, we have brushed aside many important details. Let’s now take a closer look.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark736">The AH and ESP Protocols</a><a name="bookmark737">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">IPsec is a rather complex animal—it is defined in more than a dozen RFCs. Two important RFCs are RFC 4301, which describes the overall IP security architecture, and RFC 6071, which provides an overview of the IPsec protocol suite. Our goal in this textbook, as usual, is not simply to re-hash the dry and arcane RFCs, but instead take a more operational and pedagogic approach to describing the protocols.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the IPsec protocol suite, there are two principal protocols: the <span class="s20">Authentication Header (AH) </span>protocol and the <span class="s20">Encapsulation Security Payload (ESP) </span>protocol. When a source IPsec entity (typically a host or a router) sends secure datagrams to a destination entity (also a host or a router), it does so with either the AH protocol or the ESP protocol. The AH protocol provides source authentication and data</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">integrity but <i>does not </i>provide confidentiality. The ESP protocol provides source authentication, data integrity, <i>and </i>confidentiality. Because confidentiality is often critical for VPNs and other IPsec applications, the ESP protocol is much more widely used than the AH protocol. In order to de-mystify</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">IPsec and avoid much of its complication, we will henceforth focus exclusively on the ESP protocol. Readers wanting to learn also about the AH protocol are encouraged to explore the RFCs and other online resources.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Security Associations</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">IPsec datagrams are sent between pairs of network entities, such as between two hosts, between two routers, or between a host and router. Before sending IPsec datagrams from source entity to destination entity, the source and destination entities create a network-layer logical connection. This logical connection is called a <span class="s20">security association (SA)</span>. An SA is a simplex logical connection; that is, it is unidirectional from source to destination. If both entities want to send secure datagrams to each other, then two SAs (that is, two logical connections) need to be established, one in each direction.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark734" class="s124">For example, consider once again the institutional VPN in </a><a href="#bookmark734" class="a">Figure 8.2</a>7<span class="p">. This institution consists of a</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">headquarters office, a branch office and, say, <i>n </i>traveling salespersons. For the sake of example, let’s suppose that there is bi-directional IPsec traffic between headquarters and the branch office and bi- directional IPsec traffic between headquarters and the salespersons. In this VPN, how many SAs are</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 144%;text-align: left;">there? To answer this question, note that there are two SAs between the headquarters gateway router and the branch-office gateway router (one in each direction); for each salesperson’s laptop, there are two SAs between the headquarters gateway router and the laptop (again, one in each direction). So, in total, there are <span class="s27">(</span>2+2n) SAs. <i>Keep in mind, however, that not all traffic sent into the Internet by the gateway routers or by the laptops will be IPsec secured. </i>For example, a host in headquarters may want</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">to access a Web server (such as Amazon or Google) in the public Internet. Thus, the gateway router</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark738">(and the laptops) will emit into the Internet both vanilla IPv4 datagrams and secured IPsec datagrams.</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="665" height="200" alt="image" src="计算机网络自顶向下7th-en/Image_839.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark739">Figure 8.28 Security association (SA) from R1 to R2</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark739" class="s124">Let’s now take a look “inside” an SA. To make the discussion tangible and concrete, let’s do this in the context of an SA from router R1 to router R2 in </a><a href="#bookmark739" class="a">Figure 8.2</a>8<a href="#bookmark734" class="s124">. (You can think of Router R1 as the headquarters gateway router and Router R2 as the branch office gateway router from </a><a href="#bookmark734" class="a">Figure 8.2</a>7<span class="p">.)</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Router R1 will maintain state information about this SA, which will include:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_840.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">A 32-bit identifier for the SA, called the <span class="s23">Security</span><span class="s20"> Parameter Index (SPI)</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_841.png"/></span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">The origin interface of the SA (in this case 200.168.1.100) and the destination interface of the SA (in this case 193.68.2.23)</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_842.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_843.png"/></span></p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">The type of encryption to be used (for example, 3DES with CBC) The encryption key</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_844.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_845.png"/></span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">The type of integrity check (for example, HMAC with MD5) The authentication key</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Whenever router R1 needs to construct an IPsec datagram for forwarding over this SA, it accesses this state information to determine how it should authenticate and encrypt the datagram. Similarly, router R2 will maintain the same state information for this SA and will use this information to authenticate and decrypt any IPsec datagram that arrives from the SA.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">An IPsec entity (router or host) often maintains state information for many SAs. For example, in the VPN</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark734" class="s124" name="bookmark740">example in </a><a href="#bookmark734" class="a">Figure 8.27</a><span class="s20"> </span>with <i>n </i>salespersons, the headquarters gateway router maintains state information for (2+2n) SAs. An IPsec entity stores the state information for all of its SAs in its <span class="s20">Security Association Database (SAD)</span>, which is a data structure in the entity’s OS kernel.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">The IPsec Datagram</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Having now described SAs, we can now describe the actual IPsec datagram. IPsec has two different packet forms, one for the so-called <span class="s20">tunnel mode </span>and the other for the so-called <span class="s20">transport mode</span>. The tunnel mode, being more appropriate for VPNs,</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="240" alt="image" src="计算机网络自顶向下7th-en/Image_846.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark741">Figure 8.29 IPsec datagram format</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">is more widely deployed than the transport mode. In order to further de-mystify IPsec and avoid much of its complication, we henceforth focus exclusively on the tunnel mode. Once you have a solid grip on the tunnel mode, you should be able to easily learn about the transport mode on your own.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark741" class="s124">The packet format of the IPsec datagram is shown in </a><a href="#bookmark741" class="a">Figure 8.2</a>9<span class="p">. You might think that packet formats are boring and insipid, but we will soon see that the IPsec datagram actually looks and tastes like a</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark739" class="s124">popular Tex-Mex delicacy! Let’s examine the IPsec fields in the context of </a><a href="#bookmark739" class="a">Figure 8.2</a>8<span class="p">. Suppose router R1 receives an ordinary IPv4 datagram from host 172.16.1.17 (in the headquarters network) which is destined to host 172.16.2.48 (in the branch-office network). Router R1 uses the following recipe to</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">convert this “original IPv4 datagram” into an IPsec datagram:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_847.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Appends to the back of the original IPv4 datagram (which includes the original header fields!) an “ESP trailer” field</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_848.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">Encrypts the result using the algorithm and key specified by the SA</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_849.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Appends to the front of this encrypted quantity a field called “ESP header”; the resulting package is called the “enchilada”</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_850.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">Creates an authentication MAC over the <i>whole enchilada </i>using the algorithm and key specified in</p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">the SA</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_851.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;">Appends the MAC to the back of the enchilada forming the <i>payload</i></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_852.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">Finally, creates a brand new IP header with all the classic IPv4 header fields (together normally 20 bytes long), which it appends before the payload</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Note that the resulting IPsec datagram is a bona fide IPv4 datagram, with the traditional IPv4 header fields followed by a payload. But in this case, the payload contains an ESP header, the original IP datagram, an ESP trailer, and an ESP authentication field (with the original datagram and ESP trailer encrypted). The original IP datagram has 172.16.1.17 for the source IP address and 172.16.2.48 for the destination IP address. Because the IPsec datagram includes the original IP datagram, these addresses are included (and encrypted) as part of the payload of the IPsec packet. But what about the source and destination IP addresses that are in the new IP header, that is, in the left-most header of the IPsec datagram? As you might expect, they are set to the source and destination router interfaces at the two ends of the tunnels, namely, 200.168.1.100 and 193.68.2.23. Also, the protocol number in this new IPv4 header field is not set to that of TCP, UDP, or SMTP, but instead to 50, designating that this is an IPsec datagram using the ESP protocol.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">After R1 sends the IPsec datagram into the public Internet, it will pass through many routers before reaching R2. Each of these routers will process the datagram as if it were an ordinary datagram—they are completely oblivious to the fact that the datagram is carrying IPsec-encrypted data. For these public Internet routers, because the destination IP address in the outer header is R2, the ultimate destination of the datagram is R2.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark741" class="s124">Having walked through an example of how an IPsec datagram is constructed, let’s now take a closer look at the ingredients in the enchilada. We see in </a><a href="#bookmark741" class="a">Figure 8.29</a> <span class="p">that the ESP trailer consists of three</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">fields: padding; pad length; and next header. Recall that block ciphers require the message to be encrypted to be an integer multiple of the block length. Padding (consisting of meaningless bytes) is used so that when added to the original datagram (along with the pad length and next header fields), the resulting “message” is an integer number of blocks. The pad-length field indicates to the receiving entity how much padding was inserted (and thus needs to be removed). The next header identifies the type (e.g., UDP) of data contained in the payload-data field. The payload data (typically the original IP datagram) and the ESP trailer are concatenated and then encrypted.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Appended to the front of this encrypted unit is the ESP header, which is sent in the clear and consists of two fields: the SPI and the sequence number field. The SPI indicates to the receiving entity the SA to which the datagram belongs; the receiving entity can then index its SAD with the SPI to determine the appropriate authentication/decryption algorithms and keys. The sequence number field is used to defend against replay attacks.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">The sending entity also appends an authentication MAC. As stated earlier, the sending entity calculates</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">a MAC over the whole enchilada (consisting of the ESP header, the original IP datagram, and the ESP trailer—with the datagram and trailer being encrypted). Recall that to calculate a MAC, the sender appends a secret MAC key to the enchilada and then calculates a fixed-length hash of the result.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark742">When R2 receives the IPsec datagram, R2 observes that the destination IP address of the datagram is R2 itself. R2 therefore processes the datagram. Because the protocol field (in the left-most IP header) is 50, R2 sees that it should apply IPsec ESP processing to the datagram. First, peering into the  enchilada, R2 uses the SPI to determine to which SA the datagram belongs. Second, it calculates the MAC of the enchilada and verifies that the MAC is consistent with the value in the ESP MAC field. If it is, it knows that the enchilada comes from R1 and has not been tampered with. Third, it checks the sequence-number field to verify that the datagram is fresh (and not a replayed datagram). Fourth, it decrypts the encrypted unit using the decryption algorithm and key associated with the SA. Fifth, it removes padding and extracts the original, vanilla IP datagram. And finally, sixth, it forwards the original datagram into the branch office network toward its ultimate destination. Whew, what a complicated recipe, huh? Well no one ever said that preparing and unraveling an enchilada was easy!</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">There is actually another important subtlety that needs to be addressed. It centers on the following question: When R1 receives an (unsecured) datagram from a host in the headquarters network, and that datagram is destined to some destination IP address outside of headquarters, how does R1 know whether it should be converted to an IPsec datagram? And if it is to be processed by IPsec, how does R1 know which SA (of many SAs in its SAD) should be used to construct the IPsec datagram? The problem is solved as follows. Along with a SAD, the IPsec entity also maintains another data structure called the <span class="s20">Security Policy Database (SPD)</span>. The SPD indicates what types of datagrams (as a function of source IP address, destination IP address, and protocol type) are to be IPsec processed; and for those that are to be IPsec processed, which SA should be used. In a sense, the information in a SPD indicates “what” to do with an arriving datagram; the information in the SAD indicates “how” to do it.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Summary of IPsec Services</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark739" class="s124">So what services does IPsec provide, exactly? Let us examine these services from the perspective of an attacker, say Trudy, who is a woman-in-the-middle, sitting somewhere on the path between R1 and R2 in </a><a href="#bookmark739" class="a">Figure 8.2</a>8<span class="p">. Assume throughout this discussion that Trudy does not know the authentication and</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">encryption keys used by the SA. What can and cannot Trudy do? First, Trudy cannot see the original</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">datagram. If fact, not only is the data in the original datagram hidden from Trudy, but so is the protocol number, the source IP address, and the destination IP address. For datagrams sent over the SA, Trudy only knows that the datagram originated from some host in 172.16.1.0/24 and is destined to some host in 172.16.2.0/24. She does not know if it is carrying TCP, UDP, or ICMP data; she does not know if it is carrying HTTP, SMTP, or some other type of application data. This confidentiality thus goes a lot farther than SSL. Second, suppose Trudy tries to tamper with a datagram in the SA by flipping some of its bits. When this tampered datagram arrives at R2, it will fail the integrity check (using the MAC), thwarting</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark743">Trudy’s vicious attempts once again. Third, suppose Trudy tries to masquerade as R1, creating a IPsec datagram with source 200.168.1.100 and destination 193.68.2.23. Trudy’s attack will be futile, as this datagram will again fail the integrity check at R2. Finally, because IPsec includes sequence numbers, Trudy will not be able create a successful replay attack. In summary, as claimed at the beginning of this section, IPsec provides—between any pair of devices that process packets through the network layer— confidentiality, source authentication, data integrity, and replay-attack prevention.</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">IKE: Key Management in IPsec</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark739" class="s124">When a VPN has a small number of end points (for example, just two routers as in </a><a href="#bookmark739" class="a">Figure 8.2</a>8<span class="p">), the network administrator can manually enter the SA information (encryption/authentication algorithms and keys, and the SPIs) into the SADs of the endpoints. Such “manual keying” is clearly impractical for a</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">large VPN, which may consist of hundreds or even thousands of IPsec routers and hosts. Large, geographically distributed deployments require an automated mechanism for creating the SAs. IPsec does this with the Internet Key Exchange (IKE) protocol, specified in RFC 5996.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark731" class="s124">IKE has some similarities with the handshake in SSL (see </a><a href="#bookmark731" class="a">Section 8.</a>6<span class="p">). Each IPsec entity has a certificate, which includes the entity’s public key. As with SSL, the IKE protocol has the two entities exchange certificates, negotiate authentication and encryption algorithms, and securely exchange key</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">material for creating session keys in the IPsec SAs. Unlike SSL, IKE employs two phases to carry out these tasks.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark739" class="s124">Let’s investigate these two phases in the context of two routers, R1 and R2, in </a><a href="#bookmark739" class="a">Figure 8.2</a>8<span class="p">. The first phase consists of two exchanges of message pairs between R1 and R2:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_853.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">During the first exchange of messages, the two sides use Diffie-Hellman (see Homework Problems) to create a bi-directional <span class="s20">IKE SA </span>between the routers. To keep us all confused, this bi-directional IKE SA is entirely different from the IPsec SAs discussed in Sections 8.6.3 and 8.6.4. The IKE SA</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">provides an authenticated and encrypted channel between the two routers. During this first message-pair exchange, keys are established for encryption and authentication for the IKE SA. Also established is a master secret that will be used to compute IPSec SA keys later in phase 2. Observe that during this first step, RSA public and private keys are not used. In particular, neither R1 nor R2 reveals its identity by signing a message with its private key.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_854.png"/></span></p><p style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">During the second exchange of messages, both sides reveal their identity to each other by signing their messages. However, the identities are not revealed to a passive sniffer, since the messages are sent over the secured IKE SA channel. Also during this phase, the two sides negotiate the IPsec</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">encryption and authentication algorithms to be employed by the IPsec SAs.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">In phase 2 of IKE, the two sides create an SA in each direction. At the end of phase 2, the encryption</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark744">and authentication session keys are established on both sides for the two SAs. The two sides can then</a><a name="bookmark745">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark740" class="s124">use the SAs to send secured datagrams, as described in </a><a href="#bookmark740" class="a">Sections 8.7.3</a> <a href="#bookmark743" class="s124">and </a><a href="#bookmark743" class="a">8.7.</a>4<span class="p">. The primary motivation for having two phases in IKE is computational cost—since the second phase doesn’t involve any public-key cryptography, IKE can generate a large number of SAs between the two IPsec entities</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">with relatively little computational cost.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li></ol></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark746">Securing Wireless LANs</a></p></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Security is a particularly important concern in wireless networks, where radio waves carrying frames can propagate far beyond the building containing the wireless base station and hosts. In this section we present a brief introduction to wireless security. For a more in-depth treatment, see the highly readable</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">book by Edney and Arbaugh </a><a href="#bookmark848" class="a">[Edney 2003</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The issue of security in 802.11 has attracted considerable attention in both technical circles and in the media. While there has been considerable discussion, there has been little debate—there seems to be universal agreement that the original 802.11 specification contains a number of serious security flaws. Indeed, public domain software can now be downloaded that exploits these holes, making those who use the vanilla 802.11 security mechanisms as open to security attacks as users who use no security features at all.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the following section, we discuss the security mechanisms initially standardized in the 802.11 specification, known collectively as <span class="s20">Wired Equivalent Privacy (WEP)</span>. As the name suggests, WEP is meant to provide a level of security similar to that found in wired networks. We’ll then discuss a few of the security holes in WEP and discuss the 802.11i standard, a fundamentally more secure version of</p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">802.11 adopted in 2004.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l344"><ol id="l345"><ol id="l346"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Wired Equivalent Privacy (WEP)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The IEEE 802.11 WEP protocol was designed in 1999 to provide authentication and data encryption between a host and a wireless access point (that is, base station) using a symmetric shared key approach. WEP does not specify a key management algorithm, so it is assumed that the host and wireless access point have somehow agreed on the key via an out-of-band method. Authentication is carried out as follows:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l347"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">A wireless host requests authentication by an access point.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The access point responds to the authentication request with a 128-byte nonce value.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">The wireless host encrypts the nonce using the symmetric key that it shares with the access point.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The access point decrypts the host-encrypted nonce.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">If the decrypted nonce matches the nonce value originally sent to the host, then the host is</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">authenticated by the access point.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 144%;text-align: left;"><a href="#bookmark747" class="s124">The WEP data encryption algorithm is illustrated in </a><a href="#bookmark747" class="a">Figure 8.3</a><span class="s20">0</span>. A secret 40-bit symmetric key, <i>K</i><span class="s31">S</span>, is assumed to be known by both a host and the access point. In addition, a 24-bit Initialization Vector (IV) is appended to the 40-bit key to create a 64-bit key that will be used to encrypt a single frame. The IV will</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="787" height="201" alt="image" src="计算机网络自顶向下7th-en/Image_855.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark747">Figure 8.30 802.11 WEP protocol</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark527" class="s124">change from one frame to another, and hence each frame will be encrypted with a different 64-bit key. Encryption is performed as follows. First a 4-byte CRC value (see </a><a href="#bookmark527" class="a">Section 6.</a>2<span class="p">) is computed for the data</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">payload. The payload and the four CRC bytes are then encrypted using the RC4 stream cipher. We will not cover the details of RC4 here (see </a><a href="#bookmark848" class="a">[Schneier 1995]</a><span class="s20"> </span><a href="#bookmark848" class="s124">and </a><a href="#bookmark848" class="a">[Edney 2003]</a><span class="s20"> </span>for details). For our purposes, it is enough to know that when presented with a key value (in this case, the 64-bit (<i>K</i><span class="s31">S</span>, <i>IV</i>)</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">key), the RC4 algorithm produces a stream of key values, k1IV,k2IV,k3IV,… that are used to encrypt the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;">data and CRC value in a frame. For practical purposes, we can think of these operations being performed a byte at a time. Encryption is performed by XOR-ing the <i>i</i>th byte of data, <i>d</i><span class="s31">i</span>, with the <i>i</i>th key,</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 14pt;text-align: left;"><span class="s27">k</span>iIV, in the stream of key values generated by the (<i>K</i><span class="s31">S</span>, <i>IV</i>) pair to produce the <i>i</i>th byte of ciphertext, <i>c</i><span class="s31">i</span>:</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">ci=di<span class="s29">⊕</span>kiIV</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The IV value changes from one frame to the next and is included <i>in plaintext </i><a href="#bookmark747" class="s124">in the header of each WEP-encrypted 802.11 frame, as shown in </a><a href="#bookmark747" class="a">Figure 8.3</a><span class="s20">0</span>. The receiver takes the secret 40-bit symmetric</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">key that it shares with the sender, appends the IV, and uses the resulting 64-bit key (which is identical to</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">the key used by the sender to perform encryption) to decrypt the frame:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">di=ci<span class="s29">⊕</span>kiIV</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Proper use of the RC4 algorithm requires that the same 64-bit key value <i>never </i>be used more than once. Recall that the WEP key changes on a frame-by-frame basis. For a given <i>K</i><span class="s31">S </span>(which changes rarely, if ever), this means that there are only 2<span class="s21">24</span><span class="s22"> </span>unique keys. If these keys are chosen randomly, we can show</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="a" name="bookmark748">[Edney 2003]</a> <span class="p">that the probability of having chosen the same IV value (and hence used the same 64-bit key) is more than 99 percent after only 12,000 frames. With 1 Kbyte frame sizes and a data transmission rate of 11 Mbps, only a few seconds are needed before 12,000 frames are transmitted.</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Furthermore, since the IV is transmitted in plaintext in the frame, an eavesdropper will know whenever a duplicate IV value is used.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 142%;text-align: left;">To see one of the several problems that occur when a duplicate key is used, consider the following chosen-plaintext attack taken by Trudy against Alice. Suppose that Trudy (possibly using IP spoofing) sends a request (for example, an HTTP or FTP request) to Alice to transmit a file with known content, d1, d2, d3, d4,…. Trudy also observes the encrypted data c1, c2, c3, c4,…. Since di=ci<span class="s29">⊕</span>kiIV, if we XOR</p><p class="s17" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">c<span class="s31">i </span><span class="p">with each side of this equality we have</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">di<span class="s29">⊕</span>ci=kiIV</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">With this relationship, Trudy can use the known values of <i>d</i><span class="s31">i </span>and <i>c</i><span class="s31">i </span>to compute <span class="s27">k</span>iIV. The next time Trudy sees the same value of IV being used, she will know the key sequence k1IV,k2IV,k3IV,… and will thus be able to decrypt the encrypted message.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">There are several additional security concerns with WEP as well. </a><a href="#bookmark848" class="a">[Fluhrer 2001]</a> <a href="#bookmark848" class="s124">described an attack exploiting a known weakness in RC4 when certain weak keys are chosen. </a><a href="#bookmark848" class="a">[Stubblefield </a>2002] <span class="p">discusses efficient ways to implement and exploit this attack. Another concern with WEP involves the</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark747" class="s124">CRC bits shown in </a><a href="#bookmark747" class="a">Figure 8.30</a> <span class="p">and transmitted in the 802.11 frame to detect altered bits in the payload. However, an attacker who changes the encrypted content (e.g., substituting gibberish for the original encrypted data), computes a CRC over the substituted gibberish, and places the CRC into a WEP frame</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark699" class="s124">can produce an 802.11 frame that will be accepted by the receiver. What is needed here are message integrity techniques such as those we studied in </a><a href="#bookmark699" class="a">Section 8.3</a> <a href="#bookmark848" class="s124">to detect content tampering or substitution. For more details of WEP security, see </a><a href="#bookmark848" class="a">[Edney 200</a>3<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Wright 2015]</a> <span class="p">and the references therein.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">IEEE 802.11i</p></li></ol></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Soon after the 1999 release of IEEE 802.11, work began on developing a new and improved version of</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">802.11 with stronger security mechanisms. The new standard, known as 802.11i, underwent final ratification in 2004. As we’ll see, while WEP provided relatively weak encryption, only a single way to perform authentication, and no key distribution mechanisms, IEEE 802.11i provides for much stronger forms of encryption, an extensible set of authentication mechanisms, and a key distribution mechanism. In the following, we present an overview of 802.11i; an excellent (streaming audio) technical overview of</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">802.11i is </a><a href="#bookmark848" class="a">[TechOnline 2012</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark749" class="a">Figure 8.31</a> <span class="p">overviews the 802.11i framework. In addition to the wireless client and access point,</span></p><ol id="l348"><ol id="l349"><li style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><p style="display: inline;">i defines an authentication server with which the AP can communicate. Separating the authentication server from the AP allows one authentication server to serve many APs, centralizing the (often sensitive) decisions</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="610" height="461" alt="image" src="计算机网络自顶向下7th-en/Image_856.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark749">Figure 8.31 802.11i: Four phases of operation</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">regarding authentication and access within the single server, and keeping AP costs and complexity low. 802.11i operates in four phases:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l350"><li style="padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p class="s28" style="display: inline;">Discovery. <span class="p">In the discovery phase, the AP advertises its presence and the forms of authentication and encryption that can be provided to the wireless client node. The client then</span></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">requests the specific forms of authentication and encryption that it desires. Although the client and AP are already exchanging messages, the client has not yet been authenticated nor does it have an encryption key, and so several more steps will be required before the client can communicate with an arbitrary remote host over the wireless channel.</p></li><li style="padding-top: 1pt;padding-left: 47pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p class="s28" style="display: inline;">Mutual authentication and Master Key (MK) generation. <span class="p">Authentication takes place between the wireless client and the authentication server. In this phase, the access point acts essentially</span></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 137%;text-align: left;">as a relay, forwarding messages between the client and the authentication server. The <a href="#bookmark848" class="a">Extensible Authentication Protocol (EAP) </a><a href="#bookmark848" class="s48">[RFC</a><a href="#bookmark848" class="a"> 3748]</a><span class="s20"> </span>defines the end-to-end message formats used in a simple request/response mode of interaction between the client and</p><p class="s20" style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;"><a href="#bookmark750" class="s124">authentication server. As shown in </a><a href="#bookmark750" class="a">Figure 8.3</a>2<span class="p">, EAP messages are encapsulated using </span><span class="s23">EAPoL</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">(EAP over LAN, </a><a href="#bookmark848" class="a">[IEEE 802.1X</a>]<span class="p">) and sent over the 802.11 wireless link. These EAP messages</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="553" height="299" alt="image" src="计算机网络自顶向下7th-en/Image_857.png"/></span></p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">are then decapsulated at the access point, and then re-encapsulated using the <span class="s20">RADIUS </span>protocol for transmission over UDP/IP to the authentication server. While</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><h2 style="padding-left: 48pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a name="bookmark750">Figure 8.32 EAP is an end-to-end protocol. EAP messages are encapsulated using EAPoL over the wireless link between the client and the access point, and using RADIUS over UDP/IP between the access point and the authentication server</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 48pt;text-indent: 0pt;line-height: 136%;text-align: left;"><a href="#bookmark848" class="s124">the RADIUS server and protocol </a><a href="#bookmark848" class="a">[RFC 2865]</a> <span class="p">are not required by the 802.11i protocol, they are </span><span class="s17">de facto </span><span class="p">standard components for 802.11i. The recently standardized </span><span class="s23">DIAMETER</span> <a href="#bookmark848" class="s124">protocol </a><a href="#bookmark848" class="a">[RFC 3588]</a> <span class="p">is likely to replace RADIUS in the near future.</span></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 14pt;text-align: left;">With EAP, the authentication server can choose one of a number of ways to perform</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 48pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">authentication. While 802.11i does not mandate a particular authentication method, the EAP- TLS authentication scheme </a><a href="#bookmark848" class="a">[RFC 5216]</a> <a href="#bookmark699" class="s124">is often used. EAP-TLS uses public key techniques (including nonce encryption and message digests) similar to those we studied in </a><a href="#bookmark699" class="a">Section 8.3</a> <span class="p">to</span></p><p style="padding-left: 48pt;text-indent: 0pt;line-height: 11pt;text-align: left;">allow the client and the authentication server to mutually authenticate each other, and to derive a</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;">Master Key (MK) that is known to both parties.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p class="s28" style="display: inline;">Pairwise Master Key (PMK) generation. <span class="p">The MK is a shared secret known only to the client and the authentication server, which they each use to generate a second key, the Pairwise</span></p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">Master Key (PMK). The authentication server then sends the PMK to the AP. This is where we wanted to be! The client and AP now have a shared key (recall that in WEP, the problem of key distribution was not addressed at all) and have mutually authenticated each other. They’re just about ready to get down to business.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p class="s28" style="display: inline;">Temporal Key (TK) generation. <span class="p">With the PMK, the wireless client and AP can now generate additional keys that will be used for communication. Of particular interest is the Temporal Key</span></p></li></ol></li></ol></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">(TK), which will be used to perform the link-level encryption of data sent over the wireless link and to an arbitrary remote host.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">802.11i provides several forms of encryption, including an AES-based encryption scheme and a</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark751">strengthened version of WEP encryption.</a><a name="bookmark752">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l351"><ol id="l352"><li style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 176%;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark753">Operational Security: Firewalls and Intrusion Detection Systems</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We’ve seen throughout this chapter that the Internet is not a very safe place—bad guys are out there, wreaking all sorts of havoc. Given the hostile nature of the Internet, let’s now consider an organization’s network and the network administrator who administers it. From a network administrator’s point of view, the world divides quite neatly into two camps—the good guys (who belong to the organization’s network, and who should be able to access resources inside the organization’s network in a relatively unconstrained manner) and the bad guys (everyone else, whose access to network resources must be carefully scrutinized). In many organizations, ranging from medieval castles to modern corporate office buildings, there is a single point of entry/exit where both good guys and bad guys entering and leaving the organization are security-checked. In a castle, this was done at a gate at one end of the drawbridge; in a corporate building, this is done at the security desk. In a computer network, when traffic entering/leaving a network is security-checked, logged, dropped, or forwarded, it is done by operational devices known as firewalls, intrusion detection systems (IDSs), and intrusion prevention systems (IPSs).</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l353"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Firewalls</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A <span class="s20">firewall </span>is a combination of hardware and software that isolates an organization’s internal network from the Internet at large, allowing some packets to pass and blocking others. A firewall allows a network administrator to control access between the outside world and resources within the administered network by managing the traffic flow to and from these resources. A firewall has three goals:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_858.png"/></span></p><p class="s20" style="padding-top: 3pt;padding-left: 25pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark755" style=" color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt;">All traffic from outside to inside, and vice versa, passes through the firewall. </a><a href="#bookmark755" class="a">Figure </a>8.33 <span class="p">shows a firewall, sitting squarely at the boundary between the administered network and the rest of the Internet. While large organizations may use multiple levels of firewalls or distributed firewalls</span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="a">[Skoudis 2006</a>]<a href="#bookmark755" class="s124">, locating a firewall at a single access point to the network, as shown in </a><a href="#bookmark755" class="a">Figure 8.3</a>3<span class="p">, makes it easier to manage and enforce a security-access policy.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_859.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Only authorized traffic, as defined by the local security policy, will be allowed to pass. <span class="p">With all traffic entering and leaving the institutional network passing through the firewall, the firewall can restrict access to authorized traffic.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_860.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">The firewall itself is immune to penetration. <span class="p">The firewall itself is a device connected to the network. If not designed or installed properly, it can be compromised, in which case it provides only</span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: left;"><a name="bookmark754">a false sense of security (which is worse than no firewall at all!).</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="679" height="440" alt="image" src="计算机网络自顶向下7th-en/Image_861.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark755">Figure 8.33 Firewall placement between the administered network and the outside world</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark368" class="s124">Cisco and Check Point are two of the leading firewall vendors today. You can also easily create a firewall (packet filter) from a Linux box using iptables (public-domain software that is normally shipped with Linux). Furthermore, as discussed in </a><a href="#bookmark368" class="a">Chapters 4</a> <a href="#bookmark444" class="s124">and </a>5<span class="p">, firewalls are now frequently implemented</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">in routers and controlled remotely using SDNs.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Firewalls can be classified in three categories: <span class="s20">traditional packet filters</span>, <span class="s20">stateful filters</span>, and</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">application gateways<span class="p">. We’ll cover each of these in turn in the following subsections.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Traditional Packet Filters</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark755" class="s124">As shown in </a><a href="#bookmark755" class="a">Figure 8.3</a>3<span class="p">, an organization typically has a gateway router connecting its internal network to its ISP (and hence to the larger public Internet). All traffic leaving and entering the internal network passes through this router, and it is at this router where </span>packet filtering <span class="p">occurs. A packet filter</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">examines each datagram in isolation, determining whether the datagram should be allowed to pass or should be dropped based on administrator-specific rules. Filtering decisions are typically based on:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_862.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">IP source or destination address</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_863.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_864.png"/></span></p><p style="padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;">Protocol type in IP datagram field: TCP, UDP, ICMP, OSPF, and so on TCP or UDP source and destination port</p><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark756">Table 8.5 Policies and corresponding filtering rules for an organization’s network 130.207/16 with Web server at 130.207.244.203</a></h2><p style="text-indent: 0pt;line-height: 1pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:567pt;margin-left:25.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Policy</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Firewall Setting</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">No outside Web access.</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 16pt;text-indent: 0pt;line-height: 146%;text-align: left;">Drop all outgoing packets to any IP address, port 80.</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 11pt;text-indent: 0pt;line-height: 146%;text-align: left;">No incoming TCP connections, except those for organization’s public Web server only.</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 23pt;text-indent: 0pt;line-height: 146%;text-align: left;">Drop all incoming TCP SYN packets to any IP except 130.207.244.203, port 80.</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 62pt;text-indent: 0pt;line-height: 146%;text-align: left;">Prevent Web-radios from eating up the available bandwidth.</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 8pt;text-indent: 0pt;line-height: 146%;text-align: left;">Drop all incoming UDP packets—except DNS packets.</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 36pt;text-indent: 0pt;line-height: 146%;text-align: left;">Prevent your network from being used for a smurf DoS attack.</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 23pt;text-indent: 0pt;line-height: 146%;text-align: left;">Drop all ICMP ping packets going to a “broadcast” address (eg 130.207.255.255).</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Prevent your network from being tracerouted.</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Drop all outgoing ICMP TTL expired traffic.</p></td></tr></table><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_865.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_866.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">TCP flag bits: SYN, ACK, and so on ICMP message type</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_867.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_868.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">Different rules for datagrams leaving and entering the network Different rules for the different router interfaces</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark756" class="s124">A network administrator configures the firewall based on the policy of the organization. The policy may take user productivity and bandwidth usage into account as well as the security concerns of an organization. </a><a href="#bookmark756" class="a">Table 8.5</a> <span class="p">lists a number of possible polices an organization may have, and how they</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">would be addressed with a packet filter. For example, if the organization doesn’t want any incoming TCP</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">connections except those for its public Web server, it can block all incoming TCP SYN segments except TCP SYN segments with destination port 80 and the destination IP address corresponding to the Web server. If the organization doesn’t want its users to monopolize access bandwidth with Internet radio applications, it can block all not-critical UDP traffic (since Internet radio is often sent over UDP). If the organization doesn’t want its internal network to be mapped (tracerouted) by an outsider, it can block all ICMP TTL expired messages leaving the organization’s network.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A filtering policy can be based on a combination of addresses and port numbers. For example, a filtering router could forward all Telnet datagrams (those with a port number of 23) except those going to and coming from a list of specific IP addresses. This policy permits Telnet connections to and from hosts on the allowed list. Unfortunately, basing the policy on external addresses provides no protection against</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">datagrams that have had their source addresses spoofed.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark757">Filtering can also be based on whether or not the TCP ACK bit is set. This trick is quite useful if an organization wants to let its internal clients connect to external servers but wants to prevent external clients from connecting to internal servers.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark758">Table 8.6 An access control list for a router interface</a></h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">action</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">source address</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">dest address</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">protocol</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;padding-right: 32pt;text-indent: 0pt;line-height: 146%;text-align: left;">source port</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;padding-right: 33pt;text-indent: 0pt;line-height: 146%;text-align: left;">dest port</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;padding-right: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">flag bit</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">allow</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 13pt;text-indent: 0pt;line-height: 146%;text-align: left;">outside of 222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">TCP</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">&gt; 1023</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">80</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">any</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">allow</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 13pt;text-indent: 0pt;line-height: 146%;text-align: left;">outside of 222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">TCP</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">80</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">&gt; 1023</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">ACK</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">allow</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 13pt;text-indent: 0pt;line-height: 146%;text-align: left;">outside of 222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">UDP</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">&gt; 1023</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">53</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">—</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">allow</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 13pt;text-indent: 0pt;line-height: 146%;text-align: left;">outside of 222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">UDP</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">53</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">&gt; 1023</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">—</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">deny</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">all</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">all</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">all</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">all</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">all</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">all</p></td></tr></table><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Recall from Section 3.5 that the first segment in every TCP connection has the ACK bit set to 0, whereas all the other segments in the connection have the ACK bit set to 1. Thus, if an organization wants to prevent external clients from initiating connections to internal servers, it simply filters all incoming segments with the ACK bit set to 0. This policy kills all TCP connections originating from the outside, but permits connections originating internally.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark758" class="s124">Firewall rules are implemented in routers with access control lists, with each router interface having its own list. An example of an access control list for an organization 222.22/16 is shown in </a><a href="#bookmark758" class="a">Table 8.</a>6<span class="p">. This</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">access control list is for an interface that connects the router to the organization’s external ISPs. Rules are applied to each datagram that passes through the interface from top to bottom. The first two rules together allow internal users to surf the Web: The first rule allows any TCP packet with destination port 80 to leave the organization’s network; the second rule allows any TCP packet with source port 80 and the ACK bit set to enter the organization’s network. Note that if an external source attempts to establish a TCP connection with an internal host, the connection will be blocked, even if the source or destination port is 80. The second two rules together allow DNS packets to enter and leave the organization’s</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">network. In summary, this rather restrictive access control list blocks all traffic except Web traffic initiated</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">from within the organization and DNS traffic. </a><a href="#bookmark848" class="a">[CERT Filtering 2012]</a> <span class="p">provides a list of recommended port/protocol packet filterings to avoid a number of well-known security holes in existing network applications.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Stateful Packet Filters</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In a traditional packet filter, filtering decisions are made on each packet in isolation. Stateful filters actually track TCP connections, and use this knowledge to make filtering decisions.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark759">Table 8.7 Connection table for stateful filter</a></h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">source address</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">dest address</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">source port</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">dest port</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">222.22.1.7</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">37.96.87.123</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">12699</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">80</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">222.22.93.2</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">199.1.205.23</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">37654</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">80</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">222.22.65.143</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">203.77.240.43</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">48712</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">80</p></td></tr></table><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark758" class="s124">To understand stateful filters, let’s reexamine the access control list in </a><a href="#bookmark758" class="a">Table 8.</a>6<a href="#bookmark758" class="s124">. Although rather restrictive, the access control list in </a><a href="#bookmark758" class="a">Table 8.6</a> <span class="p">nevertheless allows any packet arriving from the outside with ACK = 1 and source port 80 to get through the filter. Such packets could be used by attackers in</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">attempts to crash internal systems with malformed packets, carry out denial-of-service attacks, or map the internal network. The naive solution is to block TCP ACK packets as well, but such an approach would prevent the organization’s internal users from surfing the Web.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Stateful filters solve this problem by tracking all ongoing TCP connections in a connection table. This is possible because the firewall can observe the beginning of a new connection by observing a three-way handshake (SYN, SYNACK, and ACK); and it can observe the end of a connection when it sees a FIN packet for the connection. The firewall can also (conservatively) assume that the connection is over when it hasn’t seen any activity over the connection for, say, 60 seconds. An example connection table</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark759" class="s124">for a firewall is shown in </a><a href="#bookmark759" class="a">Table 8.</a>7<span class="p">. This connection table indicates that there are currently three ongoing TCP connections, all of which have been initiated from within the organization. Additionally, the stateful</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark760" class="s124">filter includes a new column, “check connection,” in its access control list, as shown in </a><a href="#bookmark760" class="a">Table 8.</a>8<a href="#bookmark760" class="s124">. Note that </a><a href="#bookmark760" class="a">Table 8.8</a> <a href="#bookmark758" class="s124">is identical to the access control list in </a><a href="#bookmark758" class="a">Table 8.</a>6<span class="p">, except now it indicates that the connection should be checked for two of the rules.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Let’s walk through some examples to see how the connection table and the extended access control list</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">work hand-in-hand. Suppose an attacker attempts to send a malformed packet into the organization’s network by sending a datagram with TCP source port 80 and with the ACK flag set. Further suppose that this packet has source port number 12543 and source IP address 150.23.23.155. When this packet</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark759" class="s124">reaches the firewall, the firewall checks the access control list in </a><a href="#bookmark759" class="a">Table 8.</a>7<span class="p">, which indicates that the connection table must also be checked before permitting this packet to enter the organization’s network. The firewall duly checks the connection table, sees that this packet is not part of an ongoing TCP</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">connection, and rejects the packet. As a second example, suppose that an internal user wants to surf an external Web site. Because this user first sends a TCP SYN segment, the user’s TCP connection gets recorded in the connection table. When</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark760">Table 8.8 Access control list for stateful filter</a></h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">action</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">source address</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">dest address</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">protocol</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;padding-right: 17pt;text-indent: 0pt;line-height: 146%;text-align: left;">source port</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;padding-right: 20pt;text-indent: 0pt;line-height: 146%;text-align: left;">dest port</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;padding-right: 15pt;text-indent: 0pt;line-height: 146%;text-align: left;">flag bit</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;padding-right: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">check conxion</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">allow</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 45pt;text-indent: 0pt;line-height: 146%;text-align: left;">outside of 222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">TCP</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">&gt; 1023</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">80</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">any</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">allow</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 45pt;text-indent: 0pt;line-height: 146%;text-align: left;">outside of 222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">TCP</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">80</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 16pt;text-indent: 0pt;line-height: 146%;text-align: left;">&gt; 1023</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">ACK</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">X</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">allow</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 45pt;text-indent: 0pt;line-height: 146%;text-align: left;">outside of 222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">UDP</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">&gt; 1023</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">53</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">—</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">allow</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 45pt;text-indent: 0pt;line-height: 146%;text-align: left;">outside of 222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">222.22/16</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">UDP</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">53</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 16pt;text-indent: 0pt;line-height: 146%;text-align: left;">&gt; 1023</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">—</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">X</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">deny</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">all</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">all</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">all</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">all</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">all</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">all</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/></tr></table><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the Web server sends back packets (with the ACK bit necessarily set), the firewall checks the table and sees that a corresponding connection is in progress. The firewall will thus let these packets pass, thereby not interfering with the internal user’s Web surfing activity.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Application Gateway</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the examples above, we have seen that packet-level filtering allows an organization to perform coarse-grain filtering on the basis of the contents of IP and TCP/UDP headers, including IP addresses, port numbers, and acknowledgment bits. But what if an organization wants to provide a Telnet service to a restricted set of internal users (as opposed to IP addresses)? And what if the organization wants such privileged users to authenticate themselves first before being allowed to create Telnet sessions to the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">outside world? Such tasks are beyond the capabilities of traditional and stateful filters. Indeed, information about the identity of the internal users is application-layer data and is not included in the IP/TCP/UDP headers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To have finer-level security, firewalls must combine packet filters with application gateways. Application gateways look beyond the IP/TCP/UDP headers and make policy decisions based on application data. An <span class="s20">application gateway </span>is an application-specific server through which all application data (inbound and outbound) must pass. Multiple application gateways can run on the same host, but each gateway is a separate server with its own processes.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To get some insight into application gateways, let’s design a firewall that allows only a restricted set of internal users to Telnet outside and prevents all external clients from Telneting inside. Such a policy can be accomplished by implementing</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="500" height="448" alt="image" src="计算机网络自顶向下7th-en/Image_869.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark761">Figure 8.34 Firewall consisting of an application gateway and a filter</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark761" class="s124">a combination of a packet filter (in a router) and a Telnet application gateway, as shown in </a><a href="#bookmark761" class="a">Figure 8.3</a>4<span class="p">. The router’s filter is configured to block all Telnet connections except those that originate from the IP address of the application gateway. Such a filter configuration forces all outbound Telnet connections to</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">pass through the application gateway. Consider now an internal user who wants to Telnet to the outside world. The user must first set up a Telnet session with the application gateway. An application running in the gateway, which listens for incoming Telnet sessions, prompts the user for a user ID and password. When the user supplies this information, the application gateway checks to see if the user has</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">permission to Telnet to the outside world. If not, the Telnet connection from the internal user to the gateway is terminated by the gateway. If the user has permission, then the gateway (1) prompts the user for the host name of the external host to which the user wants to connect, (2) sets up a Telnet session between the gateway and the external host, and (3) relays to the external host all data arriving from the user, and relays to the user all data arriving from the external host. Thus, the Telnet application gateway not only performs user authorization but also acts as a Telnet server and a Telnet client, relaying information between the user and the remote Telnet server. Note that the filter will permit step 2 because the gateway initiates the Telnet connection to the outside world.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="878" alt="image" src="计算机网络自顶向下7th-en/Image_870.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">CASE HISTORY</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">ANONYMITY AND PRIVACY</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Suppose you want to visit a controversial Web site (for example, a political activist site) and you</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l354"><li style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><p style="display: inline;">don’t want to reveal your IP address to the Web site, (2) don’t want your local ISP (which may be your home or office ISP) to know that you are visiting the site, and (3) don’t want your local ISP to see the data you are exchanging with the site. If you use the traditional approach of connecting directly to the Web site without any encryption, you fail on all three counts. Even if you use SSL, you fail on the first two counts: Your source IP address is presented to the Web site in every datagram you send; and the destination address of every packet you send can easily be sniffed by your local ISP.</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark763" class="s124">To obtain privacy and anonymity, you can instead use a combination of a trusted proxy server and SSL, as shown in </a><a href="#bookmark763" class="a">Figure 8.3</a>5<span class="p">. With this approach, you first make an SSL connection to the</span></p><p style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">trusted proxy. You then send, into this SSL connection, an HTTP request for a page at the desired site. When the proxy receives the SSL-encrypted HTTP request, it decrypts the request and forwards the cleartext HTTP request to the Web site. The Web site then responds to the proxy, which in turn forwards the response to you over SSL. Because the Web site only sees the IP address of the proxy, and not of your client’s address, you are indeed obtaining anonymous access to the Web site. And because all traffic between you and the proxy is encrypted, your local ISP cannot invade your privacy by logging the site you visited or recording the data you are</p><p style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">exchanging. Many companies today (such as <span style=" color: #AAA;">proxify .com</span>) make available such proxy services.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Of course, in this solution, your proxy knows everything: It knows your IP address and the IP address of the site you’re surfing; and it can see all the traffic in cleartext exchanged between you and the Web site. Such a solution, therefore, is only as good as the trustworthiness of the proxy. A more robust approach, taken by the TOR anonymizing and privacy service, is to route</p><p class="s20" style="padding-top: 2pt;padding-left: 28pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">your traffic through a series of non-colluding proxy servers </a><a href="#bookmark848" class="a">[TOR 2016</a>]<span class="p">. In particular, TOR allows independent individuals to contribute proxies to its proxy pool. When a user connects to a server using TOR, TOR randomly chooses (from its proxy pool) a chain of three proxies and</span></p><p style="padding-top: 1pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">routes all traffic between client and server over the chain. In this manner, assuming the proxies do not collude, no one knows that communication took place between your IP address and the</p><p style="text-indent: 0pt;text-align: left;"><span><img width="672" height="341" alt="image" src="计算机网络自顶向下7th-en/Image_871.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark762">target Web site. Furthermore, although cleartext is sent between the last proxy and the server, the last proxy doesn’t know what IP address is sending and receiving the cleartext.</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark763">Figure 8.35 Providing anonymity and privacy with a proxy</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark192" class="s124">Internal networks often have multiple application gateways, for example, gateways for Telnet, HTTP, FTP, and e-mail. In fact, an organization’s mail server (see </a><a href="#bookmark192" class="a">Section 2.</a>3<span class="p">) and Web cache are application</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">gateways.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Application gateways do not come without their disadvantages. First, a different application gateway is needed for each application. Second, there is a performance penalty to be paid, since all data will be relayed via the gateway. This becomes a concern particularly when multiple users or applications are using the same gateway machine. Finally, the client software must know how to contact the gateway when the user makes a request, and must know how to tell the application gateway what external server to connect to.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li></ol></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Intrusion Detection Systems</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We’ve just seen that a packet filter (traditional and stateful) inspects IP, TCP, UDP, and ICMP header fields when deciding which packets to let pass through the firewall. However, to detect many attack types, we need to perform <span class="s20">deep packet inspection</span>, that is, look beyond the header fields and into the</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark762" class="s124">actual application data that the packets carry. As we saw in </a><a href="#bookmark762" class="a">Section 8.9.</a>1<span class="p">, application gateways often do deep packet inspection. But an application gateway only does this for a specific application.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Clearly, there is a niche for yet another device—a device that not only examines the headers of all packets passing through it (like a packet filter), but also performs deep packet inspection (unlike a packet filter). When such a device observes a suspicious packet, or a suspicious series of packets, it could prevent those packets from entering the organizational network. Or, because the activity is only</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">deemed as suspicious, the device could let the packets pass, but send alerts to a network administrator, who can then take a closer look at the traffic and take appropriate actions. A device that generates alerts when it observes potentially malicious traffic is called an <span class="s20">intrusion detection system (IDS)</span>. A device that filters out suspicious traffic is called an <span class="s20">intrusion prevention system (IPS)</span>. In this section we study both systems—IDS and IPS—together, since the most interesting technical aspect of these systems is how they detect suspicious traffic (and not whether they send alerts or drop packets). We will henceforth collectively refer to IDS systems and IPS systems as IDS systems.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark101" class="s124">An IDS can be used to detect a wide range of attacks, including network mapping (emanating, for example, from nmap), port scans, TCP stack scans, DoS bandwidth-flooding attacks, worms and viruses, OS vulnerability attacks, and application vulnerability attacks. (See </a><a href="#bookmark101" class="a">Section 1.6</a> <span class="p">for a survey of</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">network attacks.) Today, thousands of organizations employ IDS systems. Many of these deployed</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">systems are proprietary, marketed by Cisco, Check Point, and other security equipment vendors. But many of the deployed IDS systems are public-domain systems, such as the immensely popular Snort IDS system (which we’ll discuss shortly).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark764" class="s124">An organization may deploy one or more IDS sensors in its organizational network. </a><a href="#bookmark764" class="a">Figure 8.36</a> <span class="p">shows an organization that has three IDS sensors. When multiple sensors are deployed, they typically work in concert, sending information about</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="777" height="538" alt="image" src="计算机网络自顶向下7th-en/Image_872.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark764">Figure 8.36 An organization deploying a filter, an application gateway, and IDS sensors</a></h2><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark764" class="s124">suspicious traffic activity to a central IDS processor, which collects and integrates the information and sends alarms to network administrators when deemed appropriate. In </a><a href="#bookmark764" class="a">Figure 8.3</a>6<span class="p">, the organization has</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">partitioned its network into two regions: a high-security region, protected by a packet filter and an application gateway and monitored by IDS sensors; and a lower-security region—referred to as the <span class="s20">demilitarized zone (DMZ)</span>—which is protected only by the packet filter, but also monitored by IDS sensors. Note that the DMZ includes the organization’s servers that need to communicate with the outside world, such as its public Web server and its authoritative DNS server.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark764" class="s124">You may be wondering at this stage, why multiple IDS sensors? Why not just place one IDS sensor just behind the packet filter (or even integrated with the packet filter) in </a><a href="#bookmark764" class="a">Figure 8.3</a>6<span class="p">? We will soon see that</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">an IDS not only needs to do deep packet inspection, but must also compare each passing packet with tens of thousands of “signatures”; this can be a significant amount of processing, particularly if the organization receives gigabits/sec of traffic from the Internet. By placing the IDS sensors further downstream, each sensor sees only a fraction of the organization’s traffic, and can more easily keep up. Nevertheless, high-performance IDS and IPS systems are available today, and many organizations can actually get by with just one sensor located near its access router.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">IDS systems are broadly classified as either <span class="s20">signature-based systems </span>or <span class="s20">anomaly-based systems</span>. A signature-based IDS maintains an extensive database of attack signatures. Each signature is a set of rules pertaining to an intrusion activity. A signature may simply be a list of characteristics about a single packet (e.g., source and destination port numbers, protocol type, and a specific string of bits in the packet payload), or may relate to a series of packets. The signatures are normally created by skilled network security engineers who research known attacks. An organization’s network administrator can customize the signatures or add its own to the database.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Operationally, a signature-based IDS sniffs every packet passing by it, comparing each sniffed packet with the signatures in its database. If a packet (or series of packets) matches a signature in the database, the IDS generates an alert. The alert could be sent to the network administrator in an e-mail message, could be sent to the network management system, or could simply be logged for future inspection.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Signature-based IDS systems, although widely deployed, have a number of limitations. Most  importantly, they require previous knowledge of the attack to generate an accurate signature. In other words, a signature-based IDS is completely blind to new attacks that have yet to be recorded. Another disadvantage is that even if a signature is matched, it may not be the result of an attack, so that a false alarm is generated. Finally, because every packet must be compared with an extensive collection of signatures, the IDS can become overwhelmed with processing and actually fail to detect many malicious</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark765">packets.</a><a name="bookmark766">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">An anomaly-based IDS creates a traffic profile as it observes traffic in normal operation. It then looks for packet streams that are statistically unusual, for example, an inordinate percentage of ICMP packets or a sudden exponential growth in port scans and ping sweeps. The great thing about anomaly-based IDS systems is that they don’t rely on previous knowledge about existing attacks—that is, they can  potentially detect new, undocumented attacks. On the other hand, it is an extremely challenging problem to distinguish between normal traffic and statistically unusual traffic. To date, most IDS deployments are primarily signature-based, although some include some anomaly-based features.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Snort</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">Snort is a public-domain, open source IDS with hundreds of thousands of existing deployments </a><a href="#bookmark848" class="a">[Snort </a>2012<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Koziol 2003</a>]<span class="p">. It can run on Linux, UNIX, and Windows platforms. It uses the generic sniffing interface libpcap, which is also used by Wireshark and many other packet sniffers. It can easily handle</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="106" alt="image" src="计算机网络自顶向下7th-en/Image_873.png"/></span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 292%;text-align: left;">100 Mbps of traffic; for installations with gibabit/sec traffic rates, multiple Snort sensors may be needed. To gain some insight into Snort, let’s take a look at an example of a Snort signature:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 1pt;line-height: 148%;text-align: left;">alert icmp $EXTERNAL_NET any -&gt; $HOME_NET any (msg:”ICMP PING NMAP”; dsize: 0; itype: 8;)</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">This signature is matched by any ICMP packet that enters the organization’s network ( <span class="s30">$HOME_NET </span>) from the outside ( <span class="s30">$EXTERNAL_NET </span><a href="#bookmark101" class="s124">), is of type 8 (ICMP ping), and has an empty payload (dsize = 0). Since nmap (see </a><a href="#bookmark101" class="a">Section 1.</a><span class="s20">6</span>) generates ping packets with these specific characteristics, this signature is designed to detect nmap ping sweeps. When a packet matches this signature, Snort generates an</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">alert that includes the message <span class="s30">“ICMP PING NMAP” </span>.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Perhaps what is most impressive about Snort is the vast community of users and security experts that maintain its signature database. Typically within a few hours of a new attack, the Snort community writes and releases an attack signature, which is then downloaded by the hundreds of thousands of Snort deployments distributed around the world. Moreover, using the Snort signature syntax, network administrators can tailor the signatures to their own organization’s needs by either modifying existing signatures or creating entirely new ones.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l355"><ol id="l356"><li style="padding-top: 2pt;padding-left: 50pt;text-indent: -45pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark767">Summary</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this chapter, we’ve examined the various mechanisms that our secret lovers, Bob and Alice, can use to communicate securely. We’ve seen that Bob and Alice are interested in confidentiality (so they alone are able to understand the contents of a transmitted message), end-point authentication (so they are sure that they are talking with each other), and message integrity (so they are sure that their messages are not altered in transit). Of course, the need for secure communication is not confined to secret lovers.</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark721" class="s124">Indeed, we saw in </a><a href="#bookmark721" class="a">Sections 8.5</a> <a href="#bookmark751" class="s124">through </a><a href="#bookmark751" class="a">8.8</a> <span class="p">that security can be used in various layers in a network architecture to protect against bad guys who have a large arsenal of possible attacks at hand.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark685" class="s124">The first part of this chapter presented various principles underlying secure communication. In </a><a href="#bookmark685" class="a">Section 8.</a>2<span class="p">, we covered cryptographic techniques for encrypting and decrypting data, including symmetric key cryptography and public key cryptography. DES and RSA were examined as specific case studies of</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">these two major classes of cryptographic techniques in use in today’s networks.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark699" class="s124">In </a><a href="#bookmark699" class="a">Section 8.</a>3<span class="p">, we examined two approaches for providing message integrity: message authentication codes (MACs) and digital signatures. The two approaches have a number of parallels. Both use cryptographic hash functions and both techniques enable us to verify the source of the message as well</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark721" class="s124">as the integrity of the message itself. One important difference is that MACs do not rely on encryption whereas digital signatures require a public key infrastructure. Both techniques are extensively used in practice, as we saw in </a><a href="#bookmark721" class="a">Sections 8.5</a> <a href="#bookmark751" class="s124">through </a><a href="#bookmark751" class="a">8.</a>8<span class="p">. Furthermore, digital signatures are used to create</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark711" class="s124">digital certificates, which are important for verifying the validity of public keys. In </a><a href="#bookmark711" class="a">Section 8.</a>4<span class="p">, we</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">examined endpoint authentication and introduced nonces to defend against the replay attack.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark721" class="s124">In </a><a href="#bookmark721" class="a">Sections 8.5</a> <a href="#bookmark751" class="s124">through </a><a href="#bookmark751" class="a">8.8</a> <span class="p">we examined several security networking protocols that enjoy extensive use in practice. We saw that symmetric key cryptography is at the core of PGP, SSL, IPsec, and wireless security. We saw that public key cryptography is crucial for both PGP and SSL. We saw that PGP uses</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">digital signatures for message integrity, whereas SSL and IPsec use MACs. Having now an understanding of the basic principles of cryptography, and having studied how these principles are actually used, you are now in position to design your own secure network protocols!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark685" class="s124">Armed with the techniques covered in </a><a href="#bookmark685" class="a">Sections 8.2</a> <a href="#bookmark751" class="s124">through </a><a href="#bookmark751" class="a">8.</a>8<span class="p">, Bob and Alice can communicate securely. (One can only hope that they are networking students who have learned this material and can thus avoid having their tryst uncovered by Trudy!) But confidentiality is only a small part of the network</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark765" class="s124">security picture. As we learned in </a><a href="#bookmark765" class="a">Section 8.</a>9<span class="p">, increasingly, the focus in network security has been on securing the network infrastructure against a potential onslaught by the bad guys. In the latter part of this chapter, we thus covered firewalls and IDS systems which inspect packets entering and leaving an</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark768">organization’s network.</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">This chapter has covered a lot of ground, while focusing on the most important topics in modern network security. Readers who desire to dig deeper are encouraged to investigate the references cited in this chapter. In particular, we recommend </a><a href="#bookmark848" class="a">[Skoudis 2006]</a> <a href="#bookmark848" class="s124">for attacks and operational security, </a><a href="#bookmark848" class="a">[Kaufman</a></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark848" class="a">1995]</a> <a href="#bookmark848" class="s124">for cryptography and how it applies to network security, </a><a href="#bookmark848" class="a">[Rescorla 2001]</a> <span class="p">for an in-depth but</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">readable treatment of SSL, and </a><a href="#bookmark848" class="a">[Edney 2003]</a> <span class="p">for a thorough discussion of 802.11 security, including an insightful investigation into WEP and its flaws.</span></p><p class="s18" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark769">Homework Problems and Questions</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Chapter 8 Review Problems</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 8.1</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;">R1. What are the differences between message confidentiality and message integrity? Can you have confidentiality without integrity? Can you have integrity without confidentiality? Justify your answer.</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;">R2. Internet entities (routers, switches, DNS servers, Web servers, user end systems, and so on) often need to communicate securely. Give three specific example pairs of Internet entities that may want secure communication.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 8.2</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R3. From a service perspective, what is an important difference between a symmetric-key system and a public-key system?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;">R4. Suppose that an intruder has an encrypted message as well as the decrypted version of that message. Can the intruder mount a ciphertext-only attack, a known-plaintext attack, or a chosen- plaintext attack?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R5. Consider an 8-block cipher. How many possible input blocks does this cipher have? How many possible mappings are there? If we view each mapping as a key, then how many possible keys does this cipher have?</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 139%;text-align: left;">R6. Suppose <i>N </i>people want to communicate with each of <span class="s27">N</span>−1 other people using symmetric key encryption. All communication between any two people, <i>i </i>and <i>j</i>, is visible to all other people in this group of <i>N</i>, and no other person in this group should be able to decode their communication. How many keys are required in the system as a whole? Now suppose that public key encryption</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">is used. How many keys are required in this case?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 116%;text-align: left;">R7. Suppose <span class="s27">n</span>=10,000, a=10,023, and <span class="s27">b</span>=10,004. Use an identity of modular arithmetic to calculate in your head (a<span class="s29">⋅</span>b)mod n.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R8. Suppose you want to encrypt the message 10101111 by encrypting the decimal number that corresponds to the message. What is the decimal number?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTIONS 8.3–8.4</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R9. In what way does a hash provide a better message integrity check than a checksum (such as the Internet checksum)?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 139%;text-align: left;"><a href="#bookmark691" class="s124">R10. Can you “decrypt” a hash of a message to get the original message? Explain your answer. R11. Consider a variation of the MAC algorithm (</a><a href="#bookmark691" class="a">Figure 8.9</a><span class="s20"> </span>) where the sender sends <span class="s27">(m</span>, H(m)+s), where <span class="s27">H</span>(m)+s is the concatenation of <i>H</i>(<i>m</i>) and <i>s</i>. Is this variation flawed? Why or</p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 13pt;text-align: left;">why not?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">R12. What does it mean for a signed document to be verifiable and nonforgeable?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R13. In what way does the public-key encrypted message hash provide a better digital signature than the public-key encrypted message?</p><p class="s20" style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="http://certifier.com/" class="s124" target="_blank">R14. Suppose </a><a href="http://certifier.com/" class="a" target="_blank">certifier.com</a> <a href="http://foo.com/" class="s124" target="_blank">creates a certificate for </a>foo.com<a href="http://certifier.com/" class="s124" target="_blank">. Typically, the entire certificate would be encrypted with </a><a href="http://certifier.com/" class="a" target="_blank">certifier.co</a>m<span class="p">’s public key. True or false?</span></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R15. Suppose Alice has a message that she is ready to send to anyone who asks. Thousands of people want to obtain Alice’s message, but each wants to be sure of the integrity of the message. In this context, do you think a MAC-based or a digital-signature-based integrity</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">scheme is more suitable? Why?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">R16. What is the purpose of a nonce in an end-point authentication protocol?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R17. What does it mean to say that a nonce is a once-in-a-lifetime value? In whose lifetime? R18. Is the message integrity scheme based on HMAC susceptible to playback attacks? If so, how can a nonce be incorporated into the scheme to remove this susceptibility?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTIONS 8.5–8.8</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R19. Suppose that Bob receives a PGP message from Alice. How does Bob know for sure that Alice created the message (rather than, say, Trudy)? Does PGP use a MAC for message integrity?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">R20. In the SSL record, there is a field for SSL sequence numbers. True or false? R21. What is the purpose of the random nonces in the SSL handshake?</p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R22. Suppose an SSL session employs a block cipher with CBC. True or false: The server sends to the client the IV in the clear.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R23. Suppose Bob initiates a TCP connection to Trudy who is pretending to be Alice. During the handshake, Trudy sends Bob Alice’s certificate. In what step of the SSL handshake algorithm will Bob discover that he is not communicating with Alice?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R24. Consider sending a stream of packets from Host A to Host B using IPsec. Typically, a new SA will be established for each packet sent in the stream. True or false?</p><p class="s20" style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark739" class="s124">R25. Suppose that TCP is being run over IPsec between headquarters and the branch office in </a><a href="#bookmark739" class="a">Figure 8.28</a> <span class="p">. If TCP retransmits the same packet, then the two corresponding packets sent by R1 packets will have the same sequence number in the ESP header. True or false?</span></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R26. An IKE SA and an IPsec SA are the same thing. True or false?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R27. Consider WEP for 802.11. Suppose that the data is 10101100 and the keystream is 1111000. What is the resulting ciphertext?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R28. In WEP, an IV is sent in the clear in every frame. True or false?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 8.9</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R29. Stateful packet filters maintain two data structures. Name them and briefly describe what they do.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R30. Consider a traditional (stateless) packet filter. This packet filter may filter packets based on TCP flag bits as well as other header fields. True or false?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R31. In a traditional packet filter, each interface can have its own access control list. True or false?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;">R32. Why must an application gateway work in conjunction with a router filter to be effective? R33. Signature-based IDSs and IPSs inspect into the payloads of TCP and UDP segments. True or false?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Problems</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark677" class="s124">P1. Using the monoalphabetic cipher in </a><a href="#bookmark677" class="a">Figure 8.3</a> <span class="p">, encode the message “This is an easy problem.” Decode the message “rmij’u uamu xyj.”</span></p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">P2. Show that Trudy’s known-plaintext attack, in which she knows the (ciphertext, plaintext) translation pairs for seven letters, reduces the number of possible substitutions to be checked in</p><p class="s20" style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;"><a href="#bookmark681" class="s124">the example in </a><a href="#bookmark681" class="a">Section 8.2.1</a> <span class="p">by approximately 109.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark678" class="s124">P3. Consider the polyalphabetic system shown in </a><a href="#bookmark678" class="a">Figure 8.4</a> <span class="p">. Will a chosen-plaintext attack that is able to get the plaintext encoding of the message “The quick brown fox jumps over the lazy dog.” be sufficient to decode all messages? Why or why not?</span></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 140%;text-align: left;"><a href="#bookmark680" class="s124">P4. Consider the block cipher in </a><a href="#bookmark680" class="a">Figure 8.5</a><span class="s20"> </span>. Suppose that each block cipher <i>T</i><span class="s31">i </span>simply reverses the order of the eight input bits (so that, for example, 11110000 becomes 00001111). Further</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 127%;text-align: left;">suppose that the 64-bit scrambler does not modify any bits (so that the output value of the <i>m</i>th bit is equal to the input value of the <i>m</i>th bit). (a) With <span class="s27">n</span>=3 and the original 64-bit input equal to 10100000 repeated eight times, what is the value of the output? (b) Repeat part (a) but now</p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">change the last bit of the original 64-bit input from a 0 to a 1. (c) Repeat parts (a) and (b) but now suppose that the 64-bit scrambler inverses the order of the 64 bits.</p><p class="s20" style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark680" class="s124">P5. Consider the block cipher in </a><a href="#bookmark680" class="a">Figure 8.5</a> <span class="p">. For a given “key” Alice and Bob would need to keep eight tables, each 8 bits by 8 bits. For Alice (or Bob) to store all eight tables, how many bits of storage are necessary? How does this number compare with the number of bits required for a</span></p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">full-table 64-bit block cipher?</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark679" class="s124">P6. Consider the 3-bit block cipher in </a><a href="#bookmark679" class="a">Table 8.1</a> <span class="p">. Suppose the plaintext is 100100100. (a) Initially assume that CBC is not used. What is the resulting ciphertext? (b) Suppose Trudy sniffs the ciphertext. Assuming she knows that a 3-bit block cipher without CBC is being employed (but</span></p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">doesn’t know the specific cipher), what can she surmise? (c) Now suppose that CBC is used</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">with IV=111. What is the resulting ciphertext?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 126%;text-align: left;">P7. (a) Using RSA, choose <span class="s27">p</span>=3 and <span class="s27">q</span>=11, and encode the word “dog” by encrypting each letter separately. Apply the decryption algorithm to the encrypted version to recover the original</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 128%;text-align: left;">plaintext message. (b) Repeat part (a) but now encrypt “dog” as one message <i>m</i>. P8. Consider RSA with <span class="s27">p</span>=5 and <span class="s27">q</span>=11.</p><ol id="l357"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What are <i>n </i>and <i>z</i>?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Let <i>e </i>be 3. Why is this an acceptable choice for <i>e</i>?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Find <i>d </i>such that <span class="s27">d</span>e=1 (mod <i>z</i>) and <span class="s27">d</span>&lt;160.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 136%;text-align: left;"><p style="display: inline;">Encrypt the message <span class="s27">m</span>=8 using the key (<i>n</i>, <i>e</i>). Let <i>c </i>denote the corresponding ciphertext. Show all work. <i>Hint: </i>To simplify the calculations, use the fact:</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 16pt;text-align: center;">[ (a mod n)<span class="s29">⋅</span>(b mod n)]mod n=(a<span class="s29">⋅</span>b)modn</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P9. In this problem, we explore the Diffie-Hellman (DH) public-key encryption algorithm, which allows two entities to agree on a shared key. The DH algorithm makes use of a large prime</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 150%;text-align: left;">number <i>p </i>and another large number <i>g </i>less than <i>p</i>. Both <i>p </i>and <i>g </i>are made public (so that an attacker would know them). In DH, Alice and Bob each independently choose secret keys, <i>S</i><span class="s31">A </span>and <i>S</i><span class="s31">B</span>, respectively. Alice then computes her public key, <i>T</i><span class="s31">A</span>, by raising <i>g </i>to <i>S</i><span class="s31">A </span>and then taking mod <i>p</i>. Bob similarly computes his own public key <i>T</i><span class="s31">B </span>by raising <i>g </i>to <i>S</i><span class="s31">B </span>and then taking mod <i>p</i>. Alice and Bob then exchange their public keys over the Internet. Alice then calculates the shared</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">secret key <i>S </i>by raising <i>T</i><span class="s31">B </span>to <i>S</i><span class="s31">A </span>and then taking mod <i>p</i>. Similarly, Bob calculates the shared key</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">S<span class="p">′ by raising </span>T<span class="s31">A </span><span class="p">to </span>S<span class="s31">B </span><span class="p">and then taking mod </span>p<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><ol id="l358"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Prove that, in general, Alice and Bob obtain the same symmetric key, that is, prove <span class="s27">S=S</span>′.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 136%;text-align: left;"><p style="display: inline;">With <i>p </i>= 11 and <i>g </i>= 2, suppose Alice and Bob choose private keys <span class="s27">SA=</span>5 and <span class="s27">SB=</span>12, respectively. Calculate Alice’s and Bob’s public keys, <i>T</i><span class="s31">A </span>and <i>T</i><span class="s31">B</span>. Show all work.</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Following up on part (b), now calculate <i>S </i>as the shared symmetric key. Show all work.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Provide a timing diagram that shows how Diffie-Hellman can be attacked by a man-in- the-middle. The timing diagram should have three vertical lines, one for Alice, one for</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">Bob, and one for the attacker Trudy.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 144%;text-align: left;">P10. Suppose Alice wants to communicate with Bob using symmetric key cryptography using a session key <i>K</i><span class="s31">S</span><a href="#bookmark685" class="s124">. In </a><a href="#bookmark685" class="a">Section 8.2</a><span class="s20"> </span>, we learned how public-key cryptography can be used to distribute the session key from Alice to Bob. In this problem, we explore how the session key can be distributed—without public key cryptography—using a key distribution center (KDC). The KDC is a server that shares a unique secret symmetric key with each registered user. For Alice</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 148%;text-align: left;">and Bob, denote these keys by <i>K</i><span class="s31">A-KDC </span>and <i>K</i><span class="s31">B-KDC</span>. Design a scheme that uses the KDC to distribute <i>K</i><span class="s31">S </span>to Alice and Bob. Your scheme should use three messages to distribute the session key: a message from Alice to the KDC; a message from the KDC to Alice; and finally a message</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 156%;text-align: left;">from Alice to Bob. The first message is <i>K</i><span class="s31">A-KDC </span>(<i>A</i>, <i>B</i>). Using the notation, <i>K</i><span class="s31">A-KDC</span>, <i>K</i><span class="s31">B-KDC</span>, <i>S, A, and B </i>answer the following questions.</p><ol id="l359"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the second message?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the third message?</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark689" class="s124">P11. Compute a third message, different from the two messages in </a><a href="#bookmark689" class="a">Figure 8.8</a> <a href="#bookmark689" class="s124">, that has the same checksum as the messages in </a><a href="#bookmark689" class="a">Figure 8.8</a> <span class="p">.</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 156%;text-align: left;">P12. Suppose Alice and Bob share two secret keys: an authentication key <i>S</i><span class="s31">1 </span>and a symmetric encryption key <i>S</i><span class="s31">2</span><a href="#bookmark691" class="s124">. Augment </a><a href="#bookmark691" class="a">Figure 8.9</a><span class="s20"> </span><a href="#bookmark138" class="s124">so that both integrity and confidentiality are provided. P13. In the BitTorrent P2P file distribution protocol (see </a><a href="#bookmark138" class="a">Chapter 2</a><span class="s20"> </span>), the seed breaks the file into</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">blocks, and the peers redistribute the blocks to each other. Without any protection, an attacker</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">can easily wreak havoc in a torrent by masquerading as a benevolent peer and sending bogus blocks to a small subset of peers in the torrent. These unsuspecting peers then redistribute the bogus blocks to other peers, which in turn redistribute the bogus blocks to even more peers. Thus, it is critical for BitTorrent to have a mechanism that allows a peer to verify the integrity of a block, so that it doesn’t redistribute bogus blocks. Assume that when a peer joins a torrent, it</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">initially gets a .torrent file from a <i>fully </i>trusted source. Describe a simple scheme that allows peers to verify the integrity of blocks.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P14. The OSPF routing protocol uses a MAC rather than digital signatures to provide message integrity. Why do you think a MAC was chosen over digital signatures?</p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark713" class="s124">P15. Consider our authentication protocol in </a><a href="#bookmark713" class="a">Figure 8.18</a> <span class="p">in which Alice authenticates herself to Bob, which we saw works well (i.e., we found no flaws in it). Now suppose that while Alice is authenticating herself to Bob, Bob must authenticate himself to Alice. Give a scenario by which</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">Trudy, pretending to be Alice, can now authenticate herself to Bob as Alice. (<i>Hint</i>: Consider that the sequence of operations of the protocol, one with Trudy initiating and one with Bob initiating, can be arbitrarily interleaved. Pay particular attention to the fact that both Bob and Alice will use</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">a nonce, and that if care is not taken, the same nonce can be used maliciously.)</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;"><a href="#bookmark711" class="s124">P16. A natural question is whether we can use a nonce and public key cryptography to solve the end-point authentication problem in </a><a href="#bookmark711" class="a">Section 8.4</a><span class="s20"> </span>. Consider the following natural protocol: (1) Alice sends the message “ <span class="s30">I am Alice </span>” to Bob. (2) Bob chooses a nonce, <i>R</i>, and sends it to Alice. (3) Alice uses her <i>private </i>key to encrypt the nonce and sends the resulting value to Bob.</p><ol id="l360"><li style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><p style="display: inline;">Bob applies Alice’s public key to the received message. Thus, Bob computes <i>R </i>and authenticates Alice.</p><ol id="l361"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Diagram this protocol, using the notation for public and private keys employed in the textbook.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose that certificates are not used. Describe how Trudy can become a “woman-in- the-middle” by intercepting Alice’s messages and then pretending to be Alice to Bob.</p></li></ol></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark716" class="s124">P17. </a><a href="#bookmark716" class="a">Figure 8.19</a> <span class="p">shows the operations that Alice must perform with PGP to provide confidentiality, authentication, and integrity. Diagram the corresponding operations that Bob must perform on the package received from Alice.</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">P18. Suppose Alice wants to send an e-mail to Bob. Bob has a public-private key pair</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 133%;text-align: left;">(KB+,KB−), and Alice has Bob’s certificate. But Alice does not have a public, private key pair. Alice and Bob (and the entire world) share the same hash function H(<span class="s29">⋅</span>).</p><ol id="l362"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">In this situation, is it possible to design a scheme so that Bob can verify that Alice created the message? If so, show how with a block diagram for Alice and Bob.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Is it possible to design a scheme that provides confidentiality for sending the message from Alice to Bob? If so, show how with a block diagram for Alice and Bob.</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P19. Consider the Wireshark output below for a portion of an SSL session.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l363"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Is Wireshark packet 112 sent by the client or server?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the server’s IP address and port number?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Assuming no loss and no retransmissions, what will be the sequence number of the next TCP segment sent by the client?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">How many SSL records does Wireshark packet 112 contain?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Does packet 112 contain a Master Secret or an Encrypted Master Secret or neither?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -15pt;line-height: 125%;text-align: left;"><p style="display: inline;">Assuming that the handshake type field is 1 byte and each length field is 3 bytes, what are the values of the first and last bytes of the Master Secret (or Encrypted Master</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">Secret)?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The client encrypted handshake message takes into account how many SSL records?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">The server encrypted handshake message takes into account how many SSL records?</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark729" class="s124">P20. In </a><a href="#bookmark729" class="a">Section 8.6.1</a> <span class="p">, it is shown that without sequence numbers, Trudy (a woman-in-the middle) can wreak havoc in an SSL session by interchanging TCP segments. Can Trudy do something similar by deleting a TCP segment? What does she need to do to succeed at the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">deletion attack? What effect will it have?</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="717" height="501" alt="image" src="计算机网络自顶向下7th-en/Image_874.jpg"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">(Wireshark screenshot reprinted by permission of the Wireshark Foundation.)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P21. Suppose Alice and Bob are communicating over an SSL session. Suppose an attacker, who does not have any of the shared keys, inserts a bogus TCP segment into a packet stream with correct TCP checksum and sequence numbers (and correct IP addresses and port</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">numbers). Will SSL at the receiving side accept the bogus packet and pass the payload to the receiving application? Why or why not?</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark739" class="s124">P22. The following true/false questions pertain to </a><a href="#bookmark739" class="a">Figure 8.28</a> <span class="p">.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l364"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p class="s20" style="display: inline;"><a href="http://amazon.com/" class="s124" target="_blank">When a host in 172.16.1/24 sends a datagram to an </a><a href="http://amazon.com/" class="a" target="_blank">Amazon.com</a> <span class="p">server, the router R1 will encrypt the datagram using IPsec.</span></p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">When a host in 172.16.1/24 sends a datagram to a host in 172.16.2/24, the router R1 will change the source and destination address of the IP datagram.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose a host in 172.16.1/24 initiates a TCP connection to a Web server in 172.16.2/24. As part of this connection, all datagrams sent by R1 will have protocol</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">number 50 in the left-most IPv4 header field.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Consider sending a TCP segment from a host in 172.16.1/24 to a host in 172.16.2/24.</p></li></ol><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">Suppose the acknowledgment for this segment gets lost, so that TCP resends the segment. Because IPsec uses sequence numbers, R1 will not resend the TCP segment.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark739" class="s124">P23. Consider the example in </a><a href="#bookmark739" class="a">Figure 8.28</a> <span class="p">. Suppose Trudy is a woman-in-the-middle, who can insert datagrams into the stream of datagrams going from R1 and R2. As part of a replay attack, Trudy sends a duplicate copy of one of the datagrams sent from R1 to R2. Will R2 decrypt the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">duplicate datagram and forward it into the branch-office network? If not, describe in detail how R2 detects the duplicate datagram.</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">P24. Consider the following pseudo-WEP protocol. The key is 4 bits and the IV is 2 bits. The IV is appended to the end of the key when generating the keystream. Suppose that the shared secret key is 1010. The keystreams for the four possible inputs are as follows:</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">101000: 0010101101010101001011010100100 . . .</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">101001: 1010011011001010110100100101101 . . .</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">101010: 0001101000111100010100101001111 . . .</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">101011: 1111101010000000101010100010111 . . .</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">Suppose all messages are 8 bits long. Suppose the ICV (integrity check) is 4 bits long, and is calculated by XOR-ing the first 4 bits of data with the last 4 bits of data. Suppose the pseudo- WEP packet consists of three fields: first the IV field, then the message field, and last the ICV field, with some of these fields encrypted.</p><ol id="l365"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 124%;text-align: left;"><p style="display: inline;">We want to send the message <span class="s27">m</span>=10100000 using the <span class="s27">IV=</span>11 and using WEP. What will be the values in the three WEP fields?</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Show that when the receiver decrypts the WEP packet, it recovers the message and the ICV.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 124%;text-align: left;"><p style="display: inline;">Suppose Trudy intercepts a WEP packet (not necessarily with the <span class="s27">IV=</span>11) and wants to modify it before forwarding it to the receiver. Suppose Trudy flips the first ICV bit.</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">Assuming that Trudy does not know the keystreams for any of the IVs, what other bit(s) must Trudy also flip so that the received packet passes the ICV check?</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Justify your answer by modifying the bits in the WEP packet in part (a), decrypting the resulting packet, and verifying the integrity check.</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">P25. Provide a filter table and a connection table for a stateful firewall that is as restrictive as possible but accomplishes the following:</p><ol id="l366"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Allows all internal users to establish Telnet sessions with external hosts.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Allows external users to surf the company Web site at 222.22.0.12.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">But otherwise blocks all inbound and outbound traffic.</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">The internal network is 222.22/16. In your solution, suppose that the connection table is currently caching three connections, all from inside to outside. You’ll need to invent appropriate IP addresses and port numbers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="http://activist.com/" class="s124" target="_blank">P26. Suppose Alice wants to visit the Web site </a><a href="http://activist.com/" class="a" target="_blank">activist.com</a> <span class="p">using a TOR-like service. This service uses two non-colluding proxy servers, Proxy1 and Proxy2. Alice first obtains the</span></p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">certificates (each containing a public key) for Proxy1 and Proxy2 from some central server. Denote K1+(),K2+(),K1−(), and K2−() for the encryption/decryption with public and private RSA keys.</p><ol id="l367"><li style="padding-top: 1pt;padding-left: 91pt;text-indent: -18pt;line-height: 147%;text-align: left;"><p style="display: inline;">Using a timing diagram, provide a protocol (as simple as possible) that enables Alice to establish a shared session key <i>S</i><span class="s22">1  </span>with Proxy1. Denote <i>S</i><span class="s22">1</span>(<i>m</i>) for encryption/decryption of data <i>m </i>with the shared key <i>S</i><span class="s22">1</span>.</p></li><li style="padding-left: 91pt;text-indent: -18pt;line-height: 147%;text-align: left;"><p style="display: inline;">Using a timing diagram, provide a protocol (as simple as possible) that allows Alice to establish a shared session key <i>S</i><span class="s22">2 </span>with Proxy2 <i>without revealing her IP address to Proxy2</i>.</p></li><li style="padding-left: 91pt;text-indent: -18pt;line-height: 15pt;text-align: left;"><p style="display: inline;">Assume now that shared keys <i>S</i><span class="s22">1 </span>and <i>S</i><span class="s22">2 </span>are now established. Using a timing diagram,</p></li></ol></li></ol><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 91pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">provide a protocol (as simple as possible and </span>not using public-key cryptography<a href="http://activist.com/" class="s124" target="_blank">) that allows Alice to request an html page from </a><a href="http://activist.com/" class="a" target="_blank">activist.com</a><span class="s20"> </span>without revealing her IP address to Proxy2 <span class="p">and </span>without revealing to Proxy1 which site she is visiting<a href="http://activist.com/" class="s124" target="_blank">. Your diagram should end with an HTTP request arriving at </a><a href="http://activist.com/" class="a" target="_blank">activist.co</a><span class="s20">m</span><span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark770">Wireshark Lab</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark731" class="s124">In this lab (available from the book Web site), we investigate the Secure Sockets Layer (SSL) protocol. Recall from </a><a href="#bookmark731" class="a">Section 8.6</a> <span class="p">that SSL is used for securing a TCP connection, and that it is extensively used</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">in practice for secure Internet transactions. In this lab, we will focus on the SSL records sent over the TCP connection. We will attempt to delineate and classify each of the records, with a goal of understanding the why and how for each record. We investigate the various SSL record types as well as the fields in the SSL messages. We do so by analyzing a trace of the SSL records sent between your host and an e-commerce server.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark771">IPsec Lab</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this lab (available from the book Web site), we will explore how to create IPsec SAs between linux boxes. You can do the first part of the lab with two ordinary linux boxes, each with one Ethernet adapter. But for the second part of the lab, you will need four linux boxes, two of which having two Ethernet adapters. In the second half of the lab, you will create IPsec SAs using the ESP protocol in the tunnel mode. You will do this by first manually creating the SAs, and then by having IKE create the SAs.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="199" alt="image" src="计算机网络自顶向下7th-en/Image_875.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">AN INTERVIEW WITH…</p><p class="s28" style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Steven M. Bellovin</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Steven M. Bellovin joined the faculty at Columbia University after many years at the Network Services Research Lab at AT&amp;T Labs Research in Florham Park, New Jersey. His focus is on networks, security, and why the two are incompatible. In 1995, he was awarded the Usenix Lifetime Achievement Award for his work in the creation of Usenet, the first newsgroup exchange network that linked two or more computers and allowed users to share information</p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_876.png"/></span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">and join in discussions. Steve is also an elected member of the National Academy of Engineering. He received his BA from Columbia University and his PhD from the University of North Carolina at Chapel Hill.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="728" height="1097" alt="image" src="计算机网络自顶向下7th-en/Image_877.gif"/></span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_878.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_879.png"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s26" style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">What led you to specialize in the networking security area?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">This is going to sound odd, but the answer is simple: It was fun. My background was in systems programming and systems administration, which leads fairly naturally to security. And I’ve always been interested in communications, ranging back to part-time systems programming jobs when I was in college.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">My work on security continues to be motivated by two things—a desire to keep computers useful, which means that their function can’t be corrupted by attackers, and a desire to protect privacy.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What was your vision for Usenet at the time that you were developing it? And now?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">We originally viewed it as a way to talk about computer science and computer programming around the country, with a lot of local use for administrative matters, for-sale ads, and so on. In fact, my original prediction was one to two messages per day, from 50–100 sites at the most— ever. But the real growth was in people-related topics, including—but not limited to—human interactions with computers. My favorite newsgroups, over the years, have been things like rec.woodworking, as well as sci.crypt.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">To some extent, netnews has been displaced by the Web. Were I to start designing it today, it would look very different. But it still excels as a way to reach a very broad audience that is interested in the topic, without having to rely on particular Web sites.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Has anyone inspired you professionally? In what ways?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 153%;text-align: left;">Professor Fred Brooks—the founder and original chair of the computer science department at the University of North Carolina at Chapel Hill, the manager of the team that developed the IBM S/360 and OS/360, and the author of <i>The Mythical Man-Month</i>—was a tremendous influence on</p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 11pt;text-align: left;">my career. More than anything else, he taught outlook and trade-offs—how to look at problems</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: justify;">in the context of the real world (and how much messier the real world is than a theorist would like), and how to balance competing interests in designing a solution. Most computer work is engineering—the art of making the right trade-offs to satisfy many contradictory objectives.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What is your vision for the future of networking and security?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Thus far, much of the security we have has come from isolation. A firewall, for example, works by cutting off access to certain machines and services. But we’re in an era of increasing connectivity—it’s gotten harder to isolate things. Worse yet, our production systems require far more separate pieces, interconnected by networks. Securing all that is one of our biggest challenges.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="470" alt="image" src="计算机网络自顶向下7th-en/Image_880.png"/></span></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><a name="bookmark772">What would you say have been the greatest advances in security? How much further do we</a><a name="bookmark773">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">have to go?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">At least scientifically, we know how to do cryptography. That’s been a big help. But most security problems are due to buggy code, and that’s a much harder problem. In fact, it’s the oldest unsolved problem in computer science, and I think it will remain that way. The challenge is figuring out how to secure systems when we have to build them out of insecure components. We can already do that for reliability in the face of hardware failures; can we do the same for security?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Do you have any advice for students about the Internet and networking security?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: justify;">Learning the mechanisms is the easy part. Learning how to “think paranoid” is harder. You have to remember that probability distributions don’t apply—the attackers can and will find improbable conditions. And the details matter—a lot.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="783" height="2" alt="image" src="计算机网络自顶向下7th-en/Image_881.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s16" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark774">Chapter </a><span class="h1">9 </span>Multimedia Networking<a name="bookmark775">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="790" height="1" alt="image" src="计算机网络自顶向下7th-en/Image_882.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">While lounging in bed or riding buses and subways, people in all corners of the world are currently using the Internet to watch movies and television shows on demand. Internet movie and television distribution companies such as Netflix and Amazon in North America and Youku and Kankan in China have practically become household names. But people are not only watching Internet videos, they are using sites like YouTube to upload and distribute their own user-generated content, becoming Internet video producers as well as consumers. Moreover, network applications such as Skype, Google Talk, and WeChat (enormously popular in China) allow people to not only make “telephone calls” over the Internet, but to also enhance those calls with video and multi-person conferencing. In fact, we predict that by the end of the current decade most of the video consumption and voice conversations will take place end-to-end over the Internet, more typically to wireless devices connected to the Internet via cellular and WiFi access networks. Traditional telephony and broadcast television are quickly becoming obsolete.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark781" class="s124">We begin this chapter with a taxonomy of multimedia applications in </a><a href="#bookmark781" class="a">Section 9.</a><span class="s20">1</span>. We’ll see that a multimedia application can be classified as either <i>streaming stored audio/video</i>, <i>conversational voice/video-over-IP</i>, or <i>streaming live audio/video</i>. We’ll see that each of these classes of applications</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">has its own unique service requirements that differ significantly from those of traditional elastic</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark788" class="s124">applications such as e-mail, Web browsing, and remote login. In </a><a href="#bookmark788" class="a">Section 9.</a>2<span class="p">, we’ll examine video streaming in some detail. We’ll explore many of the underlying principles behind video streaming,</span></p><p class="s20" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark799" class="s124">including client buffering, prefetching, and adapting video quality to available bandwidth. In </a><a href="#bookmark799" class="a">Section 9.</a>3<span class="p">, we investigate conversational voice and video, which, unlike elastic applications, are highly sensitive to end-to-end delay but can tolerate occasional loss of data. Here we’ll examine how techniques such as</span></p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark809" class="s124">adaptive playout, forward error correction, and error concealment can mitigate against network-induced packet loss and delay. We’ll also examine Skype as a case study. In </a><a href="#bookmark809" class="a">Section 9.</a>4<a href="#bookmark827" class="s124">, we’ll study RTP and SIP, two popular protocols for real-time conversational voice and video applications. In </a><a href="#bookmark827" class="a">Section 9.</a>5<span class="p">,</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">we’ll investigate mechanisms within the network that can be used to distinguish one class of traffic (e.g.,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">delay-sensitive applications such as conversational voice) from another (e.g., elastic applications such as browsing Web pages), and provide differentiated service among multiple classes of traffic.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l368"><ol id="l369"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark776">Multimedia Networking Applications</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We define a multimedia network application as any network application that employs audio or video. In this section, we provide a taxonomy of multimedia applications. We’ll see that each class of applications in the taxonomy has its own unique set of service requirements and design issues. But before diving into an in-depth discussion of Internet multimedia applications, it is useful to consider the intrinsic characteristics of the audio and video media themselves.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l370"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Properties of Video</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Perhaps the most salient characteristic of video is its <span class="s20">high bit rate</span>. Video distributed over the Internet typically ranges from 100 kbps for low-quality video conferencing to over 3 Mbps for streaming high- definition movies. To get a sense of how video bandwidth demands compare with those of other Internet applications, let’s briefly consider three different users, each using a different Internet application. Our first user, Frank, is going quickly through photos posted on his friends’ Facebook pages. Let’s assume that Frank is looking at a new photo every 10 seconds, and that photos are on average 200 Kbytes in size. (As usual, throughout this discussion we make the simplifying assumption that 1 Kbyte=8,000 bits.) Our second user, Martha, is streaming music from the Internet (“the cloud”) to her smartphone. Let’s assume Martha is using a service such as Spotify to listen to many MP3 songs, one after the other, each encoded at a rate of 128 kbps. Our third user, Victor, is watching a video that has been encoded at 2 Mbps. Finally, let’s suppose that the session length for all three users is 4,000 seconds (approximately</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark777" class="s124">67 minutes). </a><a href="#bookmark777" class="a">Table 9.1</a> <span class="p">compares the bit rates and the total bytes transferred for these three users. We see that video streaming consumes by far the most bandwidth, having a bit rate of more than ten times greater than that of the Facebook and music-streaming applications. Therefore, when design</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark777">Table 9.1 Comparison of bit-rate requirements of three Internet applications</a></h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"/><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Bit rate</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Bytes transferred in 67 min</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Facebook Frank</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">160 kbps</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">80 Mbytes</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Martha Music</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">128 kbps</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">64 Mbytes</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Victor Video</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2 Mbps</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">1 Gbyte</p></td></tr></table><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark778">ing networked video applications, the first thing we must keep in mind is the high bit-rate requirements of video. Given the popularity of video and its high bit rate, it is perhaps not surprising that Cisco predicts </a><a href="#bookmark848" class="a">[Cisco 2015]</a> <span class="p">that streaming and stored video will be approximately 80 percent of global consumer</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">Internet traffic by 2019.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 145%;text-align: left;">Another important characteristic of video is that it can be compressed, thereby trading off video quality with bit rate. A video is a sequence of images, typically being displayed at a constant rate, for example, at 24 or 30 images per second. An uncompressed, digitally encoded image consists of an array of pixels, with each pixel encoded into a number of bits to represent luminance and color. There are two types of redundancy in video, both of which can be exploited by <span class="s23">video</span><span class="s20"> compression</span>. <i>Spatial redundancy </i>is the redundancy within a given image. Intuitively, an image that consists of mostly white</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">space has a high degree of redundancy and can be efficiently compressed without significantly</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;">sacrificing image quality. <i>Temporal redundancy </i>reflects repetition from image to subsequent image. If, for example, an image and the subsequent image are exactly the same, there is no reason to re-encode the subsequent image; it is instead more efficient simply to indicate during encoding that the subsequent</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">image is exactly the same. Today’s off-the-shelf compression algorithms can compress a video to essentially any bit rate desired. Of course, the higher the bit rate, the better the image quality and the better the overall user viewing experience.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We can also use compression to create <span class="s20">multiple versions </span>of the same video, each at a different quality level. For example, we can use compression to create, say, three versions of the same video, at rates of 300 kbps, 1 Mbps, and 3 Mbps. Users can then decide which version they want to watch as a function of their current available bandwidth. Users with high-speed Internet connections might choose the 3 Mbps version; users watching the video over 3G with a smartphone might choose the 300 kbps version. Similarly, the video in a video conference application can be compressed “on-the-fly” to provide the best video quality given the available end-to-end bandwidth between conversing users.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Properties of Audio</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Digital audio (including digitized speech and music) has significantly lower bandwidth requirements than video. Digital audio, however, has its own unique properties that must be considered when designing multimedia network applications. To understand these properties, let’s first consider how analog audio (which humans and musical instruments generate) is converted to a digital signal:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_883.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">The analog audio signal is sampled at some fixed rate, for example, at 8,000 samples per second. The value of each sample will be some real number.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_884.png"/></span></p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">Each of the samples is then rounded to one of a finite number of values. This operation is referred to as <span class="s20">quantization</span>. The number of such finite values—called quantization values—is typically a power</p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark779">of two, for example, 256 quantization values.</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_885.png"/></span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;">Each of the quantization values is represented by a fixed number of bits. For example, if there are 256 quantization values, then each value—and hence each audio sample—is represented by one byte. The bit representations of all the samples are then concatenated together to form the digital</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">representation of the signal. As an example, if an analog audio signal is sampled at 8,000 samples per second and each sample is quantized and represented by 8 bits, then the resulting digital signal will have a rate of 64,000 bits per second. For playback through audio speakers, the digital signal can then be converted back—that is, decoded—to an analog signal. However, the decoded analog signal is only an approximation of the original signal, and the sound quality may be noticeably degraded (for example, high-frequency sounds may be missing in the decoded signal). By increasing the sampling rate and the number of quantization values, the decoded signal can better approximate the original analog signal. Thus (as with video), there is a trade-off between the quality of the decoded signal and the bit-rate and storage requirements of the digital signal.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The basic encoding technique that we just described is called <span class="s20">pulse code modulation (PCM)</span>. Speech encoding often uses PCM, with a sampling rate of 8,000 samples per second and 8 bits per sample, resulting in a rate of 64 kbps. The audio compact disk (CD) also uses PCM, with a sampling rate of 44,100 samples per second with 16 bits per sample; this gives a rate of 705.6 kbps for mono and 1.411 Mbps for stereo.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">PCM-encoded speech and music, however, are rarely used in the Internet. Instead, as with video, compression techniques are used to reduce the bit rates of the stream. Human speech can be compressed to less than 10 kbps and still be intelligible. A popular compression technique for near CD- quality stereo music is <span class="s20">MPEG 1 layer 3</span>, more commonly known as <span class="s20">MP3</span>. MP3 encoders can compress to many different rates; 128 kbps is the most common encoding rate and produces very little sound degradation. A related standard is <span class="s20">Advanced Audio Coding (AAC)</span>, which has been popularized by Apple. As with video, multiple versions of a prerecorded audio stream can be created, each at a different bit rate.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although audio bit rates are generally much less than those of video, users are generally much more sensitive to audio glitches than video glitches. Consider, for example, a video conference taking place over the Internet. If, from time to time, the video signal is lost for a few seconds, the video conference can likely proceed without too much user frustration. If, however, the audio signal is frequently lost, the users may have to terminate the session.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Types of Multimedia Network Applications</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">The Internet supports a large variety of useful and entertaining multimedia applications. In this subsection, we classify multimedia applications into three broad categories: <i>(i) streaming stored</i></p><p class="s17" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">audio/video<span class="p">, </span>(ii) conversational voice/video-over-IP<span class="p">, and </span>(iii) streaming live audio/video<span class="p">. As we will soon see, each of these application categories has its own set of service requirements and design issues.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: justify;">Streaming Stored Audio and Video</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">To keep the discussion concrete, we focus here on streaming stored video, which typically combines video and audio components. Streaming stored audio (such as Spotify’s streaming music service) is very similar to streaming stored video, although the bit rates are typically much lower.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">In this class of applications, the underlying medium is prerecorded video, such as a movie, a television show, a prerecorded sporting event, or a prerecorded user-generated video (such as those commonly seen on YouTube). These prerecorded videos are placed on servers, and users send requests to the</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">servers to view the videos <i>on demand</i>. Many Internet companies today provide streaming video, including YouTube (Google), Netflix, Amazon, and Hulu. Streaming stored video has three key distinguishing features.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_886.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Streaming. <span class="p">In a streaming stored video application, the client typically begins video playout within a few seconds after it begins receiving the video from the server. This means that the client will be playing out from one location in the video while at the same time receiving later parts of the video</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">from the server. This technique, known as <span class="s20">streaming</span>, avoids having to download the entire video file (and incurring a potentially long delay) before playout begins.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_887.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Interactivity. <span class="p">Because the media is prerecorded, the user may pause, reposition forward, reposition backward, fast-forward, and so on through the video content. The time from when the user makes such a request until the action manifests itself at the client should be less than a few seconds for</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">acceptable responsiveness.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_888.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Continuous playout. <span class="p">Once playout of the video begins, it should proceed according to the original timing of the recording. Therefore, data must be received from the server in time for its playout at the client; otherwise, users experience video frame freezing (when the client waits for the delayed</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">frames) or frame skipping (when the client skips over delayed frames).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark788" class="s124">By far, the most important performance measure for streaming video is average throughput. In order to provide continuous playout, the network must provide an average throughput to the streaming application that is at least as large the bit rate of the video itself. As we will see in </a><a href="#bookmark788" class="a">Section 9.</a>2<span class="p">, by using</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">buffering and prefetching, it is possible to provide continuous playout even when the throughput</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">fluctuates, as long as the average throughput (averaged over 5–10 seconds) remains above the video rate </a><a href="#bookmark848" class="a">[Wang 2008</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">For many streaming video applications, prerecorded video is stored on, and streamed from, a CDN rather than from a single data center. There are also many P2P video streaming applications for which the video is stored on users’ hosts (peers), with different chunks of video arriving from different peers</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">that may spread around the globe. Given the prominence of Internet video streaming, we will explore</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark788" class="s124">video streaming in some depth in </a><a href="#bookmark788" class="a">Section 9.</a>2<span class="p">, paying particular attention to client buffering, prefetching, adapting quality to bandwidth availability, and CDN distribution.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Conversational Voice- and Video-over-IP</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Real-time conversational voice over the Internet is often referred to as <span class="s20">Internet telephony</span>, since, from the user’s perspective, it is similar to the traditional circuit-switched telephone service. It is also commonly called <span class="s20">Voice-over-IP (VoIP)</span>. Conversational video is similar, except that it includes the video of the participants as well as their voices. Most of today’s voice and video conversational systems allow users to create conferences with three or more participants. Conversational voice and video are widely used in the Internet today, with the Internet companies Skype, QQ, and Google Talk boasting hundreds of millions of daily users.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark138" class="s124">In our discussion of application service requirements in </a><a href="#bookmark138" class="a">Chapter 2</a> <a href="#bookmark150" class="s124">(</a><a href="#bookmark150" class="a">Figure 2.</a>4<span class="p">), we identified a number of axes along which application requirements can be classified. Two of these axes—timing considerations and tolerance of data loss—are particularly important for conversational voice and video</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">applications. Timing considerations are important because audio and video conversational applications are highly <span class="s20">delay-sensitive</span>. For a conversation with two or more interacting speakers, the delay from when a user speaks or moves until the action is manifested at the other end should be less than a few hundred milliseconds. For voice, delays smaller than 150 milliseconds are not perceived by a human listener, delays between 150 and 400 milliseconds can be acceptable, and delays exceeding 400 milliseconds can result in frustrating, if not completely unintelligible, voice conversations.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">On the other hand, conversational multimedia applications are <span class="s20">loss-tolerant</span>—occasional loss only causes occasional glitches in audio/video playback, and these losses can often be partially or fully concealed. These delay-sensitive but loss-tolerant characteristics are clearly different from those of elastic data applications such as Web browsing, e-mail, social networks, and remote login. For elastic applications, long delays are annoying but not particularly harmful; the completeness and integrity of the transferred data, however, are of paramount importance. We will explore conversational voice and video</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark799" class="s124" name="bookmark780">in more depth in </a><a href="#bookmark799" class="a">Section 9.</a>3<span class="p">, paying particular attention to how adaptive playout, forward error correction, and error concealment can mitigate against network-induced packet loss and delay.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Streaming Live Audio and Video</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;">This third class of applications is similar to traditional broadcast radio and television, except that transmission takes place over the Internet. These applications allow a user to receive a <i>live </i>radio or</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">television transmission—such as a live sporting event or an ongoing news event—transmitted from any corner of the world. Today, thousands of radio and television stations around the world are broadcasting content over the Internet.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark781">Live, broadcast-like applications often have many users who receive the same audio/video program at</a><a name="bookmark782">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark228" class="s124">the same time. In the Internet today, this is typically done with CDNs (</a><a href="#bookmark228" class="a">Section 2.</a>6<span class="p">). As with streaming stored multimedia, the network must provide each live multimedia flow with an average throughput that is larger than the video consumption rate. Because the event is live, delay can also be an issue,</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">although the timing constraints are much less stringent than those for conversational voice. Delays of up to ten seconds or so from when the user chooses to view a live transmission to when playout begins can be tolerated. We will not cover streaming live media in this book because many of the techniques used for streaming live media—initial buffering delay, adaptive bandwidth use, and CDN distribution—are similar to those for streaming stored media.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li></ol></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark783">Streaming Stored Video</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">For streaming video applications, prerecorded videos are placed on servers, and users send requests to these servers to view the videos on demand. The user may watch the video from beginning to end without interruption, may stop watching the video well before it ends, or interact with the video by pausing or repositioning to a future or past scene. Streaming video systems can be classified into three <span class="s49">categories:</span> <span class="s20">UDP streaming</span><span class="s49">,</span> <span class="s20">HTTP streaming</span><span class="s49">,</span> and <span class="s20">adaptive HTTP streaming </span><span class="s49">(see</span><a href="#bookmark228" class="s124"> </a><a href="#bookmark228" class="a">Section 2.</a><span class="s20">6</span>).</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">Although all three types of systems are used in practice, the majority of today’s systems employ HTTP</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">streaming and adaptive HTTP streaming.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A common characteristic of all three forms of video streaming is the extensive use of client-side application buffering to mitigate the effects of varying end-to-end delays and varying amounts of available bandwidth between server and client. For streaming video (both stored and live), users generally can tolerate a small several-second initial delay between when the client requests a video and when video playout begins at the client. Consequently, when the video starts to arrive at the client, the client need not immediately begin playout, but can instead build up a reserve of video in an application buffer. Once the client has built up a reserve of several seconds of buffered-but-not-yet-played video, the client can then begin video playout. There are two important advantages provided by such <span class="s20">client buffering</span>. First, client-side buffering can absorb variations in server-to-client delay. If a particular piece of video data is delayed, as long as it arrives before the reserve of received-but-not-yet-played video is exhausted, this long delay will not be noticed. Second, if the server-to-client bandwidth briefly drops below the video consumption rate, a user can continue to enjoy continuous playback, again as long as the client application buffer does not become completely drained.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;"><a href="#bookmark784" class="a">Figure 9.1</a><span class="s20"> </span>illustrates client-side buffering. In this simple example, suppose that video is encoded at a fixed bit rate, and thus each video block contains video frames that are to be played out over the same fixed amount of time, Δ. The server transmits the first video block at <i>t</i><span class="s22">0</span>, the second block at <span class="s27">t</span>0+Δ, the third block at t0+2Δ, and so on. Once the client begins playout, each block should be played out Δ time units after the previous block in order to reproduce the timing of the original recorded video. Because of the variable end-to-end network delays, different video blocks experience different delays. The first</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 143%;text-align: left;">video block arrives at the client at <i>t</i><span class="s22">1 </span>and the second block arrives at <i>t</i><span class="s22">2</span>. The network delay for the <i>i</i>th block is the horizontal distance between the time the block was transmitted by the server and the time it is received at the client; note that the network delay varies from one video block to another. In this</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 143%;text-align: left;">example, if the client were to begin playout as soon as the first block arrived at <i>t</i><span class="s22">1</span>, then the second block would not have arrived in time to be played out at out at t1+Δ. In this case, video playout would either have to stall (waiting for block 2 to arrive) or block 2 could be skipped—both resulting in undesirable</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 156%;text-align: left;">playout impairments. Instead, if the client were to delay the start of playout until <i>t</i><span class="s22">3</span>, when blocks 1 through 6 have all arrived, periodic playout can proceed with <i>all </i>blocks having been received before</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">their playout time.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="671" height="323" alt="image" src="计算机网络自顶向下7th-en/Image_889.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark784">Figure 9.1 Client playout delay in video streaming</a></h2><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l371"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">UDP Streaming</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We only briefly discuss UDP streaming here, referring the reader to more in-depth discussions of the protocols behind these systems where appropriate. With UDP streaming, the server transmits video at a rate that matches the client’s video consumption rate by clocking out the video chunks over UDP at a steady rate. For example, if the video consumption rate is 2 Mbps and each UDP packet carries 8,000 bits of video, then the server would transmit one UDP packet into its socket every</p><p class="s27" style="padding-left: 5pt;text-indent: 0pt;line-height: 17pt;text-align: left;">(8000<a href="#bookmark254" class="s124"> bits)/(2 Mbps)=4 msec. As we learned in </a><a href="#bookmark254" class="a">Chapter </a><span class="s20">3</span><span class="p">, because UDP does not employ a</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">congestion-control mechanism, the server can push packets into the network at the consumption rate of the video without the rate-control restrictions of TCP. UDP streaming typically uses a small client-side buffer, big enough to hold less than a second of video.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">Before passing the video chunks to UDP, the server will encapsulate the video chunks within transport packets specially designed for transporting audio and video, using the Real-Time Transport Protocol (RTP) </a><a href="#bookmark848" class="a">[RFC 3550]</a> <span class="p">or a similar (possibly proprietary) scheme. We delay our coverage of RTP until</span></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;"><a href="#bookmark799" class="a">Section 9.</a>3<span class="p">, where we discuss RTP in the context of conversational voice and video systems.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">Another distinguishing property of UDP streaming is that in addition to the server-to-client video stream, the client and server also maintain, in parallel, a separate control connection over which the client sends commands regarding session state changes (such as pause, resume, reposition, and so on). The Real-</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark785">Time Streaming Protocol (RTSP) </a><a href="#bookmark848" class="a">[RFC </a>2326]<span class="p">, explained in some detail in the Web site for this textbook, is a popular open protocol for such a control connection.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Although UDP streaming has been employed in many open-source systems and proprietary products, it suffers from three significant drawbacks. First, due to the unpredictable and varying amount of available bandwidth between server and client, constant-rate UDP streaming can fail to provide continuous playout. For example, consider the scenario where the video consumption rate is 1 Mbps and the server-to-client available bandwidth is usually more than 1 Mbps, but every few minutes the available bandwidth drops below 1 Mbps for several seconds. In such a scenario, a UDP streaming system that</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">transmits video at a constant rate of 1 Mbps over RTP/UDP would likely provide a poor user experience, with freezing or skipped frames soon after the available bandwidth falls below 1 Mbps. The second drawback of UDP streaming is that it requires a media control server, such as an RTSP server, to process client-to-server interactivity requests and to track client state (e.g., the client’s playout point in</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: justify;">the video, whether the video is being paused or played, and so on) for <i>each </i>ongoing client session. This increases the overall cost and complexity of deploying a large-scale video-on-demand system. The third drawback is that many firewalls are configured to block UDP traffic, preventing the users behind these</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">firewalls from receiving UDP video.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">HTTP Streaming</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In HTTP streaming, the video is simply stored in an HTTP server as an ordinary file with a specific URL. When a user wants to see the video, the client establishes a TCP connection with the server and issues an HTTP GET request for that URL. The server then sends the video file, within an HTTP response message, as quickly as possible, that is, as quickly as TCP congestion control and flow control will allow. On the client side, the bytes are collected in a client application buffer. Once the number of bytes in this buffer exceeds a predetermined threshold, the client application begins playback—specifically, it periodically grabs video frames from the client application buffer, decompresses the frames, and displays them on the user’s screen.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark254" class="s124">We learned in </a><a href="#bookmark254" class="a">Chapter 3</a> <span class="p">that when transferring a file over TCP, the server-to-client transmission rate can vary significantly due to TCP’s congestion control mechanism. In particular, it is not uncommon for the transmission rate to vary in a “saw-tooth” manner associated with TCP congestion control.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Furthermore, packets can also be significantly delayed due to TCP’s retransmission mechanism. Because of these characteristics of TCP, the conventional wisdom in the 1990s was that video streaming would never work well over TCP. Over time, however, designers of streaming video systems learned that TCP’s congestion control and reliable-data transfer mechanisms do not necessarily preclude continuous playout when client buffering and prefetching (discussed in the next section) are used.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The use of HTTP over TCP also allows the video to traverse firewalls and NATs more easily (which are often configured to block most UDP traffic but to allow most HTTP traffic). Streaming over HTTP also obviates the need for a media control server, such as an RTSP server, reducing the cost of a large- scale deployment over the Internet. Due to all of these advantages, most video streaming applications today—including YouTube and Netflix—use HTTP streaming (over TCP) as its underlying streaming protocol.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Prefetching Video</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark784" class="s124">As we just learned, client-side buffering can be used to mitigate the effects of varying end-to-end delays and varying available bandwidth. In our earlier example in </a><a href="#bookmark784" class="a">Figure 9.</a><span class="s20">1</span>, the server transmits video at the rate at which the video is to be played out. However, for streaming <i>stored </i>video, the client can attempt</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">to download the video at a rate <i>higher </i>than the consumption rate, thereby <span class="s23">prefetching</span><span class="s20"> </span>video frames that</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">are to be consumed in the future. This prefetched video is naturally stored in the client application buffer. Such prefetching occurs naturally with TCP streaming, since TCP’s congestion avoidance mechanism will attempt to use all of the available bandwidth between server and client.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To gain some insight into prefetching, let’s take a look at a simple example. Suppose the video consumption rate is 1 Mbps but the network is capable of delivering the video from server to client at a constant rate of 1.5 Mbps. Then the client will not only be able to play out the video with a very small playout delay, but will also be able to increase the amount of buffered video data by 500 Kbits every second. In this manner, if in the future the client receives data at a rate of less than 1 Mbps for a brief period of time, the client will be able to continue to provide continuous playback due to the reserve in its</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">buffer. </a><a href="#bookmark848" class="a">[Wang 2008]</a> <span class="p">shows that when the average TCP throughput is roughly twice the media bit rate, streaming over TCP results in minimal starvation and low buffering delays.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Client Application Buffer and TCP Buffers</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark786" class="a">Figure 9.2</a> <span class="p">illustrates the interaction between client and server for HTTP streaming. At the server side, the portion of the video file in white has already been sent into the server’s socket, while the darkened portion is what remains to be sent. After “passing through the socket door,” the bytes are placed in the</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark254" class="s124">TCP send buffer before being transmitted into the Internet, as described in </a><a href="#bookmark254" class="a">Chapter </a>3<a href="#bookmark786" class="s124">. In </a><a href="#bookmark786" class="a">Figure 9.</a>2<span class="p">, because the TCP send buffer at the server side is shown to be full, the server is momentarily prevented from sending more bytes from the video file into the socket. On the client side, the client application</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">(media player) reads bytes from the TCP receive buffer (through its client socket) and places the bytes into the client application buffer. At the same time, the client application periodically grabs video frames from the client application buffer, decompresses the frames, and displays them on the user’s screen. Note that if the client application buffer is larger than the video file, then the whole process of moving bytes from the server’s storage to the client’s application buffer is equivalent to an ordinary file download over HTTP—the client simply pulls the video off the server as fast as TCP will allow!</p><p style="padding-top: 5pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="780" height="338" alt="image" src="计算机网络自顶向下7th-en/Image_890.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark786">Figure 9.2 Streaming stored video over HTTP/TCP</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Consider now what happens when the user pauses the video during the streaming process. During the pause period, bits are not removed from the client application buffer, even though bits continue to enter the buffer from the server. If the client application buffer is finite, it may eventually become full, which will cause “back pressure” all the way back to the server. Specifically, once the client application buffer becomes full, bytes can no longer be removed from the client TCP receive buffer, so it too becomes full. Once the client receive TCP buffer becomes full, bytes can no longer be removed from the server TCP send buffer, so it also becomes full. Once the TCP becomes full, the server cannot send any more bytes into the socket. Thus, if the user pauses the video, the server may be forced to stop transmitting, in which case the server will be blocked until the user resumes the video.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">In fact, even during regular playback (that is, without pausing), if the client application buffer becomes full, back pressure will cause the TCP buffers to become full, which will force the server to reduce its rate. To determine the resulting rate, note that when the client application removes <i>f </i>bits, it creates room</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">for <i>f </i>bits in the client application buffer, which in turn allows the server to send <i>f </i>additional bits. Thus, the</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">server send rate can be no higher than the video consumption rate at the client. Therefore, <i>a full client application buffer indirectly imposes a limit on the rate that video can be sent from server to client when streaming over HTTP.</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Analysis of Video Streaming</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark787" class="s124">Some simple modeling will provide more insight into initial playout delay and freezing due to application buffer depletion. As shown in </a><a href="#bookmark787" class="a">Figure 9.</a><span class="s20">3</span>, let <i>B </i>denote the size</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="671" height="387" alt="image" src="计算机网络自顶向下7th-en/Image_891.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark787">Figure 9.3 Analysis of client-side buffering for video streaming</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 132%;text-align: left;">(in bits) of the client’s application buffer, and let <i>Q </i>denote the number of bits that must be buffered before the client application begins playout. (Of course, <span class="s27">Q&lt;B.</span>) Let <i>r </i>denote the video consumption rate</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 14pt;text-align: left;">—the rate at which the client draws bits out of the client application buffer during playback. So, for</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">example, if the video’s frame rate is 30 frames/sec, and each (compressed) frame is 100,000 bits, then r=3 Mbps. To see the forest through the trees, we’ll ignore TCP’s send and receive buffers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 137%;text-align: left;">Let’s assume that the server sends bits at a constant rate <i>x </i>whenever the client buffer is not full. (This is a gross simplification, since TCP’s send rate varies due to congestion control; we’ll examine more realistic time-dependent rates <i>x</i>(<i>t</i>) in the problems at the end of this chapter.) Suppose at time <span class="s27">t=</span>0, the</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">application buffer is empty and video begins arriving to the client application buffer. We now ask at what</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">time t=tp does playout begin? And while we are at it, at what time t=tf does the client application buffer become full?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 151%;text-align: left;">First, let’s determine <i>t</i><span class="s31">p</span>, the time when <i>Q </i>bits have entered the application buffer and playout begins. Recall that bits arrive to the client application buffer at rate <i>x </i>and <i>no </i>bits are removed from this buffer before playout begins. Thus, the amount of time required to build up <i>Q </i>bits (the initial buffering delay) is</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">tp=Q/x.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">Now let’s determine <i>t</i><span class="s31">f</span>, the point in time when the client application buffer becomes full. We first observe that if x&lt;r (that is, if the server send rate is less than the video consumption rate), then the client buffer</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">will never become full! Indeed, starting at time <i>t</i><span class="s31">p</span>, the buffer will be depleted at rate <i>r </i>and will only be filled at rate x&lt;r. Eventually the client buffer will empty out entirely, at which time the video will freeze on</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the screen while the client buffer waits another <i>t</i><span class="s31">p </span>seconds to build up <i>Q </i>bits of video. <i>Thus, when the</i></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><i>available rate in the network is less than the video rate, playout will alternate between periods of continuous playout and periods of freezing. </i>In a homework problem, you will be asked to determine the length of each continuous playout and freezing period as a function of <i>Q</i>, <i>r</i>, and <i>x</i>. Now let’s determine <i>t</i><span class="s31">f </span>for when <span class="s27">x</span>&gt;r. In this case, starting at time <i>t</i><span class="s31">p</span>, the buffer increases from <i>Q </i>to <i>B </i>at rate <span class="s27">x</span>−r since bits are being depleted at rate <i>r </i>but are arriving at rate <i>x</i><a href="#bookmark787" class="s124">, as shown in </a><a href="#bookmark787" class="a">Figure 9.</a><span class="s20">3</span>. Given these hints, you will be asked in a homework problem to determine <i>t</i><span class="s31">f</span>, the time the client buffer becomes full. Note that <i>when the available rate in the network is more than the video rate, after the initial buffering delay, the user will enjoy continuous playout until the video ends.</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Early Termination and Repositioning the Video</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">HTTP streaming systems often make use of the <span class="s20">HTTP byte-range header </span>in the HTTP GET request message, which specifies the specific range of bytes the client currently wants to retrieve from the desired video. This is particularly useful when the user wants to reposition (that is, jump) to a future point in time in the video. When the user repositions to a new position, the client sends a new HTTP request, indicating with the byte-range header from which byte in the file should the server send data. When the server receives the new HTTP request, it can forget about any earlier request and instead send bytes beginning with the byte indicated in the byte-range request.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;">While we are on the subject of repositioning, we briefly mention that when a user repositions to a future point in the video or terminates the video early, some prefetched-but-not-yet-viewed data transmitted by the server will go unwatched—a waste of network bandwidth and server resources. For example,</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">suppose that the client buffer is full with <i>B </i>bits at some time <i>t</i><span class="s22">0 </span>into the video, and at this time the user repositions to some instant t&gt;t0+B/r into the video, and then watches the video to completion from that</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">point on. In this case, all <i>B </i>bits in the buffer will be unwatched and the bandwidth and server resources that were used to transmit those <i>B </i>bits have been completely wasted. There is significant wasted bandwidth in the Internet due to early termination, which can be quite costly, particularly for wireless</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;"><a href="#bookmark848" class="s124">links </a><a href="#bookmark848" class="a">[Ihm 2011</a>]<a href="#bookmark848" class="s124">. For this reason, many streaming systems use only a moderate-size client application buffer, or will limit the amount of prefetched video using the byte-range header in HTTP requests </a><a href="#bookmark848" class="a">[Rao </a>2011]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Repositioning and early termination are analogous to cooking a large meal, eating only a portion of it, and throwing the rest away, thereby wasting food. So the next time your parents criticize you for wasting food by not eating all your dinner, you can quickly retort by saying they are wasting bandwidth and server resources when they reposition while watching movies over the Internet! But, of course, two wrongs do not make a right—both food and bandwidth are not to be wasted!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark785" class="s124">In </a><a href="#bookmark785" class="a">Sections 9.2.1</a> <a href="#bookmark789" class="s124">and </a><a href="#bookmark789" class="a">9.2.</a>2<span class="p">, we covered UDP streaming and HTTP streaming, respectively. A third type of streaming is Dynamic Adaptive Streaming over HTTP (DASH), which uses multiple versions of the</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark220" class="s124" name="bookmark788">video, each compressed at a different rate. DASH is discussed in detail in </a><a href="#bookmark220" class="a">Section 2.6.</a>2<a href="#bookmark223" class="s124">. CDNs are often used to distribute stored and live video. CDNs are discussed in detail in </a><a href="#bookmark223" class="a">Section 2.6.</a>3<span class="p">.</span><a name="bookmark789">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p></li></ol></li><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark790">Voice-over-IP</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Real-time conversational voice over the Internet is often referred to as <span class="s20">Internet telephony</span>, since, from the user’s perspective, it is similar to the traditional circuit-switched telephone service. It is also commonly called <span class="s20">Voice-over-IP (VoIP)</span>. In this section we describe the principles and protocols underlying VoIP. Conversational video is similar in many respects to VoIP, except that it includes the video of the participants as well as their voices. To keep the discussion focused and concrete, we focus here only on voice in this section rather than combined voice and video.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l372"><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Limitations of the Best-Effort IP Service</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The Internet’s network-layer protocol, IP, provides best-effort service. That is to say the service makes its best effort to move each datagram from source to destination as quickly as possible but makes no promises whatsoever about getting the packet to the destination within some delay bound or about a limit on the percentage of packets lost. The lack of such guarantees poses significant challenges to the design of real-time conversational applications, which are acutely sensitive to packet delay, jitter, and loss.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this section, we’ll cover several ways in which the performance of VoIP over a best-effort network can be enhanced. Our focus will be on application-layer techniques, that is, approaches that do not require any changes in the network core or even in the transport layer at the end hosts. To keep the discussion concrete, we’ll discuss the limitations of best-effort IP service in the context of a specific VoIP example. The sender generates bytes at a rate of 8,000 bytes per second; every 20 msecs the sender gathers these bytes into a chunk. A chunk and a special header (discussed below) are encapsulated in a UDP segment, via a call to the socket interface. Thus, the number of bytes in a chunk is</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 15pt;text-align: left;">(20 msecs)<span class="s29">⋅</span>(8,000 bytes/sec)=160 bytes, and a UDP segment is sent every 20 msecs.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">If each packet makes it to the receiver with a constant end-to-end delay, then packets arrive at the receiver periodically every 20 msecs. In these ideal conditions, the receiver can simply play back each chunk as soon as it arrives. But unfortunately, some packets can be lost and most packets will not have the same end-to-end delay, even in a lightly congested Internet. For this reason, the receiver must take more care in determining (1) when to play back a chunk, and (2) what to do with a missing chunk.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Packet Loss</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Consider one of the UDP segments generated by our VoIP application. The UDP segment is encapsulated in an IP datagram. As the datagram wanders through the network, it passes through router buffers (that is, queues) while waiting for transmission on outbound links. It is possible that one or more of the buffers in the path from sender to receiver is full, in which case the arriving IP datagram may be discarded, never to arrive at the receiving application.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Loss could be eliminated by sending the packets over TCP (which provides for reliable data transfer) rather than over UDP. However, retransmission mechanisms are often considered unacceptable for conversational real-time audio applications such as VoIP, because they increase end-to-end delay</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="a">[Bolot 1996</a>]<span class="p">. Furthermore, due to TCP congestion control, packet loss may result in a reduction of the TCP sender’s transmission rate to a rate that is lower than the receiver’s drain rate, possibly leading to buffer starvation. This can have a severe impact on voice intelligibility at the receiver. For these reasons,</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">most existing VoIP applications run over UDP by default. </a><a href="#bookmark848" class="a">[Baset 2006]</a> <span class="p">reports that UDP is used by Skype unless a user is behind a NAT or firewall that blocks UDP segments (in which case TCP is used).</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">But losing packets is not necessarily as disastrous as one might think. Indeed, packet loss rates between 1 and 20 percent can be tolerated, depending on how voice is encoded and transmitted, and on how the loss is concealed at the receiver. For example, forward error correction (FEC) can help conceal packet loss. We’ll see below that with FEC, redundant information is transmitted along with the original information so that some of the lost original data can be recovered from the redundant information. Nevertheless, if one or more of the links between sender and receiver is severely congested, and packet loss exceeds 10 to 20 percent (for example, on a wireless link), then there is really nothing that can be done to achieve acceptable audio quality. Clearly, best-effort service has its limitations.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">End-to-End Delay</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">End-to-end delay <span class="p">is the accumulation of transmission, processing, and queuing delays in routers; propagation delays in links; and end-system processing delays. For real-time conversational applications, such as VoIP, end-to-end delays smaller than 150 msecs are not perceived by a human listener; delays between 150 and 400 msecs can be acceptable but are not ideal; and delays exceeding 400 msecs can seriously hinder the interactivity in voice conversations. The receiving side of a VoIP application will typically disregard any packets that are delayed more than a certain threshold, for example, more than 400 msecs. Thus, packets that are delayed by more than the threshold are effectively lost.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Packet Jitter</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A crucial component of end-to-end delay is the varying queuing delays that a packet experiences in the network’s routers. Because of these varying delays, the time from when a packet is generated at the</p><p class="s20" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark784" class="s124" name="bookmark791">source until it is received at the receiver can fluctuate from packet to packet, as shown in </a><a href="#bookmark784" class="a">Figure 9.</a>1<span class="p">. This phenomenon is called </span>jitter<span class="p">. As an example, consider two consecutive packets in our VoIP application. The sender sends the second packet 20 msecs after sending the first packet. But at the</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">receiver, the spacing between these packets can become greater than 20 msecs. To see this, suppose the first packet arrives at a nearly empty queue at a router, but just before the second packet arrives at the queue a large number of packets from other sources arrive at the same queue. Because the first packet experiences a small queuing delay and the second packet suffers a large queuing delay at this router, the first and second packets become spaced by more than 20 msecs. The spacing between consecutive packets can also become less than 20 msecs. To see this, again consider two consecutive packets. Suppose the first packet joins the end of a queue with a large number of packets, and the second packet arrives at the queue before this first packet is transmitted and before any packets from other sources arrive at the queue. In this case, our two packets find themselves one right after the other in the queue. If the time it takes to transmit a packet on the router’s outbound link is less than 20 msecs, then the spacing between first and second packets becomes less than 20 msecs.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The situation is analogous to driving cars on roads. Suppose you and your friend are each driving in your own cars from San Diego to Phoenix. Suppose you and your friend have similar driving styles, and that you both drive at 100 km/hour, traffic permitting. If your friend starts out one hour before you, depending on intervening traffic, you may arrive at Phoenix more or less than one hour after your friend.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">If the receiver ignores the presence of jitter and plays out chunks as soon as they arrive, then the resulting audio quality can easily become unintelligible at the receiver. Fortunately, jitter can often be removed by using <span class="s20">sequence numbers</span>, <span class="s20">timestamps</span>, and a <span class="s20">playout delay</span>, as discussed below.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Removing Jitter at the Receiver for Audio</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">For our VoIP application, where packets are being generated periodically, the receiver should attempt to provide periodic playout of voice chunks in the presence of random network jitter. This is typically done by combining the following two mechanisms:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_892.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">Prepending each chunk with a timestamp. <span class="p">The sender stamps each chunk with the time at which the chunk was generated.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_893.png"/></span></p><p class="s28" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Delaying playout of chunks at the receiver. <a href="#bookmark784" class="s124">As we saw in our earlier discussion of </a><a href="#bookmark784" class="a">Figure 9.</a><span style=" color: #1E79B8;">1</span><span class="p">, the playout delay of the received audio chunks must be long enough so that most of the packets are received before their scheduled playout times. This playout delay can either be fixed throughout the</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">duration of the audio session or vary adaptively during the audio session lifetime.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We now discuss how these three mechanisms, when combined, can alleviate or even eliminate the effects of jitter. We examine two playback strategies: fixed playout delay and adaptive playout delay.</p><p class="s24" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Fixed Playout Delay</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">With the fixed-delay strategy, the receiver attempts to play out each chunk exactly <i>q </i>msecs after the chunk is generated. So if a chunk is timestamped at the sender at time <i>t</i>, the receiver plays out the chunk at time t+q, assuming the chunk has arrived by that time. Packets that arrive after their scheduled</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">playout times are discarded and considered lost.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">What is a good choice for <i>q</i>? VoIP can support delays up to about 400 msecs, although a more satisfying conversational experience is achieved with smaller values of <i>q</i>. On the other hand, if <i>q </i>is made much smaller than 400 msecs, then many packets may miss their scheduled playback times due</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;">to the network-induced packet jitter. Roughly speaking, if large variations in end-to-end delay are typical, it is preferable to use a large <i>q</i>; on the other hand, if delay is small and variations in delay are also small, it is preferable to use a small <i>q</i>, perhaps less than 150 msecs.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark793" class="s124" name="bookmark792">The trade-off between the playback delay and packet loss is illustrated in </a><a href="#bookmark793" class="a">Figure 9.</a>4<span class="p">. The figure shows the times at which packets are generated and played</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="561" height="362" alt="image" src="计算机网络自顶向下7th-en/Image_894.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: justify;"><a name="bookmark793">Figure 9.4 Packet loss for different fixed playout delays</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;">out for a single talk spurt. Two distinct initial playout delays are considered. As shown by the leftmost staircase, the sender generates packets at regular intervals—say, every 20 msecs. The first packet in this talk spurt is received at time <i>r</i>. As shown in the figure, the arrivals of subsequent packets are not</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: justify;">evenly spaced due to the network jitter.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: justify;">For the first playout schedule, the fixed initial playout delay is set to p−r. With this schedule, the fourth</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">packet does not arrive by its scheduled playout time, and the receiver considers it lost. For the second playout schedule, the fixed initial playout delay is set to p′−r. For this schedule, all packets arrive before their scheduled playout times, and there is therefore no loss.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Adaptive Playout Delay</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The previous example demonstrates an important delay-loss trade-off that arises when designing a playout strategy with fixed playout delays. By making the initial playout delay large, most packets will make their deadlines and there will therefore be negligible loss; however, for conversational services such as VoIP, long delays can become bothersome if not intolerable. Ideally, we would like the playout delay to be minimized subject to the constraint that the loss be below a few percent.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The natural way to deal with this trade-off is to estimate the network delay and the variance of the network delay, and to adjust the playout delay accordingly at the beginning of each talk spurt. This adaptive adjustment of playout delays at the beginning of the talk spurts will cause the sender’s silent periods to be compressed and elongated; however, compression and elongation of silence by a small amount is not noticeable in speech.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">Following </a><a href="#bookmark848" class="a">[Ramjee </a>1994]<span class="p">, we now describe a generic algorithm that the receiver can use to adaptively adjust its playout delays. To this end, let</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span class="s27">t</span>i= the timestamp of the <i>i</i>th packet <span class="s27">=</span> the time the packet was generated by the sender</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span class="s27">r</span>i= the time packet <i>i </i>is received by receiver</p><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span class="s27">p</span>i= the time packet <i>i </i>is played at receiver</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">The end-to-end network delay of the <i>i</i>th packet is <span class="s27">r</span>i−ti. Due to network jitter, this delay will vary from packet to packet. Let <i>d</i><span class="s31">i </span>denote an estimate of the <i>average </i>network delay upon reception of the <i>i</i>th packet. This estimate is constructed from the timestamps as follows:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">di=(1−u)di−1+u(ri−ti)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 140%;text-align: left;">where <i>u </i>is a fixed constant (for example, <span class="s27">u</span>=0.01). Thus <i>d</i><span class="s31">i </span>is a smoothed average of the observed network delays r1−t1,…,ri−ti. The estimate places more weight on the recently observed network delays than on the observed network delays of the distant past. This form of estimate should not be completely</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 143%;text-align: left;"><a href="#bookmark254" class="s124">unfamiliar; a similar idea is used to estimate round-trip times in TCP, as discussed in </a><a href="#bookmark254" class="a">Chapter </a><span class="s20">3</span>. Let <i>v</i><span class="s31">i </span>denote an estimate of the average deviation of the delay from the estimated average delay. This estimate is also constructed from the timestamps:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">vi=(1−u)vi−1+u| ri−ti−di|</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 140%;text-align: left;"><a name="bookmark794">The estimates </a><i>d</i><span class="s31">i </span>and <i>v</i><span class="s31">i </span>are calculated for every packet received, although they are used only to determine the playout point for the first packet in any talk spurt.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 161%;text-align: left;">Once having calculated these estimates, the receiver employs the following algorithm for the playout of packets. If packet <i>i </i>is the first packet of a talk spurt, its playout time, <i>p</i><span class="s31">i</span>, is computed as:</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">pi=ti+di+Kvi</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 142%;text-align: justify;">where <i>K </i>is a positive constant (for example, <span class="s27">K=</span>4). The purpose of the <i>Kv</i><span class="s31">i </span>term is to set the playout time far enough into the future so that only a small fraction of the arriving packets in the talk spurt will be lost due to late arrivals. The playout point for any subsequent packet in a talk spurt is computed as an offset from the point in time when the first packet in the talk spurt was played out. In particular, let</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">qi=pi−ti</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">be the length of time from when the first packet in the talk spurt is generated until it is played out. If packet <i>j </i>also belongs to this talk spurt, it is played out at time</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">pj=tj+qi</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The algorithm just described makes perfect sense assuming that the receiver can tell whether a packet is the first packet in the talk spurt. This can be done by examining the signal energy in each received packet.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Recovering from Packet Loss</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">We have discussed in some detail how a VoIP application can deal with packet jitter. We now briefly describe several schemes that attempt to preserve acceptable audio quality in the presence of packet loss. Such schemes are called <span class="s20">loss recovery schemes</span>. Here we define packet loss in a broad sense: A packet is lost either if it never arrives at the receiver or if it arrives after its scheduled playout time. Our VoIP example will again serve as a context for describing loss recovery schemes.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">As mentioned at the beginning of this section, retransmitting lost packets may not be feasible in a real- time conversational application such as VoIP. Indeed, retransmitting a packet that has missed its playout deadline serves absolutely no purpose. And retransmitting a packet that overflowed a router queue cannot normally be accomplished quickly enough. Because of these considerations, VoIP applications often use some type of loss anticipation scheme. Two types of loss anticipation schemes are <span class="s20">forward error correction (FEC) and interleaving</span>.</p><p class="s24" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Forward Error Correction (FEC)</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">The basic idea of FEC is to add redundant information to the original packet stream. For the cost of marginally increasing the transmission rate, the redundant information can be used to reconstruct approximations or exact versions of some of the lost packets. Following </a><a href="#bookmark848" class="a">[Bolot 1996]</a> <a href="#bookmark848" class="s124">and </a><a href="#bookmark848" class="a">[Perkins</a></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">1998]<span class="p">, we now outline two simple FEC mechanisms. The first mechanism sends a redundant encoded</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 129%;text-align: left;">chunk after every <i>n </i>chunks. The redundant chunk is obtained by exclusive OR-ing the <i>n </i><a href="#bookmark848" class="s124">original chunks </a><a href="#bookmark848" class="a">[Shacham </a><span class="s20">1990]</span>. In this manner if any one packet of the group of <span class="s27">n</span>+1 packets is lost, the receiver can fully reconstruct the lost packet. But if two or more packets in a group are lost, the receiver cannot</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">reconstruct the lost packets. By keeping n+1, the group size, small, a large fraction of the lost packets can be recovered when loss is not excessive. However, the smaller the group size, the greater the relative increase of the transmission rate. In particular, the transmission rate increases by a factor of 1/<i>n</i>,</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">so that, if n=3, then the transmission rate increases by 33 percent. Furthermore, this simple scheme</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">increases the playout delay, as the receiver must wait to receive the entire group of packets before it can begin playout. For more practical details about how FEC works for multimedia transport see </a><a href="#bookmark848" class="a">[RFC </a>5109]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The second FEC mechanism is to send a lower-resolution audio stream as the redundant information. For example, the sender might create a nominal audio stream and a corresponding low-resolution, low- bit rate audio stream. (The nominal stream could be a PCM encoding at 64 kbps, and the lower-quality stream could be a GSM encoding at 13 kbps.) The low-bit rate stream is referred to as the redundant</p><p style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark795" class="s124">stream. As shown in </a><a href="#bookmark795" class="a">Figure 9.</a><span class="s20">5</span>, the sender constructs the <i>n</i>th packet by taking the <i>n</i>th chunk from the nominal stream and appending to it the (n−1)st chunk from the redundant stream. In this manner, whenever there is nonconsecutive packet loss, the receiver can conceal the loss by playing out the low-</p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">bit rate encoded chunk that arrives with the subsequent packet. Of course, low-bit rate chunks give lower quality than the nominal chunks. However, a stream of mostly high-quality chunks, occasional low- quality chunks, and no missing chunks gives good overall audio quality. Note that in this scheme, the receiver only has to receive two packets before playback, so that the increased playout delay is small. Furthermore, if the low-bit rate encoding is much less than the nominal encoding, then the marginal increase in the transmission rate will be small.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 147%;text-align: left;">In order to cope with consecutive loss, we can use a simple variation. Instead of appending just the <span class="s27">(</span>n−1)st low-bit rate chunk to the <i>n</i>th nominal chunk, the sender can append the <span class="s27">(</span>n−1)st and <span class="s27">(</span>n−2)nd low-</p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">bit rate chunk, or append the (n−1)st and (n−3)rd low-bit rate chunk, and so on. By appending more low-</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">bit rate chunks to each nominal chunk, the audio quality at the receiver becomes acceptable for a wider variety of harsh best-effort environments. On the other hand, the additional chunks increase the transmission bandwidth and the playout delay.</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="628" height="352" alt="image" src="计算机网络自顶向下7th-en/Image_895.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark795">Figure 9.5 Piggybacking lower-quality redundant information</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Interleaving</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">As an alternative to redundant transmission, a VoIP application can send interleaved audio. As shown in</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark797" class="a">Figure 9.</a>6<span class="p">, the sender resequences units of audio data before transmission, so that originally adjacent units are separated by a certain distance in the transmitted stream. Interleaving can mitigate the effect  of packet losses. If, for example, units are 5 msecs in length and chunks are 20 msecs (that is, four units</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">per chunk), then the first chunk could contain units 1, 5, 9, and 13; the second chunk could contain units</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark797" class="s124">2, 6, 10, and 14; and so on. </a><a href="#bookmark797" class="a">Figure 9.6</a> <span class="p">shows that the loss of a single packet from an interleaved stream results in multiple small gaps in the reconstructed stream, as opposed to the single large gap that would occur in a noninterleaved stream.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark848" class="s124">Interleaving can significantly improve the perceived quality of an audio stream </a><a href="#bookmark848" class="a">[Perkins </a>1998]<span class="p">. It also has low overhead. The obvious disadvantage of interleaving is that it increases latency. This limits its use for conversational applications such as VoIP, although it can perform well for streaming stored</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">audio. A major advantage of interleaving is that it does not increase the bandwidth requirements of a stream.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Error Concealment</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;"><a href="#bookmark848" class="s124">Error concealment schemes attempt to produce a replacement for a lost packet that is similar to the original. As discussed in </a><a href="#bookmark848" class="a">[Perkins </a>1998]<span class="p">, this is possible since audio</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="700" height="442" alt="image" src="计算机网络自顶向下7th-en/Image_896.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark796">Figure 9.6 Sending interleaved audio</a><a name="bookmark797">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">signals, and in particular speech, exhibit large amounts of short-term self-similarity. As such, these techniques work for relatively small loss rates (less than 15 percent), and for small packets (4–40 msecs). When the loss length approaches the length of a phoneme (5–100 msecs) these techniques break down, since whole phonemes may be missed by the listener.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Perhaps the simplest form of receiver-based recovery is packet repetition. Packet repetition replaces lost packets with copies of the packets that arrived immediately before the loss. It has low computational complexity and performs reasonably well. Another form of receiver-based recovery is interpolation, which uses audio before and after the loss to interpolate a suitable packet to cover the loss.  Interpolation performs somewhat better than packet repetition but is significantly more computationally</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">intensive </a><a href="#bookmark848" class="a">[Perkins </a>1998]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p></li><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Case Study: VoIP with Skype</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Skype is an immensely popular VoIP application with over 50 million accounts active on a daily basis. In addition to providing host-to-host VoIP service, Skype offers host-to-phone services, phone-to-host services, and multi-party host-to-host video conferencing services. (Here, a host is again any Internet connected IP device, including PCs, tablets, and smartphones.) Skype was acquired by Microsoft in 2011.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">Because the Skype protocol is proprietary, and because all Skype’s control and media packets are encrypted, it is difficult to precisely determine how Skype operates. Nevertheless, from the Skype Web site and several measurement studies, researchers have learned how Skype generally works </a><a href="#bookmark848" class="a">[Baset</a></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">2006<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Guha 200</a>6<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Chen 200</a>6<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Suh 200</a>6<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Ren 200</a>6<span class="p">; Zhang X 2012]. For both voice and video, the</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Skype clients have at their disposal many different codecs, which are capable of encoding the media at a wide range of rates and qualities. For example, video rates for Skype have been measured to be as low as 30 kbps for a low-quality session up to almost 1 Mbps for a high quality session [Zhang X 2012]. Typically, Skype’s audio quality is better than the “POTS” (Plain Old Telephone Service) quality provided by the wire-line phone system. (Skype codecs typically sample voice at 16,000 samples/sec or higher, which provides richer tones than POTS, which samples at 8,000/sec.) By default, Skype sends audio and video packets over UDP. However, control packets are sent over TCP, and media packets are also sent over TCP when firewalls block UDP streams. Skype uses FEC for loss recovery for both voice and video streams sent over UDP. The Skype client also adapts the audio and video streams it sends to current network conditions, by changing video quality and FEC overhead [Zhang X 2012].</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Skype uses P2P techniques in a number of innovative ways, nicely illustrating how P2P can be used in applications that go beyond content distribution and file sharing. As with instant messaging, host-to-host Internet telephony is inherently P2P since, at the heart of the application, pairs of users (that is, peers) communicate with each other in real time. But Skype also employs P2P techniques for two other important functions, namely, for user location and for NAT traversal.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="526" height="514" alt="image" src="计算机网络自顶向下7th-en/Image_897.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark798">Figure 9.7 Skype peers</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark798" class="s124">As shown in </a><a href="#bookmark798" class="a">Figure 9.</a>7<span class="p">, the peers (hosts) in Skype are organized into a hierarchical overlay network, with each peer classified as a super peer or an ordinary peer. Skype maintains an index that maps Skype usernames to current IP addresses (and port numbers). This index is distributed over the super</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">peers. When Alice wants to call Bob, her Skype client searches the distributed index to determine Bob’s current IP address. Because the Skype protocol is proprietary, it is currently not known how the index mappings are organized across the super peers, although some form of DHT organization is very possible.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><span class="p">P2P techniques are also used in Skype </span>relays<a href="#bookmark368" class="s124">, which are useful for establishing calls between hosts in home networks. Many home network configurations provide access to the Internet through NATs, as discussed in </a><a href="#bookmark368" class="a">Chapter </a>4<span class="p">. Recall that a NAT prevents a host from outside the home network from initiating</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">a connection to a host within the home network. If <i>both </i>Skype callers have NATs, then there is a</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">problem—neither can accept a call initiated by the other, making a call seemingly impossible. The clever use of super peers and relays nicely solves this problem. Suppose that when Alice signs in, she is assigned to a non-NATed super peer and initiates a session to that super peer. (Since Alice is initiating the session, her NAT permits this session.) This session allows Alice and her super peer to exchange control messages. The same happens for Bob when he signs in. Now, when Alice wants to call Bob, she informs her super peer, who in turn informs Bob’s super peer, who in turn informs Bob of Alice’s incoming call. If Bob accepts the call, the two super peers select a third non-NATed super peer—the relay peer—whose job will be to relay data between Alice and Bob. Alice’s and Bob’s super peers then</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark798" class="s124">instruct Alice and Bob respectively to initiate a session with the relay. As shown in </a><a href="#bookmark798" class="a">Figure 9.</a>7<span class="p">, Alice then sends voice packets to the relay over the Alice-to-relay connection (which was initiated by Alice), and the relay then forwards these packets over the relay-to-Bob connection (which was initiated by Bob);</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">packets from Bob to Alice flow over these same two relay connections in reverse. And <i>voila!</i>—Bob and Alice have an end-to-end connection even though neither can accept a session originating from outside.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Up to now, our discussion on Skype has focused on calls involving two persons. Now let’s examine multi-party audio conference calls. With N&gt;2 participants, if each user were to send a copy of its audio stream to each of the N−1 other users, then a total of N(N−1) audio streams would need to be sent into the network to support the audio conference. To reduce this bandwidth usage, Skype employs a clever distribution technique. Specifically, each user sends its audio stream to the conference initiator. The conference initiator combines the audio streams into one stream (basically by adding all the audio signals together) and then sends a copy of each combined stream to each of the other N−1 participants. In this manner, the number of streams is reduced to 2(N−1). For ordinary two-person video conversations, Skype routes the call peer-to-peer, unless NAT traversal is required, in which case the call is relayed through a non-NATed peer, as described earlier. For a video conference call involving N&gt;2 participants, due to the nature of the video medium, Skype does not combine the call into one</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark799">stream at one location and then redistribute the stream to all the participants, as it does for voice calls. Instead, each participant’s video stream is routed to a server cluster (located in Estonia as of 2011), which in turn relays to each participant the N−1 streams of the N−1 other participants [Zhang X 2012]. You may be wondering why each participant sends a copy to a server rather than directly sending a copy of its video stream to each of the other N−1 participants? Indeed, for both approaches, N(N−1)</a><a name="bookmark800">&zwnj;</a></p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">video streams are being collectively received by the <i>N </i>participants in the conference. The reason is, because upstream link bandwidths are significantly lower than downstream link bandwidths in most access links, the upstream links may not be able to support the N−1 streams with the P2P approach.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">VoIP systems such as Skype, WeChat, and Google Talk introduce new privacy concerns. Specifically, when Alice and Bob communicate over VoIP, Alice can sniff Bob’s IP address and then use geo-location services </a><a href="#bookmark848" class="a">[MaxMind 201</a>6<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Quova 2016]</a> <span class="p">to determine Bob’s current location and ISP (for example, his</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">work or home ISP). In fact, with Skype it is possible for Alice to block the transmission of certain packets</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">during call establishment so that she obtains Bob’s current IP address, say every hour, without Bob knowing that he is being tracked and without being on Bob’s contact list. Furthermore, the IP address discovered from Skype can be correlated with IP addresses found in BitTorrent, so that Alice can</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">determine the files that Bob is downloading </a><a href="#bookmark848" class="a">[LeBlond 2011</a>]<a href="#bookmark848" class="s124">. Moreover, it is possible to partially decrypt a Skype call by doing a traffic analysis of the packet sizes in a stream </a><a href="#bookmark848" class="a">[White 2011</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l373"><ol id="l374"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark801">Protocols for Real-Time Conversational Applications</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Real-time conversational applications, including VoIP and video conferencing, are compelling and very popular. It is therefore not surprising that standards bodies, such as the IETF and ITU, have been busy for many years (and continue to be busy!) at hammering out standards for this class of applications. With the appropriate standards in place for real-time conversational applications, independent companies are creating new products that interoperate with each other. In this section we examine RTP and SIP for real-time conversational applications. Both standards are enjoying widespread implementation in industry products.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l375"><li style="padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">RTP</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the previous section, we learned that the sender side of a VoIP application appends header fields to the audio chunks before passing them to the transport layer. These header fields include sequence numbers and timestamps. Since most multimedia networking applications can make use of sequence numbers and timestamps, it is convenient to have a standardized packet structure that includes fields for audio/video data, sequence number, and timestamp, as well as other potentially useful fields. RTP, defined in RFC 3550, is such a standard. RTP can be used for transporting common formats such as PCM, ACC, and MP3 for sound and MPEG and H.263 for video. It can also be used for transporting proprietary sound and video formats. Today, RTP enjoys widespread implementation in many products and research prototypes. It is also complementary to other important real-time interactive protocols, such as SIP.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark848" class="s124">In this section, we provide an introduction to RTP. We also encourage you to visit Henning Schulzrinne’s RTP site </a><a href="#bookmark848" class="a">[Schulzrinne-RTP 2012</a>]<span class="p">, which provides a wealth of information on the subject. Also, you may</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">want to visit the RAT site [RAT 2012], which documents VoIP application that uses RTP.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">RTP Basics</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">RTP typically runs on top of UDP. The sending side encapsulates a media chunk within an RTP packet, then encapsulates the packet in a UDP segment, and then hands the segment to IP. The receiving side extracts the RTP packet from the UDP segment, then extracts the media chunk from the RTP packet, and then passes the chunk to the media player for decoding and rendering.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">As an example, consider the use of RTP to transport voice. Suppose the voice source is PCM-encoded</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">(that is, sampled, quantized, and digitized) at 64 kbps. Further suppose that the application collects the encoded data in 20-msec chunks, that is, 160 bytes in a chunk. The sending side precedes each chunk of the audio data with an <span class="s20">RTP header </span>that includes the type of audio encoding, a sequence number, and a timestamp. The RTP header is normally 12 bytes. The audio chunk along with the RTP header form the <span class="s20">RTP packet</span>. The RTP packet is then sent into the UDP socket interface. At the receiver side, the application receives the RTP packet from its socket interface. The application extracts the audio chunk from the RTP packet and uses the header fields of the RTP packet to properly decode and play back the audio chunk.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">If an application incorporates RTP—instead of a proprietary scheme to provide payload type, sequence numbers, or timestamps—then the application will more easily interoperate with other networked multimedia applications. For example, if two different companies develop VoIP software and they both incorporate RTP into their product, there may be some hope that a user using one of the VoIP products</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark810" class="s124">will be able to communicate with a user using the other VoIP product. In </a><a href="#bookmark810" class="a">Section 9.4.</a>2<span class="p">, we’ll see that RTP is often used in conjunction with SIP, an important standard for Internet telephony.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">It should be emphasized that RTP does not provide any mechanism to ensure timely delivery of data or provide other quality-of-service (QoS) guarantees; it does not even guarantee delivery of packets or prevent out-of-order delivery of packets. Indeed, RTP encapsulation is seen only at the end systems. Routers do not distinguish between IP datagrams that carry RTP packets and IP datagrams that don’t.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">RTP allows each source (for example, a camera or a microphone) to be assigned its own independent RTP stream of packets. For example, for a video conference between two participants, four RTP streams could be opened—two streams for transmitting the audio (one in each direction) and two streams for transmitting the video (again, one in each direction). However, many popular encoding techniques—including MPEG 1 and MPEG 2—bundle the audio and video into a single stream during the encoding process. When the audio and video are bundled by the encoder, then only one RTP stream is generated in each direction.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">RTP packets are not limited to unicast applications. They can also be sent over one-to-many and many- to-many multicast trees. For a many-to-many multicast session, all of the session’s senders and sources typically use the same multicast group for sending their RTP streams. RTP multicast streams belonging together, such as audio and video streams emanating from multiple senders in a video conference application, belong to an <span class="s20">RTP session</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="670" height="52" alt="image" src="计算机网络自顶向下7th-en/Image_898.gif"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark802">Figure 9.8 RTP header fields</a></h2><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">RTP Packet Header Fields</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark802" class="s124">As shown in </a><a href="#bookmark802" class="a">Figure 9.</a>8<span class="p">, the four main RTP packet header fields are the payload type, sequence number, timestamp, and source identifier fields.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The payload type field in the RTP packet is 7 bits long. For an audio stream, the payload type field is used to indicate the type of audio encoding (for example, PCM, adaptive delta modulation, linear predictive encoding) that is being used. If a sender decides to change the encoding in the middle of a session, the sender can inform the receiver of the change through this payload type field. The sender may want to change the encoding in order to increase the audio quality or to decrease the RTP stream</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark804" class="s124">bit rate. </a><a href="#bookmark804" class="a">Table 9.2</a> <span class="p">lists some of the audio payload types currently supported by RTP.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark805" class="s124">For a video stream, the payload type is used to indicate the type of video encoding (for example, motion JPEG, MPEG 1, MPEG 2, H.261). Again, the sender can change video encoding on the fly during a session. </a><a href="#bookmark805" class="a">Table 9.3</a> <span class="p">lists some of the video payload types currently supported by RTP. The other</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">important fields are the following:</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_899.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Sequence number field. <span class="p">The sequence number field is 16 bits long. The sequence number increments by one for each RTP packet sent, and may be used by the receiver to detect packet loss and to restore packet sequence. For example, if the receiver side of the application receives a</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_900.png"/></span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;">stream of RTP packets with a gap between sequence numbers 86 and 89, then the receiver knows that packets 87 and 88 are missing. The receiver can then attempt to conceal the lost data. <b>Timestamp field. </b>The timestamp field is 32 bits long. It reflects the sampling instant of the first byte</p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 11pt;text-align: left;">in the RTP data packet. As we saw in the preceding section, the receiver can use timestamps to</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">remove packet jitter introduced in the network and to provide synchronous playout at the receiver. The timestamp is derived from a sampling clock at the sender. As an example, for audio the timestamp clock increments by one for each sampling period (for example, each 125 μsec for an 8 kHz sampling clock); if the audio application generates chunks consisting of 160 encoded samples, then the timestamp increases by 160 for each RTP packet when the source is active. The timestamp clock continues to increase at a constant rate even if the source is inactive.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_901.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Synchronization source identifier (SSRC). <span class="p">The SSRC field is 32 bits long. It identifies the source of the RTP stream. Typically, each stream in an RTP session has a distinct SSRC. The SSRC is not the IP address of the sender, but instead is a number that the source assigns randomly when the</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">new stream is started. The probability that two streams get assigned the same SSRC is very small. Should this happen, the two sources pick a new SSRC value.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Table 9.2 Audio payload types supported by RTP</h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:4.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Payload-Type Number</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Audio Format</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Sampling Rate</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Rate</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">0</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">PCM μ-law</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">8 kHz</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">64 kbps</p></td></tr></table><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;"><a name="bookmark803">1</a><a name="bookmark804">&zwnj;</a></p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">1016</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">8 kHz</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">4.8 kbps</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">3</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">GSM</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">8 kHz</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">13 kbps</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">7</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">LPC</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">8 kHz</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">2.4 kbps</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">9</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">G.722</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">16 kHz</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">48–64 kbps</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">14</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">MPEG Audio</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">90 kHz</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">—</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">15</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">G.728</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">8 kHz</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">16 kbps</p></td></tr></table><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="331" alt="image" src="计算机网络自顶向下7th-en/Image_902.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="331" alt="image" src="计算机网络自顶向下7th-en/Image_903.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="331" alt="image" src="计算机网络自顶向下7th-en/Image_904.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="331" alt="image" src="计算机网络自顶向下7th-en/Image_905.png"/></span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="1" height="331" alt="image" src="计算机网络自顶向下7th-en/Image_906.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark805">Table 9.3 Some video payload types supported by RTP</a></h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:588pt;margin-left:5.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Payload-Type Number</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Video Format</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">26</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Motion JPEG</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">31</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">H.261</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">32</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">MPEG 1 video</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s131" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">33</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">MPEG 2 video</p></td></tr></table><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-top: 3pt;padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">SIP</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">The Session Initiation Protocol (SIP), defined in </a><a href="#bookmark848" class="a">[RFC </a>3261<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">RFC 5411</a>]<span class="p">, is an open and lightweight protocol that does the following:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_907.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">It provides mechanisms for establishing calls between a caller and a callee over an IP network. It allows the caller to notify the callee that it wants to start a call. It allows the participants to agree on media encodings. It also allows participants to end calls.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_908.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 138%;text-align: left;">It provides mechanisms for the caller to determine the current IP address of the callee. Users do not have a single, fixed IP address because they may be assigned addresses dynamically (using DHCP) and because they may have multiple IP devices, each with a different IP address.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_909.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">It provides mechanisms for call management, such as adding new media streams during the call,</p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">changing the encoding during the call, inviting new participants during the call, call transfer, and call holding.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Setting Up a Call to a Known IP Address</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">To understand the essence of SIP, it is best to take a look at a concrete example. In this example, Alice is at her PC and she wants to call Bob, who is also working at his PC. Alice’s and Bob’s PCs are both equipped with SIP-based software for making and receiving phone calls. In this initial example, we’ll</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark806" class="s124">assume that Alice knows the IP address of Bob’s PC. </a><a href="#bookmark806" class="a">Figure 9.9</a> <span class="p">illustrates the SIP call-establishment process.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark806" class="s124">In </a><a href="#bookmark806" class="a">Figure 9.</a>9<span class="p">, we see that an SIP session begins when Alice sends Bob an INVITE message, which resembles an HTTP request message. This INVITE message is sent over UDP to the well-known port 5060 for SIP. (SIP messages can also be sent over TCP.) The INVITE message includes an identifier</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">for Bob (bob@193.64.210.89), an indication of Alice’s current IP address, an indication that Alice desires to receive audio, which is to be encoded in format AVP 0 (PCM encoded μ-law) and</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="676" height="655" alt="image" src="计算机网络自顶向下7th-en/Image_910.png"/></span></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark806">Figure 9.9 SIP call establishment when Alice knows Bob’s IP address</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark807">encapsulated in RTP, and an indication that she wants to receive the RTP packets on port 38060. After receiving Alice’s INVITE message, Bob sends an SIP response message, which resembles an HTTP response message. This response SIP message is also sent to the SIP port 5060. Bob’s response includes a 200 OK as well as an indication of his IP address, his desired encoding and packetization for reception, and his port number to which the audio packets should be sent. Note that in this example Alice and Bob are going to use different audio-encoding mechanisms: Alice is asked to encode her audio with GSM whereas Bob is asked to encode his audio with PCM μ-law. After receiving Bob’s response, Alice sends Bob an SIP acknowledgment message. After this SIP transaction, Bob and Alice</a></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark806" class="s124">can talk. (For visual convenience, </a><a href="#bookmark806" class="a">Figure 9.9</a> <span class="p">shows Alice talking after Bob, but in truth they would normally talk at the same time.) Bob will encode and packetize the audio as requested and send the audio packets to port number 38060 at IP address 167.180.112.24. Alice will also encode and packetize</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">the audio as requested and send the audio packets to port number 48753 at IP address 193.64.210.89.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">From this simple example, we have learned a number of key characteristics of SIP. First, SIP is an out- of-band protocol: The SIP messages are sent and received in sockets that are different from those used for sending and receiving the media data. Second, the SIP messages themselves are ASCII-readable and resemble HTTP messages. Third, SIP requires all messages to be acknowledged, so it can run over UDP or TCP.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this example, let’s consider what would happen if Bob does not have a PCM μ-law codec for encoding audio. In this case, instead of responding with 200 OK, Bob would likely respond with a 606 Not Acceptable and list in the message all the codecs he can use. Alice would then choose one of the listed codecs and send another INVITE message, this time advertising the chosen codec. Bob could also simply reject the call by sending one of many possible rejection reply codes. (There are many such codes, including “busy,” “gone,” “payment required,” and “forbidden.”)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SIP Addresses</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="mailto:bob@193.64.210.89" class="s124" target="_blank">In the previous example, Bob’s SIP address is sip:bob@193.64.210.89.</a><a href="mailto:bob@domain.com" class="s124" target="_blank"> However, we expect many—if not most—SIP addresses to resemble e-mail addresses. For example, Bob’s address might be </a><a href="mailto:bob@domain.com" class="a" target="_blank">sip:bob@domain.co</a>m<span class="p">. When Alice’s SIP device sends an INVITE message, the message would</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">include this e-mail-like address; the SIP infrastructure would then route the message to the IP device</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">that Bob is currently using (as we’ll discuss below). Other possible forms for the SIP address could be Bob’s legacy phone number or simply Bob’s first/middle/last name (assuming it is unique).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">An interesting feature of SIP addresses is that they can be included in Web pages, just as people’s e- mail addresses are included in Web pages with the mailto URL. For example, suppose Bob has a</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">personal homepage, and he wants to provide a means for visitors to the homepage to call him. He could</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="mailto:bob@domain.com" class="s124" target="_blank">then simply include the URL </a><a href="mailto:bob@domain.com" class="a" target="_blank">sip:bob@domain.co</a>m<span class="p">. When the visitor clicks on the URL, the SIP application in the visitor’s device is launched and an INVITE message is sent to Bob.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SIP Messages</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;">In this short introduction to SIP, we’ll not cover all SIP message types and headers. Instead, we’ll take a brief look at the SIP INVITE message, along with a few common header lines. Let us again suppose that Alice wants to initiate a VoIP call to Bob, and this time Alice knows only Bob’s SIP address,</p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="334" alt="image" src="计算机网络自顶向下7th-en/Image_911.png"/></span></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="mailto:bob@domain.com" class="a" target="_blank">bob@domain.co</a>m<span class="p">, and does not know the IP address of the device that Bob is currently using. Then her message might look something like this:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s47" style="padding-left: 30pt;text-indent: 1pt;line-height: 142%;text-align: left;">INVITE<a href="mailto:bob@domain.com" class="s35" target="_blank"> </a><a href="mailto:bob@domain.com" class="s36" target="_blank">sip:bob@domain.com</a><span class="s42"> </span>SIP/2.0<span class="s30"> Via: SIP/2.0/UDP 167.180.112.24</span></p><p class="s47" style="padding-left: 30pt;text-indent: 0pt;line-height: 16pt;text-align: left;">From:<a href="mailto:alice@hereway.com" class="s35" target="_blank"> </a><a href="mailto:alice@hereway.com" class="s36" target="_blank">sip:alice@hereway.com</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s47" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">To:<a href="mailto:bob@domain.com" class="s35" target="_blank"> </a><a href="mailto:bob@domain.com" class="s36" target="_blank">sip:bob@domain.com</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s47" style="padding-left: 30pt;text-indent: 0pt;line-height: 145%;text-align: left;">Call-ID:<a href="mailto:a2e3a@pigeon.hereway.com" class="s35" target="_blank"> </a><span class="s42">a2e3a@pigeon.hereway.com </span><span class="s30">Content-Type: application/sdp Content-Length: 885</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">c=IN IP4 167.180.112.24</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 30pt;text-indent: 0pt;text-align: left;">m=audio 38060 RTP/AVP 0</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The INVITE line includes the SIP version, as does an HTTP request message. Whenever an SIP message passes through an SIP device (including the device that originates the message), it attaches a Via header, which indicates the IP address of the device. (We’ll see soon that the typical INVITE message passes through many SIP devices before reaching the callee’s SIP application.) Similar to an e-mail message, the SIP message includes a From header line and a To header line. The message includes a Call-ID, which uniquely identifies the call (similar to the message-ID in e-mail). It includes a Content-Type header line, which defines the format used to describe the content contained in the SIP message. It also includes a Content-Length header line, which provides the length in bytes of the content in the message. Finally, after a carriage return and line feed, the message contains the content. In this case, the content provides information about Alice’s IP address and how Alice wants to receive the audio.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Name Translation and User Location</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark806" class="s124">In the example in </a><a href="#bookmark806" class="a">Figure 9.</a>9<span class="p">, we assumed that Alice’s SIP device knew the IP address where Bob could</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">be contacted. But this assumption is quite unrealistic, not only because IP addresses are often dynamically assigned with DHCP, but also because Bob may have multiple IP devices (for example, different devices for his home, work, and car). So now let us suppose that Alice knows only Bob’s e-mail</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: justify;"><a href="mailto:bob@domain.com" class="s124" target="_blank">address, </a>bob@domain.com<a href="mailto:bob@domain.com" class="s124" target="_blank">, and that this same address is used for SIP-based calls. In this case, Alice needs to obtain the IP address of the device that the user </a><a href="mailto:bob@domain.com" class="a" target="_blank">bob@domain.com</a> <a href="mailto:bob@domain.com" class="s124" target="_blank">is currently using. To find this out, Alice creates an INVITE message that begins with INVITE </a><a href="mailto:bob@domain.com" class="a" target="_blank">bob@domain.com</a> <span class="p">SIP/2.0 and</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 12pt;text-align: left;">sends this message to an <span class="s20">SIP proxy</span>. The proxy will respond with an SIP reply that might include the IP</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="mailto:bob@domain.com" class="s124" target="_blank">address of the device that </a><a href="mailto:bob@domain.com" class="a" target="_blank">bob@domain.com</a> <span class="p">is currently using. Alternatively, the reply might include the IP address of Bob’s voicemail box, or it might include a URL of a Web page (that says “Bob is sleeping. Leave me alone!”). Also, the result returned by the proxy might depend on the caller: If the call</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">is from Bob’s wife, he might accept the call and supply his IP address; if the call is from Bob’s mother-in- law, he might respond with the URL that points to the I-am-sleeping Web page!</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Now, you are probably wondering, how can the proxy server determine the current IP address for</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="mailto:bob@domain.com" class="a" target="_blank">bob@domain.co</a>m<span class="p">? To answer this question, we need to say a few words about another SIP device, the </span>SIP registrar<span class="p">. Every SIP user has an associated registrar. Whenever a user launches an SIP application on a device, the application sends an SIP register message to the registrar, informing the</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="785" height="192" alt="image" src="计算机网络自顶向下7th-en/Image_912.png"/></span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">registrar of its current IP address. For example, when Bob launches his SIP application on his PDA, the application would send a message along the lines of:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 1pt;line-height: 148%;text-align: left;">REGISTER sip:domain.com SIP/2.0 Via: SIP/2.0/UDP 193.64.210.89</p><p class="s47" style="padding-left: 29pt;text-indent: 0pt;line-height: 15pt;text-align: left;">From:<a href="mailto:bob@domain.com" class="s35" target="_blank"> </a><a href="mailto:bob@domain.com" class="s36" target="_blank">sip:bob@domain.com</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s47" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">To:<a href="mailto:bob@domain.com" class="s35" target="_blank"> </a><a href="mailto:bob@domain.com" class="s36" target="_blank">sip:bob@domain.com</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s30" style="padding-left: 29pt;text-indent: 0pt;text-align: left;">Expires: 3600</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Bob’s registrar keeps track of Bob’s current IP address. Whenever Bob switches to a new SIP device, the new device sends a new register message, indicating the new IP address. Also, if Bob remains at the same device for an extended period of time, the device will send refresh register messages, indicating that the most recently sent IP address is still valid. (In the example above, refresh messages need to be sent every 3600 seconds to maintain the address at the registrar server.) It is worth noting that the registrar is analogous to a DNS authoritative name server: The DNS server translates fixed host names to fixed IP addresses; the SIP registrar translates fixed human identifiers (for example,</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="mailto:bob@domain.com" class="a" target="_blank">bob@domain.co</a>m<span class="p">) to dynamic IP addresses. Often SIP registrars and SIP proxies are run on the same host.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now let’s examine how Alice’s SIP proxy server obtains Bob’s current IP address. From the preceding discussion we see that the proxy server simply needs to forward Alice’s INVITE message to Bob’s registrar/proxy. The registrar/proxy could then forward the message to Bob’s current SIP device. Finally,</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">Bob, having now received Alice’s INVITE message, could send an SIP response to Alice.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark808" class="s124">As an example, consider </a><a href="#bookmark808" class="a">Figure 9.1</a>0<a href="mailto:jim@umass.edu" class="s124" target="_blank">, in which </a>jim@umass.edu<a href="mailto:keith@upenn.edu" class="s124" target="_blank">, currently working on 217.123.56.89, wants to initiate a Voice-over-IP (VoIP) session with </a><a href="mailto:keith@upenn.edu" class="a" target="_blank">keith@upenn.ed</a>u<span class="p">, currently working on 197.87.54.21. The following steps are taken:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="459" height="523" alt="image" src="计算机网络自顶向下7th-en/Image_913.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark808">Figure 9.10 Session initiation, involving SIP proxies and registrars</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">(1) Jim sends an INVITE message to the umass SIP proxy. (2) The proxy does a DNS lookup on the SIP registrar upenn.edu (not shown in diagram) and then forwards the message to the registrar server.</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;"><a href="mailto:keith@upenn.edu" class="s124" target="_blank">(3) Because </a><a href="mailto:keith@upenn.edu" class="a" target="_blank">keith@upenn.edu</a> <a href="mailto:keith@nyu.edu" class="s124" target="_blank">is no longer registered at the upenn registrar, the upenn registrar sends a redirect response, indicating that it should try </a>keith@nyu.edu<a href="mailto:keith@upenn.edu" class="s124" target="_blank">. (4) The umass proxy sends an INVITE message to the NYU SIP registrar. (5) The NYU registrar knows the IP address of </a><a href="mailto:keith@upenn.edu" class="a" target="_blank">keith@upenn.edu</a></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 12pt;text-align: left;">and forwards the INVITE message to the host 197.87.54.21, which is running Keith’s SIP client. (6–8)</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">An SIP response is sent back through registrars/proxies to the SIP client on 217.123.56.89. (9) Media is sent directly between the two clients. (There is also an SIP acknowledgment message, which is not shown.)</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Our discussion of SIP has focused on call initiation for voice calls. SIP, being a signaling protocol for initiating and ending calls in general, can be used for video conference calls as well as for text-based</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark848" class="s124" name="bookmark809">sessions. In fact, SIP has become a fundamental component in many instant messaging applications. Readers desiring to learn more about SIP are encouraged to visit Henning Schulzrinne’s SIP Web site </a><a href="#bookmark848" class="a">[Schulzrinne-SIP 2016</a>]<span class="p">. In particular, on this site you will find open source software for SIP clients and</span><a name="bookmark810">&zwnj;</a></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: justify;"><a href="#bookmark848" class="s124">servers </a><a href="#bookmark848" class="a">[SIP Software 2016</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l376"><ol id="l377"><li style="padding-top: 2pt;padding-left: 38pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark811">Network Support for Multimedia</a></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark788" class="s124">In </a><a href="#bookmark788" class="a">Sections 9.2</a> <a href="#bookmark809" class="s124">through </a><a href="#bookmark809" class="a">9.</a>4<span class="p">, we learned how application-level mechanisms such as client buffering, prefetching, adapting media quality to available bandwidth, adaptive playout, and loss mitigation techniques can be used by multimedia applications to improve a multimedia application’s performance.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">We also learned how content distribution networks and P2P overlay networks can be used to provide a</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">system-level <span class="p">approach for delivering multimedia content. These techniques and approaches are all designed to be used in today’s best-effort Internet. Indeed, they are in use today precisely because the Internet provides only a single, best-effort class of service. But as designers of computer networks, we</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">can’t help but ask whether the <i>network </i>(rather than the applications or application-level infrastructure alone) might provide mechanisms to support multimedia content delivery. As we’ll see shortly, the answer is, of course, “yes”! But we’ll also see that a number of these new network-level mechanisms</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">have yet to be widely deployed. This may be due to their complexity and to the fact that application-level techniques together with best-effort service and properly dimensioned network resources (for example, bandwidth) can indeed provide a “good-enough” (even if not-always-perfect) end-to-end multimedia delivery service.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark812" class="a">Table 9.4</a> <span class="p">summarizes three broad approaches towards providing network-level support for multimedia applications.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_914.png"/></span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><span style=" color: #333;">Making the best of best-effort service. </span><a href="#bookmark788" class="s124">The application-level mechanisms and infrastructure that we studied in </a><a href="#bookmark788" class="a">Sections 9.2</a> <a href="#bookmark809" class="s124">through </a><a href="#bookmark809" class="a">9.4</a> <span class="p">can be successfully used in a well-dimensioned network where packet loss and excessive end-to-end delay rarely occur. When demand increases are</span></p><p class="s20" style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark848" class="s124">forecasted, the ISPs deploy additional bandwidth and switching capacity to continue to ensure satisfactory delay and packet-loss performance </a><a href="#bookmark848" class="a">[Huang 2005</a>]<span class="p">. We’ll discuss such </span><span class="s23">network</span> dimensioning <a href="#bookmark814" class="s124">further in </a><a href="#bookmark814" class="a">Section 9.5.</a>1<span class="p">.</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_915.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Differentiated service. <span class="p">Since the early days of the Internet, it’s been envisioned that different types of traffic (for example, as indicated in the Type-of-Service field in the IP4v packet header) could be provided with different classes of service, rather than a single one-size-fits-all best-effort service.</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">With <span class="s20">differentiated service</span>, one type of traffic might be given strict priority over another class of traffic when both types of traffic are queued at a router. For example, packets belonging to a real- time conversational application might be given priority over other packets due to their stringent delay constraints. Introducing differentiated service into the network will require new mechanisms for packet marking (indicating a packet’s class of service), packet scheduling, and more. We’ll cover</p><p style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark821" class="s124">differentiated service, and new network mechanisms needed to implement this service, in </a><a href="#bookmark821" class="a">Sections</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 25pt;text-indent: 0pt;text-align: left;"><a href="#bookmark821" class="a">9.5.2</a> <span class="p">and 9.5.3.</span></p><h2 style="padding-top: 3pt;padding-left: 19pt;text-indent: 0pt;text-align: left;"><a name="bookmark812">Table 9.4 Three network-level approaches to supporting multimedia applications</a></h2><p style="text-indent: 0pt;line-height: 3pt;text-align: left;"><br/></p><table style="border-collapse:collapse;width:567pt;margin-left:18.95pt" cellspacing="0"><tr><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Approach</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Granularity</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Guarantee</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Mechanisms</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">Complexity</p></td><td style="border-top-style:solid;border-top-width:2pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s129" style="padding-left: 8pt;padding-right: 9pt;text-indent: 0pt;line-height: 146%;text-align: left;">Deployment to date</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 20pt;text-indent: 0pt;line-height: 146%;text-align: left;">Making the best of best- effort service</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 34pt;text-indent: 0pt;line-height: 146%;text-align: left;">all traffic treated equally</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 3pt;text-indent: 0pt;line-height: 146%;text-align: left;">none, or soft</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 9pt;text-indent: 0pt;line-height: 146%;text-align: left;">application-layer support, CDNs, overlays, network- level resource provisioning</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">minimal</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">everywhere</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 17pt;text-indent: 0pt;line-height: 146%;text-align: left;">Differentiated service</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">different classes of traffic treated differently</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 3pt;text-indent: 0pt;line-height: 146%;text-align: left;">none, or soft</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 7pt;text-indent: 0pt;line-height: 146%;text-align: left;">packet marking, policing, scheduling</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">medium</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">some</p></td></tr><tr><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 13pt;text-indent: 0pt;line-height: 146%;text-align: left;">Per- connection Quality-of- Service (QoS) Guarantees</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 20pt;text-indent: 0pt;line-height: 146%;text-align: left;">each source- destination</p><p class="s122" style="padding-left: 8pt;padding-right: 10pt;text-indent: 0pt;line-height: 146%;text-align: left;">flows treated differently</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 9pt;text-indent: 0pt;line-height: 146%;text-align: left;">soft or hard, once flow is admitted</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;padding-right: 7pt;text-indent: 0pt;line-height: 146%;text-align: left;">packet marking, policing, scheduling; call admission and signaling</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">light</p></td><td style="border-top-style:solid;border-top-width:1pt;border-top-color:#468173;border-left-style:solid;border-left-width:1pt;border-left-color:#468173;border-bottom-style:solid;border-bottom-width:2pt;border-bottom-color:#468173;border-right-style:solid;border-right-width:1pt;border-right-color:#468173"><p style="text-indent: 0pt;line-height: 11pt;text-align: left;"><br/></p><p class="s122" style="padding-left: 8pt;text-indent: 0pt;text-align: left;">little</p></td></tr></table><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_916.png"/></span></p><p style="padding-top: 3pt;padding-left: 19pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>Per-connection Quality-of-Service (QoS) Guarantees. </b>With per-connection QoS guarantees, each instance of an application explicitly reserves end-to-end bandwidth and thus has a guaranteed end-to-end performance. A <span class="s20">hard guarantee </span>means the application will receive its requested quality</p><p style="padding-top: 1pt;padding-left: 19pt;text-indent: 0pt;line-height: 146%;text-align: left;">of service (QoS) with certainty. A <span class="s20">soft guarantee </span>means the application will receive its requested quality of service with high probability. For example, if a user wants to make a VoIP call from Host A to Host B, the user’s VoIP application reserves bandwidth explicitly in each link along a route between the two hosts. But permitting applications to make reservations and requiring the network to honor the reservations requires some big changes. First, we need a protocol that, on behalf of the applications, reserves link bandwidth on the paths from the senders to their receivers. Second, we’ll need new scheduling policies in the router queues so that per-connection bandwidth reservations can be honored. Finally, in order to make a reservation, the applications must give the network a description of the traffic that they intend to send into the network and the network will need to police each application’s traffic to make sure that it abides by that description. These mechanisms, when combined, require new and complex software in hosts and routers. Because per-connection QoS guaranteed service has not seen significant deployment, we’ll cover these mechanisms only briefly</p><p class="s20" style="padding-top: 2pt;padding-left: 19pt;text-indent: 0pt;text-align: left;"><a href="#bookmark828" class="s124">in </a><a href="#bookmark828" class="a">Section 9.5.</a>4<span class="p">.</span></p><ol id="l378"><li style="padding-top: 3pt;padding-left: 42pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;"><a name="bookmark813">Dimensioning Best-Effort Networks</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Fundamentally, the difficulty in supporting multimedia applications arises from their stringent performance requirements—low end-to-end packet delay, delay jitter, and loss—and the fact that packet delay, delay jitter, and loss occur whenever the network becomes congested. A first approach to improving the quality of multimedia applications—an approach that can often be used to solve just about any problem where resources are constrained—is simply to “throw money at the problem” and thus simply avoid resource contention. In the case of networked multimedia, this means providing enough link capacity throughout the network so that network congestion, and its consequent packet delay and loss, never (or only very rarely) occurs. With enough link capacity, packets could zip through today’s Internet without queuing delay or loss. From many perspectives this is an ideal situation—multimedia applications would perform perfectly, users would be happy, and this could all be achieved with no changes to Internet’s best-effort architecture.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The question, of course, is how much capacity is “enough” to achieve this nirvana, and whether the costs of providing “enough” bandwidth are practical from a business standpoint to the ISPs. The question of how much capacity to provide at network links in a given topology to achieve a given level of performance is often known as <span class="s20">bandwidth provisioning</span>. The even more complicated problem of how to design a network topology (where to place routers, how to interconnect routers with links, and what capacity to assign to links) to achieve a given level of end-to-end performance is a network design problem often referred to as <span class="s20">network dimensioning</span>. Both bandwidth provisioning and network dimensioning are complex topics, well beyond the scope of this textbook. We note here, however, that the following issues must be addressed in order to predict application-level performance between two network end points, and thus provision enough capacity to meet an application’s performance requirements.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_917.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Models of traffic demand between network end points. <span class="p">Models may need to be specified at both the call level (for example, users “arriving” to the network and starting up end-to-end applications) and at the packet level (for example, packets being generated by ongoing applications). Note that</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">workload may change over time.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_918.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;">Well-defined performance requirements. <span class="p">For example, a performance requirement for supporting delay-sensitive traffic, such as a conversational multimedia application, might be that the probability that the end-to-end delay of the packet is greater than a maximum tolerable delay be less than some</span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark848" class="s124">small value </a><a href="#bookmark848" class="a">[Fraleigh 2003</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_919.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Models to predict end-to-end performance for a given workload model, and techniques to find a minimal cost bandwidth allocation that will result in all user requirements being met. <span class="p">Here, researchers are busy developing performance models that can quantify performance for a given</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">workload, and optimization techniques to find minimal-cost bandwidth allocations meeting performance requirements.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark814">Given that today’s best-effort Internet could (from a technology standpoint) support multimedia traffic at an appropriate performance level if it were dimensioned to do so, the natural question is why today’s Internet doesn’t do so. The answers are primarily economic and organizational. From an economic standpoint, would users be willing to pay their ISPs enough for the ISPs to install sufficient bandwidth to support multimedia applications over a best-effort Internet? The organizational issues are perhaps even more daunting. Note that an end-to-end path between two multimedia end points will pass through the networks of multiple ISPs. From an organizational standpoint, would these ISPs be willing to cooperate (perhaps with revenue sharing) to ensure that the end-to-end path is properly dimensioned to support</a></p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark848" class="s124">multimedia applications? For a perspective on these economic and organizational issues, see </a><a href="#bookmark848" class="a">[Davies </a>2005]<a href="#bookmark848" class="s124">. For a perspective on provisioning tier-1 backbone networks to support delay-sensitive traffic, see </a><a href="#bookmark848" class="a">[Fraleigh 2003</a>]<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 43pt;text-indent: -37pt;text-align: left;"><p class="s19" style="display: inline;">Providing Multiple Classes of Service</p></li></ol></li></ol></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Perhaps the simplest enhancement to the one-size-fits-all best-effort service in today’s Internet is to divide traffic into classes, and provide different levels of service to these different classes of traffic. For example, an ISP might well want to provide a higher class of service to delay-sensitive Voice-over-IP or teleconferencing traffic (and charge more for this service!) than to elastic traffic such as e-mail or HTTP. Alternatively, an ISP may simply want to provide a higher quality of service to customers willing to pay more for this improved service. A number of residential wired-access ISPs and cellular wireless-access ISPs have adopted such tiered levels of service—with platinum-service subscribers receiving better performance than gold- or silver-service subscribers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">We’re all familiar with different classes of service from our everyday lives—first-class airline passengers get better service than business-class passengers, who in turn get better service than those of us who fly economy class; VIPs are provided immediate entry to events while everyone else waits in line; elders are revered in some countries and provided seats of honor and the finest food at a table. It’s important to note that such differential service is provided among aggregates of traffic, that is, among classes of traffic, not among individual connections. For example, all first-class passengers are handled the same (with no first-class passenger receiving any better treatment than any other first-class passenger), just as all VoIP packets would receive the same treatment within the network, independent of the particular end-to-end connection to which they belong. As we will see, by dealing with a small number of traffic aggregates, rather than a large number of individual connections, the new network mechanisms required to provide better-than-best service can be kept relatively simple.</p><p style="text-indent: 0pt;line-height: 12pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 23pt;text-align: left;"><a href="#bookmark368" class="s124">The early Internet designers clearly had this notion of multiple classes of service in mind. Recall the type-of-service (ToS) field in the IPv4 header discussed in </a><a href="#bookmark368" class="a">Chapter </a>4<a href="#bookmark848" class="s124">. IEN123 </a><a href="#bookmark848" class="a">[ISI 1979]</a> <span class="p">describes the</span></p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">ToS field also present in an ancestor of the IPv4 datagram as follows: “The Type of Service [field]</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">provides an indication of the abstract parameters of the quality of service desired. These parameters are to be used to guide the selection of the actual service parameters when transmitting a datagram through a particular network. Several networks offer service precedence, which somehow treats high precedence traffic as more important that other traffic.” More than four decades ago, the vision of providing different levels of service to different classes of traffic was clear! However, it’s taken us an equally long period of time to realize this vision.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Motivating Scenarios</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s begin our discussion of network mechanisms for providing multiple classes of service with a few motivating scenarios.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark815" class="a">Figure 9.11</a> <span class="p">shows a simple network scenario in which two application packet flows originate on Hosts H1 and H2 on one LAN and are destined for Hosts H3 and H4 on another LAN. The routers on the two LANs are connected by a 1.5 Mbps link. Let’s assume the LAN speeds are significantly higher than 1.5</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Mbps, and focus on the output queue of router R1; it is here that packet delay and packet loss will occur if the aggregate sending rate of H1 and H2 exceeds 1.5 Mbps. Let’s further suppose that a 1 Mbps audio application (for example, a CD-quality audio call) shares the</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="451" height="343" alt="image" src="计算机网络自顶向下7th-en/Image_920.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark815">Figure 9.11 Competing audio and HTTP applications</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">1.5 Mbps link between R1 and R2 with an HTTP Web-browsing application that is downloading a Web page from H2 to H4.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the best-effort Internet, the audio and HTTP packets are mixed in the output queue at R1 and (typically) transmitted in a first-in-first-out (FIFO) order. In this scenario, a burst of packets from the Web</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">server could potentially fill up the queue, causing IP audio packets to be excessively delayed or lost due to buffer overflow at R1. How should we solve this potential problem? Given that the HTTP Web- browsing application does not have time constraints, our intuition might be to give strict priority to audio packets at R1. Under a strict priority scheduling discipline, an audio packet in the R1 output buffer would always be transmitted before any HTTP packet in the R1 output buffer. The link from R1 to R2 would look like a dedicated link of 1.5 Mbps to the audio traffic, with HTTP traffic using the R1-to-R2 link only when no audio traffic is queued. In order for R1 to distinguish between the audio and HTTP packets in its queue, each packet must be marked as belonging to one of these two classes of traffic. This was the original goal of the type-of-service (ToS) field in IPv4. As obvious as this might seem, this then is our first insight into mechanisms needed to provide multiple classes of traffic:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">Insight 1: Packet marking <span class="p">allows a router to distinguish among packets belonging to different classes of traffic.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Note that although our example considers a competing multimedia and elastic flow, the same insight applies to the case that platinum, gold, and silver classes of service are implemented—a packet- marking mechanism is still needed to indicate that class of service to which a packet belongs.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Now suppose that the router is configured to give priority to packets marked as belonging to the 1 Mbps audio application. Since the outgoing link speed is 1.5 Mbps, even though the HTTP packets receive lower priority, they can still, on average, receive 0.5 Mbps of transmission service. But what happens if the audio application starts sending packets at a rate of 1.5 Mbps or higher (either maliciously or due to an error in the application)? In this case, the HTTP packets will starve, that is, they will not receive any service on the R1-to-R2 link. Similar problems would occur if multiple applications (for example, multiple audio calls), all with the same class of service as the audio application, were sharing the link’s bandwidth; they too could collectively starve the FTP session. Ideally, one wants a degree of isolation among classes of traffic so that one class of traffic can be protected from the other. This protection could be implemented at different places in the network—at each and every router, at first entry to the  network, or at inter-domain network boundaries. This then is our second insight:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 126%;text-align: left;"><b>Insight 2: </b>It is desirable to provide a degree of <span class="s23">traffic</span><span class="s20"> isolation </span>among classes so that one class is not adversely affected by another class of traffic that misbehaves.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><span class="p">We’ll examine several specific mechanisms for providing such isolation among traffic classes. We note here that two broad approaches can be taken. First, it is possible to perform </span>traffic policing<a href="#bookmark816" class="s124">, as shown in </a><a href="#bookmark816" class="a">Figure 9.1</a>2<span class="p">. If a traffic class or flow must meet certain criteria (for example, that the audio flow not</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">exceed a peak rate of 1 Mbps), then a policing mechanism can be put into place to ensure that these</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">criteria are indeed observed. If the policed application misbehaves, the policing mechanism will take some action (for example, drop or delay packets that are in violation of the criteria) so that the traffic actually entering the network conforms to the criteria. The leaky bucket mechanism that we’ll examine</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark816" class="s124">shortly is perhaps the most widely used policing mechanism. In </a><a href="#bookmark816" class="a">Figure 9.1</a>2<span class="p">, the packet classification and marking mechanism (Insight 1) and the policing mechanism (Insight 2) are both implemented together at the network’s edge, either in the end system or at an edge router.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">A complementary approach for providing isolation among traffic classes is for the link-level packet- scheduling mechanism to explicitly allocate a fixed amount of link bandwidth to each class. For example, the audio class could be allocated 1 Mbps at R1, and the HTTP class could be allocated 0.5 Mbps. In this case, the audio and</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="448" height="530" alt="image" src="计算机网络自顶向下7th-en/Image_921.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark816">Figure 9.12 Policing (and marking) the audio and HTTP traffic classes</a></h2><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="451" height="343" alt="image" src="计算机网络自顶向下7th-en/Image_922.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark817">Figure 9.13 Logical isolation of audio and HTTP traffic classes</a></h2><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark817" class="s124">HTTP flows see a logical link with capacity 1.0 and 0.5 Mbps, respectively, as shown in </a><a href="#bookmark817" class="a">Figure 9.1</a>3<span class="p">. With strict enforcement of the link-level allocation of bandwidth, a class can use only the amount of bandwidth that has been allocated; in particular, it cannot utilize bandwidth that is not currently being</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">used by others. For example, if the audio flow goes silent (for example, if the speaker pauses and generates no audio packets), the HTTP flow would still not be able to transmit more than 0.5 Mbps over the R1-to-R2 link, even though the audio flow’s 1 Mbps bandwidth allocation is not being used at that moment. Since bandwidth is a “use-it-or-lose-it” resource, there is no reason to prevent HTTP traffic from using bandwidth not used by the audio traffic. We’d like to use bandwidth as efficiently as possible, never wasting it when it could be otherwise used. This gives rise to our third insight:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">Insight 3: <span class="p">While providing isolation among classes or flows, it is desirable to use resources (for example, link bandwidth and buffers) as efficiently as possible.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark59" class="s124">Recall from our discussion in </a><a href="#bookmark59" class="a">Sections 1.3</a> <a href="#bookmark394" class="s124">and </a><a href="#bookmark394" class="a">4.2</a> <span class="p">that packets belonging to various network flows are multiplexed and queued for transmission at the output buffers associated with a link. The manner in which queued packets are selected for transmission on the link is known as the </span>link-scheduling</p><p class="s20" style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 136%;text-align: left;"><span class="s23">disciplin</span>e<a href="#bookmark394" class="s124">, and was discussed in detail in </a><a href="#bookmark394" class="a">Section 4.</a>2<a href="#bookmark394" class="s124">. Recall that in </a><a href="#bookmark394" class="a">Section 4.2</a> <span class="p">three link-scheduling disciplines were discussed, namely, FIFO, priority queuing, and Weighted Fair Queuing (WFQ). We’ll see soon see that WFQ will play a particularly important role for isolating the traffic classes.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark818">The Leaky Bucket</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">One of our earlier insights was that policing, the regulation of the rate at which a class or flow (we will assume the unit of policing is a flow in our discussion below) is allowed to inject packets into the</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">network, is an important QoS mechanism. But what aspects of a flow’s packet rate should be policed? We can identify three important policing criteria, each differing from the other according to the time scale over which the packet flow is policed:</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_923.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Average rate. <span class="p">The network may wish to limit the long-term average rate (packets per time interval) at which a flow’s packets can be sent into the network. A crucial issue here is the interval of time over which the average rate will be policed. A flow whose average rate is limited to 100 packets per</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">second is more constrained than a source that is limited to 6,000 packets per minute, even though both have the same average rate over a long enough interval of time. For example, the latter constraint would allow a flow to send 1,000 packets in a given second-long interval of time, while the former constraint would disallow this sending behavior.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_924.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Peak rate. <span class="p">While the average-rate constraint limits the amount of traffic that can be sent into the network over a relatively long period of time, a peak-rate constraint limits the maximum number of packets that can be sent over a shorter period of time. Using our example above, the network may</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">police a flow at an average rate of 6,000 packets per minute, while limiting the flow’s peak rate to 1,500 packets per second.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_925.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Burst size. <span class="p">The network may also wish to limit the maximum number of packets (the “burst” of packets) that can be sent into the network over an extremely short interval of time. In the limit, as the interval length approaches zero, the burst size limits the number of packets that can be</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">instantaneously sent into the network. Even though it is physically impossible to instantaneously send multiple packets into the network (after all, every link has a physical transmission rate that cannot be exceeded!), the abstraction of a maximum burst size is a useful one.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">The leaky bucket mechanism is an abstraction that can be used to characterize these policing limits. As</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark819" class="s124">shown in </a><a href="#bookmark819" class="a">Figure 9.1</a><span class="s20">4</span>, a leaky bucket consists of a bucket that can hold up to <i>b </i>tokens. Tokens are added to this bucket as follows. New tokens, which may potentially be added to the bucket, are always</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">being generated at a rate of <i>r </i>tokens per second. (We assume here for simplicity that the unit of time is a second.) If the bucket is filled with less than <i>b </i>tokens when a token is generated, the newly generated token is added to the bucket; otherwise the newly generated token is ignored, and the token bucket</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">remains full with <i>b </i>tokens.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let us now consider how the leaky bucket can be used to police a packet flow. Suppose that before a packet is transmitted into the network, it must first remove a token from the token bucket. If the token bucket is empty, the packet must wait for</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="658" height="348" alt="image" src="计算机网络自顶向下7th-en/Image_926.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark819">Figure 9.14 The leaky bucket policer</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 153%;text-align: left;">a token. (An alternative is for the packet to be dropped, although we will not consider that option here.) Let us now consider how this behavior polices a traffic flow. Because there can be at most <i>b </i>tokens in the bucket, the maximum burst size for a leaky-bucket-policed flow is <i>b </i>packets. Furthermore, because</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">the token generation rate is <i>r</i>, the maximum number of packets that can enter the network of <i>any </i>interval</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 126%;text-align: left;">of time of length <i>t </i>is <span class="s27">r</span>t+b. Thus, the token-generation rate, <i>r</i>, serves to limit the long-term average rate at which packets can enter the network. It is also possible to use leaky buckets (specifically, two leaky</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">buckets in series) to police a flow’s peak rate in addition to the long-term average rate; see the homework problems at the end of this chapter.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">Leaky Bucket + Weighted Fair Queuing = Provable Maximum Delay in a Queue</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: justify;"><a href="#bookmark394" class="s124">Let’s close our discussion on policing by showing how the leaky bucket and WFQ can be combined to provide a bound on the delay through a router’s queue. (Readers who have forgotten about WFQ are encouraged to review WFQ, which is covered in </a><a href="#bookmark394" class="a">Section 4.</a>2<span class="p">.) Let’s consider a router’s output link that</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 13pt;text-align: left;">multiplexes <i>n </i>flows, each policed by a leaky bucket with parameters <i>b</i><span class="s31">i </span>and <span class="s27">r</span>i,i=1,…,n, using WFQ</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 130%;text-align: left;">scheduling. We use the term <i>flow </i>here loosely to refer to the set of packets that are not distinguished from each other by the scheduler. In practice, a flow might be comprised of traffic from a single end-to-</p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="#bookmark822" class="s124">end connection or a collection of many such connections, see </a><a href="#bookmark822" class="a">Figure 9.1</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 116%;text-align: left;"><a name="bookmark820">Recall from our discussion of WFQ that each flow, </a><i>i</i>, is guaranteed to receive a share of the link bandwidth equal to at least <span class="s27">R</span><span class="s29">⋅</span>wi/(∑ wj), where <i>R </i>is the transmission</p><p style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span><img width="610" height="363" alt="image" src="计算机网络自顶向下7th-en/Image_927.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark821">Figure 9.15 </a><i>n </i>multiplexed leaky bucket flows with WFQ scheduling<a name="bookmark822">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;">rate of the link in packets/sec. What then is the maximum delay that a packet will experience while waiting for service in the WFQ (that is, after passing through the leaky bucket)? Let us focus on flow 1. Suppose that flow 1’s token bucket is initially full. A burst of <i>b</i><span class="s22">1 </span>packets then arrives to the leaky bucket</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">policer for flow 1. These packets remove all of the tokens (without wait) from the leaky bucket and then</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 142%;text-align: left;">join the WFQ waiting area for flow 1. Since these <i>b</i><span class="s22">1 </span>packets are served at a rate of at least <span class="s27">R</span><span class="s29">⋅</span>wi/(∑ wj) packet/sec, the last of these packets will then have a maximum delay, <i>d</i><span class="s22">max</span>, until its transmission is completed, where</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">dmax=b1R<span class="s29">⋅</span>w1/∑ wj</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 127%;text-align: left;">The rationale behind this formula is that if there are <i>b</i><span class="s22">1 </span>packets in the queue and packets are being serviced (removed) from the queue at a rate of at least R<span class="s29">⋅</span>w1/(∑ wj) packets per second, then the amount of time until the last bit of the last packet is transmitted cannot be more than b1/(R<span class="s29">⋅</span>w1/(∑ wj)). A homework problem asks you to prove that as long as <span class="s27">r</span>1&lt;R<span class="s29">⋅</span>w1/(∑ wj), then <i>d</i><span class="s22">max </span>is indeed the maximum delay that any packet in flow 1 will ever experience in the WFQ queue.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><ol id="l379"><ol id="l380"><ol id="l381"><li style="padding-left: 5pt;text-indent: 1pt;text-align: left;"><p class="s19" style="display: inline;">Diffserv</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 153%;text-align: left;"><a href="#bookmark848" class="s124">Having seen the motivation, insights, and specific mechanisms for providing multiple classes of service, let’s wrap up our study of approaches toward proving multiple classes of service with an example—the Internet Diffserv architecture </a><a href="#bookmark848" class="a">[RFC </a>2475<a href="#bookmark848" class="s124">; </a><a href="#bookmark848" class="a">Kilkki 1999</a>]<span class="p">. Diffserv provides service differentiation—that is,</span></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">the ability to handle different classes of traffic in different ways within the Internet in a scalable manner.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">The need for scalability arises from the fact that millions of simultaneous source-destination traffic flows may be present at a backbone router. We’ll see shortly that this need is met by placing only simple functionality within the network core, with more complex control operations being implemented at the network’s edge.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark823" class="s124">Let’s begin with the simple network shown in </a><a href="#bookmark823" class="a">Figure 9.1</a>6<a href="#bookmark848" class="s124">. We’ll describe one possible use of Diffserv here; other variations are possible, as described in </a><a href="#bookmark848" class="a">RFC </a>2475<span class="p">. The Diffserv architecture consists of two sets of functional elements:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_928.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Edge functions: Packet classification and traffic conditioning. <span class="p">At the incoming edge of the network (that is, at either a Diffserv-capable host that generates traffic or at the first Diffserv-capable router that the traffic passes through), arriving packets are marked. More specifically, the</span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">differentiated service (DS) field in the IPv4 or IPv6 packet header is set to some value </a><a href="#bookmark848" class="a">[RFC </a>3260]<span class="p">. The definition of the DS field is intended to supersede the earlier definitions of the IPv4 type-of-</span></p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark368" class="s124">service field and the IPv6 traffic class fields that we discussed in </a><a href="#bookmark368" class="a">Chapter </a>4<a href="#bookmark823" class="s124">. For example, in </a><a href="#bookmark823" class="a">Figure 9.1</a>6<span class="p">, packets being sent from H1 to H3 might be marked at R1, while packets being sent from H2 to H4 might be marked at R2. The mark that a packet receives identifies the class of traffic to which it</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">belongs. Different classes of traffic will then receive different service within the core network.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="614" height="425" alt="image" src="计算机网络自顶向下7th-en/Image_929.png"/></span></p><p style="text-indent: 0pt;line-height: 13pt;text-align: left;"><br/></p><h2 style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark823">Figure 9.16 A simple Diffserv network example</a></h2><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_930.png"/></span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Core function: Forwarding. <span class="p">When a DS-marked packet arrives at a Diffserv-capable router, the packet is forwarded onto its next hop according to the so-called per-hop behavior (PHB) associated with that packet’s class. The per-hop behavior influences how a router’s buffers and link bandwidth</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">are shared among the competing classes of traffic. A crucial tenet of the Diffserv architecture is that</p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">a router’s per-hop behavior will be based only on packet markings, that is, the class of traffic to</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark823" class="s124">which a packet belongs. Thus, if packets being sent from H1 to H3 in </a><a href="#bookmark823" class="a">Figure 9.16</a> <span class="p">receive the same marking as packets being sent from H2 to H4, then the network routers treat these packets as an aggregate, without distinguishing whether the packets originated at H1 or H2. For example, R3</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">would not distinguish between packets from H1 and H2 when forwarding these packets on to R4. Thus, the Diffserv architecture obviates the need to keep router state for individual source- destination pairs—a critical consideration in making Diffserv scalable.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">An analogy might prove useful here. At many large-scale social events (for example, a large public reception, a large dance club or discothèque, a concert, or a football game), people entering the event receive a pass of one type or another: VIP passes for Very Important People; over-21 passes for people who are 21 years old or older (for example, if alcoholic drinks are to be served); backstage passes at concerts; press passes for reporters; even an ordinary pass for the Ordinary Person. These passes are typically distributed upon entry to the event, that is, at the edge of the event. It is here at the edge where computationally intensive operations, such as paying for entry, checking for the appropriate type of invitation, and matching an invitation against a piece of identification, are performed. Furthermore, there may be a limit on the number of people of a given type that are allowed into an event. If there is such a limit, people may have to wait before entering the event. Once inside the event, one’s pass allows one to receive differentiated service at many locations around the event—a VIP is provided with free drinks, a better table, free food, entry to exclusive rooms, and fawning service. Conversely, an ordinary person is excluded from certain areas, pays for drinks, and receives only basic service. In both cases, the service received within the event depends solely on the type of one’s pass. Moreover, all people within a class are treated alike.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark824" class="a">Figure 9.17</a> <span class="p">provides a logical view of the classification and marking functions within the edge router. Packets arriving to the edge router are first classified. The classifier selects packets based on the values of one or more packet header fields (for example, source address, destination address, source port,</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">destination port, and protocol ID) and steers the packet to the appropriate marking function. As noted above, a packet’s marking is carried in the DS field in the packet header.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In some cases, an end user may have agreed to limit its packet-sending rate to conform to a declared <span class="s20">traffic profile</span>. The traffic profile might contain a limit on the peak rate, as well as the burstiness of the packet flow, as we saw previously with the leaky bucket mechanism. As long as the user sends packets into the network in a way that conforms to the negotiated traffic profile, the packets receive their priority</p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="551" height="285" alt="image" src="计算机网络自顶向下7th-en/Image_931.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark824">Figure 9.17 A simple Diffserv network example</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">marking and are forwarded along their route to the destination. On the other hand, if the traffic profile is violated, out-of-profile packets might be marked differently, might be shaped (for example, delayed so that a maximum rate constraint would be observed), or might be dropped at the network edge. The role of the </span><span class="s23">metering</span> function<a href="#bookmark824" class="s124">, shown in </a><a href="#bookmark824" class="a">Figure 9.1</a>7<span class="p">, is to compare the incoming packet flow with the</span></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 11pt;text-align: left;">negotiated traffic profile and to determine whether a packet is within the negotiated traffic profile. The</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 161%;text-align: left;">actual decision about whether to immediately remark, forward, delay, or drop a packet is a policy issue determined by the network administrator and is <i>not </i>specified in the Diffserv architecture.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">So far, we have focused on the marking and policing functions in the Diffserv architecture. The second key component of the Diffserv architecture involves the per-hop behavior (PHB) performed by Diffserv- capable routers. PHB is rather cryptically, but carefully, defined as “a description of the externally observable forwarding behavior of a Diffserv node applied to a particular Diffserv behavior aggregate”</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="a">[RFC </a>2475]<span class="p">. Digging a little deeper into this definition, we can see several important considerations embedded within:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_932.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;">A PHB can result in different classes of traffic receiving different performance (that is, different externally observable forwarding behaviors).</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_933.png"/></span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">While a PHB defines differences in performance (behavior) among classes, it does not mandate any particular mechanism for achieving these behaviors. As long as the externally observable performance criteria are met, any implementation mechanism and any buffer/bandwidth allocation</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">policy can be used. For example, a PHB would not require that a particular packet-queuing discipline (for example, a priority queue versus a WFQ queue versus a FCFS queue) be used to achieve a particular behavior. The PHB is the end, to which resource allocation and implementation mechanisms are the means.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_934.png"/></span></p><p style="padding-top: 2pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">Differences in performance must be observable and hence measurable.</p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 129%;text-align: left;"><a href="#bookmark848" class="s124" name="bookmark825">Two PHBs have been defined: an expedited forwarding (EF) PHB </a><a href="#bookmark848" class="a">[RFC 3246]</a> <a href="#bookmark848" class="s124">and an assured forwarding (AF) PHB </a><a href="#bookmark848" class="a">[RFC </a>2597]<span class="p">. The </span><span class="s23">expedited</span> forwarding <span class="p">PHB specifies that the departure rate of a class of traffic from a router must equal or exceed a configured rate. The </span>assured forwarding <span class="p">PHB</span></p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">divides traffic into four classes, where each AF class is guaranteed to be provided with some minimum amount of bandwidth and buffering.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Let’s close our discussion of Diffserv with a few observations regarding its service model. First, we have implicitly assumed that Diffserv is deployed within a single administrative domain, but typically an end- to-end service must be fashioned from multiple ISPs sitting between communicating end systems. In order to provide end-to-end Diffserv service, all the ISPs between the end systems must not only provide this service, but most also cooperate and make settlements in order to offer end customers true end-to-end service. Without this kind of cooperation, ISPs directly selling Diffserv service to customers will find themselves repeatedly saying: “Yes, we know you paid extra, but we don’t have a service agreement with the ISP that dropped and delayed your traffic. I’m sorry that there were so many gaps in your VoIP call!” Second, if Diffserv were actually in place and the network ran at only moderate load, most of the time there would be no perceived difference between a best-effort service and a Diffserv service. Indeed, end-to-end delay is usually dominated by access rates and router hops rather than by queuing delays in the routers. Imagine the unhappy Diffserv customer who has paid more for premium service but finds that the best-effort service being provided to others almost always has the same performance as premium service!</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 5pt;text-indent: 0pt;line-height: 178%;text-align: left;"><p class="s19" style="display: inline;">Per-Connection Quality-of-Service (QoS) Guarantees: Resource Reservation and Call Admission</p></li></ol></ol></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In the previous section, we have seen that packet marking and policing, traffic isolation, and link-level scheduling can provide one class of service with better performance than another. Under certain scheduling disciplines, such as priority scheduling, the lower classes of traffic are essentially “invisible” to the highest-priority class of traffic. With proper network dimensioning, the highest class of service can indeed achieve extremely low packet loss and delay—essentially circuit-like performance. But can the</p><p style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">network <i>guarantee </i>that an ongoing flow in a high-priority traffic class will continue to receive such service throughout the flow’s duration using only the mechanisms that we have described so far? It cannot. In this section, we’ll see why yet additional network mechanisms and protocols are required</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">when a hard service guarantee is provided to individual connections.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;"><a href="#bookmark821" class="s124">Let’s return to our scenario from </a><a href="#bookmark821" class="a">Section 9.5.2</a> <a href="#bookmark826" class="s124">and consider two 1 Mbps audio applications transmitting their packets over the 1.5 Mbps link, as shown in </a><a href="#bookmark826" class="a">Figure 9.1</a>8<span class="p">. The combined data rate of the two flows (2 Mbps) exceeds the link capacity. Even with classification and marking, isolation of flows, and sharing</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">of unused bandwidth (of which there is none), this is clearly a losing proposition. There is simply not</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">enough bandwidth to accommodate the needs of both applications at</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="469" height="309" alt="image" src="计算机网络自顶向下7th-en/Image_935.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark826">Figure 9.18 Two competing audio applications overloading the R1-to-R2 link</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">the same time. If the two applications equally share the bandwidth, each application would lose 25 percent of its transmitted packets. This is such an unacceptably low QoS that both audio applications are completely unusable; there’s no need even to transmit any audio packets in the first place.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark826" class="s124">Given that the two applications in </a><a href="#bookmark826" class="a">Figure 9.18</a> <span class="p">cannot both be satisfied simultaneously, what should the network do? Allowing both to proceed with an unusable QoS wastes network resources on application flows that ultimately provide no utility to the end user. The answer is hopefully clear—one of the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">application flows should be blocked (that is, denied access to the network), while the other should be allowed to proceed on, using the full 1 Mbps needed by the application. The telephone network is an example of a network that performs such call blocking—if the required resources (an end-to-end circuit in the case of the telephone network) cannot be allocated to the call, the call is blocked (prevented from entering the network) and a busy signal is returned to the user. In our example, there is no gain in allowing a flow into the network if it will not receive a sufficient QoS to be considered usable. Indeed, there is a cost to admitting a flow that does not receive its needed QoS, as network resources are being used to support a flow that provides no utility to the end user.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">By explicitly admitting or blocking flows based on their resource requirements, and the source requirements of already-admitted flows, the network can guarantee that admitted flows will be able to receive their requested QoS. Implicit in the need to provide a guaranteed QoS to a flow is the need for the flow to declare its QoS requirements. This process of having a flow declare its QoS requirement, and then having the network either accept the flow (at the required QoS) or block the flow is referred to as the <span class="s20">call admission </span>process. This then is our fourth insight (in addition to the three earlier insights</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="#bookmark821" class="s124">from </a><a href="#bookmark821" class="a">Section 9.5.</a>2<span class="p">,) into the mechanisms needed to provide QoS.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>Insight 4: </b>If sufficient resources will not always be available, and QoS is to be <i>guaranteed</i>, a call admission process is needed in which flows declare their QoS requirements and are then either admitted to the network (at the required QoS) or blocked from the network (if the required QoS cannot</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">be provided by the network).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark826" class="s124">Our motivating example in </a><a href="#bookmark826" class="a">Figure 9.18</a> <span class="p">highlights the need for several new network mechanisms and protocols if a call (an end-to-end flow) is to be guaranteed a given quality of service once it begins:</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_936.png"/></span></p><p style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;"><b>Resource reservation. </b>The only way to <i>guarantee </i>that a call will have the resources (link bandwidth, buffers) needed to meet its desired QoS is to explicitly allocate those resources to the call—a process known in networking parlance as <span class="s20">resource reservation</span>. Once resources are</p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 153%;text-align: left;">reserved, the call has on-demand access to these resources throughout its duration, regardless of the demands of all other calls. If a call reserves and receives a guarantee of <i>x </i>Mbps of link bandwidth, and never transmits at a rate greater than <i>x</i>, the call will see loss- and delay-free</p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 11pt;text-align: left;">performance.</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_937.png"/></span></p><p class="s28" style="padding-left: 26pt;text-indent: 0pt;line-height: 138%;text-align: left;">Call admission. <span class="p">If resources are to be reserved, then the network must have a mechanism for calls to request and reserve resources. Since resources are not infinite, a call making a call admission request will be denied admission, that is, be blocked, if the requested resources are not available.</span></p><p style="padding-top: 1pt;padding-left: 26pt;text-indent: 0pt;line-height: 146%;text-align: left;">Such a call admission is performed by the telephone network—we request resources when we dial a number. If the circuits (TDMA slots) needed to complete the call are available, the circuits are allocated and the call is completed. If the circuits are not available, then the call is blocked, and we receive a busy signal. A blocked call can try again to gain admission to the network, but it is not allowed to send traffic into the network until it has successfully completed the call admission process. Of course, a router that allocates link bandwidth should not allocate more than is available at that link. Typically, a call may reserve only a fraction of the link’s bandwidth, and so a router may allocate link bandwidth to more than one call. However, the sum of the allocated bandwidth to all calls should be less than the link capacity if hard quality of service guarantees are to be provided.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_938.png"/></span></p><p class="s28" style="padding-top: 2pt;padding-left: 25pt;text-indent: 0pt;line-height: 138%;text-align: left;">Call setup signaling. <span class="p">The call admission process described above requires that a call be able to reserve sufficient resources at each and every network router on its source-to-destination path to ensure that its end-to-end QoS requirement is met. Each router must determine the local resources</span></p><p style="padding-top: 1pt;padding-left: 25pt;text-indent: 0pt;line-height: 146%;text-align: left;">required by the session, consider the amounts of its resources that are already committed to other ongoing sessions, and determine whether it has sufficient resources to satisfy the per-hop QoS requirement of the session at this router without violating local QoS guarantees made to an already- admitted session. A signaling protocol is needed to coordinate these various activities—the per-hop allocation of local resources, as well as the overall end-to-end decision of whether or not the call has been able to reserve suf</p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><span><img width="609" height="383" alt="image" src="计算机网络自顶向下7th-en/Image_939.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><h2 style="padding-top: 3pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a name="bookmark827">Figure 9.19 The call setup process</a><a name="bookmark828">&zwnj;</a><a name="bookmark829">&zwnj;</a></h2><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 147%;text-align: left;"><span class="p">ficient resources at each and every router on the end-to-end path. This is the job of the </span>call setup <span class="s23">protocol</span><a href="#bookmark829" class="s124">, as shown in </a><a href="#bookmark829" class="a">Figure 9.1</a>9<span class="p">. The </span><span class="s23">RSVP</span><a href="#bookmark844" class="a"> protocol [Zhang 199</a>3<a href="#bookmark848" class="s124">, </a><a href="#bookmark848" class="a">RFC 2210]</a> <span class="p">was proposed for</span></p><p style="padding-left: 26pt;text-indent: 0pt;line-height: 11pt;text-align: left;">this purpose within an Internet architecture for providing quality-of-service guarantees. In ATM</p><p style="text-indent: 0pt;line-height: 9pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark848" class="s124">networks, the Q2931b protocol </a><a href="#bookmark848" class="a">[Black 1995]</a> <span class="p">carries this information among the ATM network’s switches and end point.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">Despite a tremendous amount of research and development, and even products that provide for per- connection quality of service guarantees, there has been almost no extended deployment of such services. There are many possible reasons. First and foremost, it may well be the case that the simple</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark788" class="s124">application-level mechanisms that we studied in </a><a href="#bookmark788" class="a">Sections 9.2</a> <a href="#bookmark809" class="s124">through </a><a href="#bookmark809" class="a">9.</a>4<a href="#bookmark814" class="s124">, combined with proper network dimensioning (</a><a href="#bookmark814" class="a">Section 9.5.</a>1<span class="p">) provide “good enough” best-effort network service for multimedia applications. In addition, the added complexity and cost of deploying and managing a network that</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">provides per-connection quality of service guarantees may be judged by ISPs to be simply too high given predicted customer revenues for that service.</p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><ol id="l382"><ol id="l383"><li style="padding-top: 2pt;padding-left: 39pt;text-indent: -33pt;text-align: left;"><p class="s18" style="display: inline;"><a name="bookmark830">Summary</a><a name="bookmark831">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">Multimedia networking is one of the most exciting developments in the Internet today. People throughout the world less and less time in front of their televisions, and are instead use their smartphones and devices to receive audio and video transmissions, both live and prerecorded. Moreover, with sites like YouTube, users have become producers as well as consumers of multimedia Internet content. In addition to video distribution, the Internet is also being used to transport phone calls. In fact, over the next 10 years, the Internet, along with wireless Internet access, may make the traditional circuit- switched telephone system a thing of the past. VoIP not only provides phone service inexpensively, but also provides numerous value-added services, such as video conferencing, online directory services, voice messaging, and integration into social networks such as Facebook and WeChat.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark781" class="s124">In </a><a href="#bookmark781" class="a">Section 9.</a>1<span class="p">, we described the intrinsic characteristics of video and voice, and then classified multimedia applications into three categories: (i) streaming stored audio/video, (ii) conversational voice/video-over-IP, and (iii) streaming live audio/video.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark788" class="s124">In </a><a href="#bookmark788" class="a">Section 9.</a>2<span class="p">, we studied streaming stored video in some depth. For streaming video applications, prerecorded videos are placed on servers, and users send requests to these servers to view the videos on demand. We saw that streaming video systems can be classified into two categories: UDP streaming</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">and HTTP. We observed that the most important performance measure for streaming video is average throughput.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark799" class="s124">In </a><a href="#bookmark799" class="a">Section 9.</a>3<span class="p">, we examined how conversational multimedia applications, such as VoIP, can be designed to run over a best-effort network. For conversational multimedia, timing considerations are important because conversational applications are highly delay-sensitive. On the other hand,</span></p><p style="padding-top: 1pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">conversational multimedia applications are loss—tolerant—occasional loss only causes occasional glitches in audio/video playback, and these losses can often be partially or fully concealed. We saw how a combination of client buffers, packet sequence numbers, and timestamps can greatly alleviate the effects of network-induced jitter. We also surveyed the technology behind Skype, one of the leading</p><p class="s20" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark809" class="s124">voice- and video-over-IP companies. In </a><a href="#bookmark809" class="a">Section 9.</a>4<span class="p">, we examined two of the most important standardized protocols for VoIP, namely, RTP and SIP.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark827" class="s124">In </a><a href="#bookmark827" class="a">Section 9.</a>5<span class="p">, we introduced how several network mechanisms (link-level scheduling disciplines and traffic policing) can be used to provide differentiated service among several classes of traffic.</span></p><p class="s18" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark832">Homework Problems and Questions</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">Chapter 9 Review Questions</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 9.1</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark777" class="s124">R1. Reconstruct </a><a href="#bookmark777" class="a">Table 9.1</a> <span class="p">for when Victor Video is watching a 4 Mbps video, Facebook Frank is looking at a new 100 Kbyte image every 20 seconds, and Martha Music is listening to 200 kbps audio stream.</span></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R2. There are two types of redundancy in video. Describe them, and discuss how they can be exploited for efficient compression.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;">R3. Suppose an analog audio signal is sampled 16,000 times per second, and each sample is quantized into one of 1024 levels. What would be the resulting bit rate of the PCM digital audio signal?</p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R4. Multimedia applications can be classified into three categories. Name and describe each category.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 9.2</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R5. Streaming video systems can be classified into three categories. Name and briefly describe each of these categories.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R6. List three disadvantages of UDP streaming.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R7. With HTTP streaming, are the TCP receive buffer and the client’s application buffer the same thing? If not, how do they interact?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R8. Consider the simple model for HTTP streaming. Suppose the server sends bits at a constant rate of 2 Mbps and playback begins when 8 million bits have been received. What is the initial</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">buffering delay <i>t</i><span class="s31">p</span>?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 9.3</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R9. What is the difference between end-to-end delay and packet jitter? What are the causes of packet jitter?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">R10. Why is a packet that is received after its scheduled playout time considered lost?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark799" class="s124">R11. </a><a href="#bookmark799" class="a">Section 9.3</a> <span class="p">describes two FEC schemes. Briefly summarize them. Both schemes increase the transmission rate of the stream by adding overhead. Does interleaving also increase the</span></p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;text-align: left;">transmission rate?</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">SECTION 9.4</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R12. How are different RTP streams in different sessions identified by a receiver? How are different streams from within the same session identified?</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;">R13. What is the role of a SIP registrar? How is the role of an SIP registrar different from that of a home agent in Mobile IP?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Problems</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-top: 3pt;padding-left: 47pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark784" class="s124">P1. Consider the figure below. Similar to our discussion of </a><a href="#bookmark784" class="a">Figure 9.1</a> <span class="p">, suppose that video is encoded at a fixed bit rate, and thus each video block contains video frames that are to be</span></p><p style="text-indent: 0pt;text-align: left;"><span><img width="450" height="275" alt="image" src="计算机网络自顶向下7th-en/Image_940.png"/></span></p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 143%;text-align: left;">played out over the same fixed amount of time, Δ. The server transmits the first video block at <i>t</i><span class="s22">0</span>, the second block at t0+Δ, the third block at t0+2Δ, and so on. Once the client begins playout, each block should be played out Δ time units after the previous block.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l384"><li style="padding-left: 90pt;text-indent: -18pt;line-height: 140%;text-align: left;"><p style="display: inline;">Suppose that the client begins playout as soon as the first block arrives at <i>t</i><span class="s22">1</span>. In the figure below, how many blocks of video (including the first block) will have arrived at the client in time for their playout? Explain how you arrived at your answer.</p></li><li style="padding-top: 1pt;padding-left: 90pt;text-indent: -18pt;line-height: 124%;text-align: left;"><p style="display: inline;">Suppose that the client begins playout now at <span class="s27">t</span>1+Δ. How many blocks of video (including the first block) will have arrived at the client in time for their playout? Explain how you</p><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;text-align: left;">arrived at your answer.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">In the same scenario at (b) above, what is the largest number of blocks that is ever stored in the client buffer, awaiting playout? Explain how you arrived at your answer.</p></li><li style="padding-top: 3pt;padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">What is the smallest playout delay at the client, such that every video block has arrived in time for its playout? Explain how you arrived at your answer.</p></li></ol></li></ol></ol><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark787" class="s124">P2. Recall the simple model for HTTP streaming shown in </a><a href="#bookmark787" class="a">Figure 9.3</a><span class="s20"> </span>. Recall that <i>B </i>denotes the size of the client’s application buffer, and <i>Q </i>denotes the number of bits that must be buffered before the client application begins playout. Also <i>r </i>denotes the video consumption rate. Assume that the server sends bits at a constant rate <i>x </i>whenever the client buffer is not full.</p><ol id="l385"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 15pt;text-align: left;"><p style="display: inline;">Suppose that <span class="s27">x</span>&lt;r. As discussed in the text, in this case playout will alternate between</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;line-height: 161%;text-align: left;">periods of continuous playout and periods of freezing. Determine the length of each continuous playout and freezing period as a function of <i>Q</i>, <i>r</i>, and <i>x</i>.</p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 13pt;text-align: left;"><p style="display: inline;">Now suppose that <span class="s27">x</span>&gt;r. At what time <span class="s27">t=tf</span> does the client application buffer become full?</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 139%;text-align: left;"><a href="#bookmark787" class="s124">P3. Recall the simple model for HTTP streaming shown in </a><a href="#bookmark787" class="a">Figure 9.3</a><span class="s20"> </span>. Suppose the buffer size is infinite but the server sends bits at variable rate <i>x</i>(<i>t</i>). Specifically, suppose <i>x</i>(<i>t</i>) has the following saw-tooth shape. The rate is initially zero at time <span class="s27">t=</span>0 and linearly climbs to <i>H </i>at time</p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 13pt;text-align: left;">t=T. It then repeats this pattern again and again, as shown in the figure below.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="454" height="269" alt="image" src="计算机网络自顶向下7th-en/Image_941.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l386"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is the server’s average send rate?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Suppose that <span class="s27">Q=</span>0, so that the client starts playback as soon as it receives a video frame.</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">What will happen?</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 123%;text-align: left;"><p style="display: inline;">Now suppose <span class="s27">Q&gt;</span>0 and <span class="s27">H</span>T/2≥Q. Determine as a function of <i>Q</i>, <i>H</i>, and <i>T </i>the time at which playback first begins.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Suppose <span class="s27">H</span>&gt;2r and <span class="s27">Q=</span>HT/2. Prove there will be no freezing after the initial playout delay.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 123%;text-align: left;"><p style="display: inline;">Suppose <span class="s27">H</span>&gt;2r. Find the smallest value of <i>Q </i>such that there will be no freezing after the initial playback delay.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -15pt;text-align: left;"><p style="display: inline;">Now suppose that the buffer size <i>B </i>is finite. Suppose <span class="s27">H</span>&gt;2r. As a function of <i>Q</i>, <i>B</i>, <i>T</i>, and</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;"><i>H</i>, determine the time <span class="s27">t=tf</span> when the client application buffer first becomes full.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark787" class="s124">P4. Recall the simple model for HTTP streaming shown in </a><a href="#bookmark787" class="a">Figure 9.3</a><span class="s20"> </span>. Suppose the client application buffer is infinite, the server sends at the constant rate <i>x</i>, and the video consumption</p><p style="padding-left: 78pt;text-indent: 0pt;line-height: 12pt;text-align: left;">r&lt;x.</p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;">rate is <i>r </i>with         Also suppose playback begins immediately. Suppose that the user terminates the video early at time t=E. At the time of termination, the server stops sending bits (if it hasn’t already sent all the bits in the video).</p><ol id="l387"><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose the video is infinitely long. How many bits are wasted (that is, sent but not viewed)?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 124%;text-align: left;"><p style="display: inline;">Suppose the video is <i>T </i>seconds long with <span class="s27">T&gt;E.</span> How many bits are wasted (that is, sent but not viewed)?</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a href="#bookmark228" class="s124">P5. Consider a DASH system (as discussed in </a><a href="#bookmark228" class="a">Section 2.6</a><span class="s20"> </span>) for which there are <i>N </i>video versions (at <i>N </i>different rates and qualities) and <i>N </i>audio versions (at <i>N </i>different rates and qualities). Suppose we want to allow the player to choose at any time any of the <i>N </i>video versions and any of the <i>N </i>audio versions.</p><ol id="l388"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 15pt;text-align: left;"><p style="display: inline;">If we create files so that the audio is mixed in with the video, so server sends only one</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">media stream at given time, how many files will the server need to store (each a different URL)?</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If the server instead sends the audio and video streams separately and has the client synchronize the streams, how many files will the server need to store?</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark799" class="s124">P6. In the VoIP example in </a><a href="#bookmark799" class="a">Section 9.3</a><span class="s20"> </span>, let <i>h </i>be the total number of header bytes added to each chunk, including UDP and IP header.</p><ol id="l389"><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Assuming an IP datagram is emitted every 20 msecs, find the transmission rate in bits per second for the datagrams generated by one side of this application.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">What is a typical value of <i>h </i>when RTP is used?</p></li></ol><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 143%;text-align: left;"><a href="#bookmark799" class="s124">P7. Consider the procedure described in </a><a href="#bookmark799" class="a">Section 9.3</a><span class="s20"> </span>for estimating average delay <i>d</i><span class="s31">i</span>. Suppose that u=0.1. Let r1−t1 be the most recent sample delay, let r2−t2 be the next most recent sample delay, and so on.</p><ol id="l390"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 124%;text-align: left;"><p style="display: inline;">For a given audio application suppose four packets have arrived at the receiver with sample delays <span class="s27">r</span>4−t4, r3−t3, r2−t2, and <span class="s27">r</span>1−t1. Express the estimate of delay <i>d </i>in terms of the four samples.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Generalize your formula for <i>n </i>sample delays.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">For the formula in part (b), let <i>n </i>approach infinity and give the resulting formula.</p></li></ol><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">Comment on why this averaging procedure is called an exponential moving average.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P8. Repeat parts (a) and (b) in Question P7 for the estimate of average delay deviation.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark799" class="s124">P9. For the VoIP example in </a><a href="#bookmark799" class="a">Section 9.3</a> <span class="p">, we introduced an online procedure (exponential moving average) for estimating delay. In this problem we will examine an alternative procedure.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;line-height: 148%;text-align: left;">Let <i>t</i><span class="s31">i </span>be the timestamp of the <i>i</i>th packet received; let <i>r</i><span class="s31">i </span>be the time at which the <i>i</i>th packet is received. Let <i>d</i><span class="s31">n </span>be our estimate of average delay after receiving the <i>n</i>th packet. After the first packet is received, we set the delay estimate equal to d1=r1−t1.</p><ol id="l391"><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;line-height: 123%;text-align: left;"><p style="display: inline;">Suppose that we would like <span class="s27">d</span>n=(r1−t1+r2−t2+<span class="s29">⋯</span>+rn−tn)/n for all <i>n</i>. Give a recursive formula for <i>d</i><span class="s31">n </span>in terms of <span class="s27">d</span>n−1, rn, and <i>t</i><span class="s31">n</span>.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p class="s20" style="display: inline;"><a href="#bookmark799" class="s124">Describe why for Internet telephony, the delay estimate described in </a><a href="#bookmark799" class="a">Section 9.3</a> <span class="p">is more appropriate than the delay estimate outlined in part (a).</span></p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark799" class="s124">P10. Compare the procedure described in </a><a href="#bookmark799" class="a">Section 9.3</a> <a href="#bookmark329" class="s124">for estimating average delay with the procedure in </a><a href="#bookmark329" class="a">Section 3.5</a> <span class="p">for estimating round-trip time. What do the procedures have in common? How are they different?</span></p><p class="s20" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a href="#bookmark787" class="s124">P11. Consider the figure below (which is similar to </a><a href="#bookmark787" class="a">Figure 9.3</a> <span class="p">). A sender begins sending packetized audio periodically at t=1. The first packet arrives at the receiver at t=8.</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><span><img width="649" height="380" alt="image" src="计算机网络自顶向下7th-en/Image_942.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><ol id="l392"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">What are the delays (from sender to receiver, ignoring any playout delays) of packets 2 through 8? Note that each vertical and horizontal line segment in the figure has a length</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">of 1, 2, or 3 time units.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 136%;text-align: left;"><p style="display: inline;">If audio playout begins as soon as the first packet arrives at the receiver at <span class="s27">t=</span>8, which of the first eight packets sent will <i>not </i>arrive in time for playout?</p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 16pt;text-align: left;"><p style="display: inline;">If audio playout begins at <span class="s27">t=</span>9, which of the first eight packets sent will not arrive in time</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">for playout?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">What is the minimum playout delay at the receiver that results in all of the first eight packets arriving in time for their playout?</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P12. Consider again the figure in P11, showing packet audio transmission and reception times.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l393"><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Compute the estimated delay for packets 2 through 8, using the formula for <i>d</i><span class="s31">i </span>from</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;"><a href="#bookmark794" class="a">Section 9.3.2</a><span class="s20"> </span>. Use a value of <span class="s27">u</span>=0.1.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 126%;text-align: left;"><p style="display: inline;">Compute the estimated deviation of the delay from the estimated average for packets 2 through 8, using the formula for <i>v</i><span class="s31">i </span><a href="#bookmark794" class="s124">from </a><a href="#bookmark794" class="a">Section 9.3.2</a><span class="s20"> </span>. Use a value of <span class="s27">u</span>=0.1.</p></li></ol><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: left;"><a href="#bookmark799" class="s124">P13. Recall the two FEC schemes for VoIP described in </a><a href="#bookmark799" class="a">Section 9.3</a> <span class="p">. Suppose the first scheme generates a redundant chunk for every four original chunks. Suppose the second scheme uses a low-bit rate encoding whose transmission rate is 25 percent of the transmission rate of the</span></p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">nominal stream.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l394"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">How much additional bandwidth does each scheme require? How much playback delay does each scheme add?</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">How do the two schemes perform if the first packet is lost in every group of five packets?</p><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">Which scheme will have better audio quality?</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">How do the two schemes perform if the first packet is lost in every group of two packets?</p></li></ol><p style="padding-top: 4pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">Which scheme will have better audio quality?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P14.</p><ol id="l395"><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 137%;text-align: left;"><p style="display: inline;">Consider an audio conference call in Skype with <span class="s27">N</span>&gt;2 participants. Suppose each participant generates a constant stream of rate <i>r </i>bps. How many bits per second will the call initiator need to send? How many bits per second will each of the other N−1 participants need to send? What is the total send rate, aggregated over all participants?</p></li><li style="padding-top: 2pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">Repeat part (a) for a Skype video conference call using a central server.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Repeat part (b), but now for when each peer sends a copy of its video stream to each of the N−1 other peers.</p></li></ol><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P15.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l396"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose we send into the Internet two IP datagrams, each carrying a different UDP segment. The first datagram has source IP address A1, destination IP address B, source</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">port P1, and destination port T. The second datagram has source IP address A2, destination IP address B, source port P2, and destination port T. Suppose that A1 is different from A2 and that P1 is different from P2. Assuming that both datagrams reach their final destination, will the two UDP datagrams be received by the same socket? Why or why not?</p></li><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose Alice, Bob, and Claire want to have an audio conference call using SIP and RTP. For Alice to send and receive RTP packets to and from Bob and Claire, is only one</p></li></ol><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;line-height: 146%;text-align: left;">UDP socket sufficient (in addition to the socket needed for the SIP messages)? If yes, then how does Alice’s SIP client distinguish between the RTP packets received from Bob and Claire?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;">P16. True or false:</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><ol id="l397"><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If stored video is streamed directly from a Web server to a media player, then the application is using TCP as the underlying transport protocol.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">When using RTP, it is possible for a sender to change encoding in the middle of a session.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">All applications that use RTP must use port 87.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">If an RTP session has a separate audio and video stream for each sender, then the audio and video streams use the same SSRC.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">In differentiated services, while per-hop behavior defines differences in performance among classes, it does not mandate any particular mechanism for achieving these</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;"><a name="bookmark833">performances.</a></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 48pt;text-indent: 0pt;text-align: left;"><span><img width="672" height="226" alt="image" src="计算机网络自顶向下7th-en/Image_943.png"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -15pt;line-height: 125%;text-align: left;"><p style="display: inline;">Suppose Alice wants to establish an SIP session with Bob. In her INVITE message she includes the line: m=audio 48753 RTP/AVP 3 (AVP 3 denotes GSM audio). Alice has</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">therefore indicated in this message that she wishes to send GSM audio.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">Referring to the preceding statement, Alice has indicated in her INVITE message that she will send audio to port 48753.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -18pt;text-align: left;"><p style="display: inline;">SIP messages are typically sent between SIP entities using a default SIP port number.</p></li><li style="padding-top: 4pt;padding-left: 48pt;text-indent: -14pt;line-height: 125%;text-align: left;"><p style="display: inline;">In order to maintain registration, SIP clients must periodically send REGISTER messages.</p></li><li style="padding-top: 3pt;padding-left: 48pt;text-indent: -14pt;text-align: left;"><p style="display: inline;">SIP mandates that all SIP clients support G.711 audio encoding.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 138%;text-align: justify;">P17. Consider the figure below, which shows a leaky bucket policer being fed by a stream of packets. The token buffer can hold at most two tokens, and is initially full at t=0. New tokens arrive at a rate of one token per slot. The output link speed is such that if two packets obtain</p><p style="padding-top: 1pt;padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">tokens at the beginning of a time slot, they can both go to the output link in the same slot. The timing details of the system are as follows:</p><ol id="l398"><li style="padding-top: 1pt;padding-left: 48pt;text-indent: -20pt;line-height: 125%;text-align: left;"><p style="display: inline;">Packets (if any) arrive at the beginning of the slot. Thus in the figure, packets 1, 2, and 3 arrive in slot 0. If there are already packets in the queue, then the arriving packets join</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">the end of the queue. Packets proceed towards the front of the queue in a FIFO manner.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p></li><li style="padding-left: 48pt;text-indent: -20pt;line-height: 125%;text-align: left;"><p style="display: inline;">After the arrivals have been added to the queue, if there are any queued packets, one or two of those packets (depending on the number of available tokens) will each remove a</p><p style="padding-top: 3pt;padding-left: 48pt;text-indent: 0pt;text-align: left;">token from the token buffer and go to the output link during that slot. Thus, packets 1 and</p><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;line-height: 146%;text-align: left;">2 each remove a token from the buffer (since there are initially two tokens) and go to the output link during slot 0.</p></li><li style="padding-top: 1pt;padding-left: 90pt;text-indent: -21pt;text-align: left;"><p style="display: inline;">A new token is added to the token buffer if it is not full, since the token generation rate is</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 90pt;text-indent: 0pt;text-align: justify;">r <span class="p">= 1 token/slot.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p></li><li style="padding-left: 90pt;text-indent: -21pt;text-align: left;"><p style="display: inline;">Time then advances to the next time slot, and these steps repeat.</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">Answer the following questions:</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><ol id="l399"><li style="padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">For each time slot, identify the packets that are in the queue and the number of tokens in the bucket, immediately after the arrivals have been processed (step 1 above) but before</p><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;line-height: 146%;text-align: justify;">any of the packets have passed through the queue and removed a token. Thus, for the t=0 time slot in the example above, packets 1, 2, and 3 are in the queue, and there are two tokens in the buffer.</p></li><li style="padding-top: 1pt;padding-left: 90pt;text-indent: -18pt;line-height: 125%;text-align: left;"><p style="display: inline;">For each time slot indicate which packets appear on the output after the token(s) have been removed from the queue. Thus, for the t=0 time slot in the example above, packets</p></li></ol></li></ol></li></ol><p style="padding-top: 3pt;padding-left: 90pt;text-indent: 0pt;text-align: justify;">1 and 2 appear on the output link from the leaky buffer during slot 0.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;text-align: left;">P18. Repeat P17 but assume that <span class="s27">r</span>=2. Assume again that the bucket is initially full.</p><p style="padding-top: 4pt;padding-left: 47pt;text-indent: 0pt;line-height: 126%;text-align: left;">P19. Consider P18 and suppose now that <span class="s27">r</span>=3 and that <span class="s27">b</span>=2 as before. Will your answer to the question above change?</p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p style="padding-left: 47pt;text-indent: 0pt;line-height: 138%;text-align: justify;">P20. Consider the leaky bucket policer that polices the average rate and burst size of a packet flow. We now want to police the peak rate, <i>p</i>, as well. Show how the output of this leaky bucket policer can be fed into a second leaky bucket policer so that the two leaky buckets in series</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 146%;text-align: left;">police the average rate, peak rate, and burst size. Be sure to give the bucket size and token generation rate for the second policer.</p><p style="padding-top: 2pt;padding-left: 47pt;text-indent: 0pt;line-height: 136%;text-align: left;">P21. A packet flow is said to conform to a leaky bucket specification (<i>r</i>, <i>b</i>) with burst size <i>b </i>and average rate <i>r </i>if the number of packets that arrive to the leaky bucket is less than <span class="s27">r</span>t+b packets in every interval of time of length <i>t </i>for all <i>t</i>. Will a packet flow that conforms to a leaky bucket specification (<i>r</i>, <i>b</i>) ever have to wait at a leaky bucket policer with parameters <i>r </i>and <i>b</i>? Justify your answer.</p><p style="padding-top: 1pt;padding-left: 47pt;text-indent: 0pt;line-height: 134%;text-align: left;">P22. Show that as long as <span class="s27">r</span>1&lt;Rw1/(∑ wj), then <i>d</i><span class="s22">max </span>is indeed the maximum delay that any packet in flow 1 will ever experience in the WFQ queue.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s24" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">Programming Assignment</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;line-height: 146%;text-align: left;">In this lab, you will implement a streaming video server and client. The client will use the real-time streaming protocol (RTSP) to control the actions of the server. The server will use the real-time protocol (RTP) to packetize the video for transport over UDP. You will be given Python code that partially implements RTSP and RTP at the client and server. Your job will be to complete both the client and server code. When you are finished, you will have created a client-server application that does the following:</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_944.png"/></span></p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;"><a name="bookmark834">The client sends SETUP, PLAY, PAUSE, and TEARDOWN RTSP commands, and the server responds to the commands.</a></p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_945.png"/></span></p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">When the server is in the playing state, it periodically grabs a stored JPEG frame, packetizes the frame with RTP, and sends the RTP packet into a UDP socket.</p><p style="text-indent: 0pt;text-align: left;"><span><img width="7" height="7" alt="image" src="计算机网络自顶向下7th-en/Image_946.png"/></span></p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;line-height: 130%;text-align: left;">The client receives the RTP packets, removes the JPEG frames, decompresses the frames, and renders the frames on the client’s monitor.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;">The code you will be given implements the RTSP protocol in the server and the RTP depacketization in the client. The code also takes care of displaying the transmitted video. You will need to implement RTSP in the client and RTP server. This programming assignment will significantly enhance the student’s understanding of RTP, RTSP, and streaming video. It is highly recommended. The assignment also suggests a number of optional exercises, including implementing the RTSP DESCRIBE command at both client and server. You can find full details of the assignment, as well as an overview of the RTSP</p><p class="s20" style="padding-top: 2pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a href="http://www.pearsonhighered.com/cs-resources" class="s124" target="_blank">protocol, at the Web site </a><a href="http://www.pearsonhighered.com/cs-resources" class="a" target="_blank">www.pearsonhighered.com/</a>cs-resources<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="695" alt="image" src="计算机网络自顶向下7th-en/Image_947.png"/></span></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">AN INTERVIEW WITH . . .</p><p class="s28" style="padding-top: 4pt;padding-left: 28pt;text-indent: 0pt;text-align: left;">Henning Schulzrinne</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Henning Schulzrinne is a professor, chair of the Department of Computer Science, and head of the Internet Real-Time Laboratory at Columbia University. He is the co-author of RTP, RTSP, SIP, and GIST—key protocols for audio and video communications over the Internet. Henning received his BS in electrical and industrial engineering at TU Darmstadt in Germany, his MS in electrical and computer engineering at the University of Cincinnati, and his PhD in electrical engineering at the University of Massachusetts, Amherst.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;"><span><img width="165" height="213" alt="image" src="计算机网络自顶向下7th-en/Image_948.gif"/></span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What made you decide to specialize in multimedia networking?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">This happened almost by accident. As a PhD student, I got involved with DARTnet, an experimental network spanning the United States with T1 lines. DARTnet was used as a proving ground for multicast and Internet real-time tools. That led me to write my first audio tool, NeVoT. Through some of the DARTnet participants, I became involved in the IETF, in the then-nascent</p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1134" alt="image" src="计算机网络自顶向下7th-en/Image_949.png"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Audio Video Transport working group. This group later ended up standardizing RTP.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What was your first job in the computer industry? What did it entail?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">My first job in the computer industry was soldering together an Altair computer kit when I was a high school student in Livermore, California. Back in Germany, I started a little consulting company that devised an address management program for a travel agency—storing data on cassette tapes for our TRS-80 and using an IBM Selectric typewriter with a home-brew hardware interface as a printer.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">My first real job was with AT&amp;T Bell Laboratories, developing a network emulator for constructing experimental networks in a lab environment.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What are the goals of the Internet Real-Time Lab?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Our goal is to provide components and building blocks for the Internet as the single future communications infrastructure. This includes developing new protocols, such as GIST (for network-layer signaling) and LoST (for finding resources by location), or enhancing protocols that we have worked on earlier, such as SIP, through work on rich presence, peer-to-peer systems, next-generation emergency calling, and service creation tools. Recently, we have also looked extensively at wireless systems for VoIP, as 802.11b and 802.11n networks and maybe WiMax networks are likely to become important last-mile technologies for telephony. We are also trying to greatly improve the ability of users to diagnose faults in the complicated tangle of providers and equipment, using a peer-to-peer fault diagnosis system called DYSWIS (Do You See What I See).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">We try to do practically relevant work, by building prototypes and open source systems, by measuring performance of real systems, and by contributing to IETF standards.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">What is your vision for the future of multimedia networking?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">We are now in a transition phase; just a few years shy of when IP will be the universal platform for multimedia services, from IPTV to VoIP. We expect radio, telephone, and TV to be available even during snowstorms and earthquakes, so when the Internet takes over the role of these dedicated networks, users will expect the same level of reliability.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">We will have to learn to design network technologies for an ecosystem of competing carriers, service and content providers, serving lots of technically untrained users and defending them against a small, but destructive, set of malicious and criminal users. Changing protocols is becoming increasingly hard. They are also becoming more complex, as they need to take into account competing business interests, security, privacy, and the lack of transparency of networks caused by firewalls and network address translators.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Since multimedia networking is becoming the foundation for almost all of consumer</p><p style="text-indent: 0pt;text-align: left;"><span><img width="2" height="1071" alt="image" src="计算机网络自顶向下7th-en/Image_950.png"/></span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-top: 3pt;padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;"><a name="bookmark835">entertainment, there will be an emphasis on managing very large networks, at low cost. Users will expect ease of use, such as finding the same content on all of their devices.</a><a name="bookmark836">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Why does SIP have a promising future?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">As the current wireless network upgrade to 3G networks proceeds, there is the hope of a single multimedia signaling mechanism spanning all types of networks, from cable modems, to corporate telephone networks and public wireless networks. Together with software radios, this will make it possible in the future that a single device can be used on a home network, as a cordless BlueTooth phone, in a corporate network via 802.11 and in the wide area via 3G networks. Even before we have such a single universal wireless device, the personal mobility mechanisms make it possible to hide the differences between networks. One identifier becomes the universal means of reaching a person, rather than remembering or passing around half a dozen technology- or location-specific telephone numbers.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">SIP also breaks apart the provision of voice (bit) transport from voice services. It now becomes technically possible to break apart the local telephone monopoly, where one company provides neutral bit transport, while others provide IP “dial tone” and the classical telephone services, such as gateways, call forwarding, and caller ID.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Beyond multimedia signaling, SIP offers a new service that has been missing in the Internet: event notification. We have approximated such services with HTTP kludges and e-mail, but this was never very satisfactory. Since events are a common abstraction for distributed systems, this may simplify the construction of new services.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s26" style="padding-left: 28pt;text-indent: 0pt;text-align: left;">Do you have any advice for students entering the networking field?</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Networking bridges disciplines. It draws from electrical engineering, all aspects of computer science, operations research, statistics, economics, and other disciplines. Thus, networking researchers have to be familiar with subjects well beyond protocols and routing algorithms. Given that networks are becoming such an important part of everyday life, students wanting to make a difference in the field should think of the new resource constraints in networks: human time and effort, rather than just bandwidth or storage.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 28pt;text-indent: 0pt;line-height: 146%;text-align: left;">Work in networking research can be immensely satisfying since it is about allowing people to communicate and exchange ideas, one of the essentials of being human. The Internet has become the third major global infrastructure, next to the transportation system and energy distribution. Almost no part of the economy can work without high-performance networks, so there should be plenty of opportunities for the foreseeable future.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s19" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark837">References</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;line-height: 130%;text-align: left;">A note on URLs. <span class="p">In the references below, we have provided URLs for Web pages, Web-only documents, and other material that has not been published in a conference or journal (when we have been able to locate a URL for such material). We have not provided URLs for conference and journal publications, as these documents can usually be</span></p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: left;"><span class="p">located via a search engine, from the conference Web site (e.g., papers in all </span><span class="s17">ACM SIGCOMM </span><a href="http://www.acm.org/sigcomm" class="s124" target="_blank">conferences and workshops can be located via </a><a href="http://www.acm.org/sigcomm" class="a" target="_blank">http://www.acm.org/ sigcom</a>m<a href="http://www.pearsonhighered.com/cs-resources" class="s124" target="_blank">), or via a digital library subscription. While all URLs provided below were valid (and tested) in Jan. 2016, URLs can become out of date. Please consult the online version of this book (</a><a href="http://www.pearsonhighered.com/cs-resources" class="a" target="_blank">www.pearsonhighered .com/</a>cs-resources<span class="p">) for an up-to-date bibliography.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;line-height: 146%;text-align: justify;"><span style=" color: #333;">A note on Internet Request for Comments (RFCs): </span><a href="http://www.rfc-editor.org/" class="s124" target="_blank">Copies of Internet RFCs are available at many sites. The RFC Editor of the Internet Society (the body that oversees the RFCs) maintains the site, </a><a href="http://www.rfc-editor.org/" class="a" target="_blank">http://www.rfc-editor.or</a>g<a href="http://www.rfc-editor.org/" class="s124" target="_blank">. This site allows you to search for a specific RFC by title, number, or authors, and will show updates to any RFCs listed. Internet RFCs can be updated or obsoleted by later RFCs. Our favorite site for getting RFCs is the original source—</a><a href="http://www.rfc-editor.org/" class="a" target="_blank">http://www.rfc-editor.or</a>g<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[3GPP 2016] <a href="http://www.3gpp.org/" class="s124" target="_blank">Third Generation Partnership Project homepage, </a><a href="http://www.3gpp.org/" class="a" target="_blank">http://www.3gpp.org/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 27pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Abramson 1970] </b>N. Abramson, “The Aloha System—Another Alternative for Computer Communications,” <i>Proc. 1970 Fall Joint Computer Conference, AFIPS Conference</i><a href="#bookmark65" class="s124">, p. </a><a href="#bookmark65" class="a">3</a><span class="s20">7</span>, 1970.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Abramson 1985] </span><span class="p">N. Abramson, “Development of the Alohanet,” </span><span class="s17">IEEE Transactions on Information Theory</span><a href="#bookmark182" class="s124">, Vol. IT-31, No. 3 (Mar. 1985), pp. </a><a href="#bookmark182" class="a">11</a>9<a href="#bookmark189" class="s124">–</a><a href="#bookmark189" class="a">12</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Abramson 2009] </span><span class="p">N. Abramson, “The Alohanet—Surfing for Wireless Data,” </span><span class="s17">IEEE Communications Magazine</span><a href="#bookmark39" class="s124">, Vol. 47, No. 12, pp. </a><a href="#bookmark39" class="a">2</a>1<a href="#bookmark47" class="s124">–</a><a href="#bookmark47" class="a">2</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Adhikari 2011a] <span class="p">V. K. Adhikari, S. Jain, Y. Chen, Z. L. Zhang, “Vivisecting YouTube: An Active Measurement Study,” Technical Report, University of Minnesota, 2011.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 27pt;text-indent: -20pt;line-height: 130%;text-align: left;">[Adhikari 2012] <span class="p">V. K. Adhikari, Y. Gao, F. Hao, M. Varvello, V. Hilt, M. Steiner, Z. L. Zhang, “Unreeling Netflix: Understanding and Improving Multi-CDN Movie Delivery,” Technical Report, University of Minnesota, 2012.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Afanasyev 2010] </b>A. Afanasyev, N. Tilley, P. Reiher, L. Kleinrock, “Host-to-Host Congestion Control for TCP,” <i>IEEE Communications Surveys &amp; Tutorials</i>, Vol. 12, No. 3, pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 27pt;text-indent: 0pt;text-align: left;"><a href="#bookmark364" class="a">30</a>4<a href="#bookmark411" class="s124">–</a><a href="#bookmark411" class="a">34</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Agarwal 2009] <span class="p">S. Agarwal, J. Lorch, “Matchmaking for Online Games and Other Latency-sensitive P2P Systems,” </span><i>Proc. 2009 ACM SIGCOMM.</i></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Ager 2012] <span class="p">B. Ager, N. Chatzis, A. Feldmann, N. Sarrar, S. Uhlig, W. Willinger, “Anatomy of a Large European ISP,” Sigcomm, 2012.</span></p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Ahn 1995] </b>J. S. Ahn, P. B. Danzig, Z. Liu, and Y. Yan, “Experience with TCP Vegas: Emulation and Experiment,” <i>Proc. 1995 ACM SIGCOMM </i>(Boston, MA, Aug. 1995), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark252" class="a">18</a>5<a href="#bookmark262" class="s124">–</a><a href="#bookmark262" class="a">19</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Akamai 2016] <i>Akamai homepage</i><a href="http://www.akamai.com/" class="s124" target="_blank">, </a><a href="http://www.akamai.com/" class="a" target="_blank">http://www.akamai.com</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Akella 2003] </b>A. Akella, S. Seshan, A. Shaikh, “An Empirical Evaluation of Wide-Area Internet Bottlenecks,” <i>Proc. 2003 ACM Internet Measurement Conference </i>(Miami, FL, Nov. 2003).</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Akhshabi 2011] </b>S. Akhshabi, A. C. Begen, C. Dovrolis, “An Experimental Evaluation of Rate-Adaptation Algorithms in Adaptive Streaming over HTTP,” <i>Proc. 2011 ACM Multimedia Systems Conf</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Akyildiz 2010] </b>I. Akyildiz, D. Gutierrex-Estevez, E. Reyes, “The Evolution to 4G Cellular Systems, LTE Advanced,” <i>Physical Communication</i>, Elsevier, 3 (2010), 217–244.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Albitz 1993] </b>P. Albitz and C. Liu, <i>DNS and BIND</i>, O’Reilly &amp; Associates, Petaluma, CA, 1993.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Al-Fares 2008] </b>M. Al-Fares, A. Loukissas, A. Vahdat, “A Scalable, Commodity Data Center Network Architecture,” <i>Proc. 2008 ACM SIGCOMM</i>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Amazon 2014] J. Hamilton, <i>“AWS: Innovation at Scale</i><a href="https://www.youtube.com/watch?v=JIQETrFC_SQ" class="s124" target="_blank">, YouTube video, </a><a href="https://www.youtube.com/watch?v=JIQETrFC_SQ" class="a" target="_blank">https://www.youtube.com/watch?v=JIQETrFC_SQ</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Anderson 1995] </span><span class="p">J. B. Andersen, T. S. Rappaport, S. Yoshida, “Propagation Measurements and Models for Wireless Communications Channels,” </span><span class="s17">IEEE Communications Magazine</span><a href="#bookmark73" class="s124">, (Jan. 1995), pp. </a><a href="#bookmark73" class="a">4</a>2<a href="#bookmark87" class="s124">–</a><a href="#bookmark87" class="a">4</a>9<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Alizadeh 2010] </span><span class="p">M. Alizadeh, A. Greenberg, D. Maltz, J. Padhye, P. Patel, B. Prabhakar, S. Sengupta, M. Sridharan. “Data center TCP (DCTCP),” </span><span class="s17">ACM SIGCOMM 2010 Conference</span><a href="#bookmark109" class="s124">, ACM, New York, NY, USA, pp. </a><a href="#bookmark109" class="a">6</a>3<a href="#bookmark123" class="s124">–</a><a href="#bookmark123" class="a">7</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Allman 2011] </span><span class="p">E. Allman, “The Robustness Principle Reconsidered: Seeking a Middle Ground,” </span><span class="s17">Communications of the ACM</span><a href="#bookmark69" class="s124">, Vol. 54, No. 8 (Aug. 2011), pp. </a><a href="#bookmark69" class="a">4</a>0<a href="#bookmark78" class="s124">–</a><a href="#bookmark78" class="a">4</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Appenzeller 2004] </b>G. Appenzeller, I. Keslassy, N. McKeown, “Sizing Router Buffers,” <i>Proc. 2004 ACM SIGCOMM </i>(Portland, OR, Aug. 2004).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[ASO-ICANN 2016] <a href="http://www.aso.icann.org/" class="s124" target="_blank">The Address Supporting Organization homepage, </a><a href="http://www.aso.icann.org/" class="a" target="_blank">http://www.aso.icann.org</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><a name="bookmark838">[AT&amp;T 2013] </a><span class="p">“AT&amp;T Vision Alignment Challenge Technology Survey,” AT&amp;T Domain 2.0 Vision White Paper, November 13, 2013.</span></p><p class="s28" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">[Atheros 2016] <a href="http://www.atheros.com/pt/AR5006Bulletins.htm" class="s124" target="_blank">Atheros Communications Inc., “Atheros AR5006 WLAN Chipset Product Bulletins,” </a><a href="http://www.atheros.com/pt/AR5006Bulletins.htm" class="s123" target="_blank">http://www.atheros.com/pt/AR5006Bulletins.htm</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Ayanoglu 1995] </b>E. Ayanoglu, S. Paul, T. F. La Porta, K. K. Sabnani, R. D. Gitlin, “AIRMAIL: A Link-Layer Protocol for Wireless Networks,” <i>ACM ACM/Baltzer Wireless Networks Journal</i>, 1: 47–60, Feb. 1995.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Bakre 1995] </span><span class="p">A. Bakre, B. R. Badrinath, “I-TCP: Indirect TCP for Mobile Hosts,” </span><span class="s17">Proc. 1995 Int. Conf. on Distributed Computing Systems (ICDCS) </span><a href="#bookmark204" class="s124">(May 1995), pp. </a><a href="#bookmark204" class="a">13</a>6<a href="#bookmark211" class="s124">–</a><a href="#bookmark211" class="a">14</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Balakrishnan 1997] <span class="p">H. Balakrishnan, V. Padmanabhan, S. Seshan, R. Katz, “A Comparison of Mechanisms for Improving TCP Performance Over Wireless Links,”</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 26pt;text-indent: 0pt;text-align: left;">IEEE/ACM Transactions on Networking <span class="p">Vol. 5, No. 6 (Dec. 1997).</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Balakrishnan 2003] </b>H. Balakrishnan, F. Kaashoek, D. Karger, R. Morris, I. Stoica, “Looking Up Data in P2P Systems,” <i>Communications of the ACM</i>, Vol. 46, No. 2 (Feb.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark74" class="s124">2003), pp. </a><a href="#bookmark74" class="a">4</a>3<a href="#bookmark86" class="s124">–</a><a href="#bookmark86" class="a">4</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Baldauf 2007</span><span class="p">] M. Baldauf, S. Dustdar, F. Rosenberg, “A Survey on Context-Aware Systems,” </span><span class="s17">Int. J. Ad Hoc and Ubiquitous Computing</span><a href="#bookmark334" class="s124">, Vol. 2, No. 4 (2007), pp. </a><a href="#bookmark334" class="a">26</a>3<a href="#bookmark350" class="s124">–</a><a href="#bookmark350" class="a">27</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;">[Baran 1964] <span class="p">P. Baran, “On Distributed Communication Networks,” </span><i>IEEE Transactions on Communication Systems</i><a href="http://www.rand.org/publications/RM/RM3420/" class="s124" target="_blank">, Mar. 1964. Rand Corporation Technical report with the same title (Memorandum RM-3420-PR, 1964). </a><a href="http://www.rand.org/publications/RM/RM3420/" class="a" target="_blank">http://www.rand.org/publications/RM/RM3420/</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 27pt;text-indent: -20pt;text-align: left;">[Bardwell 2004] <span class="p">J. Bardwell, “You Believe You Understand What You Think I Said . . . The Truth About 802.11 Signal and Noise Metrics: A Discussion Clarifying Often-</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 27pt;text-indent: 0pt;text-align: left;"><a href="http://www.connect802.com/download/techpubs/2004/you_believe_D100201.pdf" class="s124" target="_blank">Misused 802.11 WLAN Terminologies,” </a><a href="http://www.connect802.com/download/techpubs/2004/you_believe_D100201.pdf" class="a" target="_blank">http://www.connect802.com/download/techpubs/2004/you_believe_D100201.pdf</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Barford 2009] </b>P. Barford, N. Duffield, A. Ron, J. Sommers, “Network Performance Anomaly Detection and Localization,” <i>Proc. 2009 IEEE INFOCOM </i>(Apr. 2009).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 27pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Baronti 2007] </b>P. Baronti, P. Pillai, V. Chook, S. Chessa, A. Gotta, Y. Hu, “Wireless Sensor Networks: A Survey on the State of the Art and the 802.15.4 and ZigBee Standards,” <i>Computer Communications</i>, Vol. 30, No. 7 (2007), pp. 1655–1695.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Baset 2006] </b>S. A. Basset and H. Schulzrinne, “An Analysis of the Skype Peer-to-Peer Internet Telephony Protocol,” <i>Proc. 2006 IEEE INFOCOM </i>(Barcelona, Spain, Apr.</p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">2006).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[BBC 2001] <a href="http://news.bbc.co.uk/2/hi/science/nature/1264205.stm" class="s124" target="_blank">BBC news online “A Small Slice of Design,” Apr. 2001, </a><a href="http://news.bbc.co.uk/2/hi/science/nature/1264205.stm" class="a" target="_blank">http://news.bbc.co.uk/2/hi/science/nature/1264205.stm</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Beheshti 2008] <span class="p">N. Beheshti, Y. Ganjali, M. Ghobadi, N. McKeown, G. Salmon, “Experimental Study of Router Buffer Sizing,” </span><i>Proc. ACM Internet Measurement Conference</i></p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">(Oct. 2008, Vouliagmeni, Greece).</p><p class="s20" style="padding-top: 4pt;padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Bender 2000] </span><span class="p">P. Bender, P. Black, M. Grob, R. Padovani, N. Sindhushayana, A. Viterbi, “CDMA/HDR: A Bandwidth-Efficient High-Speed Wireless Data Service for Nomadic Users,” </span><span class="s17">IEEE Commun. Mag.</span><a href="#bookmark120" class="s124">, Vol. 38, No. 7 (July 2000), pp. </a><a href="#bookmark120" class="a">7</a>0<a href="#bookmark126" class="s124">–</a><a href="#bookmark126" class="a">7</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Berners-Lee 1989] <a href="http://www.w3.org/History/1989/proposal.html" class="s124" target="_blank">T. Berners-Lee, CERN, “Information Management: A Proposal,” Mar. 1989, May 1990. </a><a href="http://www.w3.org/History/1989/proposal.html" class="a" target="_blank">http://www.w3.org/History/1989/proposal .html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Berners-Lee 1994] </b>T. Berners-Lee, R. Cailliau, A. Luotonen, H. Frystyk Nielsen, A. Secret, “The World-Wide Web,” <i>Communications of the ACM</i>, Vol. 37, No. 8 (Aug.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark124" class="s124">1994), pp. </a><a href="#bookmark124" class="a">7</a>6<a href="#bookmark135" class="s124">–</a><a href="#bookmark135" class="a">8</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Bertsekas 1991] </b>D. Bertsekas, R. Gallagher, <i>Data Networks, 2nd Ed.</i>, Prentice Hall, Englewood Cliffs, NJ, 1991.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Biersack 1992] </b>E. W. Biersack, “Performance Evaluation of Forward Error Correction in ATM Networks,” <i>Proc. 1999 ACM SIGCOMM </i>(Baltimore, MD, Aug. 1992), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark314" class="a">24</a>8<a href="#bookmark326" class="s124">–</a><a href="#bookmark326" class="a">25</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[BIND 2016] <a href="http://www.isc.org/bind.html" class="s124" target="_blank">Internet Software Consortium page on BIND, </a><a href="http://www.isc.org/bind.html" class="s123" target="_blank">http://www.isc.org/bind.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Bisdikian 2001] </span><span class="p">C. Bisdikian, “An Overview of the Bluetooth Wireless Technology,” </span><span class="s17">IEEE Communications Magazine</span><a href="#bookmark141" class="s124">, No. 12 (Dec. 2001), pp. </a><a href="#bookmark141" class="a">8</a>6<a href="#bookmark151" class="s124">–</a><a href="#bookmark151" class="a">9</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Bishop 2003] </b>M. Bishop, <i>Computer Security: Art and Science</i>, Boston: Addison Wesley, Boston MA, 2003.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Black 1995] </b>U. Black, <i>ATM Volume I: Foundation for Broadband Networks</i>, Prentice Hall, 1995.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Black 1997] </b>U. Black, <i>ATM Volume II: Signaling in Broadband Networks</i>, Prentice Hall, 1997.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Blumenthal 2001] </span><span class="p">M. Blumenthal, D. Clark, “Rethinking the Design of the Internet: The End-to-end Arguments vs. the Brave New World,” </span><span class="s17">ACM Transactions on Internet Technology</span><a href="#bookmark120" class="s124">, Vol. 1, No. 1 (Aug. 2001), pp. </a><a href="#bookmark120" class="a">7</a>0<a href="#bookmark169" class="s124">–</a><a href="#bookmark169" class="a">10</a>9<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Bochman 1984] </span><span class="p">G. V. Bochmann, C. A. Sunshine, “Formal Methods in Communication Protocol Design,” </span><span class="s17">IEEE Transactions on Communications</span><a href="#bookmark709" class="s124">, Vol. 28, No. 4 (Apr. 1980) pp. </a><a href="#bookmark709" class="a">62</a>4<a href="#bookmark725" class="s124">–</a><a href="#bookmark725" class="a">63</a>1<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Bolot 1996] </span><span class="p">J-C. Bolot, A. Vega-Garcia, “Control Mechanisms for Packet Audio in the Internet,” </span><span class="s17">Proc. 1996 IEEE INFOCOM</span><a href="#bookmark297" class="s124">, pp. </a><a href="#bookmark297" class="a">23</a>2<a href="#bookmark307" class="s124">–</a><a href="#bookmark307" class="a">23</a>9<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Bosshart 2013] </b>P. Bosshart, G. Gibb, H. Kim, G. Varghese, N. McKeown, M. Izzard, F. Mujica, M. Horowitz, “Forwarding Metamorphosis: Fast Programmable Match-Action Processing in Hardware for SDN,” <i>ACM SIGCOMM Comput. Commun. Rev. </i>43, 4 (Aug. 2013), 99–110<b>.</b></p><p class="s20" style="padding-top: 4pt;padding-left: 25pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Bosshart 2014] </span><span class="p">P. Bosshart, D. Daly, G. Gibb, M. Izzard, N. McKeown, J. Rexford, C. Schlesinger, D. Talayco, A. Vahdat, G. Varghese, D. Walker, “P4: Programming Protocol-Independent Packet Processors,” </span><span class="s17">ACM SIGCOMM Comput. Commun. Rev. </span><a href="#bookmark142" class="s124">44, 3 (July 2014), pp. </a><a href="#bookmark142" class="a">8</a>7<a href="#bookmark152" class="s124">–</a><a href="#bookmark152" class="a">9</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Brakmo 1995] </b>L. Brakmo, L. Peterson, “TCP Vegas: End to End Congestion Avoidance on a Global Internet,” <i>IEEE Journal of Selected Areas in Communications</i>, Vol. 13, No. 8 (Oct. 1995), pp. 1465–1480.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Bryant 1988] <a href="http://web.mit.edu/kerberos/www/dialogue.html" class="s124" target="_blank">B. Bryant, “Designing an Authentication System: A Dialogue in Four Scenes,” </a><a href="http://web.mit.edu/kerberos/www/dialogue.html" class="a" target="_blank">http://web.mit.edu/kerberos/www/dialogue.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Bush 1945] <span class="p">V. Bush, “As We May Think,” </span><i>The Atlantic Monthly</i><a href="http://www.theatlantic.com/unbound/flashbks/computer/bushf.htm" class="s124" target="_blank">, July 1945. </a><a href="http://www.theatlantic.com/unbound/flashbks/computer/bushf.htm" class="a" target="_blank">http://www.theatlantic.com/unbound/flashbks/computer/bushf.htm</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Byers 1998] </span><span class="p">J. Byers, M. Luby, M. Mitzenmacher, A. Rege, “A Digital Fountain Approach to Reliable Distribution of Bulk Data,” </span><span class="s17">Proc. 1998 ACM SIGCOMM </span><a href="#bookmark98" class="s124">(Vancouver, Canada, Aug. 1998), pp. </a><a href="#bookmark98" class="a">5</a>6<a href="#bookmark117" class="s124">–</a><a href="#bookmark117" class="a">6</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;"><b>[Caesar 2005a] </b>M. Caesar, D. Caldwell, N. Feamster, J. Rexford, A. Shaikh, J. van der Merwe, “Design and implementation of a Routing Control Platform,” <i>Proc. Networked Systems Design and Implementation </i>(May 2005).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Caesar 2005b] </b>M. Caesar, J. Rexford, “BGP Routing Policies in ISP Networks,” <i>IEEE Network Magazine</i>, Vol. 19, No. 6 (Nov. 2005).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Caldwell 2012] <a href="http://www.utm.edu/research/primes/prove" class="s124" target="_blank">C. Caldwell, “The Prime Pages,” </a><a href="http://www.utm.edu/research/primes/prove" class="a" target="_blank">http://www.utm.edu/research/primes/prove</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Cardwell 2000] </b>N. Cardwell, S. Savage, T. Anderson, “Modeling TCP Latency,” <i>Proc. 2000 IEEE INFOCOM </i>(Tel-Aviv, Israel, Mar. 2000).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Casado 2007] </b>M. Casado, M. Freedman, J. Pettit, J. Luo, N. McKeown, S. Shenker, “Ethane: Taking Control of the Enterprise,” <i>Proc. ACM SIGCOMM ’07</i>, New York, pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;">1<a href="#bookmark22" class="s124">–</a><a href="#bookmark22" class="a">1</a>2<a href="#bookmark345" class="s124">. See also IEEE/ACM Trans. Networking, 17, 4 (Aug. 2007), pp. </a><a href="#bookmark345" class="a">27</a>0<span class="p">–1283.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;">[<b>Casado 2009] </b>M. Casado, M. Freedman, J. Pettit, J. Luo, N. Gude, N. McKeown, S. Shenker, “Rethinking Enterprise Network Control,” <i>IEEE/ACM Transactions on Networking (ToN)</i>, Vol. 17, No. 4 (Aug. 2009), pp. 1270–1283.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Casado 2014] </span><span class="p">M. Casado, N. Foster, A. Guha, “Abstractions for Software-Defined Networks,” </span><span class="s17">Communications of the ACM</span><a href="#bookmark141" class="s124">, Vol. 57 No. 10, (Oct. 2014), pp. </a><a href="#bookmark141" class="a">8</a>6<a href="#bookmark152" class="s124">–</a><a href="#bookmark152" class="a">9</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Cerf 1974] </span><span class="p">V. Cerf, R. Kahn, “A Protocol for Packet Network Interconnection,” </span><span class="s17">IEEE Transactions on Communications Technology</span><a href="#bookmark715" class="s124">, Vol. COM-22, No. 5, pp. </a><a href="#bookmark715" class="a">62</a>7<a href="#bookmark738" class="s124">–</a><a href="#bookmark738" class="a">64</a>1<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[CERT 2001–09<a href="http://www.cert.org/advisories/CA-2001-09.html" class="s124" target="_blank">] CERT, “Advisory 2001–09: Statistical Weaknesses in TCP/IP Initial Sequence Numbers,” </a><a href="http://www.cert.org/advisories/CA-2001-09.html" class="a" target="_blank">http://www.cert.org/advisories/CA-2001-09.html</a></p><p class="s28" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[CERT 2003–04] <a href="http://www.cert.org/advisories/CA-2003-04.html" class="s124" target="_blank">CERT, “CERT Advisory CA-2003-04 MS-SQL Server Worm,” </a><a href="http://www.cert.org/advisories/CA-2003-04.html" class="a" target="_blank">http://www.cert.org/advisories/CA-2003-04.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[CERT 2016] <a href="http://www.cert.org/" class="s124" target="_blank">CERT, </a><a href="http://www.cert.org/" class="a" target="_blank">http://www.cert.org</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[CERT Filtering 2012] <a href="http://www.cert.org/tech_tips/packet_filtering.html" class="s124" target="_blank">CERT, “Packet Filtering for Firewall Systems,” </a><a href="http://www.cert.org/tech_tips/packet_filtering.html" class="a" target="_blank">http://www.cert.org/tech_tips/packet_filtering.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Cert SYN 1996] <a href="http://www.cert.org/advisories/CA-1998-01.html" class="s124" target="_blank">CERT, “Advisory CA-96.21: TCP SYN Flooding and IP Spoofing Attacks,” </a><a href="http://www.cert.org/advisories/CA-1998-01.html" class="a" target="_blank">http://www.cert.org/advisories/CA-1998-01.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Chandra 2007] </span><a href="#bookmark468" class="s124">T. Chandra, R. Greisemer, J. Redstone, “Paxos Made Live: an Engineering Perspective,” Proc. of 2007 ACM Symposium on Principles of Distributed Computing (PODC), pp. </a><a href="#bookmark468" class="a">39</a>8<a href="#bookmark479" class="s124">–</a><a href="#bookmark479" class="a">40</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Chao 2001] </b>H. J. Chao, C. Lam, E. Oki, <i>Broadband Packet Switching Technologies—A Practical Guide to ATM Switches and IP Routers</i>, John Wiley &amp; Sons, 2001.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Chao 2011] </b>C. Zhang, P. Dunghel, D. Wu, K. W. Ross, “Unraveling the BitTorrent Ecosystem,” <i>IEEE Transactions on Parallel and Distributed Systems</i>, Vol. 22, No. 7 (July 2011).</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;text-align: left;"><b>[Chen 2000] </b>G. Chen, D. Kotz, “A Survey of Context-Aware Mobile Computing Research,” <i>Technical Report TR2000-381</i>, Dept. of Computer Science, Dartmouth College,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="http://www.cs.dartmouth.edu/reports/TR2000-381.pdf" class="s124" target="_blank">Nov. 2000. </a><a href="http://www.cs.dartmouth.edu/reports/TR2000-381.pdf" class="a" target="_blank">http://www.cs.dartmouth.edu/reports/TR2000-381.pdf</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Chen 2006] </b>K.-T. Chen, C.-Y. Huang, P. Huang, C.-L. Lei, “Quantifying Skype User Satisfaction,” <i>Proc. 2006 ACM SIGCOMM </i>(Pisa, Italy, Sept. 2006).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Chen 2011] </b>Y. Chen, S. Jain, V. K. Adhikari, Z. Zhang, “Characterizing Roles of Front-End Servers in End-to-End Performance of Dynamic Content Distribution,” <i>Proc. 2011 ACM Internet Measurement Conference </i>(Berlin, Germany, Nov. 2011).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Cheswick 2000] </b>B. Cheswick, H. Burch, S. Branigan, “Mapping and Visualizing the Internet,” <i>Proc. 2000 Usenix Conference </i>(San Diego, CA, June 2000).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;text-align: left;"><b>[Chiu 1989] </b>D. Chiu, R. Jain, “Analysis of the Increase and Decrease Algorithms for Congestion Avoidance in Computer Networks,” <i>Computer Networks and ISDN Systems</i>,</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark3" class="s124">Vol. 17, No. 1, pp. </a>1<a href="#bookmark26" class="s124">–</a><a href="#bookmark26" class="a">1</a>4<a href="http://www.cs.wustl.edu/%7Ejain/papers/cong_av.htm" class="s124" target="_blank">. </a><a href="http://www.cs.wustl.edu/%7Ejain/papers/cong_av.htm" class="a" target="_blank">http://www.cs.wustl.edu/~jain/papers/cong_av.htm</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Christiansen 2001] </b>M. Christiansen, K. Jeffay, D. Ott, F. D. Smith, “Tuning Red for Web Traffic,” <i>IEEE/ACM Transactions on Networking</i>, Vol. 9, No. 3 (June 2001), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark316" class="a">24</a>9<a href="#bookmark335" class="s124">–</a><a href="#bookmark335" class="a">26</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Chuang 2005] <span class="p">S. Chuang, S. Iyer, N. McKeown, “Practical Algorithms for Performance Guarantees in Buffered Crossbars,” </span><i>Proc. 2005 IEEE INFOCOM.</i></p><p class="s28" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[Cisco 802.11ac 2014] <span class="p">Cisco Systems, “802.11ac: The Fifth Generation of Wi-Fi,” Technical White Paper, Mar. 2014.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;">[Cisco 7600 2016] <a href="http://www.cisco.com/en/US/products/hw/routers/ps368/prod_technical_reference09186a0080092246.html" class="s124" target="_blank">Cisco Systems, “Cisco 7600 Series Solution and Design Guide,” </a><a href="http://www.cisco.com/en/US/products/hw/routers/ps368/prod_technical_reference09186a0080092246.html" class="a" target="_blank">http://www.cisco.com/en/US/products/hw/routers/ps368/prod_technical_ reference09186a0080092246.html</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Cisco 8500 2012] <span class="p">Cisco Systems Inc., “Catalyst 8500 Campus Switch Router Architecture,”</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: center;"><a href="http://www.cisco.com/univercd/cc/td/doc/product/l3sw/8540/rel_12_0/w5_6f/softcnfg/1cfg8500.pdf" class="s123" target="_blank">http://www.cisco.com/univercd/cc/td/doc/product/l3sw/8540/rel_12_0/w5_6f/softcnfg/1cfg8500.pdf</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Cisco 12000 2016] <a href="http://www.cisco.com/en/US/products/ps6342/index.html" class="s124" target="_blank">Cisco Systems Inc., “Cisco XR 12000 Series and Cisco 12000 Series Routers,” </a><a href="http://www.cisco.com/en/US/products/ps6342/index.html" class="a" target="_blank">http://www.cisco.com/en/US/products/ps6342/index.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Cisco 2012] <a href="http://www.cisco.com/go/dce" class="s124" target="_blank">Cisco 2012, Data Centers, </a><a href="http://www.cisco.com/go/dce" class="a" target="_blank">http://www.cisco.com/go/dce</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Cisco 2015] <span class="p">Cisco Visual Networking Index: Forecast and Methodology, 2014–2019, White Paper, 2015.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;">[Cisco 6500 2016] <a href="http://www.cisco.com/c/en/us/products/collateral/switches/catalyst-6500-series-switches/prod_white_paper0900aecd80673385.html" class="s124" target="_blank">Cisco Systems, “Cisco Catalyst 6500 Architecture White Paper,” </a><a href="http://www.cisco.com/c/en/us/products/collateral/switches/catalyst-6500-series-switches/prod_white_paper0900aecd80673385.html" class="a" target="_blank">http://www.cisco.com/c/en/us/products/collateral/switches/ catalyst-6500-series- switches/prod_white_paper0900aecd80673385.html</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Cisco NAT 2016] <a href="http://www.cisco.com/en/US/tech/tk648/tk361/technologies_tech_note09186a0080094831.shtml" class="s124" target="_blank">Cisco Systems Inc., “How NAT Works,” </a><a href="http://www.cisco.com/en/US/tech/tk648/tk361/technologies_tech_note09186a0080094831.shtml" class="s123" target="_blank">http://www.cisco.com/en/US/tech/tk648/tk361/technologies_tech_note09186a0080094831.shtml</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Cisco QoS 2016] <a href="http://www.cisco.com/warp/public/cc/pd/iosw/ioft/ioqo/tech/qos_wp.htm" class="s124" target="_blank">Cisco Systems Inc., “Advanced QoS Services for the Intelligent Internet,” </a><a href="http://www.cisco.com/warp/public/cc/pd/iosw/ioft/ioqo/tech/qos_wp.htm" class="s123" target="_blank">http://www.cisco.com/warp/public/cc/pd/iosw/ioft/ioqo/tech/qos_wp.htm</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Cisco Queue 2016] <a href="http://www.cisco.com/en/US/docs/ios/12_2/qos/configuration/guide/qcfconmg.html" class="s124" target="_blank">Cisco Systems Inc., “Congestion Management Overview,” </a><a href="http://www.cisco.com/en/US/docs/ios/12_2/qos/configuration/guide/qcfconmg.html" class="a" target="_blank">http://www.cisco.com/en/US/docs/ios/12_2/qos/configuration/guide/qcfconmg.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;">[Cisco SYN 2016] <a href="http://www.cisco.com/en/US/tech/tk828/technologies_tech_note09186a00800f67d5.shtml" class="s124" target="_blank">Cisco Systems Inc., “Defining Strategies to Protect Against TCP SYN Denial of Service Attacks,” </a><a href="http://www.cisco.com/en/US/tech/tk828/technologies_tech_note09186a00800f67d5.shtml" class="a" target="_blank">http://www.cisco.com/en/US/tech/tk828/ technologies_tech_note09186a00800f67d5.shtml</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;">[Cisco TCAM 2014] <a href="http://www.cisco.com/c/en/us/support/docs/switches/catalyst-6500-series-switches/117712-problemsolution-cat6500-00.html" class="s124" target="_blank">Cisco Systems Inc., “CAT 6500 and 7600 Series Routers and Switches TCAM Allocation Adjustment Procedures,” </a><a href="http://www.cisco.com/c/en/us/support/docs/switches/catalyst-6500-series-switches/117712-problemsolution-cat6500-00.html" class="a" target="_blank">http://www.cisco.com/c/en/us/ support/docs/switches/catalyst-6500-series-switches/117712-problemsolution-cat6500-00.html</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Cisco VNI 2015] <a href="http://www.cisco.com/web/solutions/sp/vni/vni_forecast_highlights/index.html" class="s124" target="_blank">Cisco Systems Inc., “Visual Networking Index,” </a><a href="http://www.cisco.com/web/solutions/sp/vni/vni_forecast_highlights/index.html" class="a" target="_blank">http://www.cisco.com/web/solutions/sp/vni/vni_forecast_highlights/index.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Clark 1988] </b>D. Clark, “The Design Philosophy of the DARPA Internet Protocols,” <i>Proc. 1988 ACM SIGCOMM </i>(Stanford, CA, Aug. 1988).</p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Cohen 1977] </span><span class="p">D. Cohen, “Issues in Transnet Packetized Voice Communication,” </span><span class="s17">Proc. Fifth Data Communications Symposium </span><a href="#bookmark11" class="s124">(Snowbird, UT, Sept. 1977), pp. </a>6<a href="#bookmark24" class="s124">–</a><a href="#bookmark24" class="a">1</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Cookie Central 2016] <a href="http://www.cookiecentral.com/n_cookie_faq.htm" class="s124" target="_blank">Cookie Central homepage, </a><a href="http://www.cookiecentral.com/n_cookie_faq.htm" class="a" target="_blank">http://www.cookiecentral.com/ n_cookie_faq.htm</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Cormen 2001] </b>T. H. Cormen, <i>Introduction to Algorithms, </i>2nd Ed., MIT Press, Cambridge, MA, 2001.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Crow 1997] </span><span class="p">B. Crow, I. Widjaja, J. Kim, P. Sakai, “IEEE 802.11 Wireless Local Area Networks,” </span><span class="s17">IEEE Communications Magazine </span><a href="#bookmark178" class="s124">(Sept. 1997), pp. </a><a href="#bookmark178" class="a">11</a>6<a href="#bookmark194" class="s124">–</a><a href="#bookmark194" class="a">12</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Cusumano 1998] </b>M. A. Cusumano, D. B. Yoffie, <i>Competing on Internet Time: Lessons from Netscape and Its Battle with Microsoft</i>, Free Press, New York, NY, 1998.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Czyz 2014] </span><span class="p">J. Czyz, M. Allman, J. Zhang, S. Iekel-Johnson, E. Osterweil, M. Bailey, “Measuring IPv6 Adoption,” </span><span class="s17">Proc. ACM SIGCOMM 2014, </span><a href="#bookmark142" class="s124">ACM, New York, NY, USA, pp. </a><a href="#bookmark142" class="a">8</a>7<a href="#bookmark160" class="s124">–</a><a href="#bookmark160" class="a">9</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Dahlman 1998] </b>E. Dahlman, B. Gudmundson, M. Nilsson, J. Sköld, “UMTS/IMT-2000 Based on Wideband CDMA,” <i>IEEE Communications Magazine </i>(Sept. 1998), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark120" class="a">7</a>0<a href="#bookmark132" class="s124">–</a><a href="#bookmark132" class="a">8</a>0<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Daigle 1991] </b>J. N. Daigle, <i>Queuing Theory for Telecommunications</i>, Addison-Wesley, Reading, MA, 1991.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[DAM 2016] <a href="http://www.digitalattackmap.com/" class="s124" target="_blank">Digital Attack Map, </a><a href="http://www.digitalattackmap.com/" class="a" target="_blank">http://www.digitalattackmap.com</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Davie 2000] </b>B. Davie and Y. Rekhter, <i>MPLS: Technology and Applications</i>, Morgan Kaufmann Series in Networking, 2000.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Davies 2005] </b>G. Davies, F. Kelly, “Network Dimensioning, Service Costing, and Pricing in a Packet-Switched Environment,” <i>Telecommunications Policy</i>, Vol. 28, No. 4, pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark458" class="a">39</a>1<a href="#bookmark485" class="s124">–</a><a href="#bookmark485" class="a">41</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[DEC 1990] <a href="http://www.memex.org/" class="s124" target="_blank">Digital Equipment Corporation, “In Memoriam: J. C. R. Licklider 1915–1990,” SRC Research Report 61, Aug. 1990. </a><a href="http://www.memex.org/" class="s123" target="_blank">http://www.memex.org/</a><span class="s43"> licklider.pdf</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[DeClercq 2002] </span><span class="p">J. DeClercq, O. Paridaens, “Scalability Implications of Virtual Private Networks,” </span><span class="s17">IEEE Communications Magazine</span><a href="#bookmark221" class="s124">, Vol. 40, No. 5 (May 2002), pp. </a><a href="#bookmark221" class="a">15</a>1<a href="#bookmark227" class="s124">–</a><a href="#bookmark227" class="a">15</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Demers 1990] </span><span class="p">A. Demers, S. Keshav, S. Shenker, “Analysis and Simulation of a Fair Queuing Algorithm,” </span><span class="s17">Internetworking: Research and Experience, </span><a href="#bookmark7" class="s124">Vol. 1, No. 1 (1990), pp. </a>3<a href="#bookmark50" class="s124">–</a><a href="#bookmark50" class="a">2</a>6<span class="p">.</span></p><p class="s28" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">[dhc 2016] <a href="http://www.ietf.org/html.charters/dhc-charter.html" class="s124" target="_blank">IETF Dynamic Host Configuration working group homepage, </a><a href="http://www.ietf.org/html.charters/dhc-charter.html" class="a" target="_blank">http://www.ietf.org/html.charters/dhc-charter.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Dhungel 2012] </b>P. Dhungel, K. W. Ross, M. Steiner., Y. Tian, X. Hei, “Xunlei: Peer-Assisted Download Acceleration on a Massive Scale,” <i>Passive and Active Measurement Conference (PAM) 2012</i>, Vienna, 2012.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Diffie 1976] </span><span class="p">W. Diffie, M. E. Hellman, “New Directions in Cryptography,” </span><span class="s17">IEEE Transactions on Information Theory</span><a href="#bookmark742" class="s124">, Vol IT-22 (1976), pp. </a><a href="#bookmark742" class="a">64</a>4<a href="#bookmark757" class="s124">–</a><a href="#bookmark757" class="a">65</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Diggavi 2004] </b>S. N. Diggavi, N. Al-Dhahir, A. Stamoulis, R. Calderbank, “Great Expectations: The Value of Spatial Diversity in Wireless Networks,” <i>Proceedings of the IEEE</i>, Vol. 92, No. 2 (Feb. 2004).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Dilley 2002] </b>J. Dilley, B. Maggs, J. Parikh, H. Prokop, R. Sitaraman, B. Weihl, “Globally Distributed Content Delivert,” <i>IEEE Internet Computing </i>(Sept.–Oct. 2002).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Diot 2000] </span><span class="p">C. Diot, B. N. Levine, B. Lyles, H. Kassem, D. Balensiefen, “Deployment Issues for the IP Multicast Service and Architecture,” </span><span class="s17">IEEE Network</span><a href="#bookmark128" class="s124">, Vol. 14, No. 1 (Jan./Feb. 2000) pp. </a><a href="#bookmark128" class="a">7</a>8<a href="#bookmark145" class="s124">–</a><a href="#bookmark145" class="a">8</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Dischinger 2007] </span><span class="p">M. Dischinger, A. Haeberlen, K. Gummadi, S. Saroiu, “Characterizing residential broadband networks,” </span><span class="s17">Proc. 2007 ACM Internet Measurement Conference</span><a href="#bookmark44" class="s124">, pp. </a><a href="#bookmark44" class="a">2</a>4<a href="#bookmark50" class="s124">–</a><a href="#bookmark50" class="a">2</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Dmitiropoulos 2007] </b>X. Dmitiropoulos, D. Krioukov, M. Fomenkov, B. Huffaker, Y. Hyun, K. C. Claffy, G. Riley, “AS Relationships: Inference and Validation,” <i>ACM Computer Communication Review </i>(Jan. 2007).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;">[DOCSIS 2011] <span class="p">Data-Over-Cable Service Interface Specifications, DOCSIS 3.0: MAC and Upper Layer Protocols Interface Specification, CM-SP-MULPIv3.0-I16-110623, 2011.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Dodge 2016] <a href="http://www.cybergeography.org/atlas/isp_maps.html" class="s124" target="_blank">M. Dodge, “An Atlas of Cyberspaces,” </a><a href="http://www.cybergeography.org/atlas/isp_maps.html" class="a" target="_blank">http://www.cybergeography.org/atlas/isp_maps.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Donahoo 2001] </b>M. Donahoo, K. Calvert, <i>TCP/IP Sockets in C: Practical Guide for Programmers</i>, Morgan Kaufman, 2001.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[DSL 2016] <a href="http://www.dslforum.org/" class="s124" target="_blank">DSL Forum homepage, </a><a href="http://www.dslforum.org/" class="a" target="_blank">http://www.dslforum.org/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Dhunghel 2008] </b>P. Dhungel, D. Wu, B. Schonhorst, K.W. Ross, “A Measurement Study of Attacks on BitTorrent Leechers,” <i>7th International Workshop on Peer-to-Peer Systems (IPTPS 2008) </i>(Tampa Bay, FL, Feb. 2008).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Droms 2002] </b>R. Droms, T. Lemon, <i>The DHCP Handbook </i>(2nd Edition), SAMS Publishing, 2002.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Edney 2003] </b>J. Edney and W. A. Arbaugh, <i>Real 802.11 Security: Wi-Fi Protected Access and 802.11i</i>, Addison-Wesley Professional, 2003.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Edwards 2011] </span><span class="p">W. K. Edwards, R. Grinter, R. Mahajan, D. Wetherall, “Advancing the State of Home Networking,” </span><span class="s17">Communications of the ACM</span><a href="#bookmark107" class="s124">, Vol. 54, No. 6 (June 2011), pp. </a><a href="#bookmark107" class="a">6</a>2<a href="#bookmark121" class="s124">–</a><a href="#bookmark121" class="a">7</a>1<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Ellis 1987] <a href="http://jya.com/ellisdoc.htm" class="s124" target="_blank">H. Ellis, “The Story of Non-Secret Encryption,” </a><a href="http://jya.com/ellisdoc.htm" class="s123" target="_blank">http://jya.com/ellisdoc.htm</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Erickson 2013] </span><span class="p">D. Erickson, “ The Beacon Openflow Controller,” 2nd </span><span class="s17">ACM SIGCOMM Workshop on Hot Topics in Software Defined Networking </span><a href="#bookmark24" class="s124">(HotSDN ’13). ACM, New York, NY, USA, pp. </a><a href="#bookmark24" class="a">1</a>3<a href="#bookmark34" class="s124">–</a><a href="#bookmark34" class="a">1</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Ericsson 2012] <a href="http://www.ericsson.com/technology/whitepapers/broadband/evolution_of_EDGE.shtml" class="s124" target="_blank">Ericsson, “The Evolution of Edge,” </a><a href="http://www.ericsson.com/technology/whitepapers/broadband/evolution_of_EDGE.shtml" class="s123" target="_blank">http://www.ericsson.com/technology/whitepapers/broadband/evolution_of_EDGE.shtml</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[<span class="p">Facebook 2014] A. Andreyev, “Introducing Data Center Fabric, the Next-Generation Facebook Data Center Network,”</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s43" style="text-indent: 0pt;text-align: center;">https://code.facebook.com/posts/360346274145943/introducing-data-center-fabric-the-next-generation-facebook-data-center-network</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Faloutsos 1999] <span class="p">C. Faloutsos, M. Faloutsos, P. Faloutsos, “What Does the Internet Look Like? Empirical Laws of the Internet Topology,” </span><i>Proc. 1999 ACM SIGCOMM</i></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">(Boston, MA, Aug. 1999).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Farrington 2010] </b>N. Farrington, G. Porter, S. Radhakrishnan, H. Bazzaz, V. Subramanya, Y. Fainman, G. Papen, A. Vahdat, “Helios: A Hybrid Electrical/Optical Switch Architecture for Modular Data Centers,” <i>Proc. 2010 ACM SIGCOMM</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Feamster 2004] </b>N. Feamster, H. Balakrishnan, J. Rexford, A. Shaikh, K. van der Merwe, “The Case for Separating Routing from Routers,” <i>ACM SIGCOMM Workshop on Future Directions in Network Architecture</i>, Sept. 2004.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Feamster 2004] </b>N. Feamster, J. Winick, J. Rexford, “A Model for BGP Routing for Network Engineering,” <i>Proc. 2004 ACM SIGMETRICS </i>(New York, NY, June 2004).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Feamster 2005] </b>N. Feamster, H. Balakrishnan, “Detecting BGP Configuration Faults with Static Analysis,” <i>NSDI </i>(May 2005).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Feamster 2013] </b>N. Feamster, J. Rexford, E. Zegura, “The Road to SDN,” <i>ACM Queue</i>, Volume 11, Issue 12, (Dec. 2013).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Feldmeier 1995] </span><span class="p">D. Feldmeier, “Fast Software Implementation of Error Detection Codes,” </span><span class="s17">IEEE/ACM Transactions on Networking</span><a href="#bookmark737" class="s124">, Vol. 3, No. 6 (Dec. 1995), pp. </a><a href="#bookmark737" class="a">64</a>0<a href="#bookmark754" class="s124">–</a><a href="#bookmark754" class="a">65</a>2<span class="p">.</span></p><p class="s20" style="padding-top: 3pt;padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Ferguson 2013] </span><span class="p">A. Ferguson, A. Guha, C. Liang, R. Fonseca, S. Krishnamurthi, “Participatory Networking: An API for Application Control of SDNs,” </span><span class="s17">Proceedings ACM SIGCOMM 2013</span><a href="#bookmark391" class="s124">, pp. </a><a href="#bookmark391" class="a">32</a>7<a href="#bookmark406" class="s124">–</a><a href="#bookmark406" class="a">33</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Fielding 2000] <span class="p">R. Fielding, “Architectural Styles and the Design of Network-based Software Architectures,” 2000. PhD Thesis, UC Irvine, 2000.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[FIPS 1995] <a href="http://www.itl.nist.gov/fipspubs/fip180-1.htm" class="s124" target="_blank">Federal Information Processing Standard, “Secure Hash Standard,” FIPS Publication 180-1. </a><a href="http://www.itl.nist.gov/fipspubs/fip180-1.htm" class="a" target="_blank">http://www.itl.nist.gov/fipspubs/fip180-1.htm</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Floyd 1999] </b>S. Floyd, K. Fall, “Promoting the Use of End-to-End Congestion Control in the Internet,” <i>IEEE/ACM Transactions on Networking</i>, Vol. 6, No. 5 (Oct. 1998), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 25pt;text-indent: 0pt;text-align: left;"><a href="#bookmark535" class="a">45</a>8<a href="#bookmark548" class="s124">–</a><a href="#bookmark548" class="a">47</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Floyd 2000] </b>S. Floyd, M. Handley, J. Padhye, J. Widmer, “Equation-Based Congestion Control for Unicast Applications,” <i>Proc. 2000 ACM SIGCOMM </i>(Stockholm, Sweden, Aug. 2000).</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Floyd 2001] </b>S. Floyd, “A Report on Some Recent Developments in TCP Congestion Control,” <i>IEEE Communications Magazine </i>(Apr. 2001).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Floyd 2016] <a href="http://www.icir.org/floyd/red.html" class="s124" target="_blank">S. Floyd, “References on RED (Random Early Detection) Queue Management,” </a><a href="http://www.icir.org/floyd/red.html" class="a" target="_blank">http://www.icir.org/floyd/red.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Floyd Synchronization 1994] </span><span class="p">S. Floyd, V. Jacobson, “Synchronization of Periodic Routing Messages,” </span><span class="s17">IEEE/ACM Transactions on Networking</span><a href="#bookmark188" class="s124">, Vol. 2, No. 2 (Apr. 1997) pp. </a><a href="#bookmark188" class="a">12</a>2<a href="#bookmark204" class="s124">–</a><a href="#bookmark204" class="a">13</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Floyd TCP 1994] </span><span class="p">S. Floyd, “TCP and Explicit Congestion Notification,” </span><span class="s17">ACM SIGCOMM Computer Communications Review</span><a href="#bookmark18" class="s124">, Vol. 24, No. 5 (Oct. 1994), pp. </a><a href="#bookmark18" class="a">1</a>0<a href="#bookmark43" class="s124">–</a><a href="#bookmark43" class="a">2</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Fluhrer 2001] <span class="p">S. Fluhrer, I. Mantin, A. Shamir, “Weaknesses in the Key Scheduling Algorithm of RC4,” </span><i>Eighth Annual Workshop on Selected Areas in Cryptography</i></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">(Toronto, Canada, Aug. 2002).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Fortz 2000] </b>B. Fortz, M. Thorup, “Internet Traffic Engineering by Optimizing OSPF Weights,” <i>Proc. 2000 IEEE INFOCOM </i>(Tel Aviv, Israel, Apr. 2000).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Fortz 2002] </b>B. Fortz, J. Rexford, M. Thorup, “Traffic Engineering with Traditional IP Routing Protocols,” <i>IEEE Communication Magazine </i>(Oct. 2002).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Fraleigh 2003] </b>C. Fraleigh, F. Tobagi, C. Diot, “Provisioning IP Backbone Networks to Support Latency Sensitive Traffic,” <i>Proc. 2003 IEEE INFOCOM </i>(San Francisco, CA, Mar. 2003).</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Frost 1994] <a href="http://world.std/" class="s124" target="_blank">J. Frost, “BSD Sockets: A Quick and Dirty Primer,” </a><a href="http://world.std/" class="s123" target="_blank">http://world.std</a><span class="s43"> .com/~jimf/papers/sockets/sockets.html</span></p><p class="s28" style="padding-top: 3pt;padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;">[FTC 2015] <a href="https://www.ftc.gov/system/files/documents/reports/federal-trade-commission-staff-report-november-2013-workshop-entitled-internet-things-privacy/150127iotrpt.pdf" class="s124" target="_blank">Internet of Things: Privacy and Security in a Connected World, Federal Trade Commission, 2015, </a><a href="https://www.ftc.gov/system/files/documents/reports/federal-trade-commission-staff-report-november-2013-workshop-entitled-internet-things-privacy/150127iotrpt.pdf" class="a" target="_blank">https://www.ftc.gov/system/files/documents/reports/ federal-trade-commission-staff-report-november-2013-workshop-entitled-internet-things-privacy/150127iotrpt.pdf</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[FTTH 2016] <a href="http://www.ftthcouncil.org/" class="s124" target="_blank">Fiber to the Home Council, </a><a href="http://www.ftthcouncil.org/" class="a" target="_blank">http://www.ftthcouncil.org/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Gao 2001] </span><span class="p">L. Gao, J. Rexford, “Stable Internet Routing Without Global Coordination,” </span><span class="s17">IEEE/ACM Transactions on Networking</span><a href="#bookmark780" class="s124">, Vol. 9, No. 6 (Dec. 2001), pp. </a><a href="#bookmark780" class="a">68</a>1<a href="#bookmark792" class="s124">–</a><a href="#bookmark792" class="a">69</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Gartner 2014] <a href="http://www.gartner.com/technology/research/internet-of-things" class="s124" target="_blank">Gartner report on Internet of Things, </a><a href="http://www.gartner.com/technology/research/internet-of-things" class="a" target="_blank">http://www.gartner.com/ technology/research/internet-of-things</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Gauthier 1999] </b>L. Gauthier, C. Diot, and J. Kurose, “End-to-End Transmission Control Mechanisms for Multiparty Interactive Applications on the Internet,” <i>Proc. 1999 IEEE INFOCOM </i>(New York, NY, Apr. 1999).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Gember-Jacobson 2014] </span><span class="p">A. Gember-Jacobson, R. Viswanathan, C. Prakash, R. Grandl, J. Khalid, S. Das, A. Akella, “OpenNF: Enabling Innovation in Network Function Control,” Proc. </span><span class="s17">ACM </span><a href="#bookmark233" class="s124">SIGCOMM 2014, pp. </a><a href="#bookmark233" class="a">16</a>3<a href="#bookmark245" class="s124">–</a><a href="#bookmark245" class="a">17</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Goodman 1997] </b>David J. Goodman, <i>Wireless Personal Communications Systems</i>, Prentice-Hall, 1997.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Google IPv6 2015] <a href="https://www.google.com/intl/en/ipv6/statistics.html" class="s124" target="_blank">Google Inc. “IPv6 Statistics,” </a><a href="https://www.google.com/intl/en/ipv6/statistics.html" class="a" target="_blank">https://www.google.com/intl/en/ipv6/statistics.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Google Locations 2016] <a href="http://www.google.com/corporate/datacenter/locations.html" class="s124" target="_blank">Google data centers. </a><a href="http://www.google.com/corporate/datacenter/locations.html" class="a" target="_blank">http://www.google.com/corporate/datacenter/locations.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Goralski 1999] </b>W. Goralski, <i>Frame Relay for High-Speed Networks</i>, John Wiley, New York, 1999.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Greenberg 2009a] </b>A. Greenberg, J. Hamilton, D. Maltz, P. Patel, “The Cost of a Cloud: Research Problems in Data Center Networks,” <i>ACM Computer Communications Review </i>(Jan. 2009).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Greenberg 2009b] </b>A. Greenberg, N. Jain, S. Kandula, C. Kim, P. Lahiri, D. Maltz, P. Patel, S. Sengupta, “VL2: A Scalable and Flexible Data Center Network,” <i>Proc. 2009 ACM SIGCOMM</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Greenberg 2011] <span class="p">A. Greenberg, J. Hamilton, N. Jain, S. Kandula, C. Kim, P. Lahiri, D. Maltz, P. Patel, S. Sengupta, “VL2: A Scalable and Flexible Data Center Network,”</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><span class="s17">Communications of the ACM</span><a href="#bookmark152" class="s124">, Vol. 54, No. 3 (Mar. 2011), pp. </a><a href="#bookmark152" class="a">9</a>5<a href="#bookmark165" class="s124">–</a><a href="#bookmark165" class="a">10</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[<a href="http://conferences.sigcomm.org/sigcomm/2015/pdf/papers/keynote.pdf" class="s124" target="_blank">Greenberg 2015] A. Greenberg, “SDN for the Cloud,” Sigcomm 2015 Keynote Address, </a><a href="http://conferences.sigcomm.org/sigcomm/2015/pdf/papers/keynote.pdf" class="a" target="_blank">http://conferences.sigcomm.org/sigcomm/2015/pdf/papers/keynote.pdf</a></p><p class="s28" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">[Griffin 2012] <a href="http://www.cl.cam.ac.uk/%7Etgg22/interdomain/" class="s124" target="_blank">T. Griffin, “Interdomain Routing Links,” </a><a href="http://www.cl.cam.ac.uk/%7Etgg22/interdomain/" class="a" target="_blank">http://www.cl.cam.ac.uk/~tgg22/interdomain/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;">[Gude 2008] <a href="http://ccr.sigcomm.org/online/files/p105-v38n3u-mckeownA4.pdf" class="s124" target="_blank">N. Gude, T. Koponen, J. Pettit, B. Pfaff, M. Casado, N. McKeown, and S. Shenker, </a><a href="http://ccr.sigcomm.org/online/files/p105-v38n3u-mckeownA4.pdf" class="a" target="_blank">“NOX: Towards an Operating System for Networks,”</a> <span class="p">ACM SIGCOMM Computer Communication Review, July 2008.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Guha 2006] </b>S. Guha, N. Daswani, R. Jain, “An Experimental Study of the Skype Peer-to-Peer VoIP System,” <i>Proc. Fifth Int. Workshop on P2P Systems </i>(Santa Barbara, CA, 2006).</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Guo 2005] </b>L. Guo, S. Chen, Z. Xiao, E. Tan, X. Ding, X. Zhang, “Measurement, Analysis, and Modeling of BitTorrent-Like Systems,” <i>Proc. 2005 ACM Internet Measurement Conference</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Guo 2009] </b>C. Guo, G. Lu, D. Li, H. Wu, X. Zhang, Y. Shi, C. Tian, Y. Zhang, S. Lu, “BCube: A High Performance, Server-centric Network Architecture for Modular Data Centers,” <i>Proc. 2009 ACM SIGCOMM</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Gupta 2001] </span><span class="p">P. Gupta, N. McKeown, “Algorithms for Packet Classification,” </span><span class="s17">IEEE Network Magazine</span><a href="#bookmark44" class="s124">, Vol. 15, No. 2 (Mar./Apr. 2001), pp. </a><a href="#bookmark44" class="a">2</a>4<a href="#bookmark57" class="s124">–</a><a href="#bookmark57" class="a">3</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Gupta 2014] </span><span class="p">A. Gupta, L. Vanbever, M. Shahbaz, S. Donovan, B. Schlinker, N. Feamster, J. Rexford, S. Shenker, R. Clark, E. Katz-Bassett, “SDX: A Software Defined Internet Exchange, “ </span><span class="s17">Proc. ACM SIGCOMM 2014 </span><a href="#bookmark627" class="s124">(Aug. 2014), pp. </a><a href="#bookmark627" class="a">55</a>1<a href="#bookmark639" class="s124">–</a><a href="#bookmark639" class="a">56</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Ha 2008] </b>S. Ha, I. Rhee, L. Xu, “CUBIC: A New TCP-Friendly High-Speed TCP Variant,” <i>ACM SIGOPS Operating System Review</i>, 2008.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Halabi 2000] </b>S. Halabi, <i>Internet Routing Architectures, </i>2nd Ed., Cisco Press, 2000.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Hanabali 2005] </span><span class="p">A. A. Hanbali, E. Altman, P. Nain, “A Survey of TCP over Ad Hoc Networks</span><span class="s17">,” IEEE Commun. Surveys and Tutorials</span><a href="#bookmark41" class="s124">, Vol. 7, No. 3 (2005), pp. </a><a href="#bookmark41" class="a">2</a>2<a href="#bookmark63" class="s124">–</a><a href="#bookmark63" class="a">3</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Hei 2007] </b>X. Hei, C. Liang, J. Liang, Y. Liu, K. W. Ross, “A Measurement Study of a Large-scale P2P IPTV System,” <i>IEEE Trans. on Multimedia </i>(Dec. 2007).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Heidemann 1997] </span><span class="p">J. Heidemann, K. Obraczka, J. Touch, “Modeling the Performance of HTTP over Several Transport Protocols,” </span><span class="s17">IEEE/ACM Transactions on Networking</span><a href="#bookmark694" class="s124">, Vol. 5, No. 5 (Oct. 1997), pp. </a><a href="#bookmark694" class="a">61</a>6<a href="#bookmark720" class="s124">–</a><a href="#bookmark720" class="a">63</a>0<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Held 2001] </b>G. Held, <i>Data Over Wireless Networks: Bluetooth, WAP, and Wireless LANs</i>, McGraw-Hill, 2001.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Holland 2001] <span class="p">G. Holland, N. Vaidya, V. Bahl, “A Rate-Adaptive MAC Protocol for Multi-Hop Wireless Networks,” </span><i>Proc. 2001 ACM Int. Conference of Mobile Computing and</i></p><p class="s17" style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">Networking (Mobicom01) <span class="p">(Rome, Italy, July 2001).</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Hollot 2002] </b>C.V. Hollot, V. Misra, D. Towsley, W. Gong, “Analysis and Design of Controllers for AQM Routers Supporting TCP Flows,” <i>IEEE Transactions on Automatic Control</i>, Vol. 47, No. 6 (June 2002), pp. 945–959.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Hong 2013] </span><span class="p">C. Hong, S, Kandula, R. Mahajan, M.Zhang, V. Gill, M. Nanduri, R. Wattenhofer, “Achieving High Utilization with Software-driven WAN,” ACM </span><span class="s17">SIGCOMM Conference </span><a href="#bookmark28" class="s124">(Aug. 2013), pp.</a><a href="#bookmark28" class="a">1</a>5<a href="#bookmark50" class="s124">–</a><a href="#bookmark50" class="a">2</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Huang 2002] </b>C. Haung, V. Sharma, K. Owens, V. Makam, “Building Reliable MPLS Networks Using a Path Protection Mechanism,” <i>IEEE Communications Magazine</i>, Vol.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark226" class="s124">40, No. 3 (Mar. 2002), pp. </a><a href="#bookmark226" class="a">15</a>6<a href="#bookmark232" class="s124">–</a><a href="#bookmark232" class="a">16</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Huang 2005] <span class="p">Y. Huang, R. Guerin, “Does Over-Provisioning Become More or Less Efficient as Networks Grow Larger?,” </span><i>Proc. IEEE Int. Conf. Network Protocols (ICNP)</i></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">(Boston MA, Nov. 2005).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Huang 2008] </b>C. Huang, J. Li, A. Wang, K. W. Ross, “Understanding Hybrid CDN-P2P: Why Limelight Needs Its Own Red Swoosh,” <i>Proc. 2008 NOSSDAV</i>, Braunschweig, Germany.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Huitema 1998] </b>C. Huitema, <i>IPv6: The New Internet Protocol, </i>2nd Ed., Prentice Hall, Englewood Cliffs, NJ, 1998.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Huston 1999a] </b>G. Huston, “Interconnection, Peering, and Settlements—Part I,” <i>The Internet Protocol Journal</i>, Vol. 2, No. 1 (Mar. 1999).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Huston 2004] </b>G. Huston, “NAT Anatomy: A Look Inside Network Address Translators,” <i>The Internet Protocol Journal</i>, Vol. 7, No. 3 (Sept. 2004).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Huston 2008a] <a href="http://www.potaroo.net/ispcol/2008-10/v4depletion.html" class="s124" target="_blank">G. Huston, “Confronting IPv4 Address Exhaustion,” </a><a href="http://www.potaroo.net/ispcol/2008-10/v4depletion.html" class="a" target="_blank">http://www.potaroo.net/ispcol/2008-10/v4depletion.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Huston 2008b] <a href="http://www.potaroo.net/ispcol/2008-04/ipv6.html" class="s124" target="_blank">G. Huston, G. Michaelson, “IPv6 Deployment: Just where are we?” </a><a href="http://www.potaroo.net/ispcol/2008-04/ipv6.html" class="a" target="_blank">http://www.potaroo.net/ispcol/2008-04/ipv6.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Huston 2011a] </b>G. Huston, “A Rough Guide to Address Exhaustion,” <i>The Internet Protocol Journal, </i>Vol. 14, No. 1 (Mar. 2011).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Huston 2011b] </b>G. Huston, “Transitioning Protocols,” <i>The Internet Protocol Journal</i>, Vol. 14, No. 1 (Mar. 2011).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[IAB 2016] <a href="http://www.iab.org/" class="s124" target="_blank">Internet Architecture Board homepage, </a><a href="http://www.iab.org/" class="a" target="_blank">http://www.iab.org/</a></p><p class="s28" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[IANA Protocol Numbers 2016] <a href="http://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml" class="s124" target="_blank">Internet Assigned Numbers Authority, Protocol Numbers, </a><a href="http://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml" class="a" target="_blank">http://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[IBM 1997] </b>IBM Corp., <i>IBM Inside APPN - The Essential Guide to the Next-Generation SNA</i>, SG24-3669-03, June 1997.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[ICANN 2016] <a href="http://www.icann.org/" class="s124" target="_blank">The Internet Corporation for Assigned Names and Numbers homepage, </a><a href="http://www.icann.org/" class="a" target="_blank">http://www.icann.org</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[IEEE 802 2016] <a href="http://www.ieee802.org/" class="s124" target="_blank">IEEE 802 LAN/MAN Standards Committee homepage, </a><a href="http://www.ieee802.org/" class="a" target="_blank">http://www.ieee802.org/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;">[IEEE 802.11 1999] <span class="p">IEEE 802.11, “1999 Edition (ISO/IEC 8802-11: 1999) IEEE Standards for Information Technology—Telecommunications and Information Exchange Between Systems—Local and Metropolitan Area Network—Specific Requirements—Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY)</span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="http://standards.ieee.org/getieee802/download/802.11-1999.pdf" class="s124" target="_blank">Specification,”   </a><a href="http://standards.ieee.org/getieee802/download/802.11-1999.pdf" class="s123" target="_blank">http://standards.ieee.org/getieee802/download/802.11-1999.pdf</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 138%;text-align: left;">[IEEE 802.11ac 2013] <span class="p">IEEE, “802.11ac-2013—IEEE Standard for Information technology—Telecommunications and Information Exchange Between Systems—Local and Metropolitan Area Networks—Specific Requirements—Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications—Amendment 4: Enhancements for Very High Throughput for Operation in Bands Below 6 GHz.”</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[IEEE 802.11n 2012] <a href="http://grouper.ieee.org/groups/802/11/Reports/tgn_update.htm" class="s124" target="_blank">IEEE, “IEEE P802.11—Task Group N—Meeting Update: Status of 802.11n,” </a><a href="http://grouper.ieee.org/groups/802/11/Reports/tgn_update.htm" class="a" target="_blank">http://grouper.ieee.org/groups/802/11/Reports/tgn_update .htm</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[IEEE 802.15 2012] <a href="http://grouper.ieee.org/groups/802/15/" class="s124" target="_blank">IEEE 802.15 Working Group for WPAN homepage, </a><a href="http://grouper.ieee.org/groups/802/15/" class="a" target="_blank">http://grouper.ieee.org/groups/802/15</a><span style=" color: #1E79B8;">/</span><span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[IEEE 802.15.4 2012] <a href="http://www.ieee802.org/15/pub/TG4.html" class="s124" target="_blank">IEEE 802.15 WPAN Task Group 4, </a><a href="http://www.ieee802.org/15/pub/TG4.html" class="a" target="_blank">http://www.ieee802.org/15/pub/TG4.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;">[IEEE 802.16d 2004] <a href="http://standards.ieee.org/getieee802/download/802.16-2004.pdf" class="s124" target="_blank">IEEE, “IEEE Standard for Local and Metropolitan Area Networks, Part 16: Air Interface for Fixed Broadband Wireless Access Systems,” </a><a href="http://standards.ieee.org/getieee802/download/802.16-2004.pdf" class="a" target="_blank">http:// standards.ieee.org/getieee802/download/802.16-2004.pdf</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;">[IEEE 802.16e 2005] <a href="http://standards.ieee.org/getieee802/download/802.16e-2005.pdf" class="s124" target="_blank">IEEE, “IEEE Standard for Local and Metropolitan Area Networks, Part 16: Air Interface for Fixed and Mobile Broadband Wireless Access Systems, Amendment 2: Physical and Medium Access Control Layers for Combined Fixed and Mobile Operation in Licensed Bands and Corrigendum 1,” </a><a href="http://standards.ieee.org/getieee802/download/802.16e-2005.pdf" class="a" target="_blank">http:// standards.ieee.org/getieee802/download/802.16e-2005.pdf</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;">[IEEE 802.1q 2005] <a href="http://standards.ieee.org/getieee802/download/802.1Q-2005.pdf" class="s124" target="_blank">IEEE, “IEEE Standard for Local and Metropolitan Area Networks: Virtual Bridged Local Area Networks,” </a><a href="http://standards.ieee.org/getieee802/download/802.1Q-2005.pdf" class="a" target="_blank">http://standards.ieee.org/ getieee802/ download/802.1Q-2005.pdf</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[IEEE 802.1X] <a href="http://standards.ieee.org/reading/ieee/std_public/description/lanman/" class="s124" target="_blank">IEEE Std 802.1X-2001 Port-Based Network Access Control, </a><a href="http://standards.ieee.org/reading/ieee/std_public/description/lanman/" class="s123" target="_blank">http://standards.ieee.org/reading/ieee/std_public/description/lanman/</a><span class="s43"> 802.1x-2001_desc.html</span></p><p class="s28" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[IEEE 802.3 2012] <a href="http://grouper.ieee.org/groups/802/3/" class="s124" target="_blank">IEEE, “IEEE 802.3 CSMA/CD (Ethernet),” </a><a href="http://grouper.ieee.org/groups/802/3/" class="a" target="_blank">http://grouper.ieee.org/groups/802/3/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[IEEE 802.5 2012<a href="http://www.ieee802.org/5/www8025org/" class="s124" target="_blank">] IEEE, IEEE 802.5 homepage, </a><a href="http://www.ieee802.org/5/www8025org/" class="a" target="_blank">http://www.ieee802.org/5/ www8025org/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[IETF 2016] <a href="http://www.ietf.org/" class="s124" target="_blank">Internet Engineering Task Force homepage, </a><a href="http://www.ietf.org/" class="a" target="_blank">http://www.ietf.org</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Ihm 2011] </b>S. Ihm, V. S. Pai, “Towards Understanding Modern Web Traffic,” <i>Proc. 2011 ACM Internet Measurement Conference </i>(Berlin).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[IMAP 2012] <a href="http://www.imap.org/" class="s124" target="_blank">The IMAP Connection, </a><a href="http://www.imap.org/" class="s123" target="_blank">http://www.imap.org/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[<a href="http://www.intel.com/content/www/us/en/ethernet-products/converged-network-adapters/ethernet-xl710.html" class="s124" target="_blank">Intel 2016] Intel Corp., “Intel 710 Ethernet Adapter,” </a><a href="http://www.intel.com/content/www/us/en/ethernet-products/converged-network-adapters/ethernet-xl710.html" class="a" target="_blank">http://www.intel.com/ content/www/us/en/ethernet-products/converged-network-adapters/ethernet-xl710 .html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Internet2 Multicast 2012] <a href="http://www.internet2.edu/multicast/" class="s124" target="_blank">Internet2 Multicast Working Group homepage, </a><a href="http://www.internet2.edu/multicast/" class="s123" target="_blank">http://www.internet2.edu/multicast/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[ISC 2016] <a href="http://www.isc.org/" class="s124" target="_blank">Internet Systems Consortium homepage, </a><a href="http://www.isc.org/" class="a" target="_blank">http://www.isc.org</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[ISI 1979] <a href="http://www.isi.edu/in-notes/ien/ien123.txt" class="s124" target="_blank">Information Sciences Institute, “DoD Standard Internet Protocol,” Internet Engineering Note 123 (Dec. 1979), </a><a href="http://www.isi.edu/in-notes/ien/ien123.txt" class="a" target="_blank">http://www.isi.edu/in-notes/ien/ ien123.txt</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[ISO 2016] <a href="http://www.iso.org/" class="s124" target="_blank">International Organization for Standardization homepage, International Organization for Standardization, </a><a href="http://www.iso.org/" class="a" target="_blank">http://www.iso.org/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 25pt;text-indent: -20pt;line-height: 146%;text-align: left;">[ISO X.680 2002] <a href="http://www.itu.int/ITU-T/studygroups/com17/languages/X.680-0207.pdf" class="s124" target="_blank">International Organization for Standardization, “X.680: ITU-T Recommendation X.680 (2002) Information Technology—Abstract Syntax Notation One (ASN.1): Specification of Basic Notation,” </a><a href="http://www.itu.int/ITU-T/studygroups/com17/languages/X.680-0207.pdf" class="a" target="_blank">http://www.itu.int/ITU-T/studygroups/com17/languages/X.680-0207.pdf</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[ITU 1999] <span class="p">Asymmetric Digital Subscriber Line (ADSL) Transceivers. ITU-T G.992.1, 1999.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[ITU 2003] <span class="p">Asymmetric Digital Subscriber Line (ADSL) Transceivers—Extended Bandwidth ADSL2 (ADSL2Plus). ITU-T G.992.5, 2003.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[ITU 2005a] <span class="p">International Telecommunication Union, “ITU-T X.509, The Directory: Public-key and attribute certificate frameworks” (Aug. 2005).</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[ITU 2006] <a href="http://www.itu.int/rec/T-REC-G.993.1-200406-I/en" class="s124" target="_blank">ITU, “G.993.1: Very High Speed Digital Subscriber Line Transceivers (VDSL),” https://www.itu.int/rec/T-REC-G.993.1-200406-I/en,</a><span class="p"> 2006.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[ITU 2015] <a href="http://www.itu.int/en/ITU-D/Statistics/Pages/publications/mis2015.aspx" class="s124" target="_blank">“Measuring the Information Society Report,” 2015, </a><a href="http://www.itu.int/en/ITU-D/Statistics/Pages/publications/mis2015.aspx" class="a" target="_blank">http://www.itu.int/en/ITU-D/Statistics/Pages/publications/mis2015.aspx</a></p><p class="s28" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">[ITU 2012] <a href="http://www.itu.int/" class="s124" target="_blank">The ITU homepage, </a><a href="http://www.itu.int/" class="a" target="_blank">http://www.itu.int/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;">[ITU-T Q.2931 1995] <span class="p">International Telecommunication Union, “Recommendation Q.2931 (02/95)—Broadband Integrated Services Digital Network (B-ISDN)— Digital Subscriber Signalling System No. 2 (DSS 2)—User-Network Interface (UNI)—Layer 3 Specification for Basic Call/Connection Control.”</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[IXP List 2016] <a href="https://en.wikipedia.org/wiki/List_of_Internet_exchange_points" class="s124" target="_blank">List of IXPs, Wikipedia, </a><a href="https://en.wikipedia.org/wiki/List_of_Internet_exchange_points" class="a" target="_blank">https://en.wikipedia.org/wiki/List_of_ Internet_exchange_points</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Iyengar 2015] <span class="p">J. Iyengar, I. Swett, “QUIC: A UDP-Based Secure and Reliable Transport for HTTP/2,” Internet Draft draft-tsvwg-quic-protocol-00, June 2015.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Iyer 2008] </b>S. Iyer, R. R. Kompella, N. McKeown, “Designing Packet Buffers for Router Line Cards,” <i>IEEE Transactions on Networking</i>, Vol. 16, No. 3 (June 2008), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark807" class="a">70</a>5<a href="#bookmark818" class="s124">–</a><a href="#bookmark818" class="a">71</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Jacobson 1988] </span><span class="p">V. Jacobson, “Congestion Avoidance and Control,” </span><span class="s17">Proc. 1988 ACM SIGCOMM </span><a href="#bookmark378" class="s124">(Stanford, CA, Aug. 1988), pp. </a><a href="#bookmark378" class="a">31</a>4<a href="#bookmark396" class="s124">–</a><a href="#bookmark396" class="a">32</a>9<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Jain 1986] </b>R. Jain, “A Timeout-Based Congestion Control Scheme for Window Flow-Controlled Networks,” <i>IEEE Journal on Selected Areas in Communications SAC-4</i>, 7 (Oct. 1986).</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Jain 1989] </span><span class="p">R. Jain, “A Delay-Based Approach for Congestion Avoidance in Interconnected Heterogeneous Computer Networks,” </span><span class="s17">ACM SIGCOMM Computer Communications Review</span><a href="#bookmark98" class="s124">, Vol. 19, No. 5 (1989), pp. </a><a href="#bookmark98" class="a">5</a>6<a href="#bookmark121" class="s124">–</a><a href="#bookmark121" class="a">7</a>1<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Jain 1994] </b>R. Jain, <i>FDDI Handbook: High-Speed Networking Using Fiber and Other Media</i>, Addison-Wesley, Reading, MA, 1994.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Jain 1996] <span class="p">R. Jain. S. Kalyanaraman, S. Fahmy, R. Goyal, S. Kim, “Tutorial Paper on ABR Source Behavior,” </span><i>ATM Forum</i><a href="http://www.cse.wustl.edu/%7Ejain/atmf/ftp/atm96-1270.pdf" class="s124" target="_blank">/96-1270, Oct. 1996. </a><a href="http://www.cse.wustl.edu/%7Ejain/atmf/ftp/atm96-1270.pdf" class="a" target="_blank">http://www.cse.wustl.edu/</a></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="http://www.cse.wustl.edu/%7Ejain/atmf/ftp/atm96-1270.pdf" class="a" target="_blank">~jain/atmf/ftp/atm96-1270.pdf</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Jain 2013] </span><span class="p">S. Jain, A. Kumar, S. Mandal, J. Ong, L. Poutievski, A. Singh, S.Venkata, J. Wanderer, J. Zhou, M. Zhu, J. Zolla, U. Hölzle, S. Stuart, A, Vahdat, “B4: Experience with a Globally Deployed Software Defined Wan,” </span><span class="s17">ACM SIGCOMM 2013</span><a href="#bookmark7" class="s124">, pp. </a>3<a href="#bookmark26" class="s124">–</a><a href="#bookmark26" class="a">1</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Jaiswal 2003] <span class="p">S. Jaiswal, G. Iannaccone, C. Diot, J. Kurose, D. Towsley, “Measurement and Classification of Out-of-Sequence Packets in a Tier-1 IP backbone,” </span><i>Proc.</i></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 26pt;text-indent: 0pt;text-align: left;">2003 IEEE INFOCOM<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Ji 2003] </b>P. Ji, Z. Ge, J. Kurose, D. Towsley, “A Comparison of Hard-State and Soft-State Signaling Protocols,” <i>Proc. 2003 ACM SIGCOMM </i>(Karlsruhe, Germany, Aug.</p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">2003).</p><p class="s28" style="padding-top: 3pt;padding-left: 27pt;text-indent: -21pt;line-height: 146%;text-align: left;">[Jimenez 1997] <span class="p">D. Jimenez, “Outside Hackers Infiltrate MIT Network, Compromise Security,” </span><i>The Tech</i><a href="#bookmark3" class="s124">, Vol. 117, No 49 (Oct. 1997), p. </a><span style=" color: #1E79B8;">1</span><a href="http://www-tech.mit.edu/V117/N49/hackers.49n.html" class="s124" target="_blank">, </a><a href="http://www-tech.mit.edu/V117/N49/hackers.49n.html" class="a" target="_blank">http://www-tech.mit.edu/V117/ N49/hackers.49n.html</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Jin 2004] </b>C. Jin, D. X. We, S. Low, “FAST TCP: Motivation, Architecture, Algorithms, Performance,” <i>Proc. 2004 IEEE INFOCOM </i>(Hong Kong, Mar. 2004).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Juniper Contrail 2016] <a href="http://www.juniper.net/us/en/products-services/sdn/contrail/" class="s124" target="_blank">Juniper Networks, “Contrail,” </a><a href="http://www.juniper.net/us/en/products-services/sdn/contrail/" class="a" target="_blank">http://www.juniper.net/us/en/products-services/sdn/contrail/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Juniper MX2020 2015] <a href="http://www.juniper.net/us/en/local/pdf/.../1000417-en.pdf" class="s124" target="_blank">Juniper Networks, “MX2020 and MX2010 3D Universal Edge Routers,” </a><a href="http://www.juniper.net/us/en/local/pdf/.../1000417-en.pdf" class="s123" target="_blank">www.juniper.net/us/en/local/pdf/.../1000417-en.pdf</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Kaaranen 2001] </b>H. Kaaranen, S. Naghian, L. Laitinen, A. Ahtiainen, V. Niemi, <i>Networks: Architecture, Mobility and Services</i>, New York: John Wiley &amp; Sons, 2001.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Kahn 1967] </b>D. Kahn, <i>The Codebreakers: The Story of Secret Writing</i>, The Macmillan Company, 1967.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Kahn 1978] </b>R. E. Kahn, S. Gronemeyer, J. Burchfiel, R. Kunzelman, “Advances in Packet Radio Technology,” <i>Proc. 1978 IEEE INFOCOM</i>, 66, 11 (Nov. 1978).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Kamerman 1997] </span><span class="p">A. Kamerman, L. Monteban, “WaveLAN-II: A High– Performance Wireless LAN for the Unlicensed Band,” </span><span class="s17">Bell Labs Technical Journal </span><a href="#bookmark181" class="s124">(Summer 1997), pp. </a><a href="#bookmark181" class="a">11</a>8<a href="#bookmark200" class="s124">–</a><a href="#bookmark200" class="a">13</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Kar 2000] </b>K. Kar, M. Kodialam, T. V. Lakshman, “Minimum Interference Routing of Bandwidth Guaranteed Tunnels with MPLS Traffic Engineering Applications,” <i>IEEE J. Selected Areas in Communications </i>(Dec. 2000).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Karn 1987] </b>P. Karn, C. Partridge, “Improving Round-Trip Time Estimates in Reliable Transport Protocols,” <i>Proc. 1987 ACM SIGCOMM</i>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;">[Karol 1987] <span class="p">M. Karol, M. Hluchyj, A. Morgan, “Input Versus Output Queuing on a Space-Division Packet Switch,” IEEE Transactions on Communications, Vol. 35, No. 12 (Dec.1987), pp. 1347–1356.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Kaufman 1995] </b>C. Kaufman, R. Perlman, M. Speciner, <i>Network Security, Private Communication in a Public World</i>, Prentice Hall, Englewood Cliffs, NJ, 1995.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Kelly 1998] </b>F. P. Kelly, A. Maulloo, D. Tan, “Rate Control for Communication Networks: Shadow Prices, Proportional Fairness and Stability,” <i>J. Operations Res. Soc.</i>, Vol.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark304" class="s124">49, No. 3 (Mar. 1998), pp. </a><a href="#bookmark304" class="a">23</a>7<a href="#bookmark321" class="s124">–</a><a href="#bookmark321" class="a">25</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Kelly 2003] </span><span class="p">T. Kelly, “Scalable TCP: Improving Performance in High Speed Wide Area Networks,” </span><span class="s17">ACM SIGCOMM Computer Communications Review</span><a href="#bookmark137" class="s124">, Volume 33, No. 2 (Apr. 2003), pp.</a><a href="#bookmark137" class="a">8</a>3<a href="#bookmark148" class="s124">–</a><a href="#bookmark148" class="a">9</a>1<span class="p">.</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Kilkki 1999] </b>K. Kilkki, <i>Differentiated Services for the Internet</i>, Macmillan Technical Publishing, Indianapolis, IN, 1999.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Kim 2005] </b>H. Kim, S. Rixner, V. Pai, “Network Interface Data Caching,” <i>IEEE Transactions on Computers</i>, Vol. 54, No. 11 (Nov. 2005), pp. 1394–1408.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Kim 2008] </b>C. Kim, M. Caesar, J. Rexford, “Floodless in SEATTLE: A Scalable Ethernet Architecture for Large Enterprises,” <i>Proc. 2008 ACM SIGCOMM </i>(Seattle, WA, Aug.</p><p style="padding-top: 4pt;padding-left: 25pt;text-indent: 0pt;text-align: left;">2008).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Kleinrock 1961] <span class="p">L. Kleinrock, “Information Flow in Large Communication Networks,” RLE Quarterly Progress Report, July 1961.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Kleinrock 1964] </b>L. Kleinrock, <i>1964 Communication Nets: Stochastic Message Flow and Delay</i>, McGraw-Hill, New York, NY, 1964.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Kleinrock 1975] </b>L. Kleinrock, <i>Queuing Systems, Vol. 1</i>, John Wiley, New York, 1975.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Kleinrock 1975b] </b>L. Kleinrock, F. A. Tobagi, “Packet Switching in Radio Channels: Part I—Carrier Sense Multiple-Access Modes and Their Throughput-Delay Characteristics,” <i>IEEE Transactions on Communications</i>, Vol. 23, No. 12 (Dec. 1975), pp. 1400–1416.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Kleinrock 1976] </b>L. Kleinrock, <i>Queuing Systems, Vol. 2</i>, John Wiley, New York, 1976.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Kleinrock 2004] <a href="http://www.lk.cs.ucla.edu/LK/Inet/birth.html" class="s124" target="_blank">L. Kleinrock, “The Birth of the Internet,” </a><a href="http://www.lk.cs.ucla.edu/LK/Inet/birth.html" class="a" target="_blank">http://www.lk.cs.ucla.edu/LK/Inet/birth.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Kohler 2006] </b>E. Kohler, M. Handley, S. Floyd, “DDCP: Designing DCCP: Congestion Control Without Reliability,” <i>Proc. 2006 ACM SIGCOMM </i>(Pisa, Italy, Sept. 2006).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Kolding 2003] </span><span class="p">T. Kolding, K. Pedersen, J. Wigard, F. Frederiksen, P. Mogensen, “High Speed Downlink Packet Access: WCDMA Evolution,” </span><span class="s17">IEEE Vehicular Technology Society News </span><a href="#bookmark9" class="s124">(Feb. 2003), pp. </a>4<a href="#bookmark18" class="s124">–</a><a href="#bookmark18" class="a">1</a>0<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Koponen 2010] </span><span class="p">T. Koponen, M. Casado, N. Gude, J. Stribling, L. Poutievski, M. Zhu, R. Ramanathan, Y. Iwata, H. Inoue, T. Hama, S. Shenker, “Onix: A Distributed Control Platform for Large-Scale Production Networks,” </span><span class="s17">9th USENIX conference on Operating systems design and implementation (OSDI’10)</span><a href="#bookmark3" class="s124">, pp. </a>1<a href="#bookmark11" class="s124">–</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Koponen 2011] </b>T. Koponen, S. Shenker, H. Balakrishnan, N. Feamster, I. Ganichev, A. Ghodsi, P. B. Godfrey, N. McKeown, G. Parulkar, B. Raghavan, J. Rexford, S. Arianfar, D. Kuptsov, “Architecting for Innovation,” <i>ACM Computer Communications Review</i>, 2011.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Korhonen 2003] </b>J. Korhonen, <i>Introduction to 3G Mobile Communications</i>, 2nd ed., Artech House, 2003.</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Koziol 2003] </b>J. Koziol, <i>Intrusion Detection with Snort</i>, Sams Publishing, 2003.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;text-align: left;">[Kreutz 2015] <span class="p">D. Kreutz, F.M.V. Ramos, P. Esteves Verissimo, C. Rothenberg, S. Azodolmolky, S. Uhlig, “Software-Defined Networking: A Comprehensive Survey,”</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><span class="s17">Proceedings of the IEEE</span><a href="#bookmark26" class="s124">, Vol. 103, No. 1 (Jan. 2015), pp. </a><a href="#bookmark26" class="a">1</a>4<a href="#bookmark124" class="s124">-</a><a href="#bookmark124" class="a">7</a>6<a href="https://github.com/SDN-Survey/latex/wiki" class="s124" target="_blank">. This paper is also being updated at </a><a href="https://github.com/SDN-Survey/latex/wiki" class="a" target="_blank">https://github.com/SDN-Survey/latex/wiki</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Krishnamurthy 2001] </b>B. Krishnamurthy, J. Rexford, <i>Web Protocols and Practice: HTTP/ 1.1, Networking Protocols, and Traffic Measurement</i>, Addison-Wesley, Boston, MA, 2001.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Kulkarni 2005] <span class="p">S. Kulkarni, C. Rosenberg, “Opportunistic Scheduling: Generalizations to Include Multiple Constraints, Multiple Interfaces, and Short Term Fairness,”</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 26pt;text-indent: 0pt;text-align: left;">Wireless Networks<span class="p">, 11 (2005), 557–569.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Kumar 2006] </b>R. Kumar, K.W. Ross, “Optimal Peer-Assisted File Distribution: Single and Multi-Class Problems,” <i>IEEE Workshop on Hot Topics in Web Systems and Technologies </i>(Boston, MA, 2006).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Labovitz 1997] </span><span class="p">C. Labovitz, G. R. Malan, F. Jahanian, “Internet Routing Instability,” </span><span class="s17">Proc. 1997 ACM SIGCOMM </span><a href="#bookmark175" class="s124">(Cannes, France, Sept. 1997), pp. </a><a href="#bookmark175" class="a">11</a>5<a href="#bookmark194" class="s124">–</a><a href="#bookmark194" class="a">12</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Labovitz 2010] </b>C. Labovitz, S. Iekel-Johnson, D. McPherson, J. Oberheide, F. Jahanian, “Internet Inter-Domain Traffic,” <i>Proc. 2010 ACM SIGCOMM</i>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Labrador 1999] </b>M. Labrador, S. Banerjee, “Packet Dropping Policies for ATM and IP Networks,” <i>IEEE Communications Surveys</i>, Vol. 2, No. 3 (Third Quarter 1999), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;">2<a href="#bookmark26" class="s124">–</a><a href="#bookmark26" class="a">1</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 27pt;text-indent: -21pt;line-height: 146%;text-align: left;"><b>[Lacage 2004] </b>M. Lacage, M.H. Manshaei, T. Turletti, “IEEE 802.11 Rate Adaptation: A Practical Approach,” <i>ACM Int. Symposium on Modeling, Analysis, and Simulation of Wireless and Mobile Systems (MSWiM) </i>(Venice, Italy, Oct. 2004).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Lakhina 2004] </b>A. Lakhina, M. Crovella, C. Diot, “Diagnosing Network-Wide Traffic Anomalies,” <i>Proc. 2004 ACM SIGCOMM</i>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Lakhina 2005] </b>A. Lakhina, M. Crovella, C. Diot, “Mining Anomalies Using Traffic Feature Distributions,” <i>Proc. 2005 ACM SIGCOMM</i>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 27pt;text-indent: -21pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Lakshman 1997] </span><span class="p">T. V. Lakshman, U. Madhow, “The Performance of TCP/IP for Networks with High Bandwidth-Delay Products and Random Loss,” </span><span class="s17">IEEE/ACM Transactions on Networking</span><a href="#bookmark403" class="s124">, Vol. 5, No. 3 (1997), pp. </a><a href="#bookmark403" class="a">33</a>6<a href="#bookmark421" class="s124">–</a><a href="#bookmark421" class="a">35</a>0<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 27pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Lakshman 2004] </b>T. V. Lakshman, T. Nandagopal, R. Ramjee, K. Sabnani, T. Woo, “The SoftRouter Architecture,” <i>Proc. 3nd ACM Workshop on Hot Topics in Networks (Hotnets-III)</i>, Nov. 2004.</p><p class="s20" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Lam 1980] </span><span class="p">S. Lam, “A Carrier Sense Multiple Access Protocol for Local Networks,” </span><span class="s17">Computer Networks</span><a href="#bookmark39" class="s124">, Vol. 4 (1980), pp. </a><a href="#bookmark39" class="a">2</a>1<a href="#bookmark57" class="s124">–</a><a href="#bookmark57" class="a">3</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Lamport 1989] <span class="p">L. Lamport, “The Part-Time Parliament,” Technical Report 49, Systems Research Center, Digital Equipment Corp., Palo Alto, Sept. 1989.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Lampson 1983] </b>Lampson, Butler W. “Hints for computer system design,” <i>ACM SIGOPS Operating Systems Review</i>, Vol. 17, No. 5, 1983.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Lampson 1996] </span><span class="p">B. Lampson, “How to Build a Highly Available System Using Consensus,” </span><span class="s17">Proc. 10th International Workshop on Distributed Algorithms </span><a href="#bookmark3" class="s124">(WDAG ’96), Özalp Babaoglu and Keith Marzullo (Eds.), Springer-Verlag, pp. </a>1<a href="#bookmark31" class="s124">–</a><a href="#bookmark31" class="a">1</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Lawton 2001] </span><span class="p">G. Lawton, “Is IPv6 Finally Gaining Ground?” </span><span class="s17">IEEE Computer Magazine </span><a href="#bookmark20" class="s124">(Aug. 2001), pp. </a><a href="#bookmark20" class="a">1</a>1<a href="#bookmark28" class="s124">–</a><a href="#bookmark28" class="a">1</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[LeBlond 2011] </span><span class="p">S. Le Blond, C. Zhang, A. Legout, K. Ross, W. Dabbous. 2011, “I know where you are and what you are sharing: exploiting P2P communications to invade users’ privacy.” </span><span class="s17">2011 ACM Internet Measurement Conference</span><a href="#bookmark78" class="s124">, ACM, New York, NY, USA, pp. </a><a href="#bookmark78" class="a">4</a>5<a href="#bookmark103" class="s124">–</a><a href="#bookmark103" class="a">6</a>0<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Leighton 2009] </span><span class="p">T. Leighton, “Improving Performance on the Internet,” </span><span class="s17">Communications of the ACM</span><a href="#bookmark76" class="s124">, Vol. 52, No. 2 (Feb. 2009), pp. </a><a href="#bookmark76" class="a">4</a>4<a href="#bookmark90" class="s124">–</a><a href="#bookmark90" class="a">5</a>1<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Leiner 1998] <span class="p">B. Leiner, V. Cerf, D. Clark, R. Kahn, L. Kleinrock, D. Lynch, J. Postel, L. Roberts, S. Woolf, “A Brief History of the Internet,”</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="http://www.isoc.org/internet/history/brief.html" class="s123" target="_blank">http://www.isoc.org/internet/history/brief.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Leung 2006] </b>K. Leung, V. O.K. Li, “TCP in Wireless Networks: Issues, Approaches, and Challenges,” <i>IEEE Commun. Surveys and Tutorials</i>, Vol. 8, No. 4 (2006), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark111" class="a">6</a>4<a href="#bookmark131" class="s124">–</a><a href="#bookmark131" class="a">7</a>9<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Levin 2012] </span><span class="p">D. Levin, A. Wundsam, B. Heller, N. Handigol, A. Feldmann, “Logically Centralized?: State Distribution Trade-offs in Software Defined Networks,” </span><span class="s17">Proc. First Workshop on Hot Topics in Software Defined Networks </span><a href="#bookmark3" class="s124">(Aug. 2012), pp. </a>1<a href="#bookmark11" class="s124">–</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Li 2004] <span class="p">L. Li, D. Alderson, W. Willinger, J. Doyle, “A First-Principles Approach to Understanding the Internet’s Router-Level Topology,” </span><i>Proc. 2004 ACM SIGCOMM</i></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">(Portland, OR, Aug. 2004).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Li 2007] </b>J. Li, M. Guidero, Z. Wu, E. Purpus, T. Ehrenkranz, “BGP Routing Dynamics Revisited.” <i>ACM Computer Communication Review </i>(Apr. 2007).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Li 2015] <span class="p">S.Q. Li, “Building Softcom Ecosystem Foundation,” Open Networking Summit, 2015.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Lin 2001] </b>Y. Lin, I. Chlamtac, <i>Wireless and Mobile Network Architectures</i>, John Wiley and Sons, New York, NY, 2001.</p><p class="s28" style="padding-top: 4pt;padding-left: 25pt;text-indent: -20pt;line-height: 146%;text-align: left;">[Liogkas 2006] <span class="p">N. Liogkas, R. Nelson, E. Kohler, L. Zhang, “Exploiting BitTorrent for Fun (but Not Profit),” </span><i>6th International Workshop on Peer-to-Peer Systems (IPTPS 2006).</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;"><b>[Liu 2003] </b>J. Liu, I. Matta, M. Crovella, “End-to-End Inference of Loss Nature in a Hybrid Wired/Wireless Environment,” <i>Proc. WiOpt’03: Modeling and Optimization in Mobile, Ad Hoc and Wireless Networks</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Locher 2006] </b>T. Locher, P. Moor, S. Schmid, R. Wattenhofer, “Free Riding in BitTorrent is Cheap,” <i>Proc. ACM HotNets 2006 (</i>Irvine CA, Nov. 2006).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Lui 2004] </span><span class="p">J. Lui, V. Misra, D. Rubenstein, “On the Robustness of Soft State Protocols,” </span><span class="s17">Proc. IEEE Int. Conference on Network Protocols (ICNP ’04</span><a href="#bookmark88" class="s124">), pp. </a><a href="#bookmark88" class="a">5</a>0<a href="#bookmark103" class="s124">–</a><a href="#bookmark103" class="a">6</a>0<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Mahdavi 1997] <span class="p">J. Mahdavi, S. Floyd, “TCP-Friendly Unicast Rate-Based Flow Control,” unpublished note (Jan. 1997).</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="http://www.maxmind.com/app/ip-location" style=" color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt;" target="_blank">[MaxMind 2016] </a><a href="http://www.maxmind.com/app/ip-location" class="a" target="_blank">http://www.maxmind.com/app/ip-location</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Maymounkov 2002] </span><span class="p">P. Maymounkov, D. Mazières. “Kademlia: A Peer-to-Peer Information System Based on the XOR Metric.” </span><span class="s17">Proceedings of the 1st International Workshop on Peerto-Peer Systems (IPTPS ‘02) </span><a href="#bookmark91" class="s124">(Mar. 2002), pp. </a><a href="#bookmark91" class="a">5</a>3<a href="#bookmark114" class="s124">–</a><a href="#bookmark114" class="a">6</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[McKeown 1997a] </b>N. McKeown, M. Izzard, A. Mekkittikul, W. Ellersick, M. Horowitz, “The Tiny Tera: A Packet Switch Core,” <i>IEEE Micro Magazine </i>(Jan.–Feb. 1997).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;">[McKeown 1997b] <span class="p">N. McKeown, “A Fast Switched Backplane for a Gigabit Switched Router,” </span><i>Business Communications Review, </i><a href="http://tiny-tera.stanford.edu/%7Enickm/papers/cisco_fasts_wp.pdf" class="s124" target="_blank">Vol. 27, No. 12. </a><a href="http://tiny-tera.stanford.edu/%7Enickm/papers/cisco_fasts_wp.pdf" class="a" target="_blank">http://tiny- tera.stanford.edu/~nickm/papers/cisco_fasts_wp.pdf</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[McKeown 2008] </span><span class="p">N. McKeown, T. Anderson, H. Balakrishnan, G. Parulkar, L. Peterson, J. Rexford, S. Shenker, J. Turner. 2008. OpenFlow: Enabling Innovation in Campus Networks. </span><span class="s17">SIGCOMM Comput. Commun. Rev. </span><a href="#bookmark119" class="s124">38, 2 (Mar. 2008), pp. </a><a href="#bookmark119" class="a">6</a>9<a href="#bookmark123" class="s124">–</a><a href="#bookmark123" class="a">7</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[McQuillan 1980] </b>J. McQuillan, I. Richer, E. Rosen, “The New Routing Algorithm for the Arpanet,” <i>IEEE Transactions on Communications, </i>Vol. 28, No. 5 (May 1980), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark813" class="a">71</a>1<a href="#bookmark820" class="s124">–</a><a href="#bookmark820" class="a">71</a>9<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Metcalfe 1976] </span><span class="p">R. M. Metcalfe, D. R. Boggs. “Ethernet: Distributed Packet Switching for Local Computer Networks,” </span><span class="s17">Communications of the Association for Computing Machinery, </span><a href="#bookmark464" class="s124">Vol. 19, No. 7 (July 1976), pp. </a><a href="#bookmark464" class="a">39</a>5<a href="#bookmark476" class="s124">–</a><a href="#bookmark476" class="a">40</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Meyers 2004] </b>A. Myers, T. Ng, H. Zhang, “Rethinking the Service Model: Scaling Ethernet to a Million Nodes<i>,” ACM Hotnets Conference</i>, 2004.</p><p class="s28" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">[MFA Forum 2016] <a href="http://www.ipmplsforum.org/" class="s124" target="_blank">IP/MPLS Forum homepage, </a><a href="http://www.ipmplsforum.org/" class="a" target="_blank">http://www.ipmplsforum.org/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Mockapetris 1988</b>] P. V. Mockapetris, K. J. Dunlap, “Development of the Domain Name System,” <i>Proc. 1988 ACM SIGCOMM </i>(Stanford, CA, Aug. 1988).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Mockapetris 2005] <a href="http://www.postel.org/sigcomm" class="s124" target="_blank">P. Mockapetris, Sigcomm Award Lecture, video available at </a><a href="http://www.postel.org/sigcomm" class="a" target="_blank">http://www.postel.org/sigcomm</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Molinero-Fernandez 2002] </b>P. Molinaro-Fernandez, N. McKeown, H. Zhang, “Is IP Going to Take Over the World (of Communications)?” <i>Proc. 2002 ACM Hotnets</i>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Molle 1987] </b>M. L. Molle, K. Sohraby, A. N. Venetsanopoulos, “Space-Time Models of Asynchronous CSMA Protocols for Local Area Networks,” <i>IEEE Journal on Selected Areas in Communications, </i>Vol. 5, No. 6 (1987), pp. 956–968.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Moore 2001] </b>D. Moore, G. Voelker, S. Savage, “Inferring Internet Denial of Service Activity,” <i>Proc. 2001 USENIX Security Symposium </i>(Washington, DC, Aug. 2001).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Motorola 2007] <span class="p">Motorola, “Long Term Evolution (LTE): A Technical Overview,”</span></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="http://www.motorola.com/staticfiles/Business/Solutions/Industry%20Solutions/Service%20Providers/Wireless%20Operators/LTE/_Document/Static%20Files/6834_MotDoc_New.pdf" class="s123" target="_blank">http://www.motorola.com/staticfiles/Business/Solutions/Industry%20Solutions/Service%20Providers/Wireless%20Operators/LTE/_Document/Static%20Files/6834_MotDoc_New.pdf</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Mouly 1992] </b>M. Mouly, M. Pautet, <i>The GSM System for Mobile Communications</i>, Cell and Sys, Palaiseau, France, 1992.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Moy 1998] </b>J. Moy, <i>OSPF: Anatomy of An Internet Routing Protocol</i>, Addison-Wesley, Reading, MA, 1998.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Mukherjee 1997] </b>B. Mukherjee, <i>Optical Communication Networks</i>, McGraw-Hill, 1997.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Mukherjee 2006] </b>B. Mukherjee, <i>Optical WDM Networks, </i>Springer, 2006.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Mysore 2009] </b>R. N. Mysore, A. Pamboris, N. Farrington, N. Huang, P. Miri, S. Radhakrishnan, V. Subramanya, A. Vahdat, “PortLand: A Scalable Fault-Tolerant Layer 2 Data Center Network Fabric,” <i>Proc. 2009 ACM SIGCOMM</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Nahum 2002] </b>E. Nahum, T. Barzilai, D. Kandlur, “Performance Issues in WWW Servers,” <i>IEEE/ACM Transactions on Networking</i>, Vol 10, No. 1 (Feb. 2002).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Netflix Open Connect 2016] <a href="https://openconnect.netflix.com/" class="s124" target="_blank">Netflix Open Connect CDN, 2016, </a><a href="https://openconnect.netflix.com/" class="a" target="_blank">https:// openconnect.netflix.com/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Netflix Video 1] <a href="https://www.youtube.com/watch?v=LkLLpYdDINA" class="s124" target="_blank">Designing Netflix’s Content Delivery System, D. Fulllager, 2014, </a><a href="https://www.youtube.com/watch?v=LkLLpYdDINA" class="a" target="_blank">https://www.youtube.com/watch?v=LkLLpYdDINA</a></p><p class="s28" style="padding-top: 4pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">[Netflix Video 2] <a href="https://www.youtube.com/watch?v=tbqcsHg-Q_o" class="s124" target="_blank">Scaling the Netflix Global CDN, D. Temkin, 2015, </a><a href="https://www.youtube.com/watch?v=tbqcsHg-Q_o" class="a" target="_blank">https://www .youtube.com/watch?v=tbqcsHg-Q_o</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;">[Neumann 1997] <span class="p">R. Neumann, “Internet Routing Black Hole,” </span><i>The Risks Digest: Forum on Risks to the Public in Computers and Related Systems, </i><a href="http://catless.ncl.ac.uk/Risks/19.12.html#subj1.1" class="s124" target="_blank">Vol. 19, No. 12 (May 1997).  </a><a href="http://catless.ncl.ac.uk/Risks/19.12.html#subj1.1" class="a" target="_blank">http://catless.ncl.ac.uk/Risks/19.12.html#subj1.1</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Neville-Neil 2009] </span><span class="p">G. Neville-Neil, “Whither Sockets?” </span><span class="s17">Communications of the ACM, </span><a href="#bookmark90" class="s124">Vol. 52, No. 6 (June 2009), pp. </a><a href="#bookmark90" class="a">5</a>1<a href="#bookmark96" class="s124">–</a><a href="#bookmark96" class="a">5</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 27pt;text-indent: -21pt;line-height: 130%;text-align: left;"><b>[Nicholson 2006] </b>A Nicholson, Y. Chawathe, M. Chen, B. Noble, D. Wetherall, “Improved Access Point Selection,” <i>Proc. 2006 ACM Mobisys Conference </i>(Uppsala Sweden, 2006).</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 27pt;text-indent: -21pt;line-height: 146%;text-align: left;"><b>[Nielsen 1997] </b>H. F. Nielsen, J. Gettys, A. Baird-Smith, E. Prud’hommeaux, H. W. Lie, C. Lilley, “Network Performance Effects of HTTP/1.1, CSS1, and PNG,” <i>W3C Document, </i>1997 (also appears in <i>Proc. 1997 ACM SIGCOM </i><a href="#bookmark225" class="s124">(Cannes, France, Sept 1997), pp. </a><a href="#bookmark225" class="a">15</a><span class="s20">5</span><a href="#bookmark235" class="s124">–</a><a href="#bookmark235" class="a">16</a><span class="s20">6</span>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 27pt;text-indent: -20pt;line-height: 146%;text-align: left;">[NIST 2001] <a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf" class="s124" target="_blank">National Institute of Standards and Technology, “Advanced Encryption Standard (AES),” Federal Information Processing Standards 197, Nov. 2001, </a><a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf" class="a" target="_blank">http:// csrc.nist.gov/publications/fips/fips197/fips-197.pdf</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 27pt;text-indent: -21pt;line-height: 146%;text-align: left;">[NIST IPv6 2015] <a href="http://fedv6-deployment.antd.nist.gov/snap-all.html" class="s124" target="_blank">US National Institute of Standards and Technology, “Estimating IPv6 &amp; DNSSEC Deployment SnapShots,” </a><a href="http://fedv6-deployment.antd.nist.gov/snap-all.html" class="a" target="_blank">http://fedv6-deployment.antd.nist.gov/snap- all.html</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Nmap 2012] <a href="http://www.insecure.com/nmap" class="s124" target="_blank">Nmap homepage, </a><a href="http://www.insecure.com/nmap" class="a" target="_blank">http://www.insecure.com/nmap</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 27pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Nonnenmacher 1998] </span><span class="p">J. Nonnenmacher, E. Biersak, D. Towsley, “Parity-Based Loss Recovery for Reliable Multicast Transmission,” </span><span class="s17">IEEE/ACM Transactions on Networking, </span><a href="#bookmark420" class="s124">Vol. 6, No. 4 (Aug. 1998), pp. </a><a href="#bookmark420" class="a">34</a>9<a href="#bookmark435" class="s124">–</a><a href="#bookmark435" class="a">36</a>1<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Nygren 2010] <span class="p">Erik Nygren, Ramesh K. Sitaraman, and Jennifer Sun, “The Akamai Network: A Platform for High-performance Internet Applications,” </span><i>SIGOPS Oper. Syst.</i></p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s17" style="padding-left: 27pt;text-indent: 0pt;text-align: left;">Rev. <span class="p">44, 3 (Aug. 2010), 2–19.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[ONF 2016<a href="https://www.opennetworking.org/sdn-resources/technical-library" class="s124" target="_blank">] Open Networking Foundation, Technical Library, </a><a href="https://www.opennetworking.org/sdn-resources/technical-library" class="a" target="_blank">https://www.opennetworking.org/sdn-resources/technical-library</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[ONOS 2016] </b>Open Network Operating System (ONOS), “Architecture Guide,” <span style=" color: #AAA;">https://wiki.onosproject.org/display/ONOS/Architecture+Guide</span>, 2016.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 27pt;text-indent: -20pt;line-height: 146%;text-align: left;">[OpenFlow 2009] <a href="https://www.opennetworking.org/images/stories/downloads/sdn-resources/onf-specifications/openflow/openflow-spec-v1.0.0.pdf" class="s124" target="_blank">Open Network Foundation, “OpenFlow Switch Specification 1.0.0, TS-001,” </a><a href="https://www.opennetworking.org/images/stories/downloads/sdn-resources/onf-specifications/openflow/openflow-spec-v1.0.0.pdf" class="a" target="_blank">https://www.opennetworking.org/images/stories/downloads/sdn- resources/onf-specifications/openflow/openflow-spec-v1.0.0.pdf</a></p><p class="s28" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[OpenDaylight Lithium 2016] <a href="http://www.opendaylight.org/lithium" class="s124" target="_blank">OpenDaylight, “Lithium,” </a><a href="http://www.opendaylight.org/lithium" class="s123" target="_blank">https://www.opendaylight.org/lithium</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[OSI 2012] <a href="http://www.iso.org/iso/en/ISOOnline.frontpage" class="s124" target="_blank">International Organization for Standardization homepage, </a><a href="http://www.iso.org/iso/en/ISOOnline.frontpage" class="a" target="_blank">http://www.iso.org/iso/en/ISOOnline.frontpage</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Osterweil 2012] </b>E. Osterweil, D. McPherson, S. DiBenedetto, C. Papadopoulos, D. Massey, “Behavior of DNS Top Talkers,” <i>Passive and Active Measurement Conference</i>, 2012.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Padhye 2000] </span><span class="p">J. Padhye, V. Firoiu, D. Towsley, J. Kurose, “Modeling TCP Reno Performance: A Simple Model and Its Empirical Validation,” </span><span class="s17">IEEE/ACM Transactions on Networking, </span><a href="#bookmark200" class="s124">Vol. 8 No. 2 (Apr. 2000), pp. </a><a href="#bookmark200" class="a">13</a>3<a href="#bookmark214" class="s124">–</a><a href="#bookmark214" class="a">14</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Padhye 2001] </b>J. Padhye, S. Floyd, “On Inferring TCP Behavior,” <i>Proc. 2001 ACM SIGCOMM </i>(San Diego, CA, Aug. 2001).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;"><b>[Palat 2009] </b>S. Palat, P. Godin, “The LTE Network Architecture: A Comprehensive Tutorial,” in <i>LTE—The UMTS Long Term Evolution: From Theory to Practice. Also available as a standalone Alcatel white paper</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Panda 2013] </span><span class="p">A. Panda, C. Scott, A. Ghodsi, T. Koponen, S. Shenker, “CAP for Networks,” </span><span class="s17">Proc. ACM HotSDN ’13</span><a href="#bookmark148" class="s124">, pp. </a><a href="#bookmark148" class="a">9</a>1<a href="#bookmark154" class="s124">–</a><a href="#bookmark154" class="a">9</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Parekh 1993] </span><span class="p">A. Parekh, R. Gallagher, “A Generalized Processor Sharing Approach to Flow Control in Integrated Services Networks: The Single-Node Case,” </span><span class="s17">IEEE/ACM Transactions on Networking, </span><a href="#bookmark413" class="s124">Vol. 1, No. 3 (June 1993), pp. </a><a href="#bookmark413" class="a">34</a>4<a href="#bookmark428" class="s124">–</a><a href="#bookmark428" class="a">35</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -21pt;line-height: 130%;text-align: left;"><b>[Partridge 1992] </b>C. Partridge, S. Pink, “An Implementation of the Revised Internet Stream Protocol (ST-2),” <i>Journal of Internetworking: Research and Experience</i>, Vol. 3, No. 1 (Mar. 1992).</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Partridge 1998] </span><span class="p">C. Partridge, et al. “A Fifty Gigabit per second IP Router,” </span><span class="s17">IEEE/ACM Transactions on Networking, </span><a href="#bookmark304" class="s124">Vol. 6, No. 3 (Jun. 1998), pp. </a><a href="#bookmark304" class="a">23</a>7<a href="#bookmark314" class="s124">–</a><a href="#bookmark314" class="a">24</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Pathak 2010] </b>A. Pathak, Y. A. Wang, C. Huang, A. Greenberg, Y. C. Hu, J. Li, K. W. Ross, “Measuring and Evaluating TCP Splitting for Cloud Services,” <i>Passive and Active Measurement (PAM) Conference </i>(Zurich, 2010).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Perkins 1994] </b>A. Perkins, “Networking with Bob Metcalfe,” <i>The Red Herring Magazine </i>(Nov. 1994).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Perkins 1998] </b>C. Perkins, O. Hodson, V. Hardman, “A Survey of Packet Loss Recovery Techniques for Streaming Audio,” <i>IEEE Network Magazine </i>(Sept./Oct. 1998), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark69" class="a">4</a>0<a href="#bookmark83" class="s124">–</a><a href="#bookmark83" class="a">4</a>7<span class="p">.</span></p><p style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Perkins 1998b] </b>C. Perkins, <i>Mobile IP: Design Principles and Practice</i>, Addison-Wesley, Reading, MA, 1998.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Perkins 2000] </b>C. Perkins, <i>Ad Hoc Networking</i>, Addison-Wesley, Reading, MA, 2000.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Perlman 1999] </b>R. Perlman, <i>Interconnections: Bridges, Routers, Switches, and Internetworking Protocols, </i>2nd ed., Addison-Wesley Professional Computing Series, Reading, MA, 1999.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[PGPI 2016] <a href="http://www.pgpi.org/" class="s124" target="_blank">The International PGP homepage, </a><a href="http://www.pgpi.org/" class="a" target="_blank">http://www.pgpi.org</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Phifer 2000] <span class="p">L. Phifer, “The Trouble with NAT,” </span><i>The Internet Protocol Journal, </i><a href="http://www.cisco.com/warp/public/759/ipj_3-4/ipj_" class="s124" target="_blank">Vol. 3, No. 4 (Dec. 2000), </a><a href="http://www.cisco.com/warp/public/759/ipj_3-4/ipj_" class="s123" target="_blank">http://www.cisco.com/warp/public/759/ipj_3-4/ipj_</a><span class="s43"> 3-4_nat.html</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Piatek 2007] </b>M. Piatek, T. Isdal, T. Anderson, A. Krishnamurthy, A. Venkataramani, “Do Incentives Build Robustness in Bittorrent?,” <i>Proc. NSDI </i>(2007).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Piatek 2008] </b>M. Piatek, T. Isdal, A. Krishnamurthy, T. Anderson, “One Hop Reputations for Peer-to-peer File Sharing Workloads,” <i>Proc. NSDI </i>(2008).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 25pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Pickholtz 1982] </b>R. Pickholtz, D. Schilling, L. Milstein, “Theory of Spread Spectrum Communication—a Tutorial,” <i>IEEE Transactions on Communications, </i>Vol. 30, No. 5 (May 1982), pp. 855–884.</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[PingPlotter 2016] <a href="http://www.pingplotter.com/" class="s124" target="_blank">PingPlotter homepage, </a><a href="http://www.pingplotter.com/" class="a" target="_blank">http://www.pingplotter.com</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Piscatello 1993] </b>D. Piscatello, A. Lyman Chapin, <i>Open Systems Networking, </i>Addison-Wesley, Reading, MA, 1993.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;">[Pomeranz 2010] <a href="https://righteousit.wordpress.com/2010/06/27/practical-visual-three-dimensional-pedagogy-for-internet-protocol-packet-header-control-fields/" class="s124" target="_blank">H. Pomeranz, “Practical, Visual, Three-Dimensional Pedagogy for Internet Protocol Packet Header Control Fields,” </a><a href="https://righteousit.wordpress.com/2010/06/27/practical-visual-three-dimensional-pedagogy-for-internet-protocol-packet-header-control-fields/" class="a" target="_blank">https://righteousit.wordpress.com/ 2010/06/27/</a><span style=" color: #1E79B8;">practical-visual-three-dimensional-pedagogy-for-internet-protocol-packet-header-control-fields/</span><span class="p">,  June  2010.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Potaroo 2016] <a href="http://bgp.potaroo.net/" class="s124" target="_blank">“Growth of the BGP Table–1994 to Present,” </a><a href="http://bgp.potaroo.net/" class="a" target="_blank">http://bgp.potaroo.net/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[PPLive 2012] <a href="http://www.pplive.com/" class="s124" target="_blank">PPLive homepage, </a><a href="http://www.pplive.com/" class="s123" target="_blank">http://www.pplive.com</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Qazi 2013] </b>Z. Qazi, C. Tu, L. Chiang, R. Miao, V. Sekar, M. Yu, “SIMPLE-fying Middlebox Policy Enforcement Using SDN,” ACM <i>SIGCOMM Conference </i>(Aug. 2013), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark51" class="a">2</a>7<a href="#bookmark66" class="s124">–</a><a href="#bookmark66" class="a">3</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Quagga 2012] <a href="http://www.quagga.net/" class="s124" target="_blank">Quagga, “Quagga Routing Suite,” </a><a href="http://www.quagga.net/" class="a" target="_blank">http://www.quagga.net/</a></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Quittner 1998] </b>J. Quittner, M. Slatalla, <i>Speeding the Net: The Inside Story of Netscape and How It Challenged Microsoft, </i>Atlantic Monthly Press, 1998.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a href="http://www.quova.com/" style=" color: #333; font-family:Arial, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 12.5pt;" target="_blank">[Quova 2016] </a><a href="http://www.quova.com/" class="a" target="_blank">www.quova.com</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Ramakrishnan 1990] </b>K. K. Ramakrishnan, R. Jain, “A Binary Feedback Scheme for Congestion Avoidance in Computer Networks,” <i>ACM Transactions on Computer Systems, </i>Vol. 8, No. 2 (May 1990), pp. 158–181.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Raman 1999] </b>S. Raman, S. McCanne, “A Model, Analysis, and Protocol Framework for Soft State-based Communication,” <i>Proc. 1999 ACM SIGCOMM </i>(Boston, MA, Aug.</p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">1999).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -21pt;line-height: 130%;text-align: left;"><b>[Raman 2007] </b>B. Raman, K. Chebrolu, “Experiences in Using WiFi for Rural Internet in India,” <i>IEEE Communications Magazine, </i>Special Issue on New Directions in Networking Technologies in Emerging Economies (Jan. 2007).</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Ramaswami 2010] </b>R. Ramaswami, K. Sivarajan, G. Sasaki, <i>Optical Networks: A Practical Perspective</i>, Morgan Kaufman Publishers, 2010.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;">[Ramjee 1994] <span class="p">R. Ramjee, J. Kurose, D. Towsley, H. Schulzrinne, “Adaptive Playout Mechanisms for Packetized Audio Applications in Wide-Area Networks,” </span><i>Proc. 1994 IEEE INFOCOM.</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Rao 2011] </b>A. S. Rao, Y. S. Lim, C. Barakat, A. Legout, D. Towsley, W. Dabbous, “Network Characteristics of Video Streaming Traffic,” <i>Proc. 2011 ACM CoNEXT </i>(Tokyo).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Ren 2006] </b>S. Ren, L. Guo, X. Zhang, “ASAP: An AS-Aware Peer-Relay Protocol for High Quality VoIP,” <i>Proc. 2006 IEEE ICDCS </i>(Lisboa, Portugal, July 2006).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Rescorla 2001] </b>E. Rescorla, <i>SSL and TLS: Designing and Building Secure Systems, </i>Addison-Wesley, Boston, 2001.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[RFC 001] </b>S. Crocker, “Host Software,” RFC 001 (the <i>very first </i>RFC!).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 768] <span class="p">J. Postel, “User Datagram Protocol,” RFC 768, Aug. 1980.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 791] <span class="p">J. Postel, “Internet Protocol: DARPA Internet Program Protocol Specification,” RFC 791, Sept. 1981.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 792] <span class="p">J. Postel, “Internet Control Message Protocol,” RFC 792, Sept. 1981.</span></p><p class="s28" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 793] <span class="p">J. Postel, “Transmission Control Protocol,” RFC 793, Sept. 1981.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 801] <span class="p">J. Postel, “NCP/TCP Transition Plan,” RFC 801, Nov. 1981.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 25pt;text-indent: -20pt;line-height: 130%;text-align: left;">[RFC 826] <span class="p">D. C. Plummer, “An Ethernet Address Resolution Protocol—or— Converting Network Protocol Addresses to 48-bit Ethernet Address for Transmission on Ethernet Hardware,” RFC 826, Nov. 1982.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 829] <span class="p">V. Cerf, “Packet Satellite Technology Reference Sources,” RFC 829, Nov. 1982.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 854] <span class="p">J. Postel, J. Reynolds, “TELNET Protocol Specification,” RFC 854, May 1993.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 950] <span class="p">J. Mogul, J. Postel, “Internet Standard Subnetting Procedure,” RFC 950, Aug. 1985.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 959] <span class="p">J. Postel and J. Reynolds, “File Transfer Protocol (FTP),” RFC 959, Oct. 1985.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1034] <span class="p">P. V. Mockapetris, “Domain Names—Concepts and Facilities,” RFC 1034, Nov. 1987.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1035] <span class="p">P. Mockapetris, “Domain Names—Implementation and Specification,” RFC 1035, Nov. 1987.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1058] <span class="p">C. L. Hendrick, “Routing Information Protocol,” RFC 1058, June 1988.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1071] <span class="p">R. Braden, D. Borman, and C. Partridge, “Computing the Internet Checksum,” RFC 1071, Sept. 1988.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1122] <span class="p">R. Braden, “Requirements for Internet Hosts—Communication Layers,” RFC 1122, Oct. 1989.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1123] <span class="p">R. Braden, ed., “Requirements for Internet Hosts—Application and Support,” RFC-1123, Oct. 1989.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1142] <span class="p">D. Oran, “OSI IS-IS Intra-Domain Routing Protocol,” RFC 1142, Feb. 1990.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1190] <span class="p">C. Topolcic, “Experimental Internet Stream Protocol: Version 2 (ST-II),” RFC 1190, Oct. 1990.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1256] <span class="p">S. Deering, “ICMP Router Discovery Messages,” RFC 1256, Sept. 1991.</span></p><p class="s28" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1320] <span class="p">R. Rivest, “The MD4 Message-Digest Algorithm,” RFC 1320, Apr. 1992.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1321] <span class="p">R. Rivest, “The MD5 Message-Digest Algorithm,” RFC 1321, Apr. 1992.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1323] <span class="p">V. Jacobson, S. Braden, D. Borman, “TCP Extensions for High Performance,” RFC 1323, May 1992.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1422] <span class="p">S. Kent, “Privacy Enhancement for Internet Electronic Mail: Part II: Certificate-Based Key Management,” RFC 1422.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1546] <span class="p">C. Partridge, T. Mendez, W. Milliken, “Host Anycasting Service,” RFC 1546, 1993.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1584] <span class="p">J. Moy, “Multicast Extensions to OSPF,” RFC 1584, Mar. 1994.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1633] <span class="p">R. Braden, D. Clark, S. Shenker, “Integrated Services in the Internet Architecture: an Overview,” RFC 1633, June 1994.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1636] <span class="p">R. Braden, D. Clark, S. Crocker, C. Huitema, “Report of IAB Workshop on Security in the Internet Architecture,” RFC 1636, Nov. 1994.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1700] <span class="p">J. Reynolds, J. Postel, “Assigned Numbers,” RFC 1700, Oct. 1994.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1752] <span class="p">S. Bradner, A. Mankin, “The Recommendations for the IP Next Generation Protocol,” RFC 1752, Jan. 1995.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1918] <span class="p">Y. Rekhter, B. Moskowitz, D. Karrenberg, G. J. de Groot, E. Lear, “Address Allocation for Private Internets,” RFC 1918, Feb. 1996.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1930] <span class="p">J. Hawkinson, T. Bates, “Guidelines for Creation, Selection, and Registration of an Autonomous System (AS),” RFC 1930, Mar. 1996.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1939] <span class="p">J. Myers, M. Rose, “Post Office Protocol—Version 3,” RFC 1939, May 1996.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 1945] <span class="p">T. Berners-Lee, R. Fielding, H. Frystyk, “Hypertext Transfer Protocol—HTTP/1.0,” RFC 1945, May 1996.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2003] <span class="p">C. Perkins, “IP Encapsulation Within IP,” RFC 2003, Oct. 1996.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2004] <span class="p">C. Perkins, “Minimal Encapsulation Within IP,” RFC 2004, Oct. 1996.</span></p><p class="s28" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2018] <span class="p">M. Mathis, J. Mahdavi, S. Floyd, A. Romanow, “TCP Selective Acknowledgment Options,” RFC 2018, Oct. 1996.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2131] <span class="p">R. Droms, “Dynamic Host Configuration Protocol,” RFC 2131, Mar. 1997.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2136] <span class="p">P. Vixie, S. Thomson, Y. Rekhter, J. Bound, “Dynamic Updates in the Domain Name System,” RFC 2136, Apr. 1997.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2205] <span class="p">R. Braden, Ed., L. Zhang, S. Berson, S. Herzog, S. Jamin, “Resource ReSerVation Protocol (RSVP)—Version 1 Functional Specification,” RFC 2205, Sept.</span></p><p style="padding-top: 4pt;padding-left: 25pt;text-indent: 0pt;text-align: left;">1997.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2210] <span class="p">J. Wroclawski, “The Use of RSVP with IETF Integrated Services,” RFC 2210, Sept. 1997.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2211] <span class="p">J. Wroclawski, “Specification of the Controlled-Load Network Element Service,” RFC 2211, Sept. 1997.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2215] <span class="p">S. Shenker, J. Wroclawski, “General Characterization Parameters for Integrated Service Network Elements,” RFC 2215, Sept. 1997.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2326] <span class="p">H. Schulzrinne, A. Rao, R. Lanphier, “Real Time Streaming Protocol (RTSP),” RFC 2326, Apr. 1998.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2328] <span class="p">J. Moy, “OSPF Version 2,” RFC 2328, Apr. 1998.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2420] <span class="p">H. Kummert, “The PPP Triple-DES Encryption Protocol (3DESE),” RFC 2420, Sept. 1998.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2453] <span class="p">G. Malkin, “RIP Version 2,” RFC 2453, Nov. 1998.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2460] <span class="p">S. Deering, R. Hinden, “Internet Protocol, Version 6 (IPv6) Specification,” RFC 2460, Dec. 1998.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2475] <span class="p">S. Blake, D. Black, M. Carlson, E. Davies, Z. Wang, W. Weiss, “An Architecture for Differentiated Services,” RFC 2475, Dec. 1998.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2578] <span class="p">K. McCloghrie, D. Perkins, J. Schoenwaelder, “Structure of Management Information Version 2 (SMIv2),” RFC 2578, Apr. 1999.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2579] <span class="p">K. McCloghrie, D. Perkins, J. Schoenwaelder, “Textual Conventions for SMIv2,” RFC 2579, Apr. 1999.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2580] <span class="p">K. McCloghrie, D. Perkins, J. Schoenwaelder, “Conformance Statements for SMIv2,” RFC 2580, Apr. 1999.</span></p><p class="s28" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2597] <span class="p">J. Heinanen, F. Baker, W. Weiss, J. Wroclawski, “Assured Forwarding PHB Group,” RFC 2597, June 1999.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2616] <span class="p">R. Fielding, J. Gettys, J. Mogul, H. Frystyk, L. Masinter, P. Leach, T. Berners-Lee, R. Fielding, “Hypertext Transfer Protocol—HTTP/1.1,” RFC 2616, June 1999.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2663] <span class="p">P. Srisuresh, M. Holdrege, “IP Network Address Translator (NAT) Terminology and Considerations,” RFC 2663.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2702] <span class="p">D. Awduche, J. Malcolm, J. Agogbua, M. O’Dell, J. McManus, “Requirements for Traffic Engineering Over MPLS,” RFC 2702, Sept. 1999.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2827] <span class="p">P. Ferguson, D. Senie, “Network Ingress Filtering: Defeating Denial of Service Attacks which Employ IP Source Address Spoofing,” RFC 2827, May 2000.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 2865] <span class="p">C. Rigney, S. Willens, A. Rubens, W. Simpson, “Remote Authentication Dial In User Service (RADIUS),” RFC 2865, June 2000.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3007] <span class="p">B. Wellington, “Secure Domain Name System (DNS) Dynamic Update,” RFC 3007, Nov. 2000.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3022] <span class="p">P. Srisuresh, K. Egevang, “Traditional IP Network Address Translator (Traditional NAT),” RFC 3022, Jan. 2001.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3022] <span class="p">P. Srisuresh, K. Egevang, “Traditional IP Network Address Translator (Traditional NAT),” RFC 3022, Jan. 2001.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3031] <span class="p">E. Rosen, A. Viswanathan, R. Callon, “Multiprotocol Label Switching Architecture,” RFC 3031, Jan. 2001.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3032] <span class="p">E. Rosen, D. Tappan, G. Fedorkow, Y. Rekhter, D. Farinacci, T. Li, A. Conta, “MPLS Label Stack Encoding,” RFC 3032, Jan. 2001.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3168] <span class="p">K. Ramakrishnan, S. Floyd, D. Black, “The Addition of Explicit Congestion Notification (ECN) to IP,” RFC 3168, Sept. 2001.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3209] <span class="p">D. Awduche, L. Berger, D. Gan, T. Li, V. Srinivasan, G. Swallow, “RSVP-TE: Extensions to RSVP for LSP Tunnels,” RFC 3209, Dec. 2001.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3221] <span class="p">G. Huston, “Commentary on Inter-Domain Routing in the Internet,” RFC 3221, Dec. 2001.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3232] <span class="p">J. Reynolds, “Assigned Numbers: RFC 1700 Is Replaced by an On-line Database,” RFC 3232, Jan. 2002.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3234] <span class="p">B. Carpenter, S. Brim, “Middleboxes: Taxonomy and Issues,” RFC 3234, Feb. 2002.</span></p><p class="s28" style="padding-top: 3pt;padding-left: 25pt;text-indent: -20pt;line-height: 130%;text-align: left;">[RFC 3246] <span class="p">B. Davie, A. Charny, J.C.R. Bennet, K. Benson, J.Y. Le Boudec, W. Courtney, S. Davari, V. Firoiu, D. Stiliadis, “An Expedited Forwarding PHB (Per-Hop Behavior),” RFC 3246, Mar. 2002.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3260] <span class="p">D. Grossman, “New Terminology and Clarifications for Diffserv,” RFC 3260, Apr. 2002.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 25pt;text-indent: -20pt;line-height: 130%;text-align: left;">[RFC 3261] <span class="p">J. Rosenberg, H. Schulzrinne, G. Carmarillo, A. Johnston, J. Peterson, R. Sparks, M. Handley, E. Schooler, “SIP: Session Initiation Protocol,” RFC 3261, July 2002.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3272] <span class="p">J. Boyle, V. Gill, A. Hannan, D. Cooper, D. Awduche, B. Christian, W. S. Lai, “Overview and Principles of Internet Traffic Engineering,” RFC 3272, May 2002.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3286] <span class="p">L. Ong, J. Yoakum, “An Introduction to the Stream Control Transmission Protocol (SCTP),” RFC 3286, May 2002.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3346] <span class="p">J. Boyle, V. Gill, A. Hannan, D. Cooper, D. Awduche, B. Christian, W. S. Lai, “Applicability Statement for Traffic Engineering with MPLS,” RFC 3346, Aug. 2002.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3390] <span class="p">M. Allman, S. Floyd, C. Partridge, “Increasing TCP’s Initial Window,” RFC 3390, Oct. 2002.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3410] <span class="p">J. Case, R. Mundy, D. Partain, “Introduction and Applicability Statements for Internet Standard Management Framework,” RFC 3410, Dec. 2002.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3414] <span class="p">U. Blumenthal and B. Wijnen, “User-based Security Model (USM) for Version 3 of the Simple Network Management Protocol (SNMPv3),” RFC 3414, Dec. 2002.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 25pt;text-indent: -20pt;line-height: 130%;text-align: left;">[RFC 3416] <span class="p">R. Presuhn, J. Case, K. McCloghrie, M. Rose, S. Waldbusser, “Version 2 of the Protocol Operations for the Simple Network Management Protocol (SNMP),” Dec. 2002.</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3439] <span class="p">R. Bush, D. Meyer, “Some Internet Architectural Guidelines and Philosophy,” RFC 3439, Dec. 2003.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3447] <span class="p">J. Jonsson, B. Kaliski, “Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,” RFC 3447, Feb. 2003.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3468] <span class="p">L. Andersson, G. Swallow, “The Multiprotocol Label Switching (MPLS) Working Group Decision on MPLS Signaling Protocols,” RFC 3468, Feb. 2003.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 25pt;text-indent: -20pt;line-height: 130%;text-align: left;">[RFC 3469] <span class="p">V. Sharma, Ed., F. Hellstrand, Ed, “Framework for Multi-Protocol Label Switching (MPLS)-based Recovery,” RFC 3469, Feb. 2003. ftp://ftp.rfc-editor.org/in- notes/rfc3469.txt</span></p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3501] <span class="p">M. Crispin, “Internet Message Access Protocol—Version 4rev1,” RFC 3501, Mar. 2003.</span></p><p class="s28" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3550] <span class="p">H. Schulzrinne, S. Casner, R. Frederick, V. Jacobson, “RTP: A Transport Protocol for Real-Time Applications,” RFC 3550, July 2003.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3588] <span class="p">P. Calhoun, J. Loughney, E. Guttman, G. Zorn, J. Arkko, “Diameter Base Protocol,” RFC 3588, Sept. 2003.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3649] <span class="p">S. Floyd, “HighSpeed TCP for Large Congestion Windows,” RFC 3649, Dec. 2003.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3746] <span class="p">L. Yang, R. Dantu, T. Anderson, R. Gopal, “Forwarding and Control Element Separation (ForCES) Framework,” Internet, RFC 3746, Apr. 2004.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3748] <span class="p">B. Aboba, L. Blunk, J. Vollbrecht, J. Carlson, H. Levkowetz, Ed., “Extensible Authentication Protocol (EAP),” RFC 3748, June 2004.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 3782] <span class="p">S. Floyd, T. Henderson, A. Gurtov, “The NewReno Modification to TCP’s Fast Recovery Algorithm,” RFC 3782, Apr. 2004.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 4213] <span class="p">E. Nordmark, R. Gilligan, “Basic Transition Mechanisms for IPv6 Hosts and Routers,” RFC 4213, Oct. 2005.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 4271] <span class="p">Y. Rekhter, T. Li, S. Hares, Ed., “A Border Gateway Protocol 4 (BGP-4),” RFC 4271, Jan. 2006.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 4272] <span class="p">S. Murphy, “BGP Security Vulnerabilities Analysis,” RFC 4274, Jan. 2006.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 4291] <span class="p">R. Hinden, S. Deering, “IP Version 6 Addressing Architecture,” RFC 4291, Feb. 2006.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 4340] <span class="p">E. Kohler, M. Handley, S. Floyd, “Datagram Congestion Control Protocol (DCCP),” RFC 4340, Mar. 2006.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 4443] <span class="p">A. Conta, S. Deering, M. Gupta, Ed., “Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification,” RFC 4443, Mar.</span></p><p style="padding-top: 4pt;padding-left: 25pt;text-indent: 0pt;text-align: left;">2006.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 4346] <span class="p">T. Dierks, E. Rescorla, “The Transport Layer Security (TLS) Protocol Version 1.1,” RFC 4346, Apr. 2006.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 4514] <span class="p">K. Zeilenga, Ed., “Lightweight Directory Access Protocol (LDAP): String Representation of Distinguished Names,” RFC 4514, June 2006.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 4601] <span class="p">B. Fenner, M. Handley, H. Holbrook, I. Kouvelas, “Protocol Independent Multicast—Sparse Mode (PIM-SM): Protocol Specification (Revised),” RFC 4601, Aug.</span></p><p style="padding-top: 4pt;padding-left: 25pt;text-indent: 0pt;text-align: left;">2006.</p><p class="s28" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 4632] <span class="p">V. Fuller, T. Li, “Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan,” RFC 4632, Aug. 2006.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 4960] <span class="p">R. Stewart, ed., “Stream Control Transmission Protocol,” RFC 4960, Sept. 2007.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 4987] <span class="p">W. Eddy, “TCP SYN Flooding Attacks and Common Mitigations,” RFC 4987, Aug. 2007.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 5000] <span class="p">RFC editor, “Internet Official Protocol Standards,” RFC 5000, May 2008.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 5109] <span class="p">A. Li (ed.), “RTP Payload Format for Generic Forward Error Correction,” RFC 5109, Dec. 2007.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 5216] <span class="p">D. Simon, B. Aboba, R. Hurst, “The EAP-TLS Authentication Protocol,” RFC 5216, Mar. 2008.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 5218] <span class="p">D. Thaler, B. Aboba, “What Makes for a Successful Protocol?,” RFC 5218, July 2008.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 5321] <span class="p">J. Klensin, “Simple Mail Transfer Protocol,” RFC 5321, Oct. 2008.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 5322] <span class="p">P. Resnick, Ed., “Internet Message Format,” RFC 5322, Oct. 2008.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 5348] <span class="p">S. Floyd, M. Handley, J. Padhye, J. Widmer, “TCP Friendly Rate Control (TFRC): Protocol Specification,” RFC 5348, Sept. 2008.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 5389] <span class="p">J. Rosenberg, R. Mahy, P. Matthews, D. Wing, “Session Traversal Utilities for NAT (STUN),” RFC 5389, Oct. 2008.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 5411] <span class="p">J Rosenberg, “A Hitchhiker’s Guide to the Session Initiation Protocol (SIP),” RFC 5411, Feb. 2009.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 5681] <span class="p">M. Allman, V. Paxson, E. Blanton, “TCP Congestion Control,” RFC 5681, Sept. 2009.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 5944] <span class="p">C. Perkins, Ed., “IP Mobility Support for IPv4, Revised,” RFC 5944, Nov. 2010.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 6265] <span class="p">A Barth, “HTTP State Management Mechanism,” RFC 6265, Apr. 2011.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 6298] <span class="p">V. Paxson, M. Allman, J. Chu, M. Sargent, “Computing TCP’s Retransmission Timer,” RFC 6298, June 2011.</span></p><p class="s28" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 7020] <span class="p">R. Housley, J. Curran, G. Huston, D. Conrad, “The Internet Numbers Registry System,” RFC 7020, Aug. 2013.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 7094] <span class="p">D. McPherson, D. Oran, D. Thaler, E. Osterweil, “Architectural Considerations of IP Anycast,” RFC 7094, Jan. 2014.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 7323] <span class="p">D. Borman, R. Braden, V. Jacobson, R. Scheffenegger (ed.), “TCP Extensions for High Performance,” RFC 7323, Sept. 2014.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RFC 7540] <span class="p">M. Belshe, R. Peon, M. Thomson (Eds), “Hypertext Transfer Protocol Version 2 (HTTP/2),” RFC 7540, May 2015.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Richter 2015] </b>P. Richter, M. Allman, R. Bush, V. Paxson, “A Primer on IPv4 Scarcity,” <i>ACM SIGCOMM Computer Communication Review, </i>Vol. 45, No. 2 (Apr. 2015), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark39" class="a">2</a>1<a href="#bookmark57" class="s124">–</a><a href="#bookmark57" class="a">3</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Roberts 1967] </b>L. Roberts, T. Merril, “Toward a Cooperative Network of Time-Shared Computers,” <i>AFIPS Fall Conference </i>(Oct. 1966).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Rodriguez 2010] </span><span class="p">R. Rodrigues, P. Druschel, “Peer-to-Peer Systems,” </span><span class="s17">Communications of the ACM, </span><a href="#bookmark122" class="s124">Vol. 53, No. 10 (Oct. 2010), pp. </a><a href="#bookmark122" class="a">7</a>2<a href="#bookmark135" class="s124">–</a><a href="#bookmark135" class="a">8</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Rohde 2008] <span class="p">Rohde, Schwarz, “UMTS Long Term Evolution (LTE) Technology Introduction,” Application Note 1MA111.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Rom 1990] </b>R. Rom, M. Sidi, <i>Multiple Access Protocols: Performance and Analysis, </i>Springer-Verlag, New York, 1990.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Root Servers 2016] <a href="http://www.root-servers.org/" class="s124" target="_blank">Root Servers home page, </a><a href="http://www.root-servers.org/" class="a" target="_blank">http://www.root-servers.org/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[RSA 1978] </b>R. Rivest, A. Shamir, L. Adelman, “A Method for Obtaining Digital Signatures and Public-key Cryptosystems,” <i>Communications of the ACM, </i>Vol. 21, No. 2 (Feb.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark184" class="s124">1978), pp. </a><a href="#bookmark184" class="a">12</a>0<a href="#bookmark194" class="s124">–</a><a href="#bookmark194" class="a">12</a>6<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RSA Fast 2012] <a href="http://www.rsa.com/rsalabs/node.asp?id=2215" class="s124" target="_blank">RSA Laboratories, “How Fast Is RSA?” </a><a href="http://www.rsa.com/rsalabs/node.asp?id=2215" class="a" target="_blank">http://www.rsa.com/rsalabs/node.asp?id=2215</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[RSA Key 2012] <a href="http://www.rsa.com/rsalabs/node.asp?id=2218" class="s124" target="_blank">RSA Laboratories, “How Large a Key Should Be Used in the RSA Crypto System?” </a><a href="http://www.rsa.com/rsalabs/node.asp?id=2218" class="a" target="_blank">http://www.rsa.com/rsalabs/node.asp?id=2218</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Rubenstein 1998] <span class="p">D. Rubenstein, J. Kurose, D. Towsley, “Real-Time Reliable Multicast Using Proactive Forward Error Correction,” </span><i>Proceedings of NOSSDAV ‘98</i></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">(Cambridge, UK, July 1998).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Ruiz-Sanchez 2001</span><span class="p">] M. Ruiz-Sánchez, E. Biersack, W. Dabbous, “Survey and Taxonomy of IP Address Lookup Algorithms,” </span><span class="s17">IEEE Network Magazine, </span><a href="#bookmark14" class="s124">Vol. 15, No. 2 (Mar./Apr. 2001), pp. </a>8<a href="#bookmark43" class="s124">–</a><a href="#bookmark43" class="a">2</a>3<span class="p">.</span></p><p style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Saltzer 1984] </b>J. Saltzer, D. Reed, D. Clark, “End-to-End Arguments in System Design,” <i>ACM Transactions on Computer Systems (TOCS), </i>Vol. 2, No. 4 (Nov. 1984).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Sandvine 2015] <a href="http://www.sandvine.com/news/globalbroadbandtrends.asp" class="s124" target="_blank">“Global Internet Phenomena Report, Spring 2011,” </a><a href="http://www.sandvine.com/news/globalbroadbandtrends.asp" class="s123" target="_blank">http://www.sandvine.com/news/globalbroadbandtrends.asp</a><a href="http://www.sandvine.com/news/globalbroadbandtrends.asp" class="s124" target="_blank">,</a><span class="p"> 2011.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Sardar 2006] </b>B. Sardar, D. Saha, “A Survey of TCP Enhancements for Last-Hop Wireless Networks,” <i>IEEE Commun. Surveys and Tutorials, </i>Vol. 8, No. 3 (2006), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark36" class="a">2</a>0<a href="#bookmark58" class="s124">–</a><a href="#bookmark58" class="a">3</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Saroiu 2002] </b>S. Saroiu, P. K. Gummadi, S. D. Gribble, “A Measurement Study of Peer-to-Peer File Sharing Systems,” <i>Proc. of Multimedia Computing and Networking (MMCN) </i>(2002).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Sauter 2014] </b>M. Sauter, <i>From GSM to LTE-Advanced</i>, John Wiley and Sons, 2014.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Savage 2015] <span class="p">D. Savage, J. Ng, S. Moore, D. Slice, P. Paluch, R. White, “Enhanced Interior Gateway Routing Protocol,” Internet Draft, draft-savage-eigrp-04.txt, Aug.</span></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">2015.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Saydam 1996] </span><span class="p">T. Saydam, T. Magedanz, “From Networks and Network Management into Service and Service Management,” </span><span class="s17">Journal of Networks and System Management, </span><a href="#bookmark415" class="s124">Vol. 4, No. 4 (Dec. 1996), pp. </a><a href="#bookmark415" class="a">34</a>5<a href="#bookmark418" class="s124">–</a><a href="#bookmark418" class="a">34</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Schiller 2003] </b>J. Schiller, <i>Mobile Communications </i>2nd edition, Addison Wesley, 2003.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Schneier 1995] </b>B. Schneier, <i>Applied Cryptography: Protocols, Algorithms, and Source Code in C, </i>John Wiley and Sons, 1995.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Schulzrinne-RTP 2012] <a href="http://www.cs.columbia.edu/%7Ehgs/rtp" class="s124" target="_blank">Henning Schulzrinne’s RTP site, </a><a href="http://www.cs.columbia.edu/%7Ehgs/rtp" class="a" target="_blank">http://www.cs.columbia .edu/~hgs/rtp</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Schulzrinne-SIP 2016] <a href="http://www.cs.columbia.edu/%7Ehgs/sip" class="s124" target="_blank">Henning Schulzrinne’s SIP site, </a><a href="http://www.cs.columbia.edu/%7Ehgs/sip" class="a" target="_blank">http://www.cs.columbia.edu/~hgs/sip</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Schwartz 1977] </b>M. Schwartz, <i>Computer-Communication Network Design and Analysis</i>, Prentice-Hall, Englewood Cliffs, NJ, 1997.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Schwartz 1980] </b>M. Schwartz, <i>Information, Transmission, Modulation, and Noise, </i>McGraw Hill, New York, NY 1980.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Schwartz 1982] </b>M. Schwartz, “Performance Analysis of the SNA Virtual Route Pacing Control,” <i>IEEE Transactions on Communications, </i>Vol. 30, No. 1 (Jan. 1982), pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark244" class="a">17</a>2<a href="#bookmark249" class="s124">–</a><a href="#bookmark249" class="a">18</a>4<span class="p">.</span></p><p class="s28" style="padding-top: 4pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[Scourias 2012] <a href="http://www.privateline.com/PCS/GSM0.html" class="s124" target="_blank">J. Scourias, “Overview of the Global System for Mobile Communications: GSM.” </a><a href="http://www.privateline.com/PCS/GSM0.html" class="s123" target="_blank">http://www.privateline.com/PCS/GSM0.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[SDNHub 2016] <a href="http://sdnhub.org/tutorials/" class="s124" target="_blank">SDNHub, “App Development Tutorials,” </a><a href="http://sdnhub.org/tutorials/" class="a" target="_blank">http://sdnhub.org/ tutorials/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Segaller 1998] </b>S. Segaller, <i>Nerds 2.0.1, A Brief History of the Internet, </i>TV Books, New York, 1998.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Sekar 2011</b>] V. Sekar, S. Ratnasamy, M. Reiter, N. Egi, G. Shi, “ The Middlebox Manifesto: Enabling Innovation in Middlebox Deployment,” <i>Proc. 10th ACM Workshop on Hot Topics in Networks (HotNets), </i>Article 21, 6 pages.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Serpanos 2011] </b>D. Serpanos, T. Wolf, <i>Architecture of Network Systems</i>, Morgan Kaufmann Publishers, 2011.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Shacham 1990] </span><span class="p">N. Shacham, P. McKenney, “Packet Recovery in High-Speed Networks Using Coding and Buffer Management,” </span><span class="s17">Proc. 1990 IEEE INFOCOM </span><a href="#bookmark191" class="s124">(San Francisco, CA, Apr. 1990), pp. </a><a href="#bookmark191" class="a">12</a>4<a href="#bookmark198" class="s124">–</a><a href="#bookmark198" class="a">13</a>1<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Shaikh 2001] </b>A. Shaikh, R. Tewari, M. Agrawal, “On the Effectiveness of DNS-based Server Selection,” <i>Proc. 2001 IEEE INFOCOM</i>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Singh 1999] </b>S. Singh, <i>The Code Book: The Evolution of Secrecy from Mary, Queen of Scotsto Quantum Cryptography, </i>Doubleday Press, 1999.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 138%;text-align: justify;">[Singh 2015] <span class="p">A. Singh, J. Ong,. Agarwal, G. Anderson, A. Armistead, R. Banno, S. Boving, G. Desai, B. Felderman, P. Germano, A. Kanagala, J. Provost, J. Simmons, E. Tanda, J. Wanderer, U. Hölzle, S. Stuart, A. Vahdat, “Jupiter Rising: A Decade of Clos Topologies and Centralized Control in Google’s Datacenter Network,” Sigcomm, 2015.</span></p><p style="text-indent: 0pt;line-height: 5pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[SIP Software 2016] <a href="http://www.cs.columbia.edu/IRT/software" class="s124" target="_blank">H. Schulzrinne Software Package site, </a><a href="http://www.cs.columbia.edu/IRT/software" class="a" target="_blank">http://www.cs.columbia.edu/IRT/software</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Skoudis 2004] </b>E. Skoudis, L. Zeltser, <i>Malware: Fighting Malicious Code</i>, Prentice Hall, 2004.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Skoudis 2006] </b>E. Skoudis, T. Liston, <i>Counter Hack Reloaded: A Step-by-Step Guide to Computer Attacks and Effective Defenses (2nd Edition)</i>, Prentice Hall, 2006.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Smith 2009] </span><span class="p">J. Smith, “Fighting Physics: A Tough Battle,” </span><span class="s17">Communications of the ACM, </span><a href="#bookmark103" class="s124">Vol. 52, No. 7 (July 2009), pp. </a><a href="#bookmark103" class="a">6</a>0<a href="#bookmark114" class="s124">–</a><a href="#bookmark114" class="a">6</a>5<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Snort 2012] <a href="http://www.snort.org/" class="s124" target="_blank">Sourcefire Inc., Snort homepage, </a><a href="http://www.snort.org/" class="s123" target="_blank">http://http://www.snort.org/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Solensky 1996] </b>F. Solensky, “IPv4 Address Lifetime Expectations,” in <i>IPng: Internet Protocol Next Generation </i>(S. Bradner, A. Mankin, ed.), Addison-Wesley, Reading, MA,</p><p style="padding-top: 3pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">1996.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Spragins 1991] </b>J. D. Spragins, <i>Telecommunications Protocols and Design, </i>Addison-Wesley, Reading, MA, 1991.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Srikant 2004] </b>R. Srikant, <i>The Mathematics of Internet Congestion Control, </i>Birkhauser, 2004</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;">[Steinder 2002] <span class="p">M. Steinder, A. Sethi, “Increasing Robustness of Fault Localization Through Analysis of Lost, Spurious, and Positive Symptoms,” </span><i>Proc. 2002 IEEE INFOCOM.</i></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Stevens 1990] </b>W. R. Stevens, <i>Unix Network Programming, </i>Prentice-Hall, Englewood Cliffs, NJ.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Stevens 1994] </b>W. R. Stevens, <i>TCP/IP Illustrated, Vol. 1: The Protocols, </i>Addison-Wesley, Reading, MA, 1994.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Stevens 1997] </b>W.R. Stevens, <i>Unix Network Programming, Volume 1: Networking APIs-Sockets and XTI, </i>2nd edition, Prentice-Hall, Englewood Cliffs, NJ, 1997.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Stewart 1999] </b>J. Stewart, <i>BGP4: Interdomain Routing in the Internet, </i>Addison-Wesley, 1999.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Stone 1998] </span><span class="p">J. Stone, M. Greenwald, C. Partridge, J. Hughes, “Performance of Checksums and CRC’s Over Real Data,” </span><span class="s17">IEEE/ACM Transactions on Networking, </span><a href="#bookmark599" class="s124">Vol. 6, No. 5 (Oct. 1998), pp. </a><a href="#bookmark599" class="a">52</a>9<a href="#bookmark616" class="s124">–</a><a href="#bookmark616" class="a">54</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Stone 2000] </b>J. Stone, C. Partridge, “When Reality and the Checksum Disagree,” <i>Proc. 2000 ACM SIGCOMM </i>(Stockholm, Sweden, Aug. 2000).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Strayer 1992] </b>W. T. Strayer, B. Dempsey, A. Weaver, <i>XTP: The Xpress Transfer Protocol, </i>Addison-Wesley, Reading, MA, 1992.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Stubblefield 2002] </span><span class="p">A. Stubblefield, J. Ioannidis, A. Rubin, “Using the Fluhrer, Mantin, and Shamir Attack to Break WEP,” </span><span class="s17">Proceedings of 2002 Network and Distributed Systems Security Symposium </span><a href="#bookmark31" class="s124">(2002), pp. </a><a href="#bookmark31" class="a">1</a>7<a href="#bookmark41" class="s124">–</a><a href="#bookmark41" class="a">2</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Subramanian 2000] </b>M. Subramanian, <i>Network Management: Principles and Practice, </i>Addison-Wesley, Reading, MA, 2000.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Subramanian 2002] </b>L. Subramanian, S. Agarwal, J. Rexford, R. Katz, “Characterizing the Internet Hierarchy from Multiple Vantage Points,” <i>Proc. 2002 IEEE INFOCOM</i>.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Sundaresan 2006] <span class="p">K.Sundaresan, K. Papagiannaki, “The Need for Cross-layer Information in Access Point Selection,” </span><i>Proc. 2006 ACM Internet Measurement Conference</i></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">(Rio De Janeiro, Oct. 2006).</p><p class="s28" style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">[Suh 2006] <span class="p">K. Suh, D. R. Figueiredo, J. Kurose and D. Towsley, “Characterizing and Detecting Relayed Traffic: A Case Study Using Skype,” </span><i>Proc. 2006 IEEE INFOCOM</i></p><p style="padding-top: 4pt;padding-left: 26pt;text-indent: 0pt;text-align: left;">(Barcelona, Spain, Apr. 2006).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Sunshine 1978] </b>C. Sunshine, Y. Dalal, “Connection Management in Transport Protocols,” <i>Computer Networks, </i>North-Holland, Amsterdam, 1978.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Tariq 2008] </b>M. Tariq, A. Zeitoun, V. Valancius, N. Feamster, M. Ammar, “Answering What-If Deployment and Configuration Questions with WISE,” <i>Proc. 2008 ACM SIGCOMM </i>(Aug. 2008).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[TechnOnLine 2012] <a href="http://www.techonline.com/community/tech_topic/internet/21752" class="s124" target="_blank">TechOnLine, “Protected Wireless Networks,” online webcast tutorial, </a><a href="http://www.techonline.com/community/tech_topic/internet/21752" class="s123" target="_blank">http://www.techonline.com/community/tech_topic/internet/21752</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Teixeira 2006] </b>R. Teixeira, J. Rexford, “Managing Routing Disruptions in Internet Service Provider Networks,” <i>IEEE Communications Magazine </i>(Mar. 2006).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Think 2012] <a href="http://www.cs.utexas.edu/users/chris/think/Cyclades/index.shtml" class="s124" target="_blank">Technical History of Network Protocols, “Cyclades,” </a><a href="http://www.cs.utexas.edu/users/chris/think/Cyclades/index.shtml" class="s123" target="_blank">http://www.cs.utexas.edu/users/chris/think/Cyclades/index.shtml</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Tian 2012] </b>Y. Tian, R. Dey, Y. Liu, K. W. Ross, “China’s Internet: Topology Mapping and Geolocating,” <i>IEEE INFOCOM Mini-Conference 2012 </i>(Orlando, FL, 2012).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[TLD list 2016] <a href="https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains" class="s124" target="_blank">TLD list maintained by Wikipedia, </a><a href="https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains" class="a" target="_blank">https://en.wikipedia.org/wiki/List_of_Internet_top-level_domains</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Tobagi 1990] </span><span class="p">F. Tobagi, “Fast Packet Switch Architectures for Broadband Integrated Networks,” </span><span class="s17">Proc. 1990 IEEE INFOCOM, </span><a href="#bookmark200" class="s124">Vol. 78, No. 1 (Jan. 1990), pp. </a><a href="#bookmark200" class="a">13</a>3<a href="#bookmark237" class="s124">–</a><a href="#bookmark237" class="a">16</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[TOR 2016] <a href="http://www.torproject.org/" class="s124" target="_blank">Tor: Anonymity Online, </a><a href="http://www.torproject.org/" class="s123" target="_blank">http://www.torproject.org</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Torres 2011] </b>R. Torres, A. Finamore, J. R. Kim, M. M. Munafo, S. Rao, “Dissecting Video Server Selection Strategies in the YouTube CDN,” <i>Proc. 2011 Int. Conf. on Distributed Computing Systems</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Tourrilhes 2014] </b>J. Tourrilhes, P. Sharma, S. Banerjee, J. Petit, “SDN and Openflow Evolution: A Standards Perspective,” <i>IEEE Computer Magazine, </i>Nov. 2014, pp.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: 0pt;text-align: left;"><a href="#bookmark41" class="a">2</a>2<a href="#bookmark54" class="s124">–</a><a href="#bookmark54" class="a">2</a>9<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Turner 1988] </span><span class="p">J. S. Turner, “Design of a Broadcast packet switching network,” </span><span class="s17">IEEE Transactions on Communications, </span><a href="#bookmark833" class="s124">Vol. 36, No. 6 (June 1988), pp. </a><a href="#bookmark833" class="a">73</a>4<a href="#bookmark838" class="s124">–</a><a href="#bookmark838" class="a">74</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Turner 2012] <a href="http://blogs.nmscommunications.com/communications/2008/10/2g-3g-4g-wireless-tutorial.html" class="s124" target="_blank">B. Turner, “2G, 3G, 4G Wireless Tutorial,” </a><a href="http://blogs.nmscommunications.com/communications/2008/10/2g-3g-4g-wireless-tutorial.html" class="s123" target="_blank">http://blogs.nmscommunications.com/communications/2008/10/2g-3g-4g-wireless-tutorial.html</a></p><p class="s28" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;">[UPnP Forum 2016] <a href="http://www.upnp.org/" class="s124" target="_blank">UPnP Forum homepage, </a><a href="http://www.upnp.org/" class="a" target="_blank">http://www.upnp.org/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[van der Berg 2008] <a href="http://arstechnica.com/guides/other/peering-and-transit.ars" class="s124" target="_blank">R. van der Berg, “How the ’Net Works: An Introduction to Peering and Transit,” </a><a href="http://arstechnica.com/guides/other/peering-and-transit.ars" class="a" target="_blank">http://arstechnica.com/guides/other/peering-and-transit.ars</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[van der Merwe 1998] </span><span class="p">J. van der Merwe, S. Rooney, I. Leslie, S. Crosby, “The Tempest: A Practical Framework for Network Programmability,” </span><span class="s17">IEEE Network, </span><a href="#bookmark36" class="s124">Vol. 12, No. 3 (May 1998), pp. </a><a href="#bookmark36" class="a">2</a>0<a href="#bookmark52" class="s124">–</a><a href="#bookmark52" class="a">2</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;"><b>[Varghese 1997] </b>G. Varghese, A. Lauck, “Hashed and Hierarchical Timing Wheels: Efficient Data Structures for Implementing a Timer Facility,” <i>IEEE/ACM Transactions on Networking, </i><a href="https://jigsaw.vitalsource.com/books/9780134296159/epub/OPS/xhtml/fileP700101195200000000000000000CCD7.xhtml#P7001011952000000000000000005494" class="s124" target="_blank">Vol. 5, No. 6 (Dec. 1997), pp. </a><a href="https://jigsaw.vitalsource.com/books/9780134296159/epub/OPS/xhtml/fileP700101195200000000000000000CCD7.xhtml#P7001011952000000000000000005494" class="a" target="_blank">82</a><span class="s20">4</span>–834.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -21pt;line-height: 146%;text-align: left;"><b>[Vasudevan 2012] </b>S. Vasudevan, C. Diot, J. Kurose, D. Towsley, “Facilitating Access Point Selection in IEEE 802.11 Wireless Networks,” <i>Proc. 2005 ACM Internet Measurement Conference</i>, (San Francisco CA, Oct. 2005).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Villamizar 1994] </span><span class="p">C. Villamizar, C. Song. “High Performance tcp in ansnet,” </span><span class="s17">ACM SIGCOMM Computer Communications Review</span><a href="#bookmark78" class="s124">, Vol. 24, No. 5 (1994), pp. </a><a href="#bookmark78" class="a">4</a>5<a href="#bookmark103" class="s124">–</a><a href="#bookmark103" class="a">6</a>0<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Viterbi 1995] </b>A. Viterbi, <i>CDMA: Principles of Spread Spectrum Communication, </i>Addison-Wesley, Reading, MA, 1995.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Vixie 2009] </span><span class="p">P. Vixie, “What DNS Is Not,” </span><span class="s17">Communications of the ACM, </span><a href="#bookmark74" class="s124">Vol. 52, No. 12 (Dec. 2009), pp. </a><a href="#bookmark74" class="a">4</a>3<a href="#bookmark83" class="s124">–</a><a href="#bookmark83" class="a">4</a>7<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Wakeman 1992] </span><span class="p">I. Wakeman, J. Crowcroft, Z. Wang, D. Sirovica, “Layering Considered Harmful,” </span><span class="s17">IEEE Network </span><a href="#bookmark36" class="s124">(Jan. 1992), pp. </a><a href="#bookmark36" class="a">2</a>0<a href="#bookmark44" class="s124">–</a><a href="#bookmark44" class="a">2</a>4<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Waldrop 2007] </b>M. Waldrop, “Data Center in a Box,” <i>Scientific American </i>(July 2007).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 130%;text-align: left;"><b>[Wang 2004] </b>B. Wang, J. Kurose, P. Shenoy, D. Towsley, “Multimedia Streaming via TCP: An Analytic Performance Study,” <i>Proc. 2004 ACM Multimedia Conference </i>(New York, NY, Oct. 2004).</p><p style="text-indent: 0pt;line-height: 6pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><span style=" color: #333;">[Wang 2008] </span><span class="p">B. Wang, J. Kurose, P. Shenoy, D. Towsley, “Multimedia Streaming via TCP: An Analytic Performance Study</span><span class="s17">,” ACM Transactions on Multimedia Computing Communications and Applications (TOMCCAP)</span><a href="#bookmark29" class="s124">, Vol. 4, No. 2 (Apr. 2008), p. </a><a href="#bookmark29" class="a">1</a>6<a href="#bookmark3" class="s124">. </a>1<a href="#bookmark41" class="s124">–</a><a href="#bookmark41" class="a">2</a>2<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Wang 2010] </b>G. Wang, D. G. Andersen, M. Kaminsky, K. Papagiannaki, T. S. E. Ng, M. Kozuch, M. Ryan, “c-Through: Part-time Optics in Data Centers,” <i>Proc. 2010 ACM SIGCOMM</i>.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Wei 2006] </b>W. Wei, C. Zhang, H. Zang, J. Kurose, D. Towsley, “Inference and Evaluation of Split-Connection Approaches in Cellular Data Networks,” <i>Proc. Active and Passive Measurement Workshop </i>(Adelaide, Australia, Mar. 2006).</p><p style="padding-top: 3pt;padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Wei 2007] </b>D. X. Wei, C. Jin, S. H. Low, S. Hegde, “FAST TCP: Motivation, Architecture, Algorithms, Performance,” <i>IEEE/ACM Transactions on Networking </i>(2007).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;">[Weiser 1991] <span class="p">M. Weiser, “The Computer for the Twenty-First Century,” </span><i>Scientific American </i><a href="http://www.ubiq.com/hypertext/weiser/SciAmDraft3.html" class="s124" target="_blank">(Sept. 1991): 94–10. </a><a href="http://www.ubiq.com/hypertext/weiser/SciAmDraft3.html" class="a" target="_blank">http://www.ubiq.com/hypertext/weiser/ SciAmDraft3.html</a></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[White 2011] </b>A. White, K. Snow, A. Matthews, F. Monrose, “Hookt on fon-iks: Phonotactic Reconstruction of Encrypted VoIP Conversations,” <i>IEEE Symposium on Security and Privacy</i>, Oakland, CA, 2011.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Wigle.net 2016] <a href="http://www.wigle.net/" class="s124" target="_blank">Wireless Geographic Logging Engine, </a><a href="http://www.wigle.net/" class="a" target="_blank">http://www.wigle.net</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Wiki Satellite 2016] <a href="https://en.wikipedia.org/wiki/Satellite_Internet_access" class="s124" target="_blank">Satellite Internet access, </a><a href="https://en.wikipedia.org/wiki/Satellite_Internet_access" class="a" target="_blank">https://en.wikipedia.org/wiki/Satellite_Internet_access</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;">[Wireshark 2016] <a href="http://www.wireshark.org/" class="s124" target="_blank">Wireshark homepage, </a><a href="http://www.wireshark.org/" class="a" target="_blank">http://www.wireshark.org</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Wischik 2005] </b>D. Wischik, N. McKeown, “Part I: Buffer Sizes for Core Routers,” <i>ACM SIGCOMM Computer Communications Review</i>, Vol. 35, No. 3 (July 2005).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><span style=" color: #333;">[Woo 1994] </span><span class="p">T. Woo, R. Bindignavle, S. Su, S. Lam, “SNP: an interface for secure network programming,” </span><span class="s17">Proc. 1994 Summer USENIX </span><a href="#bookmark78" class="s124">(Boston, MA, June 1994), pp. </a><a href="#bookmark78" class="a">4</a>5<a href="#bookmark100" class="s124">–</a><a href="#bookmark100" class="a">5</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Wright 2015] </b>J. Wright, J. <i>Wireless Security Secrets &amp; Solutions, </i>3e, “Hacking Exposed Wireless,” McGraw-Hill Education, 2015.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Wu 2005] <span class="p">J. Wu, Z. M. Mao, J. Rexford, J. Wang, “Finding a Needle in a Haystack: Pinpointing Significant BGP Routing Changes in an IP Network,” </span><i>Proc. USENIX NSDI</i></p><p style="padding-top: 4pt;padding-left: 27pt;text-indent: 0pt;text-align: left;">(2005).</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">[Xanadu 2012] <a href="http://www.xanadu.com/" class="s124" target="_blank">Xanadu Project homepage, </a><a href="http://www.xanadu.com/" class="a" target="_blank">http://www.xanadu.com/</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Xiao 2000] </b>X. Xiao, A. Hannan, B. Bailey, L. Ni, “Traffic Engineering with MPLS in the Internet,” <i>IEEE Network </i>(Mar./Apr. 2000).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 6pt;text-indent: 0pt;text-align: left;"><b>[Xu 2004] </b>L. Xu, K Harfoush, I. Rhee, “Binary Increase Congestion Control (BIC) for Fast Long-Distance Networks,” <i>IEEE INFOCOM 2004, </i>pp. 2514–2524.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 27pt;text-indent: -20pt;line-height: 146%;text-align: left;"><b>[Yavatkar 1994] </b>R. Yavatkar, N. Bhagwat, “Improving End-to-End Performance of TCP over Mobile Internetworks,” <i>Proc. Mobile 94 Workshop on Mobile Computing Systems and Applications </i>(Dec. 1994).</p><p class="s28" style="padding-top: 3pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark839">[YouTube 2009] </a><span class="p">YouTube 2009, Google container data center tour, 2009.</span><a name="bookmark848">&zwnj;</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s28" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark840">[YouTube 2016] </a><a href="https://www.youtube.com/yt/press/statistics.html" class="s124" target="_blank">YouTube Statistics, 2016, </a><a href="https://www.youtube.com/yt/press/statistics.html" class="a" target="_blank">https://www.youtube.com/yt/press/ statistics.html</a></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark841"><span style=" color: #333;">[Yu 2004] </span></a><span class="p">Yu, Fang, H. Katz, Tirunellai V. Lakshman. “Gigabit Rate Packet Pattern-Matching Using TCAM,” </span><span class="s17">Proc. 2004 Int. Conf. Network Protocols, </span><a href="#bookmark245" class="s124">pp. </a><a href="#bookmark245" class="a">17</a>4<a href="#bookmark248" class="s124">–</a><a href="#bookmark248" class="a">18</a>3<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark842"><b>[Yu 2011] </b></a>M. Yu, J. Rexford, X. Sun, S. Rao, N. Feamster, “A Survey of VLAN Usage in Campus Networks,” <i>IEEE Communications Magazine, </i>July 2011.</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark843"><b>[Zegura 1997] </b></a>E. Zegura, K. Calvert, M. Donahoo, “A Quantitative Comparison of Graph-based Models for Internet Topology,” <i>IEEE/ACM Transactions on Networking, </i>Vol.</p><p style="text-indent: 0pt;line-height: 7pt;text-align: left;"><br/></p><p class="s43" style="text-indent: 0pt;text-align: center;"><a href="http://www.cc.gatech.edu/projects/gtim" class="s124" target="_blank">5, No. 6, (Dec. 1997). See also </a><a href="http://www.cc.gatech.edu/projects/gtim" class="s123" target="_blank">http://www.cc.gatech.edu/projects/gtim</a> <span style=" color: #333;">for a software package that generates networks with a transit-stub structure.</span></p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><a name="bookmark844"><span style=" color: #333;">[Zhang 1993] </span></a><span class="p">L. Zhang, S. Deering, D. Estrin, S. Shenker, D. Zappala, “RSVP: A New Resource Reservation Protocol,” </span><span class="s17">IEEE Network Magazine, </span><a href="#bookmark14" class="s124">Vol. 7, No. 9 (Sept. 1993), pp. </a>8<a href="#bookmark34" class="s124">–</a><a href="#bookmark34" class="a">1</a>8<span class="p">.</span></p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark845"><b>[Zhang 2007] </b></a>L. Zhang, “A Retrospective View of NAT<i>,” The IETF Journal</i>, Vol. 3, Issue 2 (Oct. 2007).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><a name="bookmark846"><b>[Zhang 2015] </b></a>G. Zhang, W. Liu, X. Hei, W. Cheng, “Unreeling Xunlei Kankan: Understanding Hybrid CDN-P2P Video-on-Demand Streaming,” <i>IEEE Transactions on Multimedia</i>, Vol. 17, No. 2, Feb. 2015.</p><p style="text-indent: 0pt;line-height: 10pt;text-align: left;"><br/></p><p style="padding-left: 5pt;text-indent: 0pt;text-align: left;"><b>[Zhang X 2102] </b>X. Zhang, Y. Xu, Y. Liu, Z. Guo, Y. Wang, “Profiling Skype Video Calls: Rate Control and Video Quality,” <i>IEEE INFOCOM </i>(Mar. 2012).</p><p style="text-indent: 0pt;line-height: 8pt;text-align: left;"><br/></p><p class="s20" style="padding-left: 26pt;text-indent: -20pt;line-height: 146%;text-align: left;"><a name="bookmark847"><span style=" color: #333;">[Zink 2009] </span></a><span class="p">M. Zink, K. Suh, Y. Gu, J. Kurose, “Characteristics of YouTube Network Traffic at a Campus Network—Measurements, Models, and Implications,” </span><span class="s17">Computer Networks</span><a href="#bookmark575" class="s124">, Vol. 53, No. 4, pp. </a><a href="#bookmark575" class="a">50</a>1<a href="#bookmark586" class="s124">–</a><a href="#bookmark586" class="a">51</a>4<span class="p">, 2009.</span></p><p style="text-indent: 0pt;line-height: 14pt;text-align: left;"><br/></p><p class="s18" style="padding-top: 2pt;padding-left: 5pt;text-indent: 0pt;text-align: left;"><a name="bookmark849">Index</a><a name="bookmark850">&zwnj;</a></p></body></html>
